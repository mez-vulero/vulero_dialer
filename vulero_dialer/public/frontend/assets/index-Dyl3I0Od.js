var aR=Object.defineProperty,lR=Object.defineProperties;var cR=Object.getOwnPropertyDescriptors;var Ad=Object.getOwnPropertySymbols;var hb=Object.prototype.hasOwnProperty,pb=Object.prototype.propertyIsEnumerable;var fb=(n,e,t)=>e in n?aR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Y=(n,e)=>{for(var t in e||(e={}))hb.call(e,t)&&fb(n,t,e[t]);if(Ad)for(var t of Ad(e))pb.call(e,t)&&fb(n,t,e[t]);return n},Te=(n,e)=>lR(n,cR(e));var En=(n,e)=>{var t={};for(var r in n)hb.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Ad)for(var r of Ad(n))e.indexOf(r)<0&&pb.call(n,r)&&(t[r]=n[r]);return t};var Zt=(n,e,t)=>new Promise((r,i)=>{var s=l=>{try{a(t.next(l))}catch(c){i(c)}},o=l=>{try{a(t.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(n,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ey(n,e){const t=new Set(n.split(","));return e?r=>t.has(r.toLowerCase()):r=>t.has(r)}const bt={},Za=[],Ar=()=>{},uR=()=>!1,fp=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),ty=n=>n.startsWith("onUpdate:"),Ut=Object.assign,ny=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},dR=Object.prototype.hasOwnProperty,tt=(n,e)=>dR.call(n,e),Re=Array.isArray,Qa=n=>hp(n)==="[object Map]",o_=n=>hp(n)==="[object Set]",Le=n=>typeof n=="function",Mt=n=>typeof n=="string",jl=n=>typeof n=="symbol",St=n=>n!==null&&typeof n=="object",a_=n=>(St(n)||Le(n))&&Le(n.then)&&Le(n.catch),l_=Object.prototype.toString,hp=n=>l_.call(n),fR=n=>hp(n).slice(8,-1),c_=n=>hp(n)==="[object Object]",ry=n=>Mt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,qc=ey(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),pp=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},hR=/-(\w)/g,ei=pp(n=>n.replace(hR,(e,t)=>t?t.toUpperCase():"")),pR=/\B([A-Z])/g,Us=pp(n=>n.replace(pR,"-$1").toLowerCase()),mp=pp(n=>n.charAt(0).toUpperCase()+n.slice(1)),mm=pp(n=>n?`on${mp(n)}`:""),xi=(n,e)=>!Object.is(n,e),gm=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},ch=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},mR=n=>{const e=parseFloat(n);return isNaN(e)?n:e},gR=n=>{const e=Mt(n)?Number(n):NaN;return isNaN(e)?n:e};let mb;const u_=()=>mb||(mb=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Fl(n){if(Re(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=Mt(r)?wR(r):Fl(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(Mt(n)||St(n))return n}const yR=/;(?![^(]*\))/g,vR=/:([^]+)/,bR=/\/\*[^]*?\*\//g;function wR(n){const e={};return n.replace(bR,"").split(yR).forEach(t=>{if(t){const r=t.split(vR);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function De(n){let e="";if(Mt(n))e=n;else if(Re(n))for(let t=0;t<n.length;t++){const r=De(n[t]);r&&(e+=r+" ")}else if(St(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function Mr(n){if(!n)return null;let{class:e,style:t}=n;return e&&!Mt(e)&&(n.class=De(e)),t&&(n.style=Fl(t)),n}const xR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",SR=ey(xR);function d_(n){return!!n||n===""}const Ge=n=>Mt(n)?n:n==null?"":Re(n)||St(n)&&(n.toString===l_||!Le(n.toString))?JSON.stringify(n,f_,2):String(n),f_=(n,e)=>e&&e.__v_isRef?f_(n,e.value):Qa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i],s)=>(t[ym(r,s)+" =>"]=i,t),{})}:o_(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>ym(t))}:jl(e)?ym(e):St(e)&&!Re(e)&&!c_(e)?String(e):e,ym=(n,e="")=>{var t;return jl(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ur;class h_{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ur,!e&&ur&&(this.index=(ur.scopes||(ur.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ur;try{return ur=this,e()}finally{ur=t}}}on(){ur=this}off(){ur=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function p_(n){return new h_(n)}function _R(n,e=ur){e&&e.active&&e.effects.push(n)}function iy(){return ur}function sy(n){ur&&ur.cleanups.push(n)}let Do;class oy{constructor(e,t,r,i){this.fn=e,this.trigger=t,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,_R(this,i)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,ua();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(CR(t.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),da()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=$s,t=Do;try{return $s=!0,Do=this,this._runnings++,gb(this),this.fn()}finally{yb(this),this._runnings--,Do=t,$s=e}}stop(){var e;this.active&&(gb(this),yb(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function CR(n){return n.value}function gb(n){n._trackId++,n._depsLength=0}function yb(n){if(n.deps.length>n._depsLength){for(let e=n._depsLength;e<n.deps.length;e++)m_(n.deps[e],n);n.deps.length=n._depsLength}}function m_(n,e){const t=n.get(e);t!==void 0&&e._trackId!==t&&(n.delete(e),n.size===0&&n.cleanup())}let $s=!0,Zg=0;const g_=[];function ua(){g_.push($s),$s=!1}function da(){const n=g_.pop();$s=n===void 0?!0:n}function ay(){Zg++}function ly(){for(Zg--;!Zg&&Qg.length;)Qg.shift()()}function y_(n,e,t){if(e.get(n)!==n._trackId){e.set(n,n._trackId);const r=n.deps[n._depsLength];r!==e?(r&&m_(r,n),n.deps[n._depsLength++]=e):n._depsLength++}}const Qg=[];function v_(n,e,t){ay();for(const r of n.keys()){let i;r._dirtyLevel<e&&(i!=null?i:i=n.get(r)===r._trackId)&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=e),r._shouldSchedule&&(i!=null?i:i=n.get(r)===r._trackId)&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Qg.push(r.scheduler)))}ly()}const b_=(n,e)=>{const t=new Map;return t.cleanup=n,t.computed=e,t},uh=new WeakMap,$o=Symbol(""),e0=Symbol("");function rr(n,e,t){if($s&&Do){let r=uh.get(n);r||uh.set(n,r=new Map);let i=r.get(t);i||r.set(t,i=b_(()=>r.delete(t))),y_(Do,i)}}function Vi(n,e,t,r,i,s){const o=uh.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&Re(n)){const l=Number(r);o.forEach((c,u)=>{(u==="length"||!jl(u)&&u>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":Re(n)?ry(t)&&a.push(o.get("length")):(a.push(o.get($o)),Qa(n)&&a.push(o.get(e0)));break;case"delete":Re(n)||(a.push(o.get($o)),Qa(n)&&a.push(o.get(e0)));break;case"set":Qa(n)&&a.push(o.get($o));break}ay();for(const l of a)l&&v_(l,4);ly()}function kR(n,e){var t;return(t=uh.get(n))==null?void 0:t.get(e)}const ER=ey("__proto__,__v_isRef,__isVue"),w_=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(jl)),vb=TR();function TR(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=ze(this);for(let s=0,o=this.length;s<o;s++)rr(r,"get",s+"");const i=r[e](...t);return i===-1||i===!1?r[e](...t.map(ze)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){ua(),ay();const r=ze(this)[e].apply(this,t);return ly(),da(),r}}),n}function AR(n){const e=ze(this);return rr(e,"has",n),e.hasOwnProperty(n)}class x_{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?T_:E_:s?k_:C_).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=Re(e);if(!i){if(o&&tt(vb,t))return Reflect.get(vb,t,r);if(t==="hasOwnProperty")return AR}const a=Reflect.get(e,t,r);return(jl(t)?w_.has(t):ER(t))||(i||rr(e,"get",t),s)?a:Lt(a)?o&&ry(t)?a:a.value:St(a)?i?M_(a):zr(a):a}}class S_ extends x_{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];if(!this._isShallow){const l=dl(s);if(!dh(r)&&!dl(r)&&(s=ze(s),r=ze(r)),!Re(e)&&Lt(s)&&!Lt(r))return l?!1:(s.value=r,!0)}const o=Re(e)&&ry(t)?Number(t)<e.length:tt(e,t),a=Reflect.set(e,t,r,i);return e===ze(i)&&(o?xi(r,s)&&Vi(e,"set",t,r):Vi(e,"add",t,r)),a}deleteProperty(e,t){const r=tt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&Vi(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!jl(t)||!w_.has(t))&&rr(e,"has",t),r}ownKeys(e){return rr(e,"iterate",Re(e)?"length":$o),Reflect.ownKeys(e)}}class __ extends x_{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const MR=new S_,RR=new __,IR=new S_(!0),OR=new __(!0),cy=n=>n,gp=n=>Reflect.getPrototypeOf(n);function Md(n,e,t=!1,r=!1){n=n.__v_raw;const i=ze(n),s=ze(e);t||(xi(e,s)&&rr(i,"get",e),rr(i,"get",s));const{has:o}=gp(i),a=r?cy:t?uy:xu;if(o.call(i,e))return a(n.get(e));if(o.call(i,s))return a(n.get(s));n!==i&&n.get(e)}function Rd(n,e=!1){const t=this.__v_raw,r=ze(t),i=ze(n);return e||(xi(n,i)&&rr(r,"has",n),rr(r,"has",i)),n===i?t.has(n):t.has(n)||t.has(i)}function Id(n,e=!1){return n=n.__v_raw,!e&&rr(ze(n),"iterate",$o),Reflect.get(n,"size",n)}function bb(n){n=ze(n);const e=ze(this);return gp(e).has.call(e,n)||(e.add(n),Vi(e,"add",n,n)),this}function wb(n,e){e=ze(e);const t=ze(this),{has:r,get:i}=gp(t);let s=r.call(t,n);s||(n=ze(n),s=r.call(t,n));const o=i.call(t,n);return t.set(n,e),s?xi(e,o)&&Vi(t,"set",n,e):Vi(t,"add",n,e),this}function xb(n){const e=ze(this),{has:t,get:r}=gp(e);let i=t.call(e,n);i||(n=ze(n),i=t.call(e,n)),r&&r.call(e,n);const s=e.delete(n);return i&&Vi(e,"delete",n,void 0),s}function Sb(){const n=ze(this),e=n.size!==0,t=n.clear();return e&&Vi(n,"clear",void 0,void 0),t}function Od(n,e){return function(r,i){const s=this,o=s.__v_raw,a=ze(o),l=e?cy:n?uy:xu;return!n&&rr(a,"iterate",$o),o.forEach((c,u)=>r.call(i,l(c),l(u),s))}}function Pd(n,e,t){return function(...r){const i=this.__v_raw,s=ze(i),o=Qa(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=i[n](...r),u=t?cy:e?uy:xu;return!e&&rr(s,"iterate",l?e0:$o),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[u(d[0]),u(d[1])]:u(d),done:f}},[Symbol.iterator](){return this}}}}function is(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function PR(){const n={get(s){return Md(this,s)},get size(){return Id(this)},has:Rd,add:bb,set:wb,delete:xb,clear:Sb,forEach:Od(!1,!1)},e={get(s){return Md(this,s,!1,!0)},get size(){return Id(this)},has:Rd,add:bb,set:wb,delete:xb,clear:Sb,forEach:Od(!1,!0)},t={get(s){return Md(this,s,!0)},get size(){return Id(this,!0)},has(s){return Rd.call(this,s,!0)},add:is("add"),set:is("set"),delete:is("delete"),clear:is("clear"),forEach:Od(!0,!1)},r={get(s){return Md(this,s,!0,!0)},get size(){return Id(this,!0)},has(s){return Rd.call(this,s,!0)},add:is("add"),set:is("set"),delete:is("delete"),clear:is("clear"),forEach:Od(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Pd(s,!1,!1),t[s]=Pd(s,!0,!1),e[s]=Pd(s,!1,!0),r[s]=Pd(s,!0,!0)}),[n,t,e,r]}const[DR,$R,NR,LR]=PR();function yp(n,e){const t=e?n?LR:NR:n?$R:DR;return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(tt(t,i)&&i in r?t:r,i,s)}const jR={get:yp(!1,!1)},FR={get:yp(!1,!0)},HR={get:yp(!0,!1)},BR={get:yp(!0,!0)},C_=new WeakMap,k_=new WeakMap,E_=new WeakMap,T_=new WeakMap;function zR(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function VR(n){return n.__v_skip||!Object.isExtensible(n)?0:zR(fR(n))}function zr(n){return dl(n)?n:vp(n,!1,MR,jR,C_)}function A_(n){return vp(n,!1,IR,FR,k_)}function M_(n){return vp(n,!0,RR,HR,E_)}function Iee(n){return vp(n,!0,OR,BR,T_)}function vp(n,e,t,r,i){if(!St(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=VR(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function Ns(n){return dl(n)?Ns(n.__v_raw):!!(n&&n.__v_isReactive)}function dl(n){return!!(n&&n.__v_isReadonly)}function dh(n){return!!(n&&n.__v_isShallow)}function R_(n){return Ns(n)||dl(n)}function ze(n){const e=n&&n.__v_raw;return e?ze(e):n}function Hl(n){return Object.isExtensible(n)&&ch(n,"__v_skip",!0),n}const xu=n=>St(n)?zr(n):n,uy=n=>St(n)?M_(n):n;class I_{constructor(e,t,r,i){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new oy(()=>e(this._value),()=>el(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=ze(this);return(!e._cacheable||e.effect.dirty)&&xi(e._value,e._value=e.effect.run())&&el(e,4),dy(e),e.effect._dirtyLevel>=2&&el(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function O_(n,e,t=!1){let r,i;const s=Le(n);return s?(r=n,i=Ar):(r=n.get,i=n.set),new I_(r,i,s||!i,t)}function dy(n){var e;$s&&Do&&(n=ze(n),y_(Do,(e=n.dep)!=null?e:n.dep=b_(()=>n.dep=void 0,n instanceof I_?n:void 0)))}function el(n,e=4,t){n=ze(n);const r=n.dep;r&&v_(r,e)}function Lt(n){return!!(n&&n.__v_isRef===!0)}function de(n){return P_(n,!1)}function fy(n){return P_(n,!0)}function P_(n,e){return Lt(n)?n:new qR(n,e)}class qR{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:ze(e),this._value=t?e:xu(e)}get value(){return dy(this),this._value}set value(e){const t=this.__v_isShallow||dh(e)||dl(e);e=t?e:ze(e),xi(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:xu(e),el(this,4))}}function _b(n){el(n,4)}function we(n){return Lt(n)?n.value:n}const UR={get:(n,e,t)=>we(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return Lt(i)&&!Lt(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function D_(n){return Ns(n)?n:new Proxy(n,UR)}class WR{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:r}=e(()=>dy(this),()=>el(this));this._get=t,this._set=r}get value(){return this._get()}set value(e){this._set(e)}}function hy(n){return new WR(n)}function $_(n){const e=Re(n)?new Array(n.length):{};for(const t in n)e[t]=N_(n,t);return e}class JR{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return kR(ze(this._object),this._key)}}class KR{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Oee(n,e,t){return Lt(n)?n:Le(n)?new KR(n):St(n)&&arguments.length>1?N_(n,e,t):de(n)}function N_(n,e,t){const r=n[e];return Lt(r)?r:new JR(n,e,t)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ls(n,e,t,r){try{return r?n(...r):n()}catch(i){Qu(i,e,t)}}function Or(n,e,t,r){if(Le(n)){const s=Ls(n,e,t,r);return s&&a_(s)&&s.catch(o=>{Qu(o,e,t)}),s}const i=[];for(let s=0;s<n.length;s++)i.push(Or(n[s],e,t,r));return i}function Qu(n,e,t,r=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${t}`;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](n,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){Ls(l,null,10,[n,o,a]);return}}GR(n,t,i,r)}function GR(n,e,t,r=!0){console.error(n)}let Su=!1,t0=!1;const yn=[];let gi=0;const tl=[];let ms=null,go=0;const L_=Promise.resolve();let py=null;function Dn(n){const e=py||L_;return n?e.then(this?n.bind(this):n):e}function YR(n){let e=gi+1,t=yn.length;for(;e<t;){const r=e+t>>>1,i=yn[r],s=_u(i);s<n||s===n&&i.pre?e=r+1:t=r}return e}function bp(n){(!yn.length||!yn.includes(n,Su&&n.allowRecurse?gi+1:gi))&&(n.id==null?yn.push(n):yn.splice(YR(n.id),0,n),j_())}function j_(){!Su&&!t0&&(t0=!0,py=L_.then(H_))}function XR(n){const e=yn.indexOf(n);e>gi&&yn.splice(e,1)}function ZR(n){Re(n)?tl.push(...n):(!ms||!ms.includes(n,n.allowRecurse?go+1:go))&&tl.push(n),j_()}function Cb(n,e,t=Su?gi+1:0){for(;t<yn.length;t++){const r=yn[t];if(r&&r.pre){if(n&&r.id!==n.uid)continue;yn.splice(t,1),t--,r()}}}function F_(n){if(tl.length){const e=[...new Set(tl)].sort((t,r)=>_u(t)-_u(r));if(tl.length=0,ms){ms.push(...e);return}for(ms=e,go=0;go<ms.length;go++)ms[go]();ms=null,go=0}}const _u=n=>n.id==null?1/0:n.id,QR=(n,e)=>{const t=_u(n)-_u(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function H_(n){t0=!1,Su=!0,yn.sort(QR);try{for(gi=0;gi<yn.length;gi++){const e=yn[gi];e&&e.active!==!1&&Ls(e,null,14)}}finally{gi=0,yn.length=0,F_(),Su=!1,py=null,(yn.length||tl.length)&&H_()}}function eI(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||bt;let i=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:f}=r[u]||bt;f&&(i=t.map(p=>Mt(p)?p.trim():p)),d&&(i=t.map(mR))}let a,l=r[a=mm(e)]||r[a=mm(ei(e))];!l&&s&&(l=r[a=mm(Us(e))]),l&&Or(l,n,6,i);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Or(c,n,6,i)}}function B_(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},a=!1;if(!Le(n)){const l=c=>{const u=B_(c,e,!0);u&&(a=!0,Ut(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(St(n)&&r.set(n,null),null):(Re(s)?s.forEach(l=>o[l]=null):Ut(o,s),St(n)&&r.set(n,o),o)}function wp(n,e){return!n||!fp(e)?!1:(e=e.slice(2).replace(/Once$/,""),tt(n,e[0].toLowerCase()+e.slice(1))||tt(n,Us(e))||tt(n,e))}let Bt=null,xp=null;function fh(n){const e=Bt;return Bt=n,xp=n&&n.type.__scopeId||null,e}function tI(n){xp=n}function nI(){xp=null}function Ue(n,e=Bt,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&jb(-1);const s=fh(e);let o;try{o=n(...i)}finally{fh(s),r._d&&jb(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function vm(n){const{type:e,vnode:t,proxy:r,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:d,data:f,setupState:p,ctx:m,inheritAttrs:v}=n;let x,b;const _=fh(n);try{if(t.shapeFlag&4){const h=i||r,w=h;x=fi(u.call(w,h,d,s,p,f,m)),b=l}else{const h=e;x=fi(h.length>1?h(s,{attrs:l,slots:a,emit:c}):h(s,null)),b=e.props?l:rI(l)}}catch(h){Kc.length=0,Qu(h,n,1),x=ye(Pr)}let M=x;if(b&&v!==!1){const h=Object.keys(b),{shapeFlag:w}=M;h.length&&w&7&&(o&&h.some(ty)&&(b=iI(b,o)),M=_i(M,b))}return t.dirs&&(M=_i(M),M.dirs=M.dirs?M.dirs.concat(t.dirs):t.dirs),t.transition&&(M.transition=t.transition),x=M,fh(_),x}const rI=n=>{let e;for(const t in n)(t==="class"||t==="style"||fp(t))&&((e||(e={}))[t]=n[t]);return e},iI=(n,e)=>{const t={};for(const r in n)(!ty(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function sI(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?kb(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const f=u[d];if(o[f]!==r[f]&&!wp(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?kb(r,o,c):!0:!!o;return!1}function kb(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!wp(t,s))return!0}return!1}function oI({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const my="components";function mt(n,e){return V_(my,n,!0,e)||n}const z_=Symbol.for("v-ndc");function bf(n){return Mt(n)?V_(my,n,!1)||n:n||z_}function V_(n,e,t=!0,r=!1){const i=Bt||Jt;if(i){const s=i.type;if(n===my){const a=tO(s,!1);if(a&&(a===e||a===ei(e)||a===mp(ei(e))))return s}const o=Eb(i[n]||s[n],e)||Eb(i.appContext[n],e);return!o&&r?s:o}}function Eb(n,e){return n&&(n[e]||n[ei(e)]||n[mp(ei(e))])}const aI=n=>n.__isSuspense;function lI(n,e){e&&e.pendingBranch?Re(n)?e.effects.push(...n):e.effects.push(n):ZR(n)}const cI=Symbol.for("v-scx"),uI=()=>_t(cI);function Yt(n,e){return Sp(n,null,e)}function dI(n,e){return Sp(n,null,{flush:"sync"})}const Dd={};function At(n,e,t){return Sp(n,e,t)}function Sp(n,e,{immediate:t,deep:r,flush:i,once:s,onTrack:o,onTrigger:a}=bt){if(e&&s){const y=e;e=(...E)=>{y(...E),w()}}const l=Jt,c=y=>r===!0?y:Co(y,r===!1?1:void 0);let u,d=!1,f=!1;if(Lt(n)?(u=()=>n.value,d=dh(n)):Ns(n)?(u=()=>c(n),d=!0):Re(n)?(f=!0,d=n.some(y=>Ns(y)||dh(y)),u=()=>n.map(y=>{if(Lt(y))return y.value;if(Ns(y))return c(y);if(Le(y))return Ls(y,l,2)})):Le(n)?e?u=()=>Ls(n,l,2):u=()=>(p&&p(),Or(n,l,3,[m])):u=Ar,e&&r){const y=u;u=()=>Co(y())}let p,m=y=>{p=M.onStop=()=>{Ls(y,l,4),p=M.onStop=void 0}},v;if(id)if(m=Ar,e?t&&Or(e,l,3,[u(),f?[]:void 0,m]):u(),i==="sync"){const y=uI();v=y.__watcherHandles||(y.__watcherHandles=[])}else return Ar;let x=f?new Array(n.length).fill(Dd):Dd;const b=()=>{if(!(!M.active||!M.dirty))if(e){const y=M.run();(r||d||(f?y.some((E,g)=>xi(E,x[g])):xi(y,x)))&&(p&&p(),Or(e,l,3,[y,x===Dd?void 0:f&&x[0]===Dd?[]:x,m]),x=y)}else M.run()};b.allowRecurse=!!e;let _;i==="sync"?_=b:i==="post"?_=()=>Vn(b,l&&l.suspense):(b.pre=!0,l&&(b.id=l.uid),_=()=>bp(b));const M=new oy(u,Ar,_),h=iy(),w=()=>{M.stop(),h&&ny(h.effects,M)};return e?t?b():x=M.run():i==="post"?Vn(M.run.bind(M),l&&l.suspense):M.run(),v&&v.push(w),w}function fI(n,e,t){const r=this.proxy,i=Mt(n)?n.includes(".")?q_(r,n):()=>r[n]:n.bind(r,r);let s;Le(e)?s=e:(s=e.handler,t=e);const o=rd(this),a=Sp(i,s.bind(r),t);return o(),a}function q_(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}function Co(n,e,t=0,r){if(!St(n)||n.__v_skip)return n;if(e&&e>0){if(t>=e)return n;t++}if(r=r||new Set,r.has(n))return n;if(r.add(n),Lt(n))Co(n.value,e,t,r);else if(Re(n))for(let i=0;i<n.length;i++)Co(n[i],e,t,r);else if(o_(n)||Qa(n))n.forEach(i=>{Co(i,e,t,r)});else if(c_(n))for(const i in n)Co(n[i],e,t,r);return n}function Xo(n,e){if(Bt===null)return n;const t=Ep(Bt)||Bt.proxy,r=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=bt]=e[i];s&&(Le(s)&&(s={mounted:s,updated:s}),s.deep&&Co(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function ro(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(ua(),Or(l,t,8,[n.el,a,n,e]),da())}}const gs=Symbol("_leaveCb"),$d=Symbol("_enterCb");function hI(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Et(()=>{n.isMounted=!0}),td(()=>{n.isUnmounting=!0}),n}const wr=[Function,Array],U_={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:wr,onEnter:wr,onAfterEnter:wr,onEnterCancelled:wr,onBeforeLeave:wr,onLeave:wr,onAfterLeave:wr,onLeaveCancelled:wr,onBeforeAppear:wr,onAppear:wr,onAfterAppear:wr,onAppearCancelled:wr},pI={name:"BaseTransition",props:U_,setup(n,{slots:e}){const t=Ws(),r=hI();return()=>{const i=e.default&&J_(e.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const f of i)if(f.type!==Pr){s=f;break}}const o=ze(n),{mode:a}=o;if(r.isLeaving)return bm(s);const l=Tb(s);if(!l)return bm(s);const c=n0(l,o,r,t);r0(l,c);const u=t.subTree,d=u&&Tb(u);if(d&&d.type!==Pr&&!yo(l,d)){const f=n0(d,o,r,t);if(r0(d,f),a==="out-in")return r.isLeaving=!0,f.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},bm(s);a==="in-out"&&l.type!==Pr&&(f.delayLeave=(p,m,v)=>{const x=W_(r,d);x[String(d.key)]=d,p[gs]=()=>{m(),p[gs]=void 0,delete c.delayedLeave},c.delayedLeave=v})}return s}}},mI=pI;function W_(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function n0(n,e,t,r){const{appear:i,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:f,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:v,onAppear:x,onAfterAppear:b,onAppearCancelled:_}=e,M=String(n.key),h=W_(t,n),w=(g,I)=>{g&&Or(g,r,9,I)},y=(g,I)=>{const R=I[1];w(g,I),Re(g)?g.every(S=>S.length<=1)&&R():g.length<=1&&R()},E={mode:s,persisted:o,beforeEnter(g){let I=a;if(!t.isMounted)if(i)I=v||a;else return;g[gs]&&g[gs](!0);const R=h[M];R&&yo(n,R)&&R.el[gs]&&R.el[gs](),w(I,[g])},enter(g){let I=l,R=c,S=u;if(!t.isMounted)if(i)I=x||l,R=b||c,S=_||u;else return;let k=!1;const T=g[$d]=C=>{k||(k=!0,C?w(S,[g]):w(R,[g]),E.delayedLeave&&E.delayedLeave(),g[$d]=void 0)};I?y(I,[g,T]):T()},leave(g,I){const R=String(n.key);if(g[$d]&&g[$d](!0),t.isUnmounting)return I();w(d,[g]);let S=!1;const k=g[gs]=T=>{S||(S=!0,I(),T?w(m,[g]):w(p,[g]),g[gs]=void 0,h[R]===n&&delete h[R])};h[R]=n,f?y(f,[g,k]):k()},clone(g){return n0(g,e,t,r)}};return E}function bm(n){if(ed(n))return n=_i(n),n.children=null,n}function Tb(n){return ed(n)?n.children?n.children[0]:void 0:n}function r0(n,e){n.shapeFlag&6&&n.component?r0(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function J_(n,e=!1,t){let r=[],i=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===lt?(o.patchFlag&128&&i++,r=r.concat(J_(o.children,e,a))):(e||o.type!==Pr)&&r.push(a!=null?_i(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function at(n,e){return Le(n)?Ut({name:n.name},e,{setup:n}):n}const Uc=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function Nd(n){Le(n)&&(n={loader:n});const{loader:e,loadingComponent:t,errorComponent:r,delay:i=200,timeout:s,suspensible:o=!0,onError:a}=n;let l=null,c,u=0;const d=()=>(u++,l=null,f()),f=()=>{let p;return l||(p=l=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),a)return new Promise((v,x)=>{a(m,()=>v(d()),()=>x(m),u+1)});throw m}).then(m=>p!==l&&l?l:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return at({name:"AsyncComponentWrapper",__asyncLoader:f,get __asyncResolved(){return c},setup(){const p=Jt;if(c)return()=>wm(c,p);const m=_=>{l=null,Qu(_,p,13,!r)};if(o&&p.suspense||id)return f().then(_=>()=>wm(_,p)).catch(_=>(m(_),()=>r?ye(r,{error:_}):null));const v=de(!1),x=de(),b=de(!!i);return i&&setTimeout(()=>{b.value=!1},i),s!=null&&setTimeout(()=>{if(!v.value&&!x.value){const _=new Error(`Async component timed out after ${s}ms.`);m(_),x.value=_}},s),f().then(()=>{v.value=!0,p.parent&&ed(p.parent.vnode)&&(p.parent.effect.dirty=!0,bp(p.parent.update))}).catch(_=>{m(_),x.value=_}),()=>{if(v.value&&c)return wm(c,p);if(x.value&&r)return ye(r,{error:x.value});if(t&&!b.value)return ye(t)}}})}function wm(n,e){const{ref:t,props:r,children:i,ce:s}=e.vnode,o=ye(n,r,i);return o.ref=t,o.ce=s,delete e.vnode.ce,o}const ed=n=>n.type.__isKeepAlive;function gI(n,e){K_(n,"a",e)}function yI(n,e){K_(n,"da",e)}function K_(n,e,t=Jt){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(_p(e,r,t),t){let i=t.parent;for(;i&&i.parent;)ed(i.parent.vnode)&&vI(r,e,t,i),i=i.parent}}function vI(n,e,t,r){const i=_p(e,n,r,!0);pr(()=>{ny(r[e],i)},t)}function _p(n,e,t=Jt,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;ua();const a=rd(t),l=Or(e,t,n,o);return a(),da(),l});return r?i.unshift(s):i.push(s),s}}const es=n=>(e,t=Jt)=>(!id||n==="sp")&&_p(n,(...r)=>e(...r),t),bI=es("bm"),Et=es("m"),wI=es("bu"),xI=es("u"),td=es("bum"),pr=es("um"),SI=es("sp"),_I=es("rtg"),CI=es("rtc");function kI(n,e=Jt){_p("ec",n,e)}function Si(n,e,t,r){let i;const s=t&&t[r];if(Re(n)||Mt(n)){i=new Array(n.length);for(let o=0,a=n.length;o<a;o++)i[o]=e(n[o],o,void 0,s&&s[o])}else if(typeof n=="number"){i=new Array(n);for(let o=0;o<n;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(St(n))if(n[Symbol.iterator])i=Array.from(n,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(n);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];i[a]=e(n[c],c,a,s&&s[a])}}else i=[];return t&&(t[r]=i),i}function xm(n,e){for(let t=0;t<e.length;t++){const r=e[t];if(Re(r))for(let i=0;i<r.length;i++)n[r[i].name]=r[i].fn;else r&&(n[r.name]=r.key?(...i)=>{const s=r.fn(...i);return s&&(s.key=r.key),s}:r.fn)}return n}function Ye(n,e,t={},r,i){if(Bt.isCE||Bt.parent&&Uc(Bt.parent)&&Bt.parent.isCE)return e!=="default"&&(t.name=e),ye("slot",t,r&&r());let s=n[e];s&&s._c&&(s._d=!1),q();const o=s&&G_(s(t)),a=dt(lt,{key:t.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&n._===1?64:-2);return!i&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function G_(n){return n.some(e=>ph(e)?!(e.type===Pr||e.type===lt&&!G_(e.children)):!0)?n:null}const i0=n=>n?lC(n)?Ep(n)||n.proxy:i0(n.parent):null,Wc=Ut(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>i0(n.parent),$root:n=>i0(n.root),$emit:n=>n.emit,$options:n=>yy(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,bp(n.update)}),$nextTick:n=>n.n||(n.n=Dn.bind(n.proxy)),$watch:n=>fI.bind(n)}),Sm=(n,e)=>n!==bt&&!n.__isScriptSetup&&tt(n,e),EI={get({_:n},e){const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(Sm(r,e))return o[e]=1,r[e];if(i!==bt&&tt(i,e))return o[e]=2,i[e];if((c=n.propsOptions[0])&&tt(c,e))return o[e]=3,s[e];if(t!==bt&&tt(t,e))return o[e]=4,t[e];s0&&(o[e]=0)}}const u=Wc[e];let d,f;if(u)return e==="$attrs"&&rr(n,"get",e),u(n);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==bt&&tt(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,tt(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return Sm(i,e)?(i[e]=t,!0):r!==bt&&tt(r,e)?(r[e]=t,!0):tt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!t[o]||n!==bt&&tt(n,o)||Sm(e,o)||(a=s[0])&&tt(a,o)||tt(r,o)||tt(Wc,o)||tt(i.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:tt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function gy(){return Y_().slots}function nd(){return Y_().attrs}function Y_(){const n=Ws();return n.setupContext||(n.setupContext=uC(n))}function Cu(n){return Re(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}function Pee(n,e){const t=Cu(n);for(const r in e){if(r.startsWith("__skip"))continue;let i=t[r];i?Re(i)||Le(i)?i=t[r]={type:i,default:e[r]}:i.default=e[r]:i===null&&(i=t[r]={default:e[r]}),i&&e[`__skip_${r}`]&&(i.skipFactory=!0)}return t}function Ab(n,e){return!n||!e?n||e:Re(n)&&Re(e)?n.concat(e):Ut({},Cu(n),Cu(e))}let s0=!0;function TI(n){const e=yy(n),t=n.proxy,r=n.ctx;s0=!1,e.beforeCreate&&Mb(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:f,beforeUpdate:p,updated:m,activated:v,deactivated:x,beforeDestroy:b,beforeUnmount:_,destroyed:M,unmounted:h,render:w,renderTracked:y,renderTriggered:E,errorCaptured:g,serverPrefetch:I,expose:R,inheritAttrs:S,components:k,directives:T,filters:C}=e;if(c&&AI(c,r,null),o)for(const O in o){const P=o[O];Le(P)&&(r[O]=P.bind(t))}if(i){const O=i.call(t,t);St(O)&&(n.data=zr(O))}if(s0=!0,s)for(const O in s){const P=s[O],N=Le(P)?P.bind(t,t):Le(P.get)?P.get.bind(t,t):Ar,F=!Le(P)&&Le(P.set)?P.set.bind(t):Ar,j=re({get:N,set:F});Object.defineProperty(r,O,{enumerable:!0,configurable:!0,get:()=>j.value,set:J=>j.value=J})}if(a)for(const O in a)X_(a[O],r,t,O);if(l){const O=Le(l)?l.call(t):l;Reflect.ownKeys(O).forEach(P=>{bn(P,O[P])})}u&&Mb(u,n,"c");function A(O,P){Re(P)?P.forEach(N=>O(N.bind(t))):P&&O(P.bind(t))}if(A(bI,d),A(Et,f),A(wI,p),A(xI,m),A(gI,v),A(yI,x),A(kI,g),A(CI,y),A(_I,E),A(td,_),A(pr,h),A(SI,I),Re(R))if(R.length){const O=n.exposed||(n.exposed={});R.forEach(P=>{Object.defineProperty(O,P,{get:()=>t[P],set:N=>t[P]=N})})}else n.exposed||(n.exposed={});w&&n.render===Ar&&(n.render=w),S!=null&&(n.inheritAttrs=S),k&&(n.components=k),T&&(n.directives=T)}function AI(n,e,t=Ar){Re(n)&&(n=o0(n));for(const r in n){const i=n[r];let s;St(i)?"default"in i?s=_t(i.from||r,i.default,!0):s=_t(i.from||r):s=_t(i),Lt(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function Mb(n,e,t){Or(Re(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function X_(n,e,t,r){const i=r.includes(".")?q_(t,r):()=>t[r];if(Mt(n)){const s=e[n];Le(s)&&At(i,s)}else if(Le(n))At(i,n.bind(t));else if(St(n))if(Re(n))n.forEach(s=>X_(s,e,t,r));else{const s=Le(n.handler)?n.handler.bind(t):e[n.handler];Le(s)&&At(i,s,n)}}function yy(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(c=>hh(l,c,o,!0)),hh(l,e,o)),St(e)&&s.set(e,l),l}function hh(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&hh(n,s,t,!0),i&&i.forEach(o=>hh(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=MI[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const MI={data:Rb,props:Ib,emits:Ib,methods:ic,computed:ic,beforeCreate:Tn,created:Tn,beforeMount:Tn,mounted:Tn,beforeUpdate:Tn,updated:Tn,beforeDestroy:Tn,beforeUnmount:Tn,destroyed:Tn,unmounted:Tn,activated:Tn,deactivated:Tn,errorCaptured:Tn,serverPrefetch:Tn,components:ic,directives:ic,watch:II,provide:Rb,inject:RI};function Rb(n,e){return e?n?function(){return Ut(Le(n)?n.call(this,this):n,Le(e)?e.call(this,this):e)}:e:n}function RI(n,e){return ic(o0(n),o0(e))}function o0(n){if(Re(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Tn(n,e){return n?[...new Set([].concat(n,e))]:e}function ic(n,e){return n?Ut(Object.create(null),n,e):e}function Ib(n,e){return n?Re(n)&&Re(e)?[...new Set([...n,...e])]:Ut(Object.create(null),Cu(n),Cu(e!=null?e:{})):e}function II(n,e){if(!n)return e;if(!e)return n;const t=Ut(Object.create(null),n);for(const r in e)t[r]=Tn(n[r],e[r]);return t}function Z_(){return{app:null,config:{isNativeTag:uR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let OI=0;function PI(n,e){return function(r,i=null){Le(r)||(r=Ut({},r)),i!=null&&!St(i)&&(i=null);const s=Z_(),o=new WeakSet;let a=!1;const l=s.app={_uid:OI++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:rO,get config(){return s.config},set config(c){},use(c,...u){return o.has(c)||(c&&Le(c.install)?(o.add(c),c.install(l,...u)):Le(c)&&(o.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,d){if(!a){const f=ye(r,i);return f.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),u&&e?e(f,c):n(f,c,d),a=!0,l._container=c,c.__vue_app__=l,Ep(f.component)||f.component.proxy}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l},runWithContext(c){const u=nl;nl=l;try{return c()}finally{nl=u}}};return l}}let nl=null;function bn(n,e){if(Jt){let t=Jt.provides;const r=Jt.parent&&Jt.parent.provides;r===t&&(t=Jt.provides=Object.create(r)),t[n]=e}}function _t(n,e,t=!1){const r=Jt||Bt;if(r||nl){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:nl._context.provides;if(i&&n in i)return i[n];if(arguments.length>1)return t&&Le(e)?e.call(r&&r.proxy):e}}function DI(){return!!(Jt||Bt||nl)}function $I(n,e,t,r=!1){const i={},s={};ch(s,kp,1),n.propsDefaults=Object.create(null),Q_(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:A_(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function NI(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,a=ze(i),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let d=0;d<u.length;d++){let f=u[d];if(wp(n.emitsOptions,f))continue;const p=e[f];if(l)if(tt(s,f))p!==s[f]&&(s[f]=p,c=!0);else{const m=ei(f);i[m]=a0(l,a,m,p,n,!1)}else p!==s[f]&&(s[f]=p,c=!0)}}}else{Q_(n,e,i,s)&&(c=!0);let u;for(const d in a)(!e||!tt(e,d)&&((u=Us(d))===d||!tt(e,u)))&&(l?t&&(t[d]!==void 0||t[u]!==void 0)&&(i[d]=a0(l,a,d,void 0,n,!0)):delete i[d]);if(s!==a)for(const d in s)(!e||!tt(e,d))&&(delete s[d],c=!0)}c&&Vi(n,"set","$attrs")}function Q_(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(qc(l))continue;const c=e[l];let u;i&&tt(i,u=ei(l))?!s||!s.includes(u)?t[u]=c:(a||(a={}))[u]=c:wp(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(s){const l=ze(t),c=a||bt;for(let u=0;u<s.length;u++){const d=s[u];t[d]=a0(i,l,d,c[d],n,!tt(c,d))}}return o}function a0(n,e,t,r,i,s){const o=n[t];if(o!=null){const a=tt(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Le(l)){const{propsDefaults:c}=i;if(t in c)r=c[t];else{const u=rd(i);r=c[t]=l.call(null,e),u()}}else r=l}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===Us(t))&&(r=!0))}return r}function eC(n,e,t=!1){const r=e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},a=[];let l=!1;if(!Le(n)){const u=d=>{l=!0;const[f,p]=eC(d,e,!0);Ut(o,f),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!s&&!l)return St(n)&&r.set(n,Za),Za;if(Re(s))for(let u=0;u<s.length;u++){const d=ei(s[u]);Ob(d)&&(o[d]=bt)}else if(s)for(const u in s){const d=ei(u);if(Ob(d)){const f=s[u],p=o[d]=Re(f)||Le(f)?{type:f}:Ut({},f);if(p){const m=$b(Boolean,p.type),v=$b(String,p.type);p[0]=m>-1,p[1]=v<0||m<v,(m>-1||tt(p,"default"))&&a.push(d)}}}const c=[o,a];return St(n)&&r.set(n,c),c}function Ob(n){return n[0]!=="$"&&!qc(n)}function Pb(n){return n===null?"null":typeof n=="function"?n.name||"":typeof n=="object"&&n.constructor&&n.constructor.name||""}function Db(n,e){return Pb(n)===Pb(e)}function $b(n,e){return Re(e)?e.findIndex(t=>Db(t,n)):Le(e)&&Db(e,n)?0:-1}const tC=n=>n[0]==="_"||n==="$stable",vy=n=>Re(n)?n.map(fi):[fi(n)],LI=(n,e,t)=>{if(e._n)return e;const r=Ue((...i)=>vy(e(...i)),t);return r._c=!1,r},nC=(n,e,t)=>{const r=n._ctx;for(const i in n){if(tC(i))continue;const s=n[i];if(Le(s))e[i]=LI(i,s,r);else if(s!=null){const o=vy(s);e[i]=()=>o}}},rC=(n,e)=>{const t=vy(e);n.slots.default=()=>t},jI=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=ze(e),ch(e,"_",t)):nC(e,n.slots={})}else n.slots={},e&&rC(n,e);ch(n.slots,kp,1)},FI=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=bt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(Ut(i,e),!t&&a===1&&delete i._):(s=!e.$stable,nC(e,i)),o=e}else e&&(rC(n,e),o={default:1});if(s)for(const a in i)!tC(a)&&o[a]==null&&delete i[a]};function l0(n,e,t,r,i=!1){if(Re(n)){n.forEach((f,p)=>l0(f,e&&(Re(e)?e[p]:e),t,r,i));return}if(Uc(r)&&!i)return;const s=r.shapeFlag&4?Ep(r.component)||r.component.proxy:r.el,o=i?null:s,{i:a,r:l}=n,c=e&&e.r,u=a.refs===bt?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(Mt(c)?(u[c]=null,tt(d,c)&&(d[c]=null)):Lt(c)&&(c.value=null)),Le(l))Ls(l,a,12,[o,u]);else{const f=Mt(l),p=Lt(l);if(f||p){const m=()=>{if(n.f){const v=f?tt(d,l)?d[l]:u[l]:l.value;i?Re(v)&&ny(v,s):Re(v)?v.includes(s)||v.push(s):f?(u[l]=[s],tt(d,l)&&(d[l]=u[l])):(l.value=[s],n.k&&(u[n.k]=l.value))}else f?(u[l]=o,tt(d,l)&&(d[l]=o)):p&&(l.value=o,n.k&&(u[n.k]=o))};o?(m.id=-1,Vn(m,t)):m()}}}const Vn=lI;function HI(n){return BI(n)}function BI(n,e){const t=u_();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:f,setScopeId:p=Ar,insertStaticContent:m}=n,v=($,L,V,H=null,z=null,U=null,ne=void 0,G=null,te=!!L.dynamicChildren)=>{if($===L)return;$&&!yo($,L)&&(H=B($),J($,z,U,!0),$=null),L.patchFlag===-2&&(te=!1,L.dynamicChildren=null);const{type:se,ref:pe,shapeFlag:Ce}=L;switch(se){case Cp:x($,L,V,H);break;case Pr:b($,L,V,H);break;case Cm:$==null&&_(L,V,H,ne);break;case lt:k($,L,V,H,z,U,ne,G,te);break;default:Ce&1?w($,L,V,H,z,U,ne,G,te):Ce&6?T($,L,V,H,z,U,ne,G,te):(Ce&64||Ce&128)&&se.process($,L,V,H,z,U,ne,G,te,me)}pe!=null&&z&&l0(pe,$&&$.ref,U,L||$,!L)},x=($,L,V,H)=>{if($==null)r(L.el=a(L.children),V,H);else{const z=L.el=$.el;L.children!==$.children&&c(z,L.children)}},b=($,L,V,H)=>{$==null?r(L.el=l(L.children||""),V,H):L.el=$.el},_=($,L,V,H)=>{[$.el,$.anchor]=m($.children,L,V,H,$.el,$.anchor)},M=({el:$,anchor:L},V,H)=>{let z;for(;$&&$!==L;)z=f($),r($,V,H),$=z;r(L,V,H)},h=({el:$,anchor:L})=>{let V;for(;$&&$!==L;)V=f($),i($),$=V;i(L)},w=($,L,V,H,z,U,ne,G,te)=>{L.type==="svg"?ne="svg":L.type==="math"&&(ne="mathml"),$==null?y(L,V,H,z,U,ne,G,te):I($,L,z,U,ne,G,te)},y=($,L,V,H,z,U,ne,G)=>{let te,se;const{props:pe,shapeFlag:Ce,transition:_e,dirs:Ae}=$;if(te=$.el=o($.type,U,pe&&pe.is,pe),Ce&8?u(te,$.children):Ce&16&&g($.children,te,null,H,z,_m($,U),ne,G),Ae&&ro($,null,H,"created"),E(te,$,$.scopeId,ne,H),pe){for(const Xe in pe)Xe!=="value"&&!qc(Xe)&&s(te,Xe,null,pe[Xe],U,$.children,H,z,ae);"value"in pe&&s(te,"value",null,pe.value,U),(se=pe.onVnodeBeforeMount)&&ai(se,H,$)}Ae&&ro($,null,H,"beforeMount");const Fe=zI(z,_e);Fe&&_e.beforeEnter(te),r(te,L,V),((se=pe&&pe.onVnodeMounted)||Fe||Ae)&&Vn(()=>{se&&ai(se,H,$),Fe&&_e.enter(te),Ae&&ro($,null,H,"mounted")},z)},E=($,L,V,H,z)=>{if(V&&p($,V),H)for(let U=0;U<H.length;U++)p($,H[U]);if(z){let U=z.subTree;if(L===U){const ne=z.vnode;E($,ne,ne.scopeId,ne.slotScopeIds,z.parent)}}},g=($,L,V,H,z,U,ne,G,te=0)=>{for(let se=te;se<$.length;se++){const pe=$[se]=G?ys($[se]):fi($[se]);v(null,pe,L,V,H,z,U,ne,G)}},I=($,L,V,H,z,U,ne)=>{const G=L.el=$.el;let{patchFlag:te,dynamicChildren:se,dirs:pe}=L;te|=$.patchFlag&16;const Ce=$.props||bt,_e=L.props||bt;let Ae;if(V&&io(V,!1),(Ae=_e.onVnodeBeforeUpdate)&&ai(Ae,V,L,$),pe&&ro(L,$,V,"beforeUpdate"),V&&io(V,!0),se?R($.dynamicChildren,se,G,V,H,_m(L,z),U):ne||P($,L,G,null,V,H,_m(L,z),U,!1),te>0){if(te&16)S(G,L,Ce,_e,V,H,z);else if(te&2&&Ce.class!==_e.class&&s(G,"class",null,_e.class,z),te&4&&s(G,"style",Ce.style,_e.style,z),te&8){const Fe=L.dynamicProps;for(let Xe=0;Xe<Fe.length;Xe++){const vt=Fe[Xe],jt=Ce[vt],cr=_e[vt];(cr!==jt||vt==="value")&&s(G,vt,jt,cr,z,$.children,V,H,ae)}}te&1&&$.children!==L.children&&u(G,L.children)}else!ne&&se==null&&S(G,L,Ce,_e,V,H,z);((Ae=_e.onVnodeUpdated)||pe)&&Vn(()=>{Ae&&ai(Ae,V,L,$),pe&&ro(L,$,V,"updated")},H)},R=($,L,V,H,z,U,ne)=>{for(let G=0;G<L.length;G++){const te=$[G],se=L[G],pe=te.el&&(te.type===lt||!yo(te,se)||te.shapeFlag&70)?d(te.el):V;v(te,se,pe,null,H,z,U,ne,!0)}},S=($,L,V,H,z,U,ne)=>{if(V!==H){if(V!==bt)for(const G in V)!qc(G)&&!(G in H)&&s($,G,V[G],null,ne,L.children,z,U,ae);for(const G in H){if(qc(G))continue;const te=H[G],se=V[G];te!==se&&G!=="value"&&s($,G,se,te,ne,L.children,z,U,ae)}"value"in H&&s($,"value",V.value,H.value,ne)}},k=($,L,V,H,z,U,ne,G,te)=>{const se=L.el=$?$.el:a(""),pe=L.anchor=$?$.anchor:a("");let{patchFlag:Ce,dynamicChildren:_e,slotScopeIds:Ae}=L;Ae&&(G=G?G.concat(Ae):Ae),$==null?(r(se,V,H),r(pe,V,H),g(L.children||[],V,pe,z,U,ne,G,te)):Ce>0&&Ce&64&&_e&&$.dynamicChildren?(R($.dynamicChildren,_e,V,z,U,ne,G),(L.key!=null||z&&L===z.subTree)&&by($,L,!0)):P($,L,V,pe,z,U,ne,G,te)},T=($,L,V,H,z,U,ne,G,te)=>{L.slotScopeIds=G,$==null?L.shapeFlag&512?z.ctx.activate(L,V,H,ne,te):C(L,V,H,z,U,ne,te):D($,L,te)},C=($,L,V,H,z,U,ne)=>{const G=$.component=XI($,H,z);if(ed($)&&(G.ctx.renderer=me),ZI(G),G.asyncDep){if(z&&z.registerDep(G,A),!$.el){const te=G.subTree=ye(Pr);b(null,te,L,V)}}else A(G,$,L,V,z,U,ne)},D=($,L,V)=>{const H=L.component=$.component;if(sI($,L,V))if(H.asyncDep&&!H.asyncResolved){O(H,L,V);return}else H.next=L,XR(H.update),H.effect.dirty=!0,H.update();else L.el=$.el,H.vnode=L},A=($,L,V,H,z,U,ne)=>{const G=()=>{if($.isMounted){let{next:pe,bu:Ce,u:_e,parent:Ae,vnode:Fe}=$;{const rs=iC($);if(rs){pe&&(pe.el=Fe.el,O($,pe,ne)),rs.asyncDep.then(()=>{$.isUnmounted||G()});return}}let Xe=pe,vt;io($,!1),pe?(pe.el=Fe.el,O($,pe,ne)):pe=Fe,Ce&&gm(Ce),(vt=pe.props&&pe.props.onVnodeBeforeUpdate)&&ai(vt,Ae,pe,Fe),io($,!0);const jt=vm($),cr=$.subTree;$.subTree=jt,v(cr,jt,d(cr.el),B(cr),$,z,U),pe.el=jt.el,Xe===null&&oI($,jt.el),_e&&Vn(_e,z),(vt=pe.props&&pe.props.onVnodeUpdated)&&Vn(()=>ai(vt,Ae,pe,Fe),z)}else{let pe;const{el:Ce,props:_e}=L,{bm:Ae,m:Fe,parent:Xe}=$,vt=Uc(L);if(io($,!1),Ae&&gm(Ae),!vt&&(pe=_e&&_e.onVnodeBeforeMount)&&ai(pe,Xe,L),io($,!0),Ce&&Ke){const jt=()=>{$.subTree=vm($),Ke(Ce,$.subTree,$,z,null)};vt?L.type.__asyncLoader().then(()=>!$.isUnmounted&&jt()):jt()}else{const jt=$.subTree=vm($);v(null,jt,V,H,$,z,U),L.el=jt.el}if(Fe&&Vn(Fe,z),!vt&&(pe=_e&&_e.onVnodeMounted)){const jt=L;Vn(()=>ai(pe,Xe,jt),z)}(L.shapeFlag&256||Xe&&Uc(Xe.vnode)&&Xe.vnode.shapeFlag&256)&&$.a&&Vn($.a,z),$.isMounted=!0,L=V=H=null}},te=$.effect=new oy(G,Ar,()=>bp(se),$.scope),se=$.update=()=>{te.dirty&&te.run()};se.id=$.uid,io($,!0),se()},O=($,L,V)=>{L.component=$;const H=$.vnode.props;$.vnode=L,$.next=null,NI($,L.props,H,V),FI($,L.children,V),ua(),Cb($),da()},P=($,L,V,H,z,U,ne,G,te=!1)=>{const se=$&&$.children,pe=$?$.shapeFlag:0,Ce=L.children,{patchFlag:_e,shapeFlag:Ae}=L;if(_e>0){if(_e&128){F(se,Ce,V,H,z,U,ne,G,te);return}else if(_e&256){N(se,Ce,V,H,z,U,ne,G,te);return}}Ae&8?(pe&16&&ae(se,z,U),Ce!==se&&u(V,Ce)):pe&16?Ae&16?F(se,Ce,V,H,z,U,ne,G,te):ae(se,z,U,!0):(pe&8&&u(V,""),Ae&16&&g(Ce,V,H,z,U,ne,G,te))},N=($,L,V,H,z,U,ne,G,te)=>{$=$||Za,L=L||Za;const se=$.length,pe=L.length,Ce=Math.min(se,pe);let _e;for(_e=0;_e<Ce;_e++){const Ae=L[_e]=te?ys(L[_e]):fi(L[_e]);v($[_e],Ae,V,null,z,U,ne,G,te)}se>pe?ae($,z,U,!0,!1,Ce):g(L,V,H,z,U,ne,G,te,Ce)},F=($,L,V,H,z,U,ne,G,te)=>{let se=0;const pe=L.length;let Ce=$.length-1,_e=pe-1;for(;se<=Ce&&se<=_e;){const Ae=$[se],Fe=L[se]=te?ys(L[se]):fi(L[se]);if(yo(Ae,Fe))v(Ae,Fe,V,null,z,U,ne,G,te);else break;se++}for(;se<=Ce&&se<=_e;){const Ae=$[Ce],Fe=L[_e]=te?ys(L[_e]):fi(L[_e]);if(yo(Ae,Fe))v(Ae,Fe,V,null,z,U,ne,G,te);else break;Ce--,_e--}if(se>Ce){if(se<=_e){const Ae=_e+1,Fe=Ae<pe?L[Ae].el:H;for(;se<=_e;)v(null,L[se]=te?ys(L[se]):fi(L[se]),V,Fe,z,U,ne,G,te),se++}}else if(se>_e)for(;se<=Ce;)J($[se],z,U,!0),se++;else{const Ae=se,Fe=se,Xe=new Map;for(se=Fe;se<=_e;se++){const ke=L[se]=te?ys(L[se]):fi(L[se]);ke.key!=null&&Xe.set(ke.key,se)}let vt,jt=0;const cr=_e-Fe+1;let rs=!1,kd=0;const Z=new Array(cr);for(se=0;se<cr;se++)Z[se]=0;for(se=Ae;se<=Ce;se++){const ke=$[se];if(jt>=cr){J(ke,z,U,!0);continue}let qe;if(ke.key!=null)qe=Xe.get(ke.key);else for(vt=Fe;vt<=_e;vt++)if(Z[vt-Fe]===0&&yo(ke,L[vt])){qe=vt;break}qe===void 0?J(ke,z,U,!0):(Z[qe-Fe]=se+1,qe>=kd?kd=qe:rs=!0,v(ke,L[qe],V,null,z,U,ne,G,te),jt++)}const Se=rs?VI(Z):Za;for(vt=Se.length-1,se=cr-1;se>=0;se--){const ke=Fe+se,qe=L[ke],Ze=ke+1<pe?L[ke+1].el:H;Z[se]===0?v(null,qe,V,Ze,z,U,ne,G,te):rs&&(vt<0||se!==Se[vt]?j(qe,V,Ze,2):vt--)}}},j=($,L,V,H,z=null)=>{const{el:U,type:ne,transition:G,children:te,shapeFlag:se}=$;if(se&6){j($.component.subTree,L,V,H);return}if(se&128){$.suspense.move(L,V,H);return}if(se&64){ne.move($,L,V,me);return}if(ne===lt){r(U,L,V);for(let Ce=0;Ce<te.length;Ce++)j(te[Ce],L,V,H);r($.anchor,L,V);return}if(ne===Cm){M($,L,V);return}if(H!==2&&se&1&&G)if(H===0)G.beforeEnter(U),r(U,L,V),Vn(()=>G.enter(U),z);else{const{leave:Ce,delayLeave:_e,afterLeave:Ae}=G,Fe=()=>r(U,L,V),Xe=()=>{Ce(U,()=>{Fe(),Ae&&Ae()})};_e?_e(U,Fe,Xe):Xe()}else r(U,L,V)},J=($,L,V,H=!1,z=!1)=>{const{type:U,props:ne,ref:G,children:te,dynamicChildren:se,shapeFlag:pe,patchFlag:Ce,dirs:_e}=$;if(G!=null&&l0(G,null,V,$,!0),pe&256){L.ctx.deactivate($);return}const Ae=pe&1&&_e,Fe=!Uc($);let Xe;if(Fe&&(Xe=ne&&ne.onVnodeBeforeUnmount)&&ai(Xe,L,$),pe&6)he($.component,V,H);else{if(pe&128){$.suspense.unmount(V,H);return}Ae&&ro($,null,L,"beforeUnmount"),pe&64?$.type.remove($,L,V,z,me,H):se&&(U!==lt||Ce>0&&Ce&64)?ae(se,L,V,!1,!0):(U===lt&&Ce&384||!z&&pe&16)&&ae(te,L,V),H&&ie($)}(Fe&&(Xe=ne&&ne.onVnodeUnmounted)||Ae)&&Vn(()=>{Xe&&ai(Xe,L,$),Ae&&ro($,null,L,"unmounted")},V)},ie=$=>{const{type:L,el:V,anchor:H,transition:z}=$;if(L===lt){oe(V,H);return}if(L===Cm){h($);return}const U=()=>{i(V),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if($.shapeFlag&1&&z&&!z.persisted){const{leave:ne,delayLeave:G}=z,te=()=>ne(V,U);G?G($.el,U,te):te()}else U()},oe=($,L)=>{let V;for(;$!==L;)V=f($),i($),$=V;i(L)},he=($,L,V)=>{const{bum:H,scope:z,update:U,subTree:ne,um:G}=$;H&&gm(H),z.stop(),U&&(U.active=!1,J(ne,$,L,V)),G&&Vn(G,L),Vn(()=>{$.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&$.asyncDep&&!$.asyncResolved&&$.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},ae=($,L,V,H=!1,z=!1,U=0)=>{for(let ne=U;ne<$.length;ne++)J($[ne],L,V,H,z)},B=$=>$.shapeFlag&6?B($.component.subTree):$.shapeFlag&128?$.suspense.next():f($.anchor||$.el);let ee=!1;const le=($,L,V)=>{$==null?L._vnode&&J(L._vnode,null,null,!0):v(L._vnode||null,$,L,null,null,null,V),ee||(ee=!0,Cb(),F_(),ee=!1),L._vnode=$},me={p:v,um:J,m:j,r:ie,mt:C,mc:g,pc:P,pbc:R,n:B,o:n};let $e,Ke;return e&&([$e,Ke]=e(me)),{render:le,hydrate:$e,createApp:PI(le,$e)}}function _m({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function io({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function zI(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function by(n,e,t=!1){const r=n.children,i=e.children;if(Re(r)&&Re(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=ys(i[s]),a.el=o.el),t||by(o,a)),a.type===Cp&&(a.el=o.el)}}function VI(n){const e=n.slice(),t=[0];let r,i,s,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(i=t[t.length-1],n[i]<c){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<c?s=a+1:o=a;c<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function iC(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:iC(e)}const qI=n=>n.__isTeleport,Jc=n=>n&&(n.disabled||n.disabled===""),Nb=n=>typeof SVGElement!="undefined"&&n instanceof SVGElement,Lb=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,c0=(n,e)=>{const t=n&&n.to;return Mt(t)?e?e(t):null:t},UI={name:"Teleport",__isTeleport:!0,process(n,e,t,r,i,s,o,a,l,c){const{mc:u,pc:d,pbc:f,o:{insert:p,querySelector:m,createText:v,createComment:x}}=c,b=Jc(e.props);let{shapeFlag:_,children:M,dynamicChildren:h}=e;if(n==null){const w=e.el=v(""),y=e.anchor=v("");p(w,t,r),p(y,t,r);const E=e.target=c0(e.props,m),g=e.targetAnchor=v("");E&&(p(g,E),o==="svg"||Nb(E)?o="svg":(o==="mathml"||Lb(E))&&(o="mathml"));const I=(R,S)=>{_&16&&u(M,R,S,i,s,o,a,l)};b?I(t,y):E&&I(E,g)}else{e.el=n.el;const w=e.anchor=n.anchor,y=e.target=n.target,E=e.targetAnchor=n.targetAnchor,g=Jc(n.props),I=g?t:y,R=g?w:E;if(o==="svg"||Nb(y)?o="svg":(o==="mathml"||Lb(y))&&(o="mathml"),h?(f(n.dynamicChildren,h,I,i,s,o,a),by(n,e,!0)):l||d(n,e,I,R,i,s,o,a,!1),b)g?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Ld(e,t,w,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const S=e.target=c0(e.props,m);S&&Ld(e,S,null,c,0)}else g&&Ld(e,y,E,c,1)}sC(e)},remove(n,e,t,r,{um:i,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:d,props:f}=n;if(d&&s(u),o&&s(c),a&16){const p=o||!Jc(f);for(let m=0;m<l.length;m++){const v=l[m];i(v,e,t,p,!!v.dynamicChildren)}}},move:Ld,hydrate:WI};function Ld(n,e,t,{o:{insert:r},m:i},s=2){s===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=n,d=s===2;if(d&&r(o,e,t),(!d||Jc(u))&&l&16)for(let f=0;f<c.length;f++)i(c[f],e,t,2);d&&r(a,e,t)}function WI(n,e,t,r,i,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=c0(e.props,l);if(u){const d=u._lpa||u.firstChild;if(e.shapeFlag&16)if(Jc(e.props))e.anchor=c(o(n),e,a(n),t,r,i,s),e.targetAnchor=d;else{e.anchor=o(n);let f=d;for(;f;)if(f=o(f),f&&f.nodeType===8&&f.data==="teleport anchor"){e.targetAnchor=f,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(d,e,u,t,r,i,s)}sC(e)}return e.anchor&&o(e.anchor)}const wy=UI;function sC(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t&&t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const lt=Symbol.for("v-fgt"),Cp=Symbol.for("v-txt"),Pr=Symbol.for("v-cmt"),Cm=Symbol.for("v-stc"),Kc=[];let Gr=null;function q(n=!1){Kc.push(Gr=n?null:[])}function JI(){Kc.pop(),Gr=Kc[Kc.length-1]||null}let ku=1;function jb(n){ku+=n}function oC(n){return n.dynamicChildren=ku>0?Gr||Za:null,JI(),ku>0&&Gr&&Gr.push(n),n}function Q(n,e,t,r,i,s){return oC(K(n,e,t,r,i,s,!0))}function dt(n,e,t,r,i){return oC(ye(n,e,t,r,i,!0))}function ph(n){return n?n.__v_isVNode===!0:!1}function yo(n,e){return n.type===e.type&&n.key===e.key}const kp="__vInternal",aC=({key:n})=>n!=null?n:null,wf=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Mt(n)||Lt(n)||Le(n)?{i:Bt,r:n,k:e,f:!!t}:n:null);function K(n,e=null,t=null,r=0,i=null,s=n===lt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&aC(e),ref:e&&wf(e),scopeId:xp,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Bt};return a?(xy(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=Mt(t)?8:16),ku>0&&!o&&Gr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Gr.push(l),l}const ye=KI;function KI(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===z_)&&(n=Pr),ph(n)){const a=_i(n,e,!0);return t&&xy(a,t),ku>0&&!s&&Gr&&(a.shapeFlag&6?Gr[Gr.indexOf(n)]=a:Gr.push(a)),a.patchFlag|=-2,a}if(nO(n)&&(n=n.__vccOpts),e){e=Yr(e);let{class:a,style:l}=e;a&&!Mt(a)&&(e.class=De(a)),St(l)&&(R_(l)&&!Re(l)&&(l=Ut({},l)),e.style=Fl(l))}const o=Mt(n)?1:aI(n)?128:qI(n)?64:St(n)?4:Le(n)?2:0;return K(n,e,t,r,i,o,s,!0)}function Yr(n){return n?R_(n)||kp in n?Ut({},n):n:null}function _i(n,e,t=!1){const{props:r,ref:i,patchFlag:s,children:o}=n,a=e?nn(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&aC(a),ref:e&&e.ref?t&&i?Re(i)?i.concat(wf(e)):[i,wf(e)]:wf(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==lt?s===-1?16:s|16:s,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&_i(n.ssContent),ssFallback:n.ssFallback&&_i(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function Zo(n=" ",e=0){return ye(Cp,null,n,e)}function He(n="",e=!1){return e?(q(),dt(Pr,null,n)):ye(Pr,null,n)}function fi(n){return n==null||typeof n=="boolean"?ye(Pr):Re(n)?ye(lt,null,n.slice()):typeof n=="object"?ys(n):ye(Cp,null,String(n))}function ys(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:_i(n)}function xy(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Re(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),xy(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!(kp in e)?e._ctx=Bt:i===3&&Bt&&(Bt.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Le(e)?(e={default:e,_ctx:Bt},t=32):(e=String(e),r&64?(t=16,e=[Zo(e)]):t=8);n.children=e,n.shapeFlag|=t}function nn(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=De([e.class,r.class]));else if(i==="style")e.style=Fl([e.style,r.style]);else if(fp(i)){const s=e[i],o=r[i];o&&s!==o&&!(Re(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function ai(n,e,t,r=null){Or(n,e,7,[t,r])}const GI=Z_();let YI=0;function XI(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||GI,s={uid:YI++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new h_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eC(r,i),emitsOptions:B_(r,i),emit:null,emitted:null,propsDefaults:bt,inheritAttrs:r.inheritAttrs,ctx:bt,data:bt,props:bt,attrs:bt,slots:bt,refs:bt,setupState:bt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=eI.bind(null,s),n.ce&&n.ce(s),s}let Jt=null;const Ws=()=>Jt||Bt;let mh,u0;{const n=u_(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};mh=e("__VUE_INSTANCE_SETTERS__",t=>Jt=t),u0=e("__VUE_SSR_SETTERS__",t=>id=t)}const rd=n=>{const e=Jt;return mh(n),n.scope.on(),()=>{n.scope.off(),mh(e)}},Fb=()=>{Jt&&Jt.scope.off(),mh(null)};function lC(n){return n.vnode.shapeFlag&4}let id=!1;function ZI(n,e=!1){e&&u0(e);const{props:t,children:r}=n.vnode,i=lC(n);$I(n,t,i,e),jI(n,r);const s=i?QI(n,e):void 0;return e&&u0(!1),s}function QI(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=Hl(new Proxy(n.ctx,EI));const{setup:r}=t;if(r){const i=n.setupContext=r.length>1?uC(n):null,s=rd(n);ua();const o=Ls(r,n,0,[n.props,i]);if(da(),s(),a_(o)){if(o.then(Fb,Fb),e)return o.then(a=>{Hb(n,a,e)}).catch(a=>{Qu(a,n,0)});n.asyncDep=o}else Hb(n,o,e)}else cC(n,e)}function Hb(n,e,t){Le(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:St(e)&&(n.setupState=D_(e)),cC(n,t)}let Bb;function cC(n,e,t){const r=n.type;if(!n.render){if(!e&&Bb&&!r.render){const i=r.template||yy(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=Ut(Ut({isCustomElement:s,delimiters:a},o),l);r.render=Bb(i,c)}}n.render=r.render||Ar}{const i=rd(n);ua();try{TI(n)}finally{da(),i()}}}function eO(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,t){return rr(n,"get","$attrs"),e[t]}}))}function uC(n){const e=t=>{n.exposed=t||{}};return{get attrs(){return eO(n)},slots:n.slots,emit:n.emit,expose:e}}function Ep(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(D_(Hl(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Wc)return Wc[t](n)},has(e,t){return t in e||t in Wc}}))}function tO(n,e=!0){return Le(n)?n.displayName||n.name:n.name||e&&n.__name}function nO(n){return Le(n)&&"__vccOpts"in n}const re=(n,e)=>O_(n,e,id);function zb(n,e,t=bt){const r=Ws(),i=ei(e),s=Us(e),o=hy((l,c)=>{let u;return dI(()=>{const d=n[e];xi(u,d)&&(u=d,c())}),{get(){return l(),t.get?t.get(u):u},set(d){const f=r.vnode.props;!(f&&(e in f||i in f||s in f)&&(`onUpdate:${e}`in f||`onUpdate:${i}`in f||`onUpdate:${s}`in f))&&xi(d,u)&&(u=d,c()),r.emit(`update:${e}`,t.set?t.set(d):d)}}}),a=e==="modelValue"?"modelModifiers":`${e}Modifiers`;return o[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?n[a]||{}:o,done:!1}:{done:!0}}}},o}function gt(n,e,t){const r=arguments.length;return r===2?St(e)&&!Re(e)?ph(e)?ye(n,null,[e]):ye(n,e):ye(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&ph(t)&&(t=[t]),ye(n,e,t))}const rO="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const iO="http://www.w3.org/2000/svg",sO="http://www.w3.org/1998/Math/MathML",vs=typeof document!="undefined"?document:null,Vb=vs&&vs.createElement("template"),oO={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?vs.createElementNS(iO,n):e==="mathml"?vs.createElementNS(sO,n):vs.createElement(n,t?{is:t}:void 0);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>vs.createTextNode(n),createComment:n=>vs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>vs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{Vb.innerHTML=r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n;const a=Vb.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},ss="transition",Wl="animation",Eu=Symbol("_vtc"),Sy=(n,{slots:e})=>gt(mI,aO(n),e);Sy.displayName="Transition";const dC={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Sy.props=Ut({},U_,dC);const so=(n,e=[])=>{Re(n)?n.forEach(t=>t(...e)):n&&n(...e)},qb=n=>n?Re(n)?n.some(e=>e.length>1):n.length>1:!1;function aO(n){const e={};for(const k in n)k in dC||(e[k]=n[k]);if(n.css===!1)return e;const{name:t="v",type:r,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:p=`${t}-leave-to`}=n,m=lO(i),v=m&&m[0],x=m&&m[1],{onBeforeEnter:b,onEnter:_,onEnterCancelled:M,onLeave:h,onLeaveCancelled:w,onBeforeAppear:y=b,onAppear:E=_,onAppearCancelled:g=M}=e,I=(k,T,C)=>{oo(k,T?u:a),oo(k,T?c:o),C&&C()},R=(k,T)=>{k._isLeaving=!1,oo(k,d),oo(k,p),oo(k,f),T&&T()},S=k=>(T,C)=>{const D=k?E:_,A=()=>I(T,k,C);so(D,[T,A]),Ub(()=>{oo(T,k?l:s),as(T,k?u:a),qb(D)||Wb(T,r,v,A)})};return Ut(e,{onBeforeEnter(k){so(b,[k]),as(k,s),as(k,o)},onBeforeAppear(k){so(y,[k]),as(k,l),as(k,c)},onEnter:S(!1),onAppear:S(!0),onLeave(k,T){k._isLeaving=!0;const C=()=>R(k,T);as(k,d),dO(),as(k,f),Ub(()=>{k._isLeaving&&(oo(k,d),as(k,p),qb(h)||Wb(k,r,x,C))}),so(h,[k,C])},onEnterCancelled(k){I(k,!1),so(M,[k])},onAppearCancelled(k){I(k,!0),so(g,[k])},onLeaveCancelled(k){R(k),so(w,[k])}})}function lO(n){if(n==null)return null;if(St(n))return[km(n.enter),km(n.leave)];{const e=km(n);return[e,e]}}function km(n){return gR(n)}function as(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[Eu]||(n[Eu]=new Set)).add(e)}function oo(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[Eu];t&&(t.delete(e),t.size||(n[Eu]=void 0))}function Ub(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let cO=0;function Wb(n,e,t,r){const i=n._endId=++cO,s=()=>{i===n._endId&&r()};if(t)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=uO(n,e);if(!o)return r();const c=o+"end";let u=0;const d=()=>{n.removeEventListener(c,f),s()},f=p=>{p.target===n&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),n.addEventListener(c,f)}function uO(n,e){const t=window.getComputedStyle(n),r=m=>(t[m]||"").split(", "),i=r(`${ss}Delay`),s=r(`${ss}Duration`),o=Jb(i,s),a=r(`${Wl}Delay`),l=r(`${Wl}Duration`),c=Jb(a,l);let u=null,d=0,f=0;e===ss?o>0&&(u=ss,d=o,f=s.length):e===Wl?c>0&&(u=Wl,d=c,f=l.length):(d=Math.max(o,c),u=d>0?o>c?ss:Wl:null,f=u?u===ss?s.length:l.length:0);const p=u===ss&&/\b(transform|all)(,|$)/.test(r(`${ss}Property`).toString());return{type:u,timeout:d,propCount:f,hasTransform:p}}function Jb(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>Kb(t)+Kb(n[r])))}function Kb(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function dO(){return document.body.offsetHeight}function fO(n,e,t){const r=n[Eu];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const gh=Symbol("_vod"),fC=Symbol("_vsh"),Qo={beforeMount(n,{value:e},{transition:t}){n[gh]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Jl(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),Jl(n,!0),r.enter(n)):r.leave(n,()=>{Jl(n,!1)}):Jl(n,e))},beforeUnmount(n,{value:e}){Jl(n,e)}};function Jl(n,e){n.style.display=e?n[gh]:"none",n[fC]=!e}const hO=Symbol(""),pO=/(^|;)\s*display\s*:/;function mO(n,e,t){const r=n.style,i=Mt(t);let s=!1;if(t&&!i){if(e)if(Mt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&xf(r,a,"")}else for(const o in e)t[o]==null&&xf(r,o,"");for(const o in t)o==="display"&&(s=!0),xf(r,o,t[o])}else if(i){if(e!==t){const o=r[hO];o&&(t+=";"+o),r.cssText=t,s=pO.test(t)}}else e&&n.removeAttribute("style");gh in n&&(n[gh]=s?r.display:"",n[fC]&&(r.display="none"))}const Gb=/\s*!important$/;function xf(n,e,t){if(Re(t))t.forEach(r=>xf(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=gO(n,e);Gb.test(t)?n.setProperty(Us(r),t.replace(Gb,""),"important"):n[r]=t}}const Yb=["Webkit","Moz","ms"],Em={};function gO(n,e){const t=Em[e];if(t)return t;let r=ei(e);if(r!=="filter"&&r in n)return Em[e]=r;r=mp(r);for(let i=0;i<Yb.length;i++){const s=Yb[i]+r;if(s in n)return Em[e]=s}return e}const Xb="http://www.w3.org/1999/xlink";function yO(n,e,t,r,i){if(r&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(Xb,e.slice(6,e.length)):n.setAttributeNS(Xb,e,t);else{const s=SR(e);t==null||s&&!d_(t)?n.removeAttribute(e):n.setAttribute(e,s?"":t)}}function vO(n,e,t,r,i,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,s),n[e]=t==null?"":t;return}const a=n.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const c=a==="OPTION"?n.getAttribute("value")||"":n.value,u=t==null?"":t;(c!==u||!("_value"in n))&&(n.value=u),t==null&&n.removeAttribute(e),n._value=t;return}let l=!1;if(t===""||t==null){const c=typeof n[e];c==="boolean"?t=d_(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{n[e]=t}catch(c){}l&&n.removeAttribute(e)}function bO(n,e,t,r){n.addEventListener(e,t,r)}function wO(n,e,t,r){n.removeEventListener(e,t,r)}const Zb=Symbol("_vei");function xO(n,e,t,r,i=null){const s=n[Zb]||(n[Zb]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=SO(e);if(r){const c=s[e]=kO(r,i);bO(n,a,c,l)}else o&&(wO(n,a,o,l),s[e]=void 0)}}const Qb=/(?:Once|Passive|Capture)$/;function SO(n){let e;if(Qb.test(n)){e={};let r;for(;r=n.match(Qb);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Us(n.slice(2)),e]}let Tm=0;const _O=Promise.resolve(),CO=()=>Tm||(_O.then(()=>Tm=0),Tm=Date.now());function kO(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Or(EO(r,t.value),e,5,[r])};return t.value=n,t.attached=CO(),t}function EO(n,e){if(Re(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const ew=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,TO=(n,e,t,r,i,s,o,a,l)=>{const c=i==="svg";e==="class"?fO(n,r,c):e==="style"?mO(n,t,r):fp(e)?ty(e)||xO(n,e,t,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):AO(n,e,r,c))?vO(n,e,r,s,o,a,l):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),yO(n,e,r,c))};function AO(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&ew(e)&&Le(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return ew(e)&&Mt(t)?!1:e in n}const MO=["ctrl","shift","alt","meta"],RO={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>MO.some(t=>n[`${t}Key`]&&!e.includes(t))},Wa=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(i,...s)=>{for(let o=0;o<e.length;o++){const a=RO[e[o]];if(a&&a(i,e))return}return n(i,...s)})},IO={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Dee=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=i=>{if(!("key"in i))return;const s=Us(i.key);if(e.some(o=>o===s||IO[o]===s))return n(i)})},OO=Ut({patchProp:TO},oO);let tw;function PO(){return tw||(tw=HI(OO))}const DO=(...n)=>{const e=PO().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=NO(r);if(!i)return;const s=e._component;!Le(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=t(i,!1,$O(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function $O(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function NO(n){return Mt(n)?document.querySelector(n):n}const LO="modulepreload",jO=function(n){return"/"+n},nw={},sc=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(t.map(l=>{if(l=jO(l),l in nw)return;nw[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!r)for(let p=s.length-1;p>=0;p--){const m=s[p];if(m.href===l&&(!c||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":LO,c||(f.as="script",f.crossOrigin=""),f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const ka=typeof document!="undefined";function FO(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const ct=Object.assign;function Am(n,e){const t={};for(const r in e){const i=e[r];t[r]=ti(i)?i.map(n):n(i)}return t}const Gc=()=>{},ti=Array.isArray,hC=/#/g,HO=/&/g,BO=/\//g,zO=/=/g,VO=/\?/g,pC=/\+/g,qO=/%5B/g,UO=/%5D/g,mC=/%5E/g,WO=/%60/g,gC=/%7B/g,JO=/%7C/g,yC=/%7D/g,KO=/%20/g;function _y(n){return encodeURI(""+n).replace(JO,"|").replace(qO,"[").replace(UO,"]")}function GO(n){return _y(n).replace(gC,"{").replace(yC,"}").replace(mC,"^")}function d0(n){return _y(n).replace(pC,"%2B").replace(KO,"+").replace(hC,"%23").replace(HO,"%26").replace(WO,"`").replace(gC,"{").replace(yC,"}").replace(mC,"^")}function YO(n){return d0(n).replace(zO,"%3D")}function XO(n){return _y(n).replace(hC,"%23").replace(VO,"%3F")}function ZO(n){return n==null?"":XO(n).replace(BO,"%2F")}function Tu(n){try{return decodeURIComponent(""+n)}catch(e){}return""+n}const QO=/\/$/,e8=n=>n.replace(QO,"");function Mm(n,e,t="/"){let r,i={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),i=n(s)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=i8(r!=null?r:e,t),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:Tu(o)}}function t8(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function rw(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function n8(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&fl(e.matched[r],t.matched[i])&&vC(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function fl(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function vC(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!r8(n[t],e[t]))return!1;return!0}function r8(n,e){return ti(n)?iw(n,e):ti(e)?iw(e,n):n===e}function iw(n,e){return ti(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function i8(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}var Au;(function(n){n.pop="pop",n.push="push"})(Au||(Au={}));var Yc;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Yc||(Yc={}));function s8(n){if(!n)if(ka){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),e8(n)}const o8=/^[^#]+#/;function a8(n,e){return n.replace(o8,"#")+e}function l8(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Tp=()=>({left:window.scrollX,top:window.scrollY});function c8(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=l8(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function sw(n,e){return(history.state?history.state.position-e:-1)+n}const f0=new Map;function u8(n,e){f0.set(n,e)}function d8(n){const e=f0.get(n);return f0.delete(n),e}let f8=()=>location.protocol+"//"+location.host;function bC(n,e){const{pathname:t,search:r,hash:i}=e,s=n.indexOf("#");if(s>-1){let a=i.includes(n.slice(s))?n.slice(s).length:1,l=i.slice(a);return l[0]!=="/"&&(l="/"+l),rw(l,"")}return rw(t,n)+r+i}function h8(n,e,t,r){let i=[],s=[],o=null;const a=({state:f})=>{const p=bC(n,location),m=t.value,v=e.value;let x=0;if(f){if(t.value=p,e.value=f,o&&o===m){o=null;return}x=v?f.position-v.position:0}else r(p);i.forEach(b=>{b(t.value,m,{delta:x,type:Au.pop,direction:x?x>0?Yc.forward:Yc.back:Yc.unknown})})};function l(){o=t.value}function c(f){i.push(f);const p=()=>{const m=i.indexOf(f);m>-1&&i.splice(m,1)};return s.push(p),p}function u(){const{history:f}=window;f.state&&f.replaceState(ct({},f.state,{scroll:Tp()}),"")}function d(){for(const f of s)f();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function ow(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?Tp():null}}function p8(n){const{history:e,location:t}=window,r={value:bC(n,t)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const d=n.indexOf("#"),f=d>-1?(t.host&&document.querySelector("base")?n:n.slice(d))+l:f8()+n+l;try{e[u?"replaceState":"pushState"](c,"",f),i.value=c}catch(p){console.error(p),t[u?"replace":"assign"](f)}}function o(l,c){const u=ct({},e.state,ow(i.value.back,l,i.value.forward,!0),c,{position:i.value.position});s(l,u,!0),r.value=l}function a(l,c){const u=ct({},i.value,e.state,{forward:l,scroll:Tp()});s(u.current,u,!0);const d=ct({},ow(r.value,l,null),{position:u.position+1},c);s(l,d,!1),r.value=l}return{location:r,state:i,push:a,replace:o}}function m8(n){n=s8(n);const e=p8(n),t=h8(n,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=ct({location:"",base:n,go:r,createHref:a8.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function g8(n){return typeof n=="string"||n&&typeof n=="object"}function wC(n){return typeof n=="string"||typeof n=="symbol"}const ls={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},xC=Symbol("");var aw;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(aw||(aw={}));function hl(n,e){return ct(new Error,{type:n,[xC]:!0},e)}function Pi(n,e){return n instanceof Error&&xC in n&&(e==null||!!(n.type&e))}const lw="[^/]+?",y8={sensitive:!1,strict:!1,start:!0,end:!0},v8=/[.+*?^${}()[\]/\\]/g;function b8(n,e){const t=ct({},y8,e),r=[];let i=t.start?"^":"";const s=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(i+="/");for(let d=0;d<c.length;d++){const f=c[d];let p=40+(t.sensitive?.25:0);if(f.type===0)d||(i+="/"),i+=f.value.replace(v8,"\\$&"),p+=40;else if(f.type===1){const{value:m,repeatable:v,optional:x,regexp:b}=f;s.push({name:m,repeatable:v,optional:x});const _=b||lw;if(_!==lw){p+=10;try{new RegExp(`(${_})`)}catch(h){throw new Error(`Invalid custom RegExp for param "${m}" (${_}): `+h.message)}}let M=v?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;d||(M=x&&c.length<2?`(?:/${M})`:"/"+M),x&&(M+="?"),i+=M,p+=20,x&&(p+=-8),v&&(p+=-20),_===".*"&&(p+=-50)}u.push(p)}r.push(u)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function a(c){const u=c.match(o),d={};if(!u)return null;for(let f=1;f<u.length;f++){const p=u[f]||"",m=s[f-1];d[m.name]=p&&m.repeatable?p.split("/"):p}return d}function l(c){let u="",d=!1;for(const f of n){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const p of f)if(p.type===0)u+=p.value;else if(p.type===1){const{value:m,repeatable:v,optional:x}=p,b=m in c?c[m]:"";if(ti(b)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const _=ti(b)?b.join("/"):b;if(!_)if(x)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${m}"`);u+=_}}return u||"/"}return{re:o,score:r,keys:s,parse:a,stringify:l}}function w8(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function x8(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const s=w8(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(cw(r))return 1;if(cw(i))return-1}return i.length-r.length}function cw(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const S8={type:0,value:""},_8=/[a-zA-Z0-9_]/;function C8(n){if(!n)return[[]];if(n==="/")return[[S8]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(p){throw new Error(`ERR (${t})/"${c}": ${p}`)}let t=0,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,l,c="",u="";function d(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),t=1):f();break;case 4:f(),t=r;break;case 1:l==="("?t=2:_8.test(l)?f():(d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),o(),i}function k8(n,e,t){const r=b8(C8(n.path),t),i=ct(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function E8(n,e){const t=[],r=new Map;e=fw({strict:!1,end:!0,sensitive:!1},e);function i(u){return r.get(u)}function s(u,d,f){const p=!f,m=T8(u);m.aliasOf=f&&f.record;const v=fw(e,u),x=[m];if("alias"in u){const M=typeof u.alias=="string"?[u.alias]:u.alias;for(const h of M)x.push(ct({},m,{components:f?f.record.components:m.components,path:h,aliasOf:f?f.record:m}))}let b,_;for(const M of x){const{path:h}=M;if(d&&h[0]!=="/"){const w=d.record.path,y=w[w.length-1]==="/"?"":"/";M.path=d.record.path+(h&&y+h)}if(b=k8(M,d,v),f?f.alias.push(b):(_=_||b,_!==b&&_.alias.push(b),p&&u.name&&!dw(b)&&o(u.name)),m.children){const w=m.children;for(let y=0;y<w.length;y++)s(w[y],b,f&&f.children[y])}f=f||b,(b.record.components&&Object.keys(b.record.components).length||b.record.name||b.record.redirect)&&l(b)}return _?()=>{o(_)}:Gc}function o(u){if(wC(u)){const d=r.get(u);d&&(r.delete(u),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(u);d>-1&&(t.splice(d,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return t}function l(u){let d=0;for(;d<t.length&&x8(u,t[d])>=0&&(u.record.path!==t[d].record.path||!SC(u,t[d]));)d++;t.splice(d,0,u),u.record.name&&!dw(u)&&r.set(u.record.name,u)}function c(u,d){let f,p={},m,v;if("name"in u&&u.name){if(f=r.get(u.name),!f)throw hl(1,{location:u});v=f.record.name,p=ct(uw(d.params,f.keys.filter(_=>!_.optional).concat(f.parent?f.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),u.params&&uw(u.params,f.keys.map(_=>_.name))),m=f.stringify(p)}else if(u.path!=null)m=u.path,f=t.find(_=>_.re.test(m)),f&&(p=f.parse(m),v=f.record.name);else{if(f=d.name?r.get(d.name):t.find(_=>_.re.test(d.path)),!f)throw hl(1,{location:u,currentLocation:d});v=f.record.name,p=ct({},d.params,u.params),m=f.stringify(p)}const x=[];let b=f;for(;b;)x.unshift(b.record),b=b.parent;return{name:v,path:m,params:p,matched:x,meta:M8(x)}}return n.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:i}}function uw(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function T8(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:A8(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function A8(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function dw(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function M8(n){return n.reduce((e,t)=>ct(e,t.meta),{})}function fw(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function SC(n,e){return e.children.some(t=>t===n||SC(n,t))}function R8(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(pC," "),o=s.indexOf("="),a=Tu(o<0?s:s.slice(0,o)),l=o<0?null:Tu(s.slice(o+1));if(a in e){let c=e[a];ti(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function hw(n){let e="";for(let t in n){const r=n[t];if(t=YO(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(ti(r)?r.map(s=>s&&d0(s)):[r&&d0(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function I8(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=ti(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const O8=Symbol(""),pw=Symbol(""),Ap=Symbol(""),_C=Symbol(""),h0=Symbol("");function Kl(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function bs(n,e,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l(hl(4,{from:t,to:e})):f instanceof Error?l(f):g8(f)?l(hl(2,{from:e,to:f})):(o&&r.enterCallbacks[i]===o&&typeof f=="function"&&o.push(f),a())},u=s(()=>n.call(r&&r.instances[i],e,t,c));let d=Promise.resolve(u);n.length<3&&(d=d.then(c)),d.catch(f=>l(f))})}function Rm(n,e,t,r,i=s=>s()){const s=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(P8(l)){const u=(l.__vccOpts||l)[e];u&&s.push(bs(u,t,r,o,a,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${o.path}"`));const d=FO(u)?u.default:u;o.components[a]=d;const p=(d.__vccOpts||d)[e];return p&&bs(p,t,r,o,a,i)()}))}}return s}function P8(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function mw(n){const e=_t(Ap),t=_t(_C),r=re(()=>e.resolve(we(n.to))),i=re(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],d=t.matched;if(!u||!d.length)return-1;const f=d.findIndex(fl.bind(null,u));if(f>-1)return f;const p=gw(l[c-2]);return c>1&&gw(u)===p&&d[d.length-1].path!==p?d.findIndex(fl.bind(null,l[c-2])):f}),s=re(()=>i.value>-1&&L8(t.params,r.value.params)),o=re(()=>i.value>-1&&i.value===t.matched.length-1&&vC(t.params,r.value.params));function a(l={}){return N8(l)?e[we(n.replace)?"replace":"push"](we(n.to)).catch(Gc):Promise.resolve()}return{route:r,href:re(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}const D8=at({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:mw,setup(n,{slots:e}){const t=zr(mw(n)),{options:r}=_t(Ap),i=re(()=>({[yw(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[yw(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return n.custom?s:gt("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),$8=D8;function N8(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function L8(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!ti(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function gw(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const yw=(n,e,t)=>n!=null?n:e!=null?e:t,j8=at({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=_t(h0),i=re(()=>n.route||r.value),s=_t(pw,0),o=re(()=>{let c=we(s);const{matched:u}=i.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=re(()=>i.value.matched[o.value]);bn(pw,re(()=>o.value+1)),bn(O8,a),bn(h0,i);const l=de();return At(()=>[l.value,a.value,n.name],([c,u,d],[f,p,m])=>{u&&(u.instances[d]=c,p&&p!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!fl(u,p)||!f)&&(u.enterCallbacks[d]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=i.value,u=n.name,d=a.value,f=d&&d.components[u];if(!f)return vw(t.default,{Component:f,route:c});const p=d.props[u],m=p?p===!0?c.params:typeof p=="function"?p(c):p:null,x=gt(f,ct({},m,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return vw(t.default,{Component:x,route:c})||x}}});function vw(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const F8=j8;function H8(n){const e=E8(n.routes,n),t=n.parseQuery||R8,r=n.stringifyQuery||hw,i=n.history,s=Kl(),o=Kl(),a=Kl(),l=fy(ls);let c=ls;ka&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Am.bind(null,B=>""+B),d=Am.bind(null,ZO),f=Am.bind(null,Tu);function p(B,ee){let le,me;return wC(B)?(le=e.getRecordMatcher(B),me=ee):me=B,e.addRoute(me,le)}function m(B){const ee=e.getRecordMatcher(B);ee&&e.removeRoute(ee)}function v(){return e.getRoutes().map(B=>B.record)}function x(B){return!!e.getRecordMatcher(B)}function b(B,ee){if(ee=ct({},ee||l.value),typeof B=="string"){const L=Mm(t,B,ee.path),V=e.resolve({path:L.path},ee),H=i.createHref(L.fullPath);return ct(L,V,{params:f(V.params),hash:Tu(L.hash),redirectedFrom:void 0,href:H})}let le;if(B.path!=null)le=ct({},B,{path:Mm(t,B.path,ee.path).path});else{const L=ct({},B.params);for(const V in L)L[V]==null&&delete L[V];le=ct({},B,{params:d(L)}),ee.params=d(ee.params)}const me=e.resolve(le,ee),$e=B.hash||"";me.params=u(f(me.params));const Ke=t8(r,ct({},B,{hash:GO($e),path:me.path})),$=i.createHref(Ke);return ct({fullPath:Ke,hash:$e,query:r===hw?I8(B.query):B.query||{}},me,{redirectedFrom:void 0,href:$})}function _(B){return typeof B=="string"?Mm(t,B,l.value.path):ct({},B)}function M(B,ee){if(c!==B)return hl(8,{from:ee,to:B})}function h(B){return E(B)}function w(B){return h(ct(_(B),{replace:!0}))}function y(B){const ee=B.matched[B.matched.length-1];if(ee&&ee.redirect){const{redirect:le}=ee;let me=typeof le=="function"?le(B):le;return typeof me=="string"&&(me=me.includes("?")||me.includes("#")?me=_(me):{path:me},me.params={}),ct({query:B.query,hash:B.hash,params:me.path!=null?{}:B.params},me)}}function E(B,ee){const le=c=b(B),me=l.value,$e=B.state,Ke=B.force,$=B.replace===!0,L=y(le);if(L)return E(ct(_(L),{state:typeof L=="object"?ct({},$e,L.state):$e,force:Ke,replace:$}),ee||le);const V=le;V.redirectedFrom=ee;let H;return!Ke&&n8(r,me,le)&&(H=hl(16,{to:V,from:me}),j(me,me,!0,!1)),(H?Promise.resolve(H):R(V,me)).catch(z=>Pi(z)?Pi(z,2)?z:F(z):P(z,V,me)).then(z=>{if(z){if(Pi(z,2))return E(ct({replace:$},_(z.to),{state:typeof z.to=="object"?ct({},$e,z.to.state):$e,force:Ke}),ee||V)}else z=k(V,me,!0,$,$e);return S(V,me,z),z})}function g(B,ee){const le=M(B,ee);return le?Promise.reject(le):Promise.resolve()}function I(B){const ee=oe.values().next().value;return ee&&typeof ee.runWithContext=="function"?ee.runWithContext(B):B()}function R(B,ee){let le;const[me,$e,Ke]=B8(B,ee);le=Rm(me.reverse(),"beforeRouteLeave",B,ee);for(const L of me)L.leaveGuards.forEach(V=>{le.push(bs(V,B,ee))});const $=g.bind(null,B,ee);return le.push($),ae(le).then(()=>{le=[];for(const L of s.list())le.push(bs(L,B,ee));return le.push($),ae(le)}).then(()=>{le=Rm($e,"beforeRouteUpdate",B,ee);for(const L of $e)L.updateGuards.forEach(V=>{le.push(bs(V,B,ee))});return le.push($),ae(le)}).then(()=>{le=[];for(const L of Ke)if(L.beforeEnter)if(ti(L.beforeEnter))for(const V of L.beforeEnter)le.push(bs(V,B,ee));else le.push(bs(L.beforeEnter,B,ee));return le.push($),ae(le)}).then(()=>(B.matched.forEach(L=>L.enterCallbacks={}),le=Rm(Ke,"beforeRouteEnter",B,ee,I),le.push($),ae(le))).then(()=>{le=[];for(const L of o.list())le.push(bs(L,B,ee));return le.push($),ae(le)}).catch(L=>Pi(L,8)?L:Promise.reject(L))}function S(B,ee,le){a.list().forEach(me=>I(()=>me(B,ee,le)))}function k(B,ee,le,me,$e){const Ke=M(B,ee);if(Ke)return Ke;const $=ee===ls,L=ka?history.state:{};le&&(me||$?i.replace(B.fullPath,ct({scroll:$&&L&&L.scroll},$e)):i.push(B.fullPath,$e)),l.value=B,j(B,ee,le,$),F()}let T;function C(){T||(T=i.listen((B,ee,le)=>{if(!he.listening)return;const me=b(B),$e=y(me);if($e){E(ct($e,{replace:!0}),me).catch(Gc);return}c=me;const Ke=l.value;ka&&u8(sw(Ke.fullPath,le.delta),Tp()),R(me,Ke).catch($=>Pi($,12)?$:Pi($,2)?(E($.to,me).then(L=>{Pi(L,20)&&!le.delta&&le.type===Au.pop&&i.go(-1,!1)}).catch(Gc),Promise.reject()):(le.delta&&i.go(-le.delta,!1),P($,me,Ke))).then($=>{$=$||k(me,Ke,!1),$&&(le.delta&&!Pi($,8)?i.go(-le.delta,!1):le.type===Au.pop&&Pi($,20)&&i.go(-1,!1)),S(me,Ke,$)}).catch(Gc)}))}let D=Kl(),A=Kl(),O;function P(B,ee,le){F(B);const me=A.list();return me.length?me.forEach($e=>$e(B,ee,le)):console.error(B),Promise.reject(B)}function N(){return O&&l.value!==ls?Promise.resolve():new Promise((B,ee)=>{D.add([B,ee])})}function F(B){return O||(O=!B,C(),D.list().forEach(([ee,le])=>B?le(B):ee()),D.reset()),B}function j(B,ee,le,me){const{scrollBehavior:$e}=n;if(!ka||!$e)return Promise.resolve();const Ke=!le&&d8(sw(B.fullPath,0))||(me||!le)&&history.state&&history.state.scroll||null;return Dn().then(()=>$e(B,ee,Ke)).then($=>$&&c8($)).catch($=>P($,B,ee))}const J=B=>i.go(B);let ie;const oe=new Set,he={currentRoute:l,listening:!0,addRoute:p,removeRoute:m,hasRoute:x,getRoutes:v,resolve:b,options:n,push:h,replace:w,go:J,back:()=>J(-1),forward:()=>J(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:A.add,isReady:N,install(B){const ee=this;B.component("RouterLink",$8),B.component("RouterView",F8),B.config.globalProperties.$router=ee,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>we(l)}),ka&&!ie&&l.value===ls&&(ie=!0,h(i.location).catch($e=>{}));const le={};for(const $e in ls)Object.defineProperty(le,$e,{get:()=>l.value[$e],enumerable:!0});B.provide(Ap,ee),B.provide(_C,A_(le)),B.provide(h0,l);const me=B.unmount;oe.add(B),B.unmount=function(){oe.delete(B),oe.size<1&&(c=ls,T&&T(),T=null,l.value=ls,ie=!1,O=!1),me()}}};function ae(B){return B.reduce((ee,le)=>ee.then(()=>I(le)),Promise.resolve())}return he}function B8(n,e){const t=[],r=[],i=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(c=>fl(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>fl(c,l))||i.push(l))}return[t,r,i]}function CC(){return _t(Ap)}const z8=[{path:"/",name:"Home",component:()=>sc(()=>import("./Home-DQT407r7.js"),[])}];let V8=H8({history:m8("/"),routes:z8});const je=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},q8={},U8={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-file"},W8=K("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},null,-1),J8=K("polyline",{points:"14 2 14 8 20 8"},null,-1),K8=[W8,J8];function G8(n,e){return q(),Q("svg",U8,K8)}const Y8=je(q8,[["render",G8]]),X8={},Z8={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q8=K("g",null,[K("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.62476 4.49023C9.62476 5.3877 8.89722 6.11523 7.99976 6.11523C7.10229 6.11523 6.37476 5.3877 6.37476 4.49023C6.37476 3.59277 7.10229 2.86523 7.99976 2.86523C8.89722 2.86523 9.62476 3.59277 9.62476 4.49023ZM10.6248 4.49023C10.6248 5.93998 9.4495 7.11523 7.99976 7.11523C6.55001 7.11523 5.37476 5.93998 5.37476 4.49023C5.37476 3.04049 6.55001 1.86523 7.99976 1.86523C9.4495 1.86523 10.6248 3.04049 10.6248 4.49023ZM3.33049 11.4862C3.67081 9.95482 5.0291 8.86523 6.59788 8.86523H9.40237C10.9711 8.86523 12.3294 9.95482 12.6698 11.4862L12.7625 11.9035C12.96 12.7925 12.2836 13.6359 11.3728 13.6359H4.62741C3.7167 13.6359 3.0402 12.7925 3.23776 11.9035L3.33049 11.4862ZM6.59788 7.86523C4.5604 7.86523 2.7963 9.28035 2.3543 11.2693L2.26158 11.6866C1.92523 13.2001 3.07695 14.6359 4.62741 14.6359H11.3728C12.9233 14.6359 14.075 13.2001 13.7387 11.6866L13.6459 11.2693C13.204 9.28035 11.4398 7.86523 9.40237 7.86523H6.59788Z",fill:"currentColor"})],-1),eP=[Q8];function tP(n,e){return q(),Q("svg",Z8,eP)}const nP=je(X8,[["render",tP]]),rP={},iP={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minimize-2"},sP=K("polyline",{points:"4 14 10 14 10 20"},null,-1),oP=K("polyline",{points:"20 10 14 10 14 4"},null,-1),aP=K("line",{x1:"14",y1:"10",x2:"21",y2:"3"},null,-1),lP=K("line",{x1:"3",y1:"21",x2:"10",y2:"14"},null,-1),cP=[sP,oP,aP,lP];function uP(n,e){return q(),Q("svg",iP,cP)}const dP=je(rP,[["render",uP]]),fP={},hP={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pP=K("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.64645 3.14645C5.84171 2.95118 6.15829 2.95118 6.35355 3.14645C6.54882 3.34171 6.54882 3.65829 6.35355 3.85355L3.20711 7H10C12.4853 7 14.5 9.01472 14.5 11.5V12C14.5 12.2761 14.2761 12.5 14 12.5C13.7239 12.5 13.5 12.2761 13.5 12V11.5C13.5 9.567 11.933 8 10 8H3.20711L6.35355 11.1464C6.54882 11.3417 6.54882 11.6583 6.35355 11.8536C6.15829 12.0488 5.84171 12.0488 5.64645 11.8536L1.64645 7.85355C1.45118 7.65829 1.45118 7.34171 1.64645 7.14645L5.64645 3.14645Z",fill:"currentColor"},null,-1),mP=[pP];function gP(n,e){return q(),Q("svg",hP,mP)}const yP=je(fP,[["render",gP]]),vP={},bP={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wP=K("path",{d:"M10.381 15.0091L13.0108 12.8044C13.3009 12.5612 13.7186 12.5445 14.0272 12.7639L16.5838 14.5815C17.0394 14.9054 17.0522 15.5775 16.6093 15.9186L15.6001 16.6955C14.9561 17.1913 14.0933 17.2956 13.3711 16.9225C11.824 16.1231 9.08016 14.5487 7.11025 12.5456C5.21236 10.6158 3.81881 8.0839 3.08578 6.57321C2.70649 5.79154 2.88609 4.87094 3.48778 4.24418L4.42402 3.26893C4.7989 2.87842 5.441 2.94435 5.72871 3.40288L7.34325 5.976C7.55012 6.3057 7.50072 6.73477 7.22432 7.00882L4.62919 9.58191",stroke:"currentColor","stroke-linejoin":"round"},null,-1),xP=[wP];function SP(n,e){return q(),Q("svg",bP,xP)}const cs=je(vP,[["render",SP]]),_P={__name:"CountUpTimer",setup(n,{expose:e}){const t=de(0),r=de(0),i=de(0),s=de(null),o=de("0:00");function a(){i.value===59&&(i.value=0,r.value=r.value+1,i.value--),r.value===60&&(r.value=0,t.value=t.value+1),i.value++;let u=r.value,d=i.value<10?"0"+i.value:i.value,f=t.value>0?t.value+":":"";f&&(u=u<10?"0"+u:u,d=d<10?"0"+d:d,u===0&&(u="00")),o.value=f+u+":"+d}function l(){s.value=setInterval(()=>a(),1e3)}function c(){clearInterval(s.value);let u=o.value;return t.value=0,r.value=0,i.value=0,o.value="0:00",u}return e({start:l,stop:c,updatedTime:o}),(u,d)=>Ye(u.$slots,"default")}},CP={},kP={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},EP=K("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.9998 3.5H4.92871C4.65257 3.5 4.42871 3.72386 4.42871 4C4.42871 4.27614 4.65257 4.5 4.92871 4.5H10.7929L3.64645 11.6464C3.45118 11.8417 3.45118 12.1583 3.64645 12.3536C3.84171 12.5488 4.15829 12.5488 4.35355 12.3536L11.4998 5.20733V11.0711C11.4998 11.3472 11.7236 11.5711 11.9998 11.5711C12.2759 11.5711 12.4998 11.3472 12.4998 11.0711V4.0149C12.5037 3.88202 12.455 3.74787 12.3536 3.64645C12.281 3.57388 12.1917 3.52828 12.098 3.50965C12.0813 3.50632 12.0643 3.50383 12.0471 3.50221C12.0336 3.50095 12.02 3.50022 12.0062 3.50004C12.0041 3.50001 12.0019 3.5 11.9998 3.5Z",fill:"currentColor"},null,-1),TP=[EP];function AP(n,e){return q(),Q("svg",kP,TP)}const MP=je(CP,[["render",AP]]),RP={name:"Alert",props:{title:String,type:{type:String,default:"warning"}},computed:{classes(){return{warning:"text-gray-700 bg-blue-50"}[this.type]}}},IP={class:"block w-full"},OP=K("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[K("path",{opacity:"0.8","fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2ZM12 10.5C12.5523 10.5 13 10.9477 13 11.5V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V11.5C11 10.9477 11.4477 10.5 12 10.5ZM13 7.99976C13 7.44747 12.5523 6.99976 12 6.99976C11.4477 6.99976 11 7.44747 11 7.99976V8.1C11 8.65228 11.4477 9.1 12 9.1C12.5523 9.1 13 8.65228 13 8.1V7.99976Z",fill:"#318AD8"})],-1),PP={class:"ml-2 w-full"},DP={class:"flex flex-col md:flex-row md:items-baseline"},$P={key:0,class:"text-lg font-medium text-gray-900"},NP={class:"mt-1 md:ml-2 md:mt-0"},LP={class:"mt-3 md:ml-auto md:mt-0"};function jP(n,e,t,r,i,s){return q(),Q("div",IP,[K("div",{class:De(["flex items-start rounded-md px-4 py-3.5 text-base md:px-5",s.classes])},[OP,K("div",PP,[K("div",DP,[t.title?(q(),Q("h3",$P,Ge(t.title),1)):He("",!0),K("div",NP,[Ye(n.$slots,"default")]),K("div",LP,[Ye(n.$slots,"actions")])])])],2)])}const FP=je(RP,[["render",jP]]);function ba(n,e,t){var s;let r=(s=t.initialDeps)!=null?s:[],i;return()=>{var o,a,l,c;let u;t.key&&((o=t.debug)!=null&&o.call(t))&&(u=Date.now());const d=n();if(!(d.length!==r.length||d.some((m,v)=>r[v]!==m)))return i;r=d;let p;if(t.key&&((a=t.debug)!=null&&a.call(t))&&(p=Date.now()),i=e(...d),t.key&&((l=t.debug)!=null&&l.call(t))){const m=Math.round((Date.now()-u)*100)/100,v=Math.round((Date.now()-p)*100)/100,x=v/16,b=(_,M)=>{for(_=String(_);_.length<M;)_=" "+_;return _};console.info(`%c ${b(v,5)} /${b(m,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*x,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(c=t==null?void 0:t.onChange)==null||c.call(t,i),i}}function Im(n,e){if(n===void 0)throw new Error(`Unexpected undefined${e?`: ${e}`:""}`);return n}const HP=(n,e)=>Math.abs(n-e)<1,BP=n=>n,zP=n=>{const e=Math.max(n.startIndex-n.overscan,0),t=Math.min(n.endIndex+n.overscan,n.count-1),r=[];for(let i=e;i<=t;i++)r.push(i);return r},VP=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=s=>{const{width:o,height:a}=s;e({width:Math.round(o),height:Math.round(a)})};if(r(t.getBoundingClientRect()),typeof ResizeObserver=="undefined")return()=>{};const i=new ResizeObserver(s=>{const o=s[0];if(o!=null&&o.borderBoxSize){const a=o.borderBoxSize[0];if(a){r({width:a.inlineSize,height:a.blockSize});return}}r(t.getBoundingClientRect())});return i.observe(t,{box:"border-box"}),()=>{i.unobserve(t)}},qP=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=()=>{e(t[n.options.horizontal?"scrollLeft":"scrollTop"])};return r(),t.addEventListener("scroll",r,{passive:!0}),()=>{t.removeEventListener("scroll",r)}},UP=(n,e,t)=>{if(e!=null&&e.borderBoxSize){const r=e.borderBoxSize[0];if(r)return Math.round(r[t.options.horizontal?"inlineSize":"blockSize"])}return Math.round(n.getBoundingClientRect()[t.options.horizontal?"width":"height"])},WP=(n,{adjustments:e=0,behavior:t},r)=>{var i,s;const o=n+e;(s=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||s.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:t})};class JP{constructor(e){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let t=null;const r=()=>t||(typeof ResizeObserver!="undefined"?t=new ResizeObserver(i=>{i.forEach(s=>{this._measureElement(s.target,s)})}):null);return{disconnect:()=>{var i;return(i=r())==null?void 0:i.disconnect()},observe:i=>{var s;return(s=r())==null?void 0:s.observe(i,{box:"border-box"})},unobserve:i=>{var s;return(s=r())==null?void 0:s.unobserve(i)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([r,i])=>{typeof i=="undefined"&&delete t[r]}),this.options=Y({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:BP,rangeExtractor:zP,onChange:()=>{},measureElement:UP,initialRect:{width:0,height:0},scrollMargin:0,gap:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},t)},this.notify=t=>{var r,i;(i=(r=this.options).onChange)==null||i.call(r,this,t)},this.maybeNotify=ba(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const t=this.options.getScrollElement();this.scrollElement!==t&&(this.cleanup(),this.scrollElement=t,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,r=>{this.scrollRect=r,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,r=>{this.scrollAdjustments=0,this.scrollOffset!==r&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<r?"forward":"backward",this.scrollOffset=r,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=ba(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(t,r,i,s)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:r,scrollMargin:i,getItemKey:s}),{key:!1}),this.getFurthestMeasurement=(t,r)=>{const i=new Map,s=new Map;for(let o=r-1;o>=0;o--){const a=t[o];if(i.has(a.lane))continue;const l=s.get(a.lane);if(l==null||a.end>l.end?s.set(a.lane,a):a.end<l.end&&i.set(a.lane,!0),i.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((o,a)=>o.end===a.end?o.index-a.index:o.end-a.end)[0]:void 0},this.getMeasurements=ba(()=>[this.memoOptions(),this.itemSizeCache],({count:t,paddingStart:r,scrollMargin:i,getItemKey:s},o)=>{const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const l=this.measurementsCache.slice(0,a);for(let c=a;c<t;c++){const u=s(c),d=this.options.lanes===1?l[c-1]:this.getFurthestMeasurement(l,c),f=d?d.end+this.options.gap:r+i,p=o.get(u),m=typeof p=="number"?p:this.options.estimateSize(c),v=f+m,x=d?d.lane:c%this.options.lanes;l[c]={index:c,start:f,size:m,end:v,key:u,lane:x}}return this.measurementsCache=l,l},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ba(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(t,r,i)=>this.range=t.length>0&&r>0?KP({measurements:t,outerSize:r,scrollOffset:i}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=ba(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(t,r,i,s)=>r===null?[]:t(Te(Y({},r),{overscan:i,count:s})),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const r=this.options.indexAttribute,i=t.getAttribute(r);return i?parseInt(i,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(t,r)=>{const i=this.measurementsCache[this.indexFromElement(t)];if(!i||!t.isConnected){this.measureElementCache.forEach((a,l)=>{a===t&&(this.observer.unobserve(t),this.measureElementCache.delete(l))});return}const s=this.measureElementCache.get(i.key);s!==t&&(s&&this.observer.unobserve(s),this.observer.observe(t),this.measureElementCache.set(i.key,t));const o=this.options.measureElement(t,r,this);this.resizeItem(i,o)},this.resizeItem=(t,r)=>{var o;const i=(o=this.itemSizeCache.get(t.key))!=null?o:t.size,s=r-i;s!==0&&(t.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=s,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,r)),this.notify(!1))},this.measureElement=t=>{t&&this._measureElement(t,void 0)},this.getVirtualItems=ba(()=>[this.getIndexes(),this.getMeasurements()],(t,r)=>{const i=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=r[a];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const r=this.getMeasurements();return Im(r[kC(0,r.length-1,i=>Im(r[i]).start,t)])},this.getOffsetForAlignment=(t,r)=>{const i=this.getSize();r==="auto"&&(t<=this.scrollOffset?r="start":t>=this.scrollOffset+i?r="end":r="start"),r==="start"?t=t:r==="end"?t=t-i:r==="center"&&(t=t-i/2);const s=this.options.horizontal?"scrollWidth":"scrollHeight",a=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[s]:this.scrollElement[s]:0)-this.getSize();return Math.max(Math.min(a,t),0)},this.getOffsetForIndex=(t,r="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const i=Im(this.getMeasurements()[t]);if(r==="auto")if(i.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)r="end";else if(i.start<=this.scrollOffset+this.options.scrollPaddingStart)r="start";else return[this.scrollOffset,r];const s=r==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(s,r),r]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(t,{align:r="start",behavior:i}={})=>{this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,r),{adjustments:void 0,behavior:i})},this.scrollToIndex=(t,{align:r="auto",behavior:i}={})=>{t=Math.max(0,Math.min(t,this.options.count-1)),this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[s,o]=this.getOffsetForIndex(t,r);this._scrollToOffset(s,{adjustments:void 0,behavior:i}),i!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(t))){const[l]=this.getOffsetForIndex(t,o);HP(l,this.scrollOffset)||this.scrollToIndex(t,{align:o,behavior:i})}else this.scrollToIndex(t,{align:o,behavior:i})}))},this.scrollBy=(t,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+t,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var s;var t;const r=this.getMeasurements();let i;return r.length===0?i=this.options.paddingStart:i=this.options.lanes===1?(s=(t=r[r.length-1])==null?void 0:t.end)!=null?s:0:Math.max(...r.slice(-this.options.lanes).map(o=>o.end)),i-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(t,{adjustments:r,behavior:i})=>{this.options.scrollToFn(t,{behavior:i,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(t=>{this.itemSizeCache.set(t.key,t.size)}),this.maybeNotify()}}const kC=(n,e,t,r)=>{for(;n<=e;){const i=(n+e)/2|0,s=t(i);if(s<r)n=i+1;else if(s>r)e=i-1;else return i}return n>0?n-1:0};function KP({measurements:n,outerSize:e,scrollOffset:t}){const r=n.length-1,s=kC(0,r,a=>n[a].start,t);let o=s;for(;o<r&&n[o].end<t+e;)o++;return{startIndex:s,endIndex:o}}function GP(n){const e=new JP(we(n)),t=fy(e),r=e._didMount();return At(()=>we(n).getScrollElement(),i=>{i&&e._willUpdate()},{immediate:!0}),At(()=>we(n),i=>{e.setOptions(Te(Y({},i),{onChange:(s,o)=>{var a;_b(t),(a=i.onChange)==null||a.call(i,s,o)}})),e._willUpdate(),_b(t)},{immediate:!0}),sy(r),t}function YP(n){return GP(re(()=>Y({observeElementRect:VP,observeElementOffset:qP,scrollToFn:WP},we(n))))}function XP(n,e,t){let r=de(t==null?void 0:t.value),i=re(()=>n.value!==void 0);return[re(()=>i.value?n.value:r.value),function(s){return i.value||(r.value=s),e==null?void 0:e(s)}]}let ZP=Symbol("headlessui.useid"),QP=0;function Js(){return _t(ZP,()=>`${++QP}`)()}function Pe(n){var e;if(n==null||n.value==null)return null;let t=(e=n.value.$el)!=null?e:n.value;return t instanceof Node?t:null}function vn(n,e,...t){if(n in e){let i=e[n];return typeof i=="function"?i(...t):i}let r=new Error(`Tried to handle "${n}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,vn),r}var eD=Object.defineProperty,tD=(n,e,t)=>e in n?eD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bw=(n,e,t)=>(tD(n,typeof e!="symbol"?e+"":e,t),t);let nD=class{constructor(){bw(this,"current",this.detect()),bw(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window=="undefined"||typeof document=="undefined"?"server":"client"}},sd=new nD;function Ks(n){if(sd.isServer)return null;if(n instanceof Node)return n.ownerDocument;if(n!=null&&n.hasOwnProperty("value")){let e=Pe(n);if(e)return e.ownerDocument}return document}let p0=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>`${n}:not([tabindex='-1'])`).join(",");var Es=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n))(Es||{}),EC=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(EC||{}),rD=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(rD||{});function iD(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(p0)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var TC=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(TC||{});function sD(n,e=0){var t;return n===((t=Ks(n))==null?void 0:t.body)?!1:vn(e,{0(){return n.matches(p0)},1(){let r=n;for(;r!==null;){if(r.matches(p0))return!0;r=r.parentElement}return!1}})}var oD=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(oD||{});typeof window!="undefined"&&typeof document!="undefined"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function No(n){n==null||n.focus({preventScroll:!0})}let aD=["textarea","input"].join(",");function lD(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,aD))!=null?t:!1}function AC(n,e=t=>t){return n.slice().sort((t,r)=>{let i=e(t),s=e(r);if(i===null||s===null)return 0;let o=i.compareDocumentPosition(s);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Sf(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:i=[]}={}){var s;let o=(s=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n==null?void 0:n.ownerDocument)!=null?s:document,a=Array.isArray(n)?t?AC(n):n:iD(n);i.length>0&&a.length>1&&(a=a.filter(m=>!i.includes(m))),r=r!=null?r:o.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,a.indexOf(r))-1;if(e&4)return Math.max(0,a.indexOf(r))+1;if(e&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},d=0,f=a.length,p;do{if(d>=f||d+f<=0)return 0;let m=c+d;if(e&16)m=(m+f)%f;else{if(m<0)return 3;if(m>=f)return 1}p=a[m],p==null||p.focus(u),d+=l}while(p!==o.activeElement);return e&6&&lD(p)&&p.select(),2}function MC(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function cD(){return/Android/gi.test(window.navigator.userAgent)}function RC(){return MC()||cD()}function jd(n,e,t){sd.isServer||Yt(r=>{document.addEventListener(n,e,t),r(()=>document.removeEventListener(n,e,t))})}function IC(n,e,t){sd.isServer||Yt(r=>{window.addEventListener(n,e,t),r(()=>window.removeEventListener(n,e,t))})}function OC(n,e,t=re(()=>!0)){function r(s,o){if(!t.value||s.defaultPrevented)return;let a=o(s);if(a===null||!a.getRootNode().contains(a))return;let l=function c(u){return typeof u=="function"?c(u()):Array.isArray(u)||u instanceof Set?u:[u]}(n);for(let c of l){if(c===null)continue;let u=c instanceof HTMLElement?c:Pe(c);if(u!=null&&u.contains(a)||s.composed&&s.composedPath().includes(u))return}return!sD(a,TC.Loose)&&a.tabIndex!==-1&&s.preventDefault(),e(s,a)}let i=de(null);jd("pointerdown",s=>{var o,a;t.value&&(i.value=((a=(o=s.composedPath)==null?void 0:o.call(s))==null?void 0:a[0])||s.target)},!0),jd("mousedown",s=>{var o,a;t.value&&(i.value=((a=(o=s.composedPath)==null?void 0:o.call(s))==null?void 0:a[0])||s.target)},!0),jd("click",s=>{RC()||i.value&&(r(s,()=>i.value),i.value=null)},!0),jd("touchend",s=>r(s,()=>s.target instanceof HTMLElement?s.target:null),!0),IC("blur",s=>r(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function ww(n,e){if(n)return n;let t=e!=null?e:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function uD(n,e){let t=de(ww(n.value.type,n.value.as));return Et(()=>{t.value=ww(n.value.type,n.value.as)}),Yt(()=>{var r;t.value||Pe(e)&&Pe(e)instanceof HTMLButtonElement&&!((r=Pe(e))!=null&&r.hasAttribute("type"))&&(t.value="button")}),t}function xw(n){return[n.screenX,n.screenY]}function dD(){let n=de([-1,-1]);return{wasMoved(e){let t=xw(e);return n.value[0]===t[0]&&n.value[1]===t[1]?!1:(n.value=t,!0)},update(e){n.value=xw(e)}}}function fD({container:n,accept:e,walk:t,enabled:r}){Yt(()=>{let i=n.value;if(!i||r!==void 0&&!r.value)return;let s=Ks(n);if(!s)return;let o=Object.assign(l=>e(l),{acceptNode:e}),a=s.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,o,!1);for(;a.nextNode();)t(a.currentNode)})}var Bs=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(Bs||{}),Rs=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(Rs||{});function Hn(s){var o=s,{visible:n=!0,features:e=0,ourProps:t,theirProps:r}=o,i=En(o,["visible","features","ourProps","theirProps"]);var a;let l=DC(r,t),c=Object.assign(i,{props:l});if(n||e&2&&l.static)return Om(c);if(e&1){let u=(a=l.unmount)==null||a?0:1;return vn(u,{0(){return null},1(){return Om(Te(Y({},i),{props:Te(Y({},l),{hidden:!0,style:{display:"none"}})}))}})}return Om(c)}function Om({props:n,attrs:e,slots:t,slot:r,name:i}){var s,o;let d=od(n,["unmount","static"]),{as:a}=d,l=En(d,["as"]),c=(s=t.default)==null?void 0:s.call(t,r),u={};if(r){let f=!1,p=[];for(let[m,v]of Object.entries(r))typeof v=="boolean"&&(f=!0),v===!0&&p.push(m);f&&(u["data-headlessui-state"]=p.join(" "))}if(a==="template"){if(c=PC(c!=null?c:[]),Object.keys(l).length>0||Object.keys(e).length>0){let[f,...p]=c!=null?c:[];if(!pD(f)||p.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${i} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(e)).map(x=>x.trim()).filter((x,b,_)=>_.indexOf(x)===b).sort((x,b)=>x.localeCompare(b)).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`));let m=DC((o=f.props)!=null?o:{},l,u),v=_i(f,m,!0);for(let x in m)x.startsWith("on")&&(v.props||(v.props={}),v.props[x]=m[x]);return v}return Array.isArray(c)&&c.length===1?c[0]:c}return gt(a,Object.assign({},l,u),{default:()=>c})}function PC(n){return n.flatMap(e=>e.type===lt?PC(e.children):[e])}function DC(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(t).map(r=>[r,void 0])));for(let r in t)Object.assign(e,{[r](i,...s){let o=t[r];for(let a of o){if(i instanceof Event&&i.defaultPrevented)return;a(i,...s)}}});return e}function hD(n){let e=Object.assign({},n);for(let t in e)e[t]===void 0&&delete e[t];return e}function od(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function pD(n){return n==null?!1:typeof n.type=="string"||typeof n.type=="object"||typeof n.type=="function"}var Mu=(n=>(n[n.None=1]="None",n[n.Focusable=2]="Focusable",n[n.Hidden=4]="Hidden",n))(Mu||{});let yh=at({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(n,{slots:e,attrs:t}){return()=>{var r;let a=n,{features:i}=a,s=En(a,["features"]),o={"aria-hidden":(i&2)===2?!0:(r=s["aria-hidden"])!=null?r:void 0,style:Y({position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},(i&4)===4&&(i&2)!==2&&{display:"none"})};return Hn({ourProps:o,theirProps:s,slot:{},attrs:t,slots:e,name:"Hidden"})}}}),$C=Symbol("Context");var cn=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(cn||{});function mD(){return Mp()!==null}function Mp(){return _t($C,null)}function NC(n){bn($C,n)}var qn=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(qn||{});function gD(n){function e(){document.readyState!=="loading"&&(n(),document.removeEventListener("DOMContentLoaded",e))}typeof window!="undefined"&&typeof document!="undefined"&&(document.addEventListener("DOMContentLoaded",e),e())}let Hi=[];gD(()=>{function n(e){e.target instanceof HTMLElement&&e.target!==document.body&&Hi[0]!==e.target&&(Hi.unshift(e.target),Hi=Hi.filter(t=>t!=null&&t.isConnected),Hi.splice(10))}window.addEventListener("click",n,{capture:!0}),window.addEventListener("mousedown",n,{capture:!0}),window.addEventListener("focus",n,{capture:!0}),document.body.addEventListener("click",n,{capture:!0}),document.body.addEventListener("mousedown",n,{capture:!0}),document.body.addEventListener("focus",n,{capture:!0})});function yD(n){throw new Error("Unexpected object: "+n)}var ln=(n=>(n[n.First=0]="First",n[n.Previous=1]="Previous",n[n.Next=2]="Next",n[n.Last=3]="Last",n[n.Specific=4]="Specific",n[n.Nothing=5]="Nothing",n))(ln||{});function Sw(n,e){let t=e.resolveItems();if(t.length<=0)return null;let r=e.resolveActiveIndex(),i=r!=null?r:-1;switch(n.focus){case 0:{for(let s=0;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 1:{i===-1&&(i=t.length);for(let s=i-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 2:{for(let s=i+1;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 3:{for(let s=t.length-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 4:{for(let s=0;s<t.length;++s)if(e.resolveId(t[s],s,t)===n.id)return s;return r}case 5:return null;default:yD(n)}}function Cy(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}function ea(){let n=[],e={addEventListener(t,r,i,s){return t.addEventListener(r,i,s),e.add(()=>t.removeEventListener(r,i,s))},requestAnimationFrame(...t){let r=requestAnimationFrame(...t);e.add(()=>cancelAnimationFrame(r))},nextFrame(...t){e.requestAnimationFrame(()=>{e.requestAnimationFrame(...t)})},setTimeout(...t){let r=setTimeout(...t);e.add(()=>clearTimeout(r))},microTask(...t){let r={current:!0};return Cy(()=>{r.current&&t[0]()}),e.add(()=>{r.current=!1})},style(t,r,i){let s=t.style.getPropertyValue(r);return Object.assign(t.style,{[r]:i}),this.add(()=>{Object.assign(t.style,{[r]:s})})},group(t){let r=ea();return t(r),this.add(()=>r.dispose())},add(t){return n.push(t),()=>{let r=n.indexOf(t);if(r>=0)for(let i of n.splice(r,1))i()}},dispose(){for(let t of n.splice(0))t()}};return e}function LC(n={},e=null,t=[]){for(let[r,i]of Object.entries(n))FC(t,jC(e,r),i);return t}function jC(n,e){return n?n+"["+e+"]":e}function FC(n,e,t){if(Array.isArray(t))for(let[r,i]of t.entries())FC(n,jC(e,r.toString()),i);else t instanceof Date?n.push([e,t.toISOString()]):typeof t=="boolean"?n.push([e,t?"1":"0"]):typeof t=="string"?n.push([e,t]):typeof t=="number"?n.push([e,`${t}`]):t==null?n.push([e,""]):LC(t,e,n)}var vD={};function bD(n,e){return n===e}var wD=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(wD||{}),xD=(n=>(n[n.Single=0]="Single",n[n.Multi=1]="Multi",n))(xD||{}),SD=(n=>(n[n.Pointer=0]="Pointer",n[n.Focus=1]="Focus",n[n.Other=2]="Other",n))(SD||{});let HC=Symbol("ComboboxContext");function Bl(n){let e=_t(HC,null);if(e===null){let t=new Error(`<${n} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Bl),t}return e}let BC=Symbol("VirtualContext"),_D=at({name:"VirtualProvider",setup(n,{slots:e}){let t=Bl("VirtualProvider"),r=re(()=>{let a=Pe(t.optionsRef);if(!a)return{start:0,end:0};let l=window.getComputedStyle(a);return{start:parseFloat(l.paddingBlockStart||l.paddingTop),end:parseFloat(l.paddingBlockEnd||l.paddingBottom)}}),i=YP(re(()=>({scrollPaddingStart:r.value.start,scrollPaddingEnd:r.value.end,count:t.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return Pe(t.optionsRef)},overscan:12}))),s=re(()=>{var a;return(a=t.virtual.value)==null?void 0:a.options}),o=de(0);return At([s],()=>{o.value+=1}),bn(BC,t.virtual.value?i:null),()=>[gt("div",{style:{position:"relative",width:"100%",height:`${i.value.getTotalSize()}px`},ref:a=>{if(a){if(typeof process!="undefined"&&vD.JEST_WORKER_ID!==void 0||t.activationTrigger.value===0)return;t.activeOptionIndex.value!==null&&t.virtual.value.options.length>t.activeOptionIndex.value&&i.value.scrollToIndex(t.activeOptionIndex.value)}}},i.value.getVirtualItems().map(a=>_i(e.default({option:t.virtual.value.options[a.index],open:t.comboboxState.value===0})[0],{key:`${o.value}-${a.index}`,"data-index":a.index,"aria-setsize":t.virtual.value.options.length,"aria-posinset":a.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${a.start}px)`,overflowAnchor:"none"}})))]}}),CD=at({name:"Combobox",emits:{"update:modelValue":n=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(n,{slots:e,attrs:t,emit:r}){let i=de(1),s=de(null),o=de(null),a=de(null),l=de(null),c=de({static:!1,hold:!1}),u=de([]),d=de(null),f=de(2),p=de(!1);function m(R=S=>S){let S=d.value!==null?u.value[d.value]:null,k=R(u.value.slice()),T=k.length>0&&k[0].dataRef.order.value!==null?k.sort((D,A)=>D.dataRef.order.value-A.dataRef.order.value):AC(k,D=>Pe(D.dataRef.domRef)),C=S?T.indexOf(S):null;return C===-1&&(C=null),{options:T,activeOptionIndex:C}}let v=re(()=>n.multiple?1:0),x=re(()=>n.nullable),[b,_]=XP(re(()=>n.modelValue),R=>r("update:modelValue",R),re(()=>n.defaultValue)),M=re(()=>b.value===void 0?vn(v.value,{1:[],0:void 0}):b.value),h=null,w=null;function y(R){return vn(v.value,{0(){return _==null?void 0:_(R)},1:()=>{let S=ze(g.value.value).slice(),k=ze(R),T=S.findIndex(C=>g.compare(k,ze(C)));return T===-1?S.push(k):S.splice(T,1),_==null?void 0:_(S)}})}let E=re(()=>{});At([E],([R],[S])=>{if(g.virtual.value&&R&&S&&d.value!==null){let k=R.indexOf(S[d.value]);k!==-1?d.value=k:d.value=null}});let g={comboboxState:i,value:M,mode:v,compare(R,S){if(typeof n.by=="string"){let k=n.by;return(R==null?void 0:R[k])===(S==null?void 0:S[k])}return n.by===null?bD(R,S):n.by(R,S)},calculateIndex(R){return g.virtual.value?n.by===null?g.virtual.value.options.indexOf(R):g.virtual.value.options.findIndex(S=>g.compare(S,R)):u.value.findIndex(S=>g.compare(S.dataRef.value,R))},defaultValue:re(()=>n.defaultValue),nullable:x,immediate:re(()=>!1),virtual:re(()=>null),inputRef:o,labelRef:s,buttonRef:a,optionsRef:l,disabled:re(()=>n.disabled),options:u,change(R){_(R)},activeOptionIndex:re(()=>{if(p.value&&d.value===null&&(g.virtual.value?g.virtual.value.options.length>0:u.value.length>0)){if(g.virtual.value){let S=g.virtual.value.options.findIndex(k=>{var T;return!((T=g.virtual.value)!=null&&T.disabled(k))});if(S!==-1)return S}let R=u.value.findIndex(S=>!S.dataRef.disabled);if(R!==-1)return R}return d.value}),activationTrigger:f,optionsPropsRef:c,closeCombobox(){p.value=!1,!n.disabled&&i.value!==1&&(i.value=1,d.value=null)},openCombobox(){if(p.value=!0,!n.disabled&&i.value!==0){if(g.value.value){let R=g.calculateIndex(g.value.value);R!==-1&&(d.value=R)}i.value=0}},setActivationTrigger(R){f.value=R},goToOption(R,S,k){p.value=!1,h!==null&&cancelAnimationFrame(h),h=requestAnimationFrame(()=>{if(n.disabled||l.value&&!c.value.static&&i.value===1)return;if(g.virtual.value){d.value=R===ln.Specific?S:Sw({focus:R},{resolveItems:()=>g.virtual.value.options,resolveActiveIndex:()=>{var D,A;return(A=(D=g.activeOptionIndex.value)!=null?D:g.virtual.value.options.findIndex(O=>{var P;return!((P=g.virtual.value)!=null&&P.disabled(O))}))!=null?A:null},resolveDisabled:D=>g.virtual.value.disabled(D),resolveId(){throw new Error("Function not implemented.")}}),f.value=k!=null?k:2;return}let T=m();if(T.activeOptionIndex===null){let D=T.options.findIndex(A=>!A.dataRef.disabled);D!==-1&&(T.activeOptionIndex=D)}let C=R===ln.Specific?S:Sw({focus:R},{resolveItems:()=>T.options,resolveActiveIndex:()=>T.activeOptionIndex,resolveId:D=>D.id,resolveDisabled:D=>D.dataRef.disabled});d.value=C,f.value=k!=null?k:2,u.value=T.options})},selectOption(R){let S=u.value.find(T=>T.id===R);if(!S)return;let{dataRef:k}=S;y(k.value)},selectActiveOption(){if(g.activeOptionIndex.value!==null){if(g.virtual.value)y(g.virtual.value.options[g.activeOptionIndex.value]);else{let{dataRef:R}=u.value[g.activeOptionIndex.value];y(R.value)}g.goToOption(ln.Specific,g.activeOptionIndex.value)}},registerOption(R,S){let k=zr({id:R,dataRef:S});if(g.virtual.value){u.value.push(k);return}w&&cancelAnimationFrame(w);let T=m(C=>(C.push(k),C));d.value===null&&g.isSelected(S.value.value)&&(T.activeOptionIndex=T.options.indexOf(k)),u.value=T.options,d.value=T.activeOptionIndex,f.value=2,T.options.some(C=>!Pe(C.dataRef.domRef))&&(w=requestAnimationFrame(()=>{let C=m();u.value=C.options,d.value=C.activeOptionIndex}))},unregisterOption(R,S){if(h!==null&&cancelAnimationFrame(h),S&&(p.value=!0),g.virtual.value){u.value=u.value.filter(T=>T.id!==R);return}let k=m(T=>{let C=T.findIndex(D=>D.id===R);return C!==-1&&T.splice(C,1),T});u.value=k.options,d.value=k.activeOptionIndex,f.value=2},isSelected(R){return vn(v.value,{0:()=>g.compare(ze(g.value.value),ze(R)),1:()=>ze(g.value.value).some(S=>g.compare(ze(S),ze(R)))})},isActive(R){return d.value===g.calculateIndex(R)}};OC([o,a,l],()=>g.closeCombobox(),re(()=>i.value===0)),bn(HC,g),NC(re(()=>vn(i.value,{0:cn.Open,1:cn.Closed})));let I=re(()=>{var R;return(R=Pe(o))==null?void 0:R.closest("form")});return Et(()=>{At([I],()=>{if(!I.value||n.defaultValue===void 0)return;function R(){g.change(n.defaultValue)}return I.value.addEventListener("reset",R),()=>{var S;(S=I.value)==null||S.removeEventListener("reset",R)}},{immediate:!0})}),()=>{var R,S,k;let P=n,{name:T,disabled:C,form:D}=P,A=En(P,["name","disabled","form"]),O={open:i.value===0,disabled:C,activeIndex:g.activeOptionIndex.value,activeOption:g.activeOptionIndex.value===null?null:g.virtual.value?g.virtual.value.options[(R=g.activeOptionIndex.value)!=null?R:0]:(k=(S=g.options.value[g.activeOptionIndex.value])==null?void 0:S.dataRef.value)!=null?k:null,value:M.value};return gt(lt,[...T!=null&&M.value!=null?LC({[T]:M.value}).map(([N,F])=>gt(yh,hD({features:Mu.Hidden,key:N,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:D,name:N,value:F}))):[],Hn({theirProps:Y(Y({},t),od(A,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])),ourProps:{},slot:O,slots:e,attrs:t,name:"Combobox"})])}}}),kD=at({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:`headlessui-combobox-button-${Js()}`,o=Bl("ComboboxButton");r({el:o.buttonRef,$el:o.buttonRef});function a(u){o.disabled.value||(o.comboboxState.value===0?o.closeCombobox():(u.preventDefault(),o.openCombobox()),Dn(()=>{var d;return(d=Pe(o.inputRef))==null?void 0:d.focus({preventScroll:!0})}))}function l(u){switch(u.key){case qn.ArrowDown:u.preventDefault(),u.stopPropagation(),o.comboboxState.value===1&&o.openCombobox(),Dn(()=>{var d;return(d=o.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case qn.ArrowUp:u.preventDefault(),u.stopPropagation(),o.comboboxState.value===1&&(o.openCombobox(),Dn(()=>{o.value.value||o.goToOption(ln.Last)})),Dn(()=>{var d;return(d=o.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case qn.Escape:if(o.comboboxState.value!==0)return;u.preventDefault(),o.optionsRef.value&&!o.optionsPropsRef.value.static&&u.stopPropagation(),o.closeCombobox(),Dn(()=>{var d;return(d=o.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return}}let c=uD(re(()=>({as:n.as,type:e.type})),o.buttonRef);return()=>{var u,d;let f={open:o.comboboxState.value===0,disabled:o.disabled.value,value:o.value.value},p=En(n,[]),m={ref:o.buttonRef,id:s,type:c.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(u=Pe(o.optionsRef))==null?void 0:u.id,"aria-expanded":o.comboboxState.value===0,"aria-labelledby":o.labelRef.value?[(d=Pe(o.labelRef))==null?void 0:d.id,s].join(" "):void 0,disabled:o.disabled.value===!0?!0:void 0,onKeydown:l,onClick:a};return Hn({ourProps:m,theirProps:p,slot:f,attrs:e,slots:t,name:"ComboboxButton"})}}}),ED=at({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:n=>!0},setup(n,{emit:e,attrs:t,slots:r,expose:i}){var s;let o=(s=n.id)!=null?s:`headlessui-combobox-input-${Js()}`,a=Bl("ComboboxInput"),l=re(()=>Ks(Pe(a.inputRef))),c={value:!1};i({el:a.inputRef,$el:a.inputRef});function u(){a.change(null);let h=Pe(a.optionsRef);h&&(h.scrollTop=0),a.goToOption(ln.Nothing)}let d=re(()=>{var h;let w=a.value.value;return Pe(a.inputRef)?typeof n.displayValue!="undefined"&&w!==void 0?(h=n.displayValue(w))!=null?h:"":typeof w=="string"?w:"":""});Et(()=>{At([d,a.comboboxState,l],([h,w],[y,E])=>{if(c.value)return;let g=Pe(a.inputRef);g&&((E===0&&w===1||h!==y)&&(g.value=h),requestAnimationFrame(()=>{var I;if(c.value||!g||((I=l.value)==null?void 0:I.activeElement)!==g)return;let{selectionStart:R,selectionEnd:S}=g;Math.abs((S!=null?S:0)-(R!=null?R:0))===0&&R===0&&g.setSelectionRange(g.value.length,g.value.length)}))},{immediate:!0}),At([a.comboboxState],([h],[w])=>{if(h===0&&w===1){if(c.value)return;let y=Pe(a.inputRef);if(!y)return;let E=y.value,{selectionStart:g,selectionEnd:I,selectionDirection:R}=y;y.value="",y.value=E,R!==null?y.setSelectionRange(g,I,R):y.setSelectionRange(g,I)}})});let f=de(!1);function p(){f.value=!0}function m(){ea().nextFrame(()=>{f.value=!1})}function v(h){switch(c.value=!0,h.key){case qn.Enter:if(c.value=!1,a.comboboxState.value!==0||f.value)return;if(h.preventDefault(),h.stopPropagation(),a.activeOptionIndex.value===null){a.closeCombobox();return}a.selectActiveOption(),a.mode.value===0&&a.closeCombobox();break;case qn.ArrowDown:return c.value=!1,h.preventDefault(),h.stopPropagation(),vn(a.comboboxState.value,{0:()=>a.goToOption(ln.Next),1:()=>a.openCombobox()});case qn.ArrowUp:return c.value=!1,h.preventDefault(),h.stopPropagation(),vn(a.comboboxState.value,{0:()=>a.goToOption(ln.Previous),1:()=>{a.openCombobox(),Dn(()=>{a.value.value||a.goToOption(ln.Last)})}});case qn.Home:if(h.shiftKey)break;return c.value=!1,h.preventDefault(),h.stopPropagation(),a.goToOption(ln.First);case qn.PageUp:return c.value=!1,h.preventDefault(),h.stopPropagation(),a.goToOption(ln.First);case qn.End:if(h.shiftKey)break;return c.value=!1,h.preventDefault(),h.stopPropagation(),a.goToOption(ln.Last);case qn.PageDown:return c.value=!1,h.preventDefault(),h.stopPropagation(),a.goToOption(ln.Last);case qn.Escape:if(c.value=!1,a.comboboxState.value!==0)return;h.preventDefault(),a.optionsRef.value&&!a.optionsPropsRef.value.static&&h.stopPropagation(),a.nullable.value&&a.mode.value===0&&a.value.value===null&&u(),a.closeCombobox();break;case qn.Tab:if(c.value=!1,a.comboboxState.value!==0)return;a.mode.value===0&&a.activationTrigger.value!==1&&a.selectActiveOption(),a.closeCombobox();break}}function x(h){e("change",h),a.nullable.value&&a.mode.value===0&&h.target.value===""&&u(),a.openCombobox()}function b(h){var w,y,E;let g=(w=h.relatedTarget)!=null?w:Hi.find(I=>I!==h.currentTarget);if(c.value=!1,!((y=Pe(a.optionsRef))!=null&&y.contains(g))&&!((E=Pe(a.buttonRef))!=null&&E.contains(g))&&a.comboboxState.value===0)return h.preventDefault(),a.mode.value===0&&(a.nullable.value&&a.value.value===null?u():a.activationTrigger.value!==1&&a.selectActiveOption()),a.closeCombobox()}function _(h){var w,y,E;let g=(w=h.relatedTarget)!=null?w:Hi.find(I=>I!==h.currentTarget);(y=Pe(a.buttonRef))!=null&&y.contains(g)||(E=Pe(a.optionsRef))!=null&&E.contains(g)||a.disabled.value||a.immediate.value&&a.comboboxState.value!==0&&(a.openCombobox(),ea().nextFrame(()=>{a.setActivationTrigger(1)}))}let M=re(()=>{var h,w,y,E;return(E=(y=(w=n.defaultValue)!=null?w:a.defaultValue.value!==void 0?(h=n.displayValue)==null?void 0:h.call(n,a.defaultValue.value):null)!=null?y:a.defaultValue.value)!=null?E:""});return()=>{var h,w,y,E,g,I,R;let S={open:a.comboboxState.value===0},A=n,{displayValue:k,onChange:T}=A,C=En(A,["displayValue","onChange"]),D={"aria-controls":(h=a.optionsRef.value)==null?void 0:h.id,"aria-expanded":a.comboboxState.value===0,"aria-activedescendant":a.activeOptionIndex.value===null?void 0:a.virtual.value?(w=a.options.value.find(O=>!a.virtual.value.disabled(O.dataRef.value)&&a.compare(O.dataRef.value,a.virtual.value.options[a.activeOptionIndex.value])))==null?void 0:w.id:(y=a.options.value[a.activeOptionIndex.value])==null?void 0:y.id,"aria-labelledby":(I=(E=Pe(a.labelRef))==null?void 0:E.id)!=null?I:(g=Pe(a.buttonRef))==null?void 0:g.id,"aria-autocomplete":"list",id:o,onCompositionstart:p,onCompositionend:m,onKeydown:v,onInput:x,onFocus:_,onBlur:b,role:"combobox",type:(R=t.type)!=null?R:"text",tabIndex:0,ref:a.inputRef,defaultValue:M.value,disabled:a.disabled.value===!0?!0:void 0};return Hn({ourProps:D,theirProps:C,slot:S,attrs:t,slots:r,features:Bs.RenderStrategy|Bs.Static,name:"ComboboxInput"})}}}),TD=at({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(n,{attrs:e,slots:t,expose:r}){let i=Bl("ComboboxOptions"),s=`headlessui-combobox-options-${Js()}`;r({el:i.optionsRef,$el:i.optionsRef}),Yt(()=>{i.optionsPropsRef.value.static=n.static}),Yt(()=>{i.optionsPropsRef.value.hold=n.hold});let o=Mp(),a=re(()=>o!==null?(o.value&cn.Open)===cn.Open:i.comboboxState.value===0);return fD({container:re(()=>Pe(i.optionsRef)),enabled:re(()=>i.comboboxState.value===0),accept(l){return l.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:l.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(l){l.setAttribute("role","none")}}),()=>{var l,c,u;let d={open:i.comboboxState.value===0},f={"aria-labelledby":(u=(l=Pe(i.labelRef))==null?void 0:l.id)!=null?u:(c=Pe(i.buttonRef))==null?void 0:c.id,id:s,ref:i.optionsRef,role:"listbox","aria-multiselectable":i.mode.value===1?!0:void 0},p=od(n,["hold"]);return Hn({ourProps:f,theirProps:p,slot:d,attrs:e,slots:i.virtual.value&&i.comboboxState.value===0?Te(Y({},t),{default:()=>[gt(_D,{},t.default)]}):t,features:Bs.RenderStrategy|Bs.Static,visible:a.value,name:"ComboboxOptions"})}}}),AD=at({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(n,{slots:e,attrs:t,expose:r}){let i=Bl("ComboboxOption"),s=`headlessui-combobox-option-${Js()}`,o=de(null);r({el:o,$el:o});let a=re(()=>{var b;return i.virtual.value?i.activeOptionIndex.value===i.calculateIndex(n.value):i.activeOptionIndex.value===null?!1:((b=i.options.value[i.activeOptionIndex.value])==null?void 0:b.id)===s}),l=re(()=>i.isSelected(n.value)),c=_t(BC,null),u=re(()=>({disabled:n.disabled,value:n.value,domRef:o,order:re(()=>n.order)}));Et(()=>i.registerOption(s,u)),pr(()=>i.unregisterOption(s,a.value)),Yt(()=>{let b=Pe(o);b&&(c==null||c.value.measureElement(b))}),Yt(()=>{i.comboboxState.value===0&&a.value&&(i.virtual.value||i.activationTrigger.value!==0&&Dn(()=>{var b,_;return(_=(b=Pe(o))==null?void 0:b.scrollIntoView)==null?void 0:_.call(b,{block:"nearest"})}))});function d(b){var _;if(n.disabled||(_=i.virtual.value)!=null&&_.disabled(n.value))return b.preventDefault();i.selectOption(s),RC()||requestAnimationFrame(()=>{var M;return(M=Pe(i.inputRef))==null?void 0:M.focus({preventScroll:!0})}),i.mode.value===0&&requestAnimationFrame(()=>i.closeCombobox())}function f(){var b;if(n.disabled||(b=i.virtual.value)!=null&&b.disabled(n.value))return i.goToOption(ln.Nothing);let _=i.calculateIndex(n.value);i.goToOption(ln.Specific,_)}let p=dD();function m(b){p.update(b)}function v(b){var _;if(!p.wasMoved(b)||n.disabled||(_=i.virtual.value)!=null&&_.disabled(n.value)||a.value)return;let M=i.calculateIndex(n.value);i.goToOption(ln.Specific,M,0)}function x(b){var _;p.wasMoved(b)&&(n.disabled||(_=i.virtual.value)!=null&&_.disabled(n.value)||a.value&&(i.optionsPropsRef.value.hold||i.goToOption(ln.Nothing)))}return()=>{let{disabled:b}=n,_={active:a.value,selected:l.value,disabled:b},M={id:s,ref:o,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":l.value,disabled:void 0,onClick:d,onFocus:f,onPointerenter:m,onMouseenter:m,onPointermove:v,onMousemove:v,onPointerleave:x,onMouseleave:x},h=od(n,["order","value"]);return Hn({ourProps:M,theirProps:h,slot:_,attrs:t,slots:e,name:"ComboboxOption"})}}});function zC(n,e,t,r){sd.isServer||Yt(i=>{n=n!=null?n:window,n.addEventListener(e,t,r),i(()=>n.removeEventListener(e,t,r))})}var oc=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(oc||{});function MD(){let n=de(0);return IC("keydown",e=>{e.key==="Tab"&&(n.value=e.shiftKey?1:0)}),n}function VC(n){if(!n)return new Set;if(typeof n=="function")return new Set(n());let e=new Set;for(let t of n.value){let r=Pe(t);r instanceof HTMLElement&&e.add(r)}return e}var qC=(n=>(n[n.None=1]="None",n[n.InitialFocus=2]="InitialFocus",n[n.TabLock=4]="TabLock",n[n.FocusLock=8]="FocusLock",n[n.RestoreFocus=16]="RestoreFocus",n[n.All=30]="All",n))(qC||{});let Gl=Object.assign(at({name:"FocusTrap",props:{as:{type:[Object,String],default:"div"},initialFocus:{type:Object,default:null},features:{type:Number,default:30},containers:{type:[Object,Function],default:de(new Set)}},inheritAttrs:!1,setup(n,{attrs:e,slots:t,expose:r}){let i=de(null);r({el:i,$el:i});let s=re(()=>Ks(i)),o=de(!1);Et(()=>o.value=!0),pr(()=>o.value=!1),ID({ownerDocument:s},re(()=>o.value&&!!(n.features&16)));let a=OD({ownerDocument:s,container:i,initialFocus:re(()=>n.initialFocus)},re(()=>o.value&&!!(n.features&2)));PD({ownerDocument:s,container:i,containers:n.containers,previousActiveElement:a},re(()=>o.value&&!!(n.features&8)));let l=MD();function c(p){let m=Pe(i);m&&(v=>v())(()=>{vn(l.value,{[oc.Forwards]:()=>{Sf(m,Es.First,{skipElements:[p.relatedTarget]})},[oc.Backwards]:()=>{Sf(m,Es.Last,{skipElements:[p.relatedTarget]})}})})}let u=de(!1);function d(p){p.key==="Tab"&&(u.value=!0,requestAnimationFrame(()=>{u.value=!1}))}function f(p){if(!o.value)return;let m=VC(n.containers);Pe(i)instanceof HTMLElement&&m.add(Pe(i));let v=p.relatedTarget;v instanceof HTMLElement&&v.dataset.headlessuiFocusGuard!=="true"&&(UC(m,v)||(u.value?Sf(Pe(i),vn(l.value,{[oc.Forwards]:()=>Es.Next,[oc.Backwards]:()=>Es.Previous})|Es.WrapAround,{relativeTo:p.target}):p.target instanceof HTMLElement&&No(p.target)))}return()=>{let p={},m={ref:i,onKeydown:d,onFocusout:f},M=n,{features:v,initialFocus:x,containers:b}=M,_=En(M,["features","initialFocus","containers"]);return gt(lt,[!!(v&4)&&gt(yh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:c,features:Mu.Focusable}),Hn({ourProps:m,theirProps:Y(Y({},e),_),slot:p,attrs:e,slots:t,name:"FocusTrap"}),!!(v&4)&&gt(yh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:c,features:Mu.Focusable})])}}}),{features:qC});function RD(n){let e=de(Hi.slice());return At([n],([t],[r])=>{r===!0&&t===!1?Cy(()=>{e.value.splice(0)}):r===!1&&t===!0&&(e.value=Hi.slice())},{flush:"post"}),()=>{var t;return(t=e.value.find(r=>r!=null&&r.isConnected))!=null?t:null}}function ID({ownerDocument:n},e){let t=RD(e);Et(()=>{Yt(()=>{var r,i;e.value||((r=n.value)==null?void 0:r.activeElement)===((i=n.value)==null?void 0:i.body)&&No(t())},{flush:"post"})}),pr(()=>{e.value&&No(t())})}function OD({ownerDocument:n,container:e,initialFocus:t},r){let i=de(null),s=de(!1);return Et(()=>s.value=!0),pr(()=>s.value=!1),Et(()=>{At([e,t,r],(o,a)=>{if(o.every((c,u)=>(a==null?void 0:a[u])===c)||!r.value)return;let l=Pe(e);l&&Cy(()=>{var c,u;if(!s.value)return;let d=Pe(t),f=(c=n.value)==null?void 0:c.activeElement;if(d){if(d===f){i.value=f;return}}else if(l.contains(f)){i.value=f;return}d?No(d):Sf(l,Es.First|Es.NoScroll)===EC.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),i.value=(u=n.value)==null?void 0:u.activeElement})},{immediate:!0,flush:"post"})}),i}function PD({ownerDocument:n,container:e,containers:t,previousActiveElement:r},i){var s;zC((s=n.value)==null?void 0:s.defaultView,"focus",o=>{if(!i.value)return;let a=VC(t);Pe(e)instanceof HTMLElement&&a.add(Pe(e));let l=r.value;if(!l)return;let c=o.target;c&&c instanceof HTMLElement?UC(a,c)?(r.value=c,No(c)):(o.preventDefault(),o.stopPropagation(),No(l)):No(r.value)},!0)}function UC(n,e){for(let t of n)if(t.contains(e))return!0;return!1}function DD(n){let e=fy(n.getSnapshot());return pr(n.subscribe(()=>{e.value=n.getSnapshot()})),e}function $D(n,e){let t=n(),r=new Set;return{getSnapshot(){return t},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...s){let o=e[i].call(t,...s);o&&(t=o,r.forEach(a=>a()))}}}function ND(){let n;return{before({doc:e}){var t;let r=e.documentElement;n=((t=e.defaultView)!=null?t:window).innerWidth-r.clientWidth},after({doc:e,d:t}){let r=e.documentElement,i=r.clientWidth-r.offsetWidth,s=n-i;t.style(r,"paddingRight",`${s}px`)}}}function LD(){return MC()?{before({doc:n,d:e,meta:t}){function r(i){return t.containers.flatMap(s=>s()).some(s=>s.contains(i))}e.microTask(()=>{var i;if(window.getComputedStyle(n.documentElement).scrollBehavior!=="auto"){let a=ea();a.style(n.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>a.dispose()))}let s=(i=window.scrollY)!=null?i:window.pageYOffset,o=null;e.addEventListener(n,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),u=n.querySelector(c);u&&!r(u)&&(o=u)}catch(l){}},!0),e.addEventListener(n,"touchstart",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&r(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(a.target,"touchAction","none")}),e.addEventListener(n,"touchmove",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()},{passive:!1}),e.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;s!==l&&window.scrollTo(0,s),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function jD(){return{before({doc:n,d:e}){e.style(n.documentElement,"overflow","hidden")}}}function FD(n){let e={};for(let t of n)Object.assign(e,t(e));return e}let ko=$D(()=>new Map,{PUSH(n,e){var t;let r=(t=this.get(n))!=null?t:{doc:n,count:0,d:ea(),meta:new Set};return r.count++,r.meta.add(e),this.set(n,r),this},POP(n,e){let t=this.get(n);return t&&(t.count--,t.meta.delete(e)),this},SCROLL_PREVENT({doc:n,d:e,meta:t}){let r={doc:n,d:e,meta:FD(t)},i=[LD(),ND(),jD()];i.forEach(({before:s})=>s==null?void 0:s(r)),i.forEach(({after:s})=>s==null?void 0:s(r))},SCROLL_ALLOW({d:n}){n.dispose()},TEARDOWN({doc:n}){this.delete(n)}});ko.subscribe(()=>{let n=ko.getSnapshot(),e=new Map;for(let[t]of n)e.set(t,t.documentElement.style.overflow);for(let t of n.values()){let r=e.get(t.doc)==="hidden",i=t.count!==0;(i&&!r||!i&&r)&&ko.dispatch(t.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",t),t.count===0&&ko.dispatch("TEARDOWN",t)}});function HD(n,e,t){let r=DD(ko),i=re(()=>{let s=n.value?r.value.get(n.value):void 0;return s?s.count>0:!1});return At([n,e],([s,o],[a],l)=>{if(!s||!o)return;ko.dispatch("PUSH",s,t);let c=!1;l(()=>{c||(ko.dispatch("POP",a!=null?a:s,t),c=!0)})},{immediate:!0}),i}let Pm=new Map,Yl=new Map;function _w(n,e=de(!0)){Yt(t=>{var r;if(!e.value)return;let i=Pe(n);if(!i)return;t(function(){var o;if(!i)return;let a=(o=Yl.get(i))!=null?o:1;if(a===1?Yl.delete(i):Yl.set(i,a-1),a!==1)return;let l=Pm.get(i);l&&(l["aria-hidden"]===null?i.removeAttribute("aria-hidden"):i.setAttribute("aria-hidden",l["aria-hidden"]),i.inert=l.inert,Pm.delete(i))});let s=(r=Yl.get(i))!=null?r:0;Yl.set(i,s+1),s===0&&(Pm.set(i,{"aria-hidden":i.getAttribute("aria-hidden"),inert:i.inert}),i.setAttribute("aria-hidden","true"),i.inert=!0)})}function BD({defaultContainers:n=[],portals:e,mainTreeNodeRef:t}={}){let r=de(null),i=Ks(r);function s(){var o,a,l;let c=[];for(let u of n)u!==null&&(u instanceof HTMLElement?c.push(u):"value"in u&&u.value instanceof HTMLElement&&c.push(u.value));if(e!=null&&e.value)for(let u of e.value)c.push(u);for(let u of(o=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?o:[])u!==document.body&&u!==document.head&&u instanceof HTMLElement&&u.id!=="headlessui-portal-root"&&(u.contains(Pe(r))||u.contains((l=(a=Pe(r))==null?void 0:a.getRootNode())==null?void 0:l.host)||c.some(d=>u.contains(d))||c.push(u));return c}return{resolveContainers:s,contains(o){return s().some(a=>a.contains(o))},mainTreeNodeRef:r,MainTreeNode(){return t!=null?null:gt(yh,{features:Mu.Hidden,ref:r})}}}let WC=Symbol("ForcePortalRootContext");function zD(){return _t(WC,!1)}let Cw=at({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(n,{slots:e,attrs:t}){return bn(WC,n.force),()=>{let s=n,{force:r}=s,i=En(s,["force"]);return Hn({theirProps:i,ourProps:{},slot:{},slots:e,attrs:t,name:"ForcePortalRoot"})}}}),JC=Symbol("StackContext");var m0=(n=>(n[n.Add=0]="Add",n[n.Remove=1]="Remove",n))(m0||{});function VD(){return _t(JC,()=>{})}function qD({type:n,enabled:e,element:t,onUpdate:r}){let i=VD();function s(...o){r==null||r(...o),i(...o)}Et(()=>{At(e,(o,a)=>{o?s(0,n,t):a===!0&&s(1,n,t)},{immediate:!0,flush:"sync"})}),pr(()=>{e.value&&s(1,n,t)}),bn(JC,s)}let UD=Symbol("DescriptionContext");function WD({slot:n=de({}),name:e="Description",props:t={}}={}){let r=de([]);function i(s){return r.value.push(s),()=>{let o=r.value.indexOf(s);o!==-1&&r.value.splice(o,1)}}return bn(UD,{register:i,slot:n,name:e,props:t}),re(()=>r.value.length>0?r.value.join(" "):void 0)}function JD(n){let e=Ks(n);if(!e){if(n===null)return null;throw new Error(`[Headless UI]: Cannot find ownerDocument for contextElement: ${n}`)}let t=e.getElementById("headlessui-portal-root");if(t)return t;let r=e.createElement("div");return r.setAttribute("id","headlessui-portal-root"),e.body.appendChild(r)}let KD=at({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:e,attrs:t}){let r=de(null),i=re(()=>Ks(r)),s=zD(),o=_t(KC,null),a=de(s===!0||o==null?JD(r.value):o.resolveTarget()),l=de(!1);Et(()=>{l.value=!0}),Yt(()=>{s||o!=null&&(a.value=o.resolveTarget())});let c=_t(g0,null),u=!1,d=Ws();return At(r,()=>{if(u||!c)return;let f=Pe(r);f&&(pr(c.register(f),d),u=!0)}),pr(()=>{var f,p;let m=(f=i.value)==null?void 0:f.getElementById("headlessui-portal-root");m&&a.value===m&&a.value.children.length<=0&&((p=a.value.parentElement)==null||p.removeChild(a.value))}),()=>{if(!l.value||a.value===null)return null;let f={ref:r,"data-headlessui-portal":""};return gt(wy,{to:a.value},Hn({ourProps:f,theirProps:n,slot:{},attrs:t,slots:e,name:"Portal"}))}}}),g0=Symbol("PortalParentContext");function GD(){let n=_t(g0,null),e=de([]);function t(s){return e.value.push(s),n&&n.register(s),()=>r(s)}function r(s){let o=e.value.indexOf(s);o!==-1&&e.value.splice(o,1),n&&n.unregister(s)}let i={register:t,unregister:r,portals:e};return[e,at({name:"PortalWrapper",setup(s,{slots:o}){return bn(g0,i),()=>{var a;return(a=o.default)==null?void 0:a.call(o)}}})]}let KC=Symbol("PortalGroupContext"),YD=at({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(n,{attrs:e,slots:t}){let r=zr({resolveTarget(){return n.target}});return bn(KC,r),()=>{let o=n,{target:i}=o,s=En(o,["target"]);return Hn({theirProps:s,ourProps:{},slot:{},attrs:e,slots:t,name:"PortalGroup"})}}});var XD=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(XD||{});let y0=Symbol("DialogContext");function ky(n){let e=_t(y0,null);if(e===null){let t=new Error(`<${n} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ky),t}return e}let Fd="DC8F892D-2EBD-447C-A4C8-A03058436FF4",ZD=at({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:Fd},initialFocus:{type:Object,default:null},id:{type:String,default:null},role:{type:String,default:"dialog"}},emits:{close:n=>!0},setup(n,{emit:e,attrs:t,slots:r,expose:i}){var s,o;let a=(s=n.id)!=null?s:`headlessui-dialog-${Js()}`,l=de(!1);Et(()=>{l.value=!0});let c=!1,u=re(()=>n.role==="dialog"||n.role==="alertdialog"?n.role:(c||(c=!0,console.warn(`Invalid role [${u}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")),d=de(0),f=Mp(),p=re(()=>n.open===Fd&&f!==null?(f.value&cn.Open)===cn.Open:n.open),m=de(null),v=re(()=>Ks(m));if(i({el:m,$el:m}),!(n.open!==Fd||f!==null))throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if(typeof p.value!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${p.value===Fd?void 0:n.open}`);let x=re(()=>l.value&&p.value?0:1),b=re(()=>x.value===0),_=re(()=>d.value>1),M=_t(y0,null)!==null,[h,w]=GD(),{resolveContainers:y,mainTreeNodeRef:E,MainTreeNode:g}=BD({portals:h,defaultContainers:[re(()=>{var j;return(j=O.panelRef.value)!=null?j:m.value})]}),I=re(()=>_.value?"parent":"leaf"),R=re(()=>f!==null?(f.value&cn.Closing)===cn.Closing:!1),S=re(()=>M||R.value?!1:b.value),k=re(()=>{var j,J,ie;return(ie=Array.from((J=(j=v.value)==null?void 0:j.querySelectorAll("body > *"))!=null?J:[]).find(oe=>oe.id==="headlessui-portal-root"?!1:oe.contains(Pe(E))&&oe instanceof HTMLElement))!=null?ie:null});_w(k,S);let T=re(()=>_.value?!0:b.value),C=re(()=>{var j,J,ie;return(ie=Array.from((J=(j=v.value)==null?void 0:j.querySelectorAll("[data-headlessui-portal]"))!=null?J:[]).find(oe=>oe.contains(Pe(E))&&oe instanceof HTMLElement))!=null?ie:null});_w(C,T),qD({type:"Dialog",enabled:re(()=>x.value===0),element:m,onUpdate:(j,J)=>{if(J==="Dialog")return vn(j,{[m0.Add]:()=>d.value+=1,[m0.Remove]:()=>d.value-=1})}});let D=WD({name:"DialogDescription",slot:re(()=>({open:p.value}))}),A=de(null),O={titleId:A,panelRef:de(null),dialogState:x,setTitleId(j){A.value!==j&&(A.value=j)},close(){e("close",!1)}};bn(y0,O);let P=re(()=>!(!b.value||_.value));OC(y,(j,J)=>{O.close(),Dn(()=>J==null?void 0:J.focus())},P);let N=re(()=>!(_.value||x.value!==0));zC((o=v.value)==null?void 0:o.defaultView,"keydown",j=>{N.value&&(j.defaultPrevented||j.key===qn.Escape&&(j.preventDefault(),j.stopPropagation(),O.close()))});let F=re(()=>!(R.value||x.value!==0||M));return HD(v,F,j=>{var J;return{containers:[...(J=j.containers)!=null?J:[],y]}}),Yt(j=>{if(x.value!==0)return;let J=Pe(m);if(!J)return;let ie=new ResizeObserver(oe=>{for(let he of oe){let ae=he.target.getBoundingClientRect();ae.x===0&&ae.y===0&&ae.width===0&&ae.height===0&&O.close()}});ie.observe(J),j(()=>ie.disconnect())}),()=>{let ae=n,{open:j,initialFocus:J}=ae,ie=En(ae,["open","initialFocus"]),oe=Te(Y({},t),{ref:m,id:a,role:u.value,"aria-modal":x.value===0?!0:void 0,"aria-labelledby":A.value,"aria-describedby":D.value}),he={open:x.value===0};return gt(Cw,{force:!0},()=>[gt(KD,()=>gt(YD,{target:m.value},()=>gt(Cw,{force:!1},()=>gt(Gl,{initialFocus:J,containers:y,features:b.value?vn(I.value,{parent:Gl.features.RestoreFocus,leaf:Gl.features.All&~Gl.features.FocusLock}):Gl.features.None},()=>gt(w,{},()=>Hn({ourProps:oe,theirProps:Y(Y({},ie),t),slot:he,attrs:t,slots:r,visible:x.value===0,features:Bs.RenderStrategy|Bs.Static,name:"Dialog"})))))),gt(g)])}}}),QD=at({name:"DialogPanel",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},setup(n,{attrs:e,slots:t,expose:r}){var i;let s=(i=n.id)!=null?i:`headlessui-dialog-panel-${Js()}`,o=ky("DialogPanel");r({el:o.panelRef,$el:o.panelRef});function a(l){l.stopPropagation()}return()=>{let l=En(n,[]),c={id:s,ref:o.panelRef,onClick:a};return Hn({ourProps:c,theirProps:l,slot:{open:o.dialogState.value===0},attrs:e,slots:t,name:"DialogPanel"})}}}),e4=at({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"},id:{type:String,default:null}},setup(n,{attrs:e,slots:t}){var r;let i=(r=n.id)!=null?r:`headlessui-dialog-title-${Js()}`,s=ky("DialogTitle");return Et(()=>{s.setTitleId(i),pr(()=>s.setTitleId(null))}),()=>{let o=En(n,[]);return Hn({ourProps:{id:i},theirProps:o,slot:{open:s.dialogState.value===0},attrs:e,slots:t,name:"DialogTitle"})}}});function t4(n){let e={called:!1};return(...t)=>{if(!e.called)return e.called=!0,n(...t)}}function Dm(n,...e){n&&e.length>0&&n.classList.add(...e)}function Hd(n,...e){n&&e.length>0&&n.classList.remove(...e)}var v0=(n=>(n.Finished="finished",n.Cancelled="cancelled",n))(v0||{});function n4(n,e){let t=ea();if(!n)return t.dispose;let{transitionDuration:r,transitionDelay:i}=getComputedStyle(n),[s,o]=[r,i].map(a=>{let[l=0]=a.split(",").filter(Boolean).map(c=>c.includes("ms")?parseFloat(c):parseFloat(c)*1e3).sort((c,u)=>u-c);return l});return s!==0?t.setTimeout(()=>e("finished"),s+o):e("finished"),t.add(()=>e("cancelled")),t.dispose}function kw(n,e,t,r,i,s){let o=ea(),a=s!==void 0?t4(s):()=>{};return Hd(n,...i),Dm(n,...e,...t),o.nextFrame(()=>{Hd(n,...t),Dm(n,...r),o.add(n4(n,l=>(Hd(n,...r,...e),Dm(n,...i),a(l))))}),o.add(()=>Hd(n,...e,...t,...r,...i)),o.add(()=>a("cancelled")),o.dispose}function ao(n=""){return n.split(/\s+/).filter(e=>e.length>1)}let Ey=Symbol("TransitionContext");var r4=(n=>(n.Visible="visible",n.Hidden="hidden",n))(r4||{});function i4(){return _t(Ey,null)!==null}function s4(){let n=_t(Ey,null);if(n===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return n}function o4(){let n=_t(Ty,null);if(n===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return n}let Ty=Symbol("NestingContext");function Rp(n){return"children"in n?Rp(n.children):n.value.filter(({state:e})=>e==="visible").length>0}function GC(n){let e=de([]),t=de(!1);Et(()=>t.value=!0),pr(()=>t.value=!1);function r(s,o=Rs.Hidden){let a=e.value.findIndex(({id:l})=>l===s);a!==-1&&(vn(o,{[Rs.Unmount](){e.value.splice(a,1)},[Rs.Hidden](){e.value[a].state="hidden"}}),!Rp(e)&&t.value&&(n==null||n()))}function i(s){let o=e.value.find(({id:a})=>a===s);return o?o.state!=="visible"&&(o.state="visible"):e.value.push({id:s,state:"visible"}),()=>r(s,Rs.Unmount)}return{children:e,register:i,unregister:r}}let YC=Bs.RenderStrategy,XC=at({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(n,{emit:e,attrs:t,slots:r,expose:i}){let s=de(0);function o(){s.value|=cn.Opening,e("beforeEnter")}function a(){s.value&=~cn.Opening,e("afterEnter")}function l(){s.value|=cn.Closing,e("beforeLeave")}function c(){s.value&=~cn.Closing,e("afterLeave")}if(!i4()&&mD())return()=>gt(ZC,Te(Y({},n),{onBeforeEnter:o,onAfterEnter:a,onBeforeLeave:l,onAfterLeave:c}),r);let u=de(null),d=re(()=>n.unmount?Rs.Unmount:Rs.Hidden);i({el:u,$el:u});let{show:f,appear:p}=s4(),{register:m,unregister:v}=o4(),x=de(f.value?"visible":"hidden"),b={value:!0},_=Js(),M={value:!1},h=GC(()=>{!M.value&&x.value!=="hidden"&&(x.value="hidden",v(_),c())});Et(()=>{let T=m(_);pr(T)}),Yt(()=>{if(d.value===Rs.Hidden&&_){if(f.value&&x.value!=="visible"){x.value="visible";return}vn(x.value,{hidden:()=>v(_),visible:()=>m(_)})}});let w=ao(n.enter),y=ao(n.enterFrom),E=ao(n.enterTo),g=ao(n.entered),I=ao(n.leave),R=ao(n.leaveFrom),S=ao(n.leaveTo);Et(()=>{Yt(()=>{if(x.value==="visible"){let T=Pe(u);if(T instanceof Comment&&T.data==="")throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}})});function k(T){let C=b.value&&!p.value,D=Pe(u);!D||!(D instanceof HTMLElement)||C||(M.value=!0,f.value&&o(),f.value||l(),T(f.value?kw(D,w,y,E,g,A=>{M.value=!1,A===v0.Finished&&a()}):kw(D,I,R,S,g,A=>{M.value=!1,A===v0.Finished&&(Rp(h)||(x.value="hidden",v(_),c()))})))}return Et(()=>{At([f],(T,C,D)=>{k(D),b.value=!1},{immediate:!0})}),bn(Ty,h),NC(re(()=>vn(x.value,{visible:cn.Open,hidden:cn.Closed})|s.value)),()=>{let he=n,{appear:T,show:C,enter:D,enterFrom:A,enterTo:O,entered:P,leave:N,leaveFrom:F,leaveTo:j}=he,J=En(he,["appear","show","enter","enterFrom","enterTo","entered","leave","leaveFrom","leaveTo"]),ie={ref:u},oe=Y(Y({},J),p.value&&f.value&&sd.isServer?{class:De([t.class,J.class,...w,...y])}:{});return Hn({theirProps:oe,ourProps:ie,slot:{},slots:r,attrs:t,features:YC,visible:x.value==="visible",name:"TransitionChild"})}}}),a4=XC,ZC=at({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(n,{emit:e,attrs:t,slots:r}){let i=Mp(),s=re(()=>n.show===null&&i!==null?(i.value&cn.Open)===cn.Open:n.show);Yt(()=>{if(![!0,!1].includes(s.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let o=de(s.value?"visible":"hidden"),a=GC(()=>{o.value="hidden"}),l=de(!0),c={show:s,appear:re(()=>n.appear||!l.value)};return Et(()=>{Yt(()=>{l.value=!1,s.value?o.value="visible":Rp(a)||(o.value="hidden")})}),bn(Ty,a),bn(Ey,c),()=>{let u=od(n,["show","appear","unmount","onBeforeEnter","onBeforeLeave","onAfterEnter","onAfterLeave"]),d={unmount:n.unmount};return Hn({ourProps:Te(Y({},d),{as:"template"}),theirProps:{},slot:{},slots:Te(Y({},r),{default:()=>[gt(a4,Y(Y(Y({onBeforeEnter:()=>e("beforeEnter"),onAfterEnter:()=>e("afterEnter"),onBeforeLeave:()=>e("beforeLeave"),onAfterLeave:()=>e("afterLeave")},t),d),u),r.default)]}),attrs:{},features:YC,visible:o.value==="visible",name:"Transition"})}}});var Zn="top",jr="bottom",Fr="right",Qn="left",Ay="auto",ad=[Zn,jr,Fr,Qn],pl="start",Ru="end",l4="clippingParents",QC="viewport",Xl="popper",c4="reference",Ew=ad.reduce(function(n,e){return n.concat([e+"-"+pl,e+"-"+Ru])},[]),ek=[].concat(ad,[Ay]).reduce(function(n,e){return n.concat([e,e+"-"+pl,e+"-"+Ru])},[]),u4="beforeRead",d4="read",f4="afterRead",h4="beforeMain",p4="main",m4="afterMain",g4="beforeWrite",y4="write",v4="afterWrite",b4=[u4,d4,f4,h4,p4,m4,g4,y4,v4];function Ci(n){return n?(n.nodeName||"").toLowerCase():null}function ri(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ml(n){var e=ri(n).Element;return n instanceof e||n instanceof Element}function Dr(n){var e=ri(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function tk(n){if(typeof ShadowRoot=="undefined")return!1;var e=ri(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function w4(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},s=e.elements[t];!Dr(s)||!Ci(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function x4(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!Dr(i)||!Ci(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const S4={name:"applyStyles",enabled:!0,phase:"write",fn:w4,effect:x4,requires:["computeStyles"]};function vi(n){return n.split("-")[0]}var Lo=Math.max,vh=Math.min,gl=Math.round;function yl(n,e){e===void 0&&(e=!1);var t=n.getBoundingClientRect(),r=1,i=1;if(Dr(n)&&e){var s=n.offsetHeight,o=n.offsetWidth;o>0&&(r=gl(t.width)/o||1),s>0&&(i=gl(t.height)/s||1)}return{width:t.width/r,height:t.height/i,top:t.top/i,right:t.right/r,bottom:t.bottom/i,left:t.left/r,x:t.left/r,y:t.top/i}}function My(n){var e=yl(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function nk(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&tk(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ji(n){return ri(n).getComputedStyle(n)}function _4(n){return["table","td","th"].indexOf(Ci(n))>=0}function Gs(n){return((ml(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ip(n){return Ci(n)==="html"?n:n.assignedSlot||n.parentNode||(tk(n)?n.host:null)||Gs(n)}function Tw(n){return!Dr(n)||Ji(n).position==="fixed"?null:n.offsetParent}function C4(n){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,t=navigator.userAgent.indexOf("Trident")!==-1;if(t&&Dr(n)){var r=Ji(n);if(r.position==="fixed")return null}for(var i=Ip(n);Dr(i)&&["html","body"].indexOf(Ci(i))<0;){var s=Ji(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function ld(n){for(var e=ri(n),t=Tw(n);t&&_4(t)&&Ji(t).position==="static";)t=Tw(t);return t&&(Ci(t)==="html"||Ci(t)==="body"&&Ji(t).position==="static")?e:t||C4(n)||e}function Ry(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Xc(n,e,t){return Lo(n,vh(e,t))}function k4(n,e,t){var r=Xc(n,e,t);return r>t?t:r}function rk(){return{top:0,right:0,bottom:0,left:0}}function ik(n){return Object.assign({},rk(),n)}function sk(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var E4=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,ik(typeof e!="number"?e:sk(e,ad))};function T4(n){var e,t=n.state,r=n.name,i=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=vi(t.placement),l=Ry(a),c=[Qn,Fr].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var d=E4(i.padding,t),f=My(s),p=l==="y"?Zn:Qn,m=l==="y"?jr:Fr,v=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],x=o[l]-t.rects.reference[l],b=ld(s),_=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,M=v/2-x/2,h=d[p],w=_-f[u]-d[m],y=_/2-f[u]/2+M,E=Xc(h,y,w),g=l;t.modifiersData[r]=(e={},e[g]=E,e.centerOffset=E-y,e)}}function A4(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||nk(e.elements.popper,i)&&(e.elements.arrow=i))}const M4={name:"arrow",enabled:!0,phase:"main",fn:T4,effect:A4,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function vl(n){return n.split("-")[1]}var R4={top:"auto",right:"auto",bottom:"auto",left:"auto"};function I4(n){var e=n.x,t=n.y,r=window,i=r.devicePixelRatio||1;return{x:gl(e*i)/i||0,y:gl(t*i)/i||0}}function Aw(n){var e,t=n.popper,r=n.popperRect,i=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=o.x,p=f===void 0?0:f,m=o.y,v=m===void 0?0:m,x=typeof u=="function"?u({x:p,y:v}):{x:p,y:v};p=x.x,v=x.y;var b=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),M=Qn,h=Zn,w=window;if(c){var y=ld(t),E="clientHeight",g="clientWidth";if(y===ri(t)&&(y=Gs(t),Ji(y).position!=="static"&&a==="absolute"&&(E="scrollHeight",g="scrollWidth")),y=y,i===Zn||(i===Qn||i===Fr)&&s===Ru){h=jr;var I=d&&w.visualViewport?w.visualViewport.height:y[E];v-=I-r.height,v*=l?1:-1}if(i===Qn||(i===Zn||i===jr)&&s===Ru){M=Fr;var R=d&&w.visualViewport?w.visualViewport.width:y[g];p-=R-r.width,p*=l?1:-1}}var S=Object.assign({position:a},c&&R4),k=u===!0?I4({x:p,y:v}):{x:p,y:v};if(p=k.x,v=k.y,l){var T;return Object.assign({},S,(T={},T[h]=_?"0":"",T[M]=b?"0":"",T.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",T))}return Object.assign({},S,(e={},e[h]=_?v+"px":"",e[M]=b?p+"px":"",e.transform="",e))}function O4(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:vi(e.placement),variation:vl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Aw(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Aw(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const P4={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:O4,data:{}};var Bd={passive:!0};function D4(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,a=o===void 0?!0:o,l=ri(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,Bd)}),a&&l.addEventListener("resize",t.update,Bd),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,Bd)}),a&&l.removeEventListener("resize",t.update,Bd)}}const $4={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:D4,data:{}};var N4={left:"right",right:"left",bottom:"top",top:"bottom"};function _f(n){return n.replace(/left|right|bottom|top/g,function(e){return N4[e]})}var L4={start:"end",end:"start"};function Mw(n){return n.replace(/start|end/g,function(e){return L4[e]})}function Iy(n){var e=ri(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function Oy(n){return yl(Gs(n)).left+Iy(n).scrollLeft}function j4(n){var e=ri(n),t=Gs(n),r=e.visualViewport,i=t.clientWidth,s=t.clientHeight,o=0,a=0;return r&&(i=r.width,s=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=r.offsetLeft,a=r.offsetTop)),{width:i,height:s,x:o+Oy(n),y:a}}function F4(n){var e,t=Gs(n),r=Iy(n),i=(e=n.ownerDocument)==null?void 0:e.body,s=Lo(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Lo(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Oy(n),l=-r.scrollTop;return Ji(i||t).direction==="rtl"&&(a+=Lo(t.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Py(n){var e=Ji(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function ok(n){return["html","body","#document"].indexOf(Ci(n))>=0?n.ownerDocument.body:Dr(n)&&Py(n)?n:ok(Ip(n))}function Zc(n,e){var t;e===void 0&&(e=[]);var r=ok(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),s=ri(r),o=i?[s].concat(s.visualViewport||[],Py(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(Zc(Ip(o)))}function b0(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function H4(n){var e=yl(n);return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function Rw(n,e){return e===QC?b0(j4(n)):ml(e)?H4(e):b0(F4(Gs(n)))}function B4(n){var e=Zc(Ip(n)),t=["absolute","fixed"].indexOf(Ji(n).position)>=0,r=t&&Dr(n)?ld(n):n;return ml(r)?e.filter(function(i){return ml(i)&&nk(i,r)&&Ci(i)!=="body"}):[]}function z4(n,e,t){var r=e==="clippingParents"?B4(n):[].concat(e),i=[].concat(r,[t]),s=i[0],o=i.reduce(function(a,l){var c=Rw(n,l);return a.top=Lo(c.top,a.top),a.right=vh(c.right,a.right),a.bottom=vh(c.bottom,a.bottom),a.left=Lo(c.left,a.left),a},Rw(n,s));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ak(n){var e=n.reference,t=n.element,r=n.placement,i=r?vi(r):null,s=r?vl(r):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case Zn:l={x:o,y:e.y-t.height};break;case jr:l={x:o,y:e.y+e.height};break;case Fr:l={x:e.x+e.width,y:a};break;case Qn:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?Ry(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case pl:l[c]=l[c]-(e[u]/2-t[u]/2);break;case Ru:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Iu(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,s=t.boundary,o=s===void 0?l4:s,a=t.rootBoundary,l=a===void 0?QC:a,c=t.elementContext,u=c===void 0?Xl:c,d=t.altBoundary,f=d===void 0?!1:d,p=t.padding,m=p===void 0?0:p,v=ik(typeof m!="number"?m:sk(m,ad)),x=u===Xl?c4:Xl,b=n.rects.popper,_=n.elements[f?x:u],M=z4(ml(_)?_:_.contextElement||Gs(n.elements.popper),o,l),h=yl(n.elements.reference),w=ak({reference:h,element:b,strategy:"absolute",placement:i}),y=b0(Object.assign({},b,w)),E=u===Xl?y:h,g={top:M.top-E.top+v.top,bottom:E.bottom-M.bottom+v.bottom,left:M.left-E.left+v.left,right:E.right-M.right+v.right},I=n.modifiersData.offset;if(u===Xl&&I){var R=I[i];Object.keys(g).forEach(function(S){var k=[Fr,jr].indexOf(S)>=0?1:-1,T=[Zn,jr].indexOf(S)>=0?"y":"x";g[S]+=R[T]*k})}return g}function V4(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?ek:l,u=vl(r),d=u?a?Ew:Ew.filter(function(m){return vl(m)===u}):ad,f=d.filter(function(m){return c.indexOf(m)>=0});f.length===0&&(f=d);var p=f.reduce(function(m,v){return m[v]=Iu(n,{placement:v,boundary:i,rootBoundary:s,padding:o})[vi(v)],m},{});return Object.keys(p).sort(function(m,v){return p[m]-p[v]})}function q4(n){if(vi(n)===Ay)return[];var e=_f(n);return[Mw(n),e,Mw(e)]}function U4(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,f=t.altBoundary,p=t.flipVariations,m=p===void 0?!0:p,v=t.allowedAutoPlacements,x=e.options.placement,b=vi(x),_=b===x,M=l||(_||!m?[_f(x)]:q4(x)),h=[x].concat(M).reduce(function(oe,he){return oe.concat(vi(he)===Ay?V4(e,{placement:he,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:v}):he)},[]),w=e.rects.reference,y=e.rects.popper,E=new Map,g=!0,I=h[0],R=0;R<h.length;R++){var S=h[R],k=vi(S),T=vl(S)===pl,C=[Zn,jr].indexOf(k)>=0,D=C?"width":"height",A=Iu(e,{placement:S,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),O=C?T?Fr:Qn:T?jr:Zn;w[D]>y[D]&&(O=_f(O));var P=_f(O),N=[];if(s&&N.push(A[k]<=0),a&&N.push(A[O]<=0,A[P]<=0),N.every(function(oe){return oe})){I=S,g=!1;break}E.set(S,N)}if(g)for(var F=m?3:1,j=function(he){var ae=h.find(function(B){var ee=E.get(B);if(ee)return ee.slice(0,he).every(function(le){return le})});if(ae)return I=ae,"break"},J=F;J>0;J--){var ie=j(J);if(ie==="break")break}e.placement!==I&&(e.modifiersData[r]._skip=!0,e.placement=I,e.reset=!0)}}const W4={name:"flip",enabled:!0,phase:"main",fn:U4,requiresIfExists:["offset"],data:{_skip:!1}};function Iw(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ow(n){return[Zn,Fr,jr,Qn].some(function(e){return n[e]>=0})}function J4(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Iu(e,{elementContext:"reference"}),a=Iu(e,{altBoundary:!0}),l=Iw(o,r),c=Iw(a,i,s),u=Ow(l),d=Ow(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const K4={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:J4};function G4(n,e,t){var r=vi(n),i=[Qn,Zn].indexOf(r)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[Qn,Fr].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function Y4(n){var e=n.state,t=n.options,r=n.name,i=t.offset,s=i===void 0?[0,0]:i,o=ek.reduce(function(u,d){return u[d]=G4(d,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const X4={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Y4};function Z4(n){var e=n.state,t=n.name;e.modifiersData[t]=ak({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Q4={name:"popperOffsets",enabled:!0,phase:"read",fn:Z4,data:{}};function e6(n){return n==="x"?"y":"x"}function t6(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,f=t.tether,p=f===void 0?!0:f,m=t.tetherOffset,v=m===void 0?0:m,x=Iu(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=vi(e.placement),_=vl(e.placement),M=!_,h=Ry(b),w=e6(h),y=e.modifiersData.popperOffsets,E=e.rects.reference,g=e.rects.popper,I=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,R=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),S=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(y){if(s){var T,C=h==="y"?Zn:Qn,D=h==="y"?jr:Fr,A=h==="y"?"height":"width",O=y[h],P=O+x[C],N=O-x[D],F=p?-g[A]/2:0,j=_===pl?E[A]:g[A],J=_===pl?-g[A]:-E[A],ie=e.elements.arrow,oe=p&&ie?My(ie):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:rk(),ae=he[C],B=he[D],ee=Xc(0,E[A],oe[A]),le=M?E[A]/2-F-ee-ae-R.mainAxis:j-ee-ae-R.mainAxis,me=M?-E[A]/2+F+ee+B+R.mainAxis:J+ee+B+R.mainAxis,$e=e.elements.arrow&&ld(e.elements.arrow),Ke=$e?h==="y"?$e.clientTop||0:$e.clientLeft||0:0,$=(T=S==null?void 0:S[h])!=null?T:0,L=O+le-$-Ke,V=O+me-$,H=Xc(p?vh(P,L):P,O,p?Lo(N,V):N);y[h]=H,k[h]=H-O}if(a){var z,U=h==="x"?Zn:Qn,ne=h==="x"?jr:Fr,G=y[w],te=w==="y"?"height":"width",se=G+x[U],pe=G-x[ne],Ce=[Zn,Qn].indexOf(b)!==-1,_e=(z=S==null?void 0:S[w])!=null?z:0,Ae=Ce?se:G-E[te]-g[te]-_e+R.altAxis,Fe=Ce?G+E[te]+g[te]-_e-R.altAxis:pe,Xe=p&&Ce?k4(Ae,G,Fe):Xc(p?Ae:se,G,p?Fe:pe);y[w]=Xe,k[w]=Xe-G}e.modifiersData[r]=k}}const n6={name:"preventOverflow",enabled:!0,phase:"main",fn:t6,requiresIfExists:["offset"]};function r6(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function i6(n){return n===ri(n)||!Dr(n)?Iy(n):r6(n)}function s6(n){var e=n.getBoundingClientRect(),t=gl(e.width)/n.offsetWidth||1,r=gl(e.height)/n.offsetHeight||1;return t!==1||r!==1}function o6(n,e,t){t===void 0&&(t=!1);var r=Dr(e),i=Dr(e)&&s6(e),s=Gs(e),o=yl(n,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((Ci(e)!=="body"||Py(s))&&(a=i6(e)),Dr(e)?(l=yl(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Oy(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function a6(n){var e=new Map,t=new Set,r=[];n.forEach(function(s){e.set(s.name,s)});function i(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(s)}return n.forEach(function(s){t.has(s.name)||i(s)}),r}function l6(n){var e=a6(n);return b4.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function c6(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function u6(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Pw={placement:"bottom",modifiers:[],strategy:"absolute"};function Dw(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function d6(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,s=i===void 0?Pw:i;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pw,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(b){var _=typeof b=="function"?b(u.options):b;v(),u.options=Object.assign({},s,u.options,_),u.scrollParents={reference:ml(a)?Zc(a):a.contextElement?Zc(a.contextElement):[],popper:Zc(l)};var M=l6(u6([].concat(r,u.options.modifiers)));return u.orderedModifiers=M.filter(function(h){return h.enabled}),m(),p.update()},forceUpdate:function(){if(!f){var b=u.elements,_=b.reference,M=b.popper;if(Dw(_,M)){u.rects={reference:o6(_,ld(M),u.options.strategy==="fixed"),popper:My(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(R){return u.modifiersData[R.name]=Object.assign({},R.data)});for(var h=0;h<u.orderedModifiers.length;h++){if(u.reset===!0){u.reset=!1,h=-1;continue}var w=u.orderedModifiers[h],y=w.fn,E=w.options,g=E===void 0?{}:E,I=w.name;typeof y=="function"&&(u=y({state:u,options:g,name:I,instance:p})||u)}}}},update:c6(function(){return new Promise(function(x){p.forceUpdate(),x(u)})}),destroy:function(){v(),f=!0}};if(!Dw(a,l))return p;p.setOptions(c).then(function(x){!f&&c.onFirstUpdate&&c.onFirstUpdate(x)});function m(){u.orderedModifiers.forEach(function(x){var b=x.name,_=x.options,M=_===void 0?{}:_,h=x.effect;if(typeof h=="function"){var w=h({state:u,name:b,instance:p,options:M}),y=function(){};d.push(w||y)}})}function v(){d.forEach(function(x){return x()}),d=[]}return p}}var f6=[$4,Q4,P4,S4,X4,W4,n6,M4,K4],h6=d6({defaultModifiers:f6});const p6={name:"Popover",inheritAttrs:!1,props:{show:{default:void 0},trigger:{type:String,default:"click"},hoverDelay:{type:Number,default:0},leaveDelay:{type:Number,default:0},placement:{type:String,default:"bottom-start"},popoverClass:[String,Object,Array],transition:{default:null},hideOnBlur:{default:!0}},emits:["open","close","update:show"],expose:["open","close"],data(){return{popoverContainerClass:"body-container",showPopup:!1,targetWidth:null,pointerOverTargetOrPopup:!1}},watch:{show(n){n?this.open():this.close()}},created(){if(typeof window!="undefined"&&!document.getElementById("frappeui-popper-root")){const n=document.createElement("div");n.id="frappeui-popper-root",document.body.appendChild(n)}},mounted(){this.listener=n=>{const e=n.target,t=this.$refs.reference,r=this.$refs.popover;if(e===t||e===r||(t==null?void 0:t.contains(e))||(r==null?void 0:r.contains(e)))return;if(!document.getElementById("frappeui-popper-root").contains(e))return this.close();const a=`.${this.popoverContainerClass}`,l=e==null?void 0:e.closest(a),c=t==null?void 0:t.closest(a);l&&c&&l===c&&this.close()},this.hideOnBlur&&document.addEventListener("click",this.listener),this.$nextTick(()=>{this.targetWidth=this.$refs.target.clientWidth})},beforeDestroy(){this.popper&&this.popper.destroy(),document.removeEventListener("click",this.listener)},computed:{showPropPassed(){return this.show!=null},isOpen:{get(){return this.showPropPassed?this.show:this.showPopup},set(n){n=!!n,this.showPropPassed?this.$emit("update:show",n):this.showPopup=n,n===!1?this.$emit("close"):n===!0&&this.$emit("open")}},popupTransition(){let n={default:{enterActiveClass:"transition duration-150 ease-out",enterFromClass:"translate-y-1 opacity-0",enterToClass:"translate-y-0 opacity-100",leaveActiveClass:"transition duration-150 ease-in",leaveFromClass:"translate-y-0 opacity-100",leaveToClass:"translate-y-1 opacity-0"}};return typeof this.transition=="string"?n[this.transition]:this.transition}},methods:{setupPopper(){this.popper?this.updatePosition():this.popper=h6(this.$refs.reference,this.$refs.popover,{placement:this.placement})},updatePosition(){this.popper&&this.popper.update()},togglePopover(n){n instanceof Event&&(n=null),n==null&&(n=!this.isOpen),n=!!n,n?this.open():this.close()},open(){this.isOpen=!0,this.$nextTick(()=>this.setupPopper())},close(){this.isOpen=!1},onMouseover(){this.pointerOverTargetOrPopup=!0,this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.trigger==="hover"&&(this.hoverDelay?this.hoverTimer=setTimeout(()=>{this.pointerOverTargetOrPopup&&this.open()},Number(this.hoverDelay)*1e3):this.open())},onMouseleave(n){this.pointerOverTargetOrPopup=!1,this.hoverTimer&&(clearTimeout(this.hoverTimer),this.hoverTimer=null),this.trigger==="hover"&&(this.leaveTimer&&clearTimeout(this.leaveTimer),this.leaveDelay?this.leaveTimer=setTimeout(()=>{this.pointerOverTargetOrPopup||this.close()},Number(this.leaveDelay)*1e3):this.pointerOverTargetOrPopup||this.close())}}},m6={ref:"reference"},g6={class:"rounded-lg border border-gray-100 bg-white shadow-xl"};function y6(n,e,t,r,i,s){return q(),Q("div",m6,[K("div",{ref:"target",class:De(["flex",n.$attrs.class]),onClick:e[0]||(e[0]=(...o)=>s.updatePosition&&s.updatePosition(...o)),onFocusin:e[1]||(e[1]=(...o)=>s.updatePosition&&s.updatePosition(...o)),onKeydown:e[2]||(e[2]=(...o)=>s.updatePosition&&s.updatePosition(...o)),onMouseover:e[3]||(e[3]=(...o)=>s.onMouseover&&s.onMouseover(...o)),onMouseleave:e[4]||(e[4]=(...o)=>s.onMouseleave&&s.onMouseleave(...o))},[Ye(n.$slots,"target",Mr(Yr({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})))],34),(q(),dt(wy,{to:"#frappeui-popper-root"},[K("div",{ref:"popover",class:De(["relative z-[100]",[i.popoverContainerClass,t.popoverClass]]),style:Fl({minWidth:i.targetWidth?i.targetWidth+"px":null}),onMouseover:e[5]||(e[5]=o=>i.pointerOverTargetOrPopup=!0),onMouseleave:e[6]||(e[6]=(...o)=>s.onMouseleave&&s.onMouseleave(...o))},[ye(Sy,Mr(Yr(s.popupTransition)),{default:Ue(()=>[Xo(K("div",null,[Ye(n.$slots,"body",Mr(Yr({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})),()=>[K("div",g6,[Ye(n.$slots,"body-main",Mr(Yr({togglePopover:s.togglePopover,updatePosition:s.updatePosition,open:s.open,close:s.close,isOpen:s.isOpen})))])])],512),[[Qo,s.isOpen]])]),_:3},16)],38)]))],512)}const lk=je(p6,[["render",y6]]);var be=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ck(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var uk={exports:{}};(function(n,e){(function(r,i){n.exports=i()})(typeof self!="undefined"?self:be,function(){return function(t){var r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=r,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},i.r=function(s){Object.defineProperty(s,"__esModule",{value:!0})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=0)}({"./dist/icons.json":function(t){t.exports={activity:'<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>',airplay:'<path d="M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"></path><polygon points="12 15 17 21 7 21 12 15"></polygon>',"alert-circle":'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line>',"alert-octagon":'<polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line>',"alert-triangle":'<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line>',"align-center":'<line x1="18" y1="10" x2="6" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="18" y1="18" x2="6" y2="18"></line>',"align-justify":'<line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line>',"align-left":'<line x1="17" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="17" y1="18" x2="3" y2="18"></line>',"align-right":'<line x1="21" y1="10" x2="7" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="7" y2="18"></line>',anchor:'<circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path>',aperture:'<circle cx="12" cy="12" r="10"></circle><line x1="14.31" y1="8" x2="20.05" y2="17.94"></line><line x1="9.69" y1="8" x2="21.17" y2="8"></line><line x1="7.38" y1="12" x2="13.12" y2="2.06"></line><line x1="9.69" y1="16" x2="3.95" y2="6.06"></line><line x1="14.31" y1="16" x2="2.83" y2="16"></line><line x1="16.62" y1="12" x2="10.88" y2="21.94"></line>',archive:'<polyline points="21 8 21 21 3 21 3 8"></polyline><rect x="1" y="3" width="22" height="5"></rect><line x1="10" y1="12" x2="14" y2="12"></line>',"arrow-down-circle":'<circle cx="12" cy="12" r="10"></circle><polyline points="8 12 12 16 16 12"></polyline><line x1="12" y1="8" x2="12" y2="16"></line>',"arrow-down-left":'<line x1="17" y1="7" x2="7" y2="17"></line><polyline points="17 17 7 17 7 7"></polyline>',"arrow-down-right":'<line x1="7" y1="7" x2="17" y2="17"></line><polyline points="17 7 17 17 7 17"></polyline>',"arrow-down":'<line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline>',"arrow-left-circle":'<circle cx="12" cy="12" r="10"></circle><polyline points="12 8 8 12 12 16"></polyline><line x1="16" y1="12" x2="8" y2="12"></line>',"arrow-left":'<line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline>',"arrow-right-circle":'<circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line>',"arrow-right":'<line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline>',"arrow-up-circle":'<circle cx="12" cy="12" r="10"></circle><polyline points="16 12 12 8 8 12"></polyline><line x1="12" y1="16" x2="12" y2="8"></line>',"arrow-up-left":'<line x1="17" y1="17" x2="7" y2="7"></line><polyline points="7 17 7 7 17 7"></polyline>',"arrow-up-right":'<line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline>',"arrow-up":'<line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline>',"at-sign":'<circle cx="12" cy="12" r="4"></circle><path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>',award:'<circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>',"bar-chart-2":'<line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line>',"bar-chart":'<line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line>',"battery-charging":'<path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3.19M15 6h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3.19"></path><line x1="23" y1="13" x2="23" y2="11"></line><polyline points="11 6 7 12 13 12 9 18"></polyline>',battery:'<rect x="1" y="6" width="18" height="12" rx="2" ry="2"></rect><line x1="23" y1="13" x2="23" y2="11"></line>',"bell-off":'<path d="M13.73 21a2 2 0 0 1-3.46 0"></path><path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path><path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path><path d="M18 8a6 6 0 0 0-9.33-5"></path><line x1="1" y1="1" x2="23" y2="23"></line>',bell:'<path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path>',bluetooth:'<polyline points="6.5 6.5 17.5 17.5 12 23 12 1 17.5 6.5 6.5 17.5"></polyline>',bold:'<path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>',"book-open":'<path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>',book:'<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>',bookmark:'<path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>',box:'<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line>',briefcase:'<rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>',calendar:'<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>',"camera-off":'<line x1="1" y1="1" x2="23" y2="23"></line><path d="M21 21H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3m3-3h6l2 3h4a2 2 0 0 1 2 2v9.34m-7.72-2.06a4 4 0 1 1-5.56-5.56"></path>',camera:'<path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle>',cast:'<path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6"></path><line x1="2" y1="20" x2="2.01" y2="20"></line>',"check-circle":'<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline>',"check-square":'<polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>',check:'<polyline points="20 6 9 17 4 12"></polyline>',"chevron-down":'<polyline points="6 9 12 15 18 9"></polyline>',"chevron-left":'<polyline points="15 18 9 12 15 6"></polyline>',"chevron-right":'<polyline points="9 18 15 12 9 6"></polyline>',"chevron-up":'<polyline points="18 15 12 9 6 15"></polyline>',"chevrons-down":'<polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline>',"chevrons-left":'<polyline points="11 17 6 12 11 7"></polyline><polyline points="18 17 13 12 18 7"></polyline>',"chevrons-right":'<polyline points="13 17 18 12 13 7"></polyline><polyline points="6 17 11 12 6 7"></polyline>',"chevrons-up":'<polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline>',chrome:'<circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="4"></circle><line x1="21.17" y1="8" x2="12" y2="8"></line><line x1="3.95" y1="6.06" x2="8.54" y2="14"></line><line x1="10.88" y1="21.94" x2="15.46" y2="14"></line>',circle:'<circle cx="12" cy="12" r="10"></circle>',clipboard:'<path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>',clock:'<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>',"cloud-drizzle":'<line x1="8" y1="19" x2="8" y2="21"></line><line x1="8" y1="13" x2="8" y2="15"></line><line x1="16" y1="19" x2="16" y2="21"></line><line x1="16" y1="13" x2="16" y2="15"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="12" y1="15" x2="12" y2="17"></line><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path>',"cloud-lightning":'<path d="M19 16.9A5 5 0 0 0 18 7h-1.26a8 8 0 1 0-11.62 9"></path><polyline points="13 11 9 17 15 17 11 23"></polyline>',"cloud-off":'<path d="M22.61 16.95A5 5 0 0 0 18 10h-1.26a8 8 0 0 0-7.05-6M5 5a8 8 0 0 0 4 15h9a5 5 0 0 0 1.7-.3"></path><line x1="1" y1="1" x2="23" y2="23"></line>',"cloud-rain":'<line x1="16" y1="13" x2="16" y2="21"></line><line x1="8" y1="13" x2="8" y2="21"></line><line x1="12" y1="15" x2="12" y2="23"></line><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path>',"cloud-snow":'<path d="M20 17.58A5 5 0 0 0 18 8h-1.26A8 8 0 1 0 4 16.25"></path><line x1="8" y1="16" x2="8.01" y2="16"></line><line x1="8" y1="20" x2="8.01" y2="20"></line><line x1="12" y1="18" x2="12.01" y2="18"></line><line x1="12" y1="22" x2="12.01" y2="22"></line><line x1="16" y1="16" x2="16.01" y2="16"></line><line x1="16" y1="20" x2="16.01" y2="20"></line>',cloud:'<path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>',code:'<polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline>',codepen:'<polygon points="12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2"></polygon><line x1="12" y1="22" x2="12" y2="15.5"></line><polyline points="22 8.5 12 15.5 2 8.5"></polyline><polyline points="2 15.5 12 8.5 22 15.5"></polyline><line x1="12" y1="2" x2="12" y2="8.5"></line>',codesandbox:'<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line>',coffee:'<path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line>',columns:'<path d="M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"></path>',command:'<path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"></path>',compass:'<circle cx="12" cy="12" r="10"></circle><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon>',copy:'<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>',"corner-down-left":'<polyline points="9 10 4 15 9 20"></polyline><path d="M20 4v7a4 4 0 0 1-4 4H4"></path>',"corner-down-right":'<polyline points="15 10 20 15 15 20"></polyline><path d="M4 4v7a4 4 0 0 0 4 4h12"></path>',"corner-left-down":'<polyline points="14 15 9 20 4 15"></polyline><path d="M20 4h-7a4 4 0 0 0-4 4v12"></path>',"corner-left-up":'<polyline points="14 9 9 4 4 9"></polyline><path d="M20 20h-7a4 4 0 0 1-4-4V4"></path>',"corner-right-down":'<polyline points="10 15 15 20 20 15"></polyline><path d="M4 4h7a4 4 0 0 1 4 4v12"></path>',"corner-right-up":'<polyline points="10 9 15 4 20 9"></polyline><path d="M4 20h7a4 4 0 0 0 4-4V4"></path>',"corner-up-left":'<polyline points="9 14 4 9 9 4"></polyline><path d="M20 20v-7a4 4 0 0 0-4-4H4"></path>',"corner-up-right":'<polyline points="15 14 20 9 15 4"></polyline><path d="M4 20v-7a4 4 0 0 1 4-4h12"></path>',cpu:'<rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line>',"credit-card":'<rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line>',crop:'<path d="M6.13 1L6 16a2 2 0 0 0 2 2h15"></path><path d="M1 6.13L16 6a2 2 0 0 1 2 2v15"></path>',crosshair:'<circle cx="12" cy="12" r="10"></circle><line x1="22" y1="12" x2="18" y2="12"></line><line x1="6" y1="12" x2="2" y2="12"></line><line x1="12" y1="6" x2="12" y2="2"></line><line x1="12" y1="22" x2="12" y2="18"></line>',database:'<ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>',delete:'<path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line>',disc:'<circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="3"></circle>',"divide-circle":'<line x1="8" y1="12" x2="16" y2="12"></line><line x1="12" y1="16" x2="12" y2="16"></line><line x1="12" y1="8" x2="12" y2="8"></line><circle cx="12" cy="12" r="10"></circle>',"divide-square":'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="8" y1="12" x2="16" y2="12"></line><line x1="12" y1="16" x2="12" y2="16"></line><line x1="12" y1="8" x2="12" y2="8"></line>',divide:'<circle cx="12" cy="6" r="2"></circle><line x1="5" y1="12" x2="19" y2="12"></line><circle cx="12" cy="18" r="2"></circle>',"dollar-sign":'<line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>',"download-cloud":'<polyline points="8 17 12 21 16 17"></polyline><line x1="12" y1="12" x2="12" y2="21"></line><path d="M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"></path>',download:'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line>',dribbble:'<circle cx="12" cy="12" r="10"></circle><path d="M8.56 2.75c4.37 6.03 6.02 9.42 8.03 17.72m2.54-15.38c-3.72 4.35-8.94 5.66-16.88 5.85m19.5 1.9c-3.5-.93-6.63-.82-8.94 0-2.58.92-5.01 2.86-7.44 6.32"></path>',droplet:'<path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>',"edit-2":'<path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>',"edit-3":'<path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>',edit:'<path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>',"external-link":'<path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>',"eye-off":'<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line>',eye:'<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>',facebook:'<path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>',"fast-forward":'<polygon points="13 19 22 12 13 5 13 19"></polygon><polygon points="2 19 11 12 2 5 2 19"></polygon>',feather:'<path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line>',figma:'<path d="M5 5.5A3.5 3.5 0 0 1 8.5 2H12v7H8.5A3.5 3.5 0 0 1 5 5.5z"></path><path d="M12 2h3.5a3.5 3.5 0 1 1 0 7H12V2z"></path><path d="M12 12.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 1 1-7 0z"></path><path d="M5 19.5A3.5 3.5 0 0 1 8.5 16H12v3.5a3.5 3.5 0 1 1-7 0z"></path><path d="M5 12.5A3.5 3.5 0 0 1 8.5 9H12v7H8.5A3.5 3.5 0 0 1 5 12.5z"></path>',"file-minus":'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="9" y1="15" x2="15" y2="15"></line>',"file-plus":'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line>',"file-text":'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline>',file:'<path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>',film:'<rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line>',filter:'<polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>',flag:'<path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line>',"folder-minus":'<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1="9" y1="14" x2="15" y2="14"></line>',"folder-plus":'<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><line x1="12" y1="11" x2="12" y2="17"></line><line x1="9" y1="14" x2="15" y2="14"></line>',folder:'<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>',framer:'<path d="M5 16V9h14V2H5l14 14h-7m-7 0l7 7v-7m-7 0h7"></path>',frown:'<circle cx="12" cy="12" r="10"></circle><path d="M16 16s-1.5-2-4-2-4 2-4 2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line>',gift:'<polyline points="20 12 20 22 4 22 4 12"></polyline><rect x="2" y="7" width="20" height="5"></rect><line x1="12" y1="22" x2="12" y2="7"></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>',"git-branch":'<line x1="6" y1="3" x2="6" y2="15"></line><circle cx="18" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><path d="M18 9a9 9 0 0 1-9 9"></path>',"git-commit":'<circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line>',"git-merge":'<circle cx="18" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><path d="M6 21V9a9 9 0 0 0 9 9"></path>',"git-pull-request":'<circle cx="18" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><path d="M13 6h3a2 2 0 0 1 2 2v7"></path><line x1="6" y1="9" x2="6" y2="21"></line>',github:'<path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>',gitlab:'<path d="M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"></path>',globe:'<circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>',grid:'<rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect>',"hard-drive":'<line x1="22" y1="12" x2="2" y2="12"></line><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"></path><line x1="6" y1="16" x2="6.01" y2="16"></line><line x1="10" y1="16" x2="10.01" y2="16"></line>',hash:'<line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line>',headphones:'<path d="M3 18v-6a9 9 0 0 1 18 0v6"></path><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"></path>',heart:'<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>',"help-circle":'<circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line>',hexagon:'<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>',home:'<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline>',image:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline>',inbox:'<polyline points="22 12 16 12 14 15 10 15 8 12 2 12"></polyline><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"></path>',info:'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line>',instagram:'<rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>',italic:'<line x1="19" y1="4" x2="10" y2="4"></line><line x1="14" y1="20" x2="5" y2="20"></line><line x1="15" y1="4" x2="9" y2="20"></line>',key:'<path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>',layers:'<polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline>',layout:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line>',"life-buoy":'<circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="4"></circle><line x1="4.93" y1="4.93" x2="9.17" y2="9.17"></line><line x1="14.83" y1="14.83" x2="19.07" y2="19.07"></line><line x1="14.83" y1="9.17" x2="19.07" y2="4.93"></line><line x1="14.83" y1="9.17" x2="18.36" y2="5.64"></line><line x1="4.93" y1="19.07" x2="9.17" y2="14.83"></line>',"link-2":'<path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>',link:'<path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>',linkedin:'<path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>',list:'<line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line>',loader:'<line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>',lock:'<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path>',"log-in":'<path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line>',"log-out":'<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line>',mail:'<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>',"map-pin":'<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle>',map:'<polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="8" y1="2" x2="8" y2="18"></line><line x1="16" y1="6" x2="16" y2="22"></line>',"maximize-2":'<polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line>',maximize:'<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>',meh:'<circle cx="12" cy="12" r="10"></circle><line x1="8" y1="15" x2="16" y2="15"></line><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line>',menu:'<line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>',"message-circle":'<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>',"message-square":'<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>',"mic-off":'<line x1="1" y1="1" x2="23" y2="23"></line><path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"></path><path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line>',mic:'<path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line>',"minimize-2":'<polyline points="4 14 10 14 10 20"></polyline><polyline points="20 10 14 10 14 4"></polyline><line x1="14" y1="10" x2="21" y2="3"></line><line x1="3" y1="21" x2="10" y2="14"></line>',minimize:'<path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path>',"minus-circle":'<circle cx="12" cy="12" r="10"></circle><line x1="8" y1="12" x2="16" y2="12"></line>',"minus-square":'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="8" y1="12" x2="16" y2="12"></line>',minus:'<line x1="5" y1="12" x2="19" y2="12"></line>',monitor:'<rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line>',moon:'<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>',"more-horizontal":'<circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle>',"more-vertical":'<circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle>',"mouse-pointer":'<path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path><path d="M13 13l6 6"></path>',move:'<polyline points="5 9 2 12 5 15"></polyline><polyline points="9 5 12 2 15 5"></polyline><polyline points="15 19 12 22 9 19"></polyline><polyline points="19 9 22 12 19 15"></polyline><line x1="2" y1="12" x2="22" y2="12"></line><line x1="12" y1="2" x2="12" y2="22"></line>',music:'<path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle>',"navigation-2":'<polygon points="12 2 19 21 12 17 5 21 12 2"></polygon>',navigation:'<polygon points="3 11 22 2 13 21 11 13 3 11"></polygon>',octagon:'<polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon>',package:'<line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line>',paperclip:'<path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>',"pause-circle":'<circle cx="12" cy="12" r="10"></circle><line x1="10" y1="15" x2="10" y2="9"></line><line x1="14" y1="15" x2="14" y2="9"></line>',pause:'<rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect>',"pen-tool":'<path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="M2 2l7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle>',percent:'<line x1="19" y1="5" x2="5" y2="19"></line><circle cx="6.5" cy="6.5" r="2.5"></circle><circle cx="17.5" cy="17.5" r="2.5"></circle>',"phone-call":'<path d="M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',"phone-forwarded":'<polyline points="19 1 23 5 19 9"></polyline><line x1="15" y1="5" x2="23" y2="5"></line><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',"phone-incoming":'<polyline points="16 2 16 8 22 8"></polyline><line x1="23" y1="1" x2="16" y2="8"></line><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',"phone-missed":'<line x1="23" y1="1" x2="17" y2="7"></line><line x1="17" y1="1" x2="23" y2="7"></line><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',"phone-off":'<path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"></path><line x1="23" y1="1" x2="1" y2="23"></line>',"phone-outgoing":'<polyline points="23 7 23 1 17 1"></polyline><line x1="16" y1="8" x2="23" y2="1"></line><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',phone:'<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',"pie-chart":'<path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path>',"play-circle":'<circle cx="12" cy="12" r="10"></circle><polygon points="10 8 16 12 10 16 10 8"></polygon>',play:'<polygon points="5 3 19 12 5 21 5 3"></polygon>',"plus-circle":'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line>',"plus-square":'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line>',plus:'<line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line>',pocket:'<path d="M4 3h16a2 2 0 0 1 2 2v6a10 10 0 0 1-10 10A10 10 0 0 1 2 11V5a2 2 0 0 1 2-2z"></path><polyline points="8 10 12 14 16 10"></polyline>',power:'<path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path><line x1="12" y1="2" x2="12" y2="12"></line>',printer:'<polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect>',radio:'<circle cx="12" cy="12" r="2"></circle><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path>',"refresh-ccw":'<polyline points="1 4 1 10 7 10"></polyline><polyline points="23 20 23 14 17 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>',"refresh-cw":'<polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>',repeat:'<polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path>',rewind:'<polygon points="11 19 2 12 11 5 11 19"></polygon><polygon points="22 19 13 12 22 5 22 19"></polygon>',"rotate-ccw":'<polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>',"rotate-cw":'<polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>',rss:'<path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>',save:'<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline>',scissors:'<circle cx="6" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><line x1="20" y1="4" x2="8.12" y2="15.88"></line><line x1="14.47" y1="14.48" x2="20" y2="20"></line><line x1="8.12" y1="8.12" x2="12" y2="12"></line>',search:'<circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>',send:'<line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>',server:'<rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6.01" y2="6"></line><line x1="6" y1="18" x2="6.01" y2="18"></line>',settings:'<circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>',"share-2":'<circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>',share:'<path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line>',"shield-off":'<path d="M19.69 14a6.9 6.9 0 0 0 .31-2V5l-8-3-3.16 1.18"></path><path d="M4.73 4.73L4 5v7c0 6 8 10 8 10a20.29 20.29 0 0 0 5.62-4.38"></path><line x1="1" y1="1" x2="23" y2="23"></line>',shield:'<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>',"shopping-bag":'<path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path>',"shopping-cart":'<circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>',shuffle:'<polyline points="16 3 21 3 21 8"></polyline><line x1="4" y1="20" x2="21" y2="3"></line><polyline points="21 16 21 21 16 21"></polyline><line x1="15" y1="15" x2="21" y2="21"></line><line x1="4" y1="4" x2="9" y2="9"></line>',sidebar:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line>',"skip-back":'<polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line>',"skip-forward":'<polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line>',slack:'<path d="M14.5 10c-.83 0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"></path><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path><path d="M9.5 14c.83 0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"></path><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"></path><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83 0-1.5-.67-1.5-1.5z"></path><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"></path><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83 0 1.5-.67 1.5-1.5z"></path><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"></path>',slash:'<circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>',sliders:'<line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line>',smartphone:'<rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line>',smile:'<circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line>',speaker:'<rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><circle cx="12" cy="14" r="4"></circle><line x1="12" y1="6" x2="12.01" y2="6"></line>',square:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>',star:'<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>',"stop-circle":'<circle cx="12" cy="12" r="10"></circle><rect x="9" y="9" width="6" height="6"></rect>',sun:'<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>',sunrise:'<path d="M17 18a5 5 0 0 0-10 0"></path><line x1="12" y1="2" x2="12" y2="9"></line><line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line><line x1="1" y1="18" x2="3" y2="18"></line><line x1="21" y1="18" x2="23" y2="18"></line><line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line><line x1="23" y1="22" x2="1" y2="22"></line><polyline points="8 6 12 2 16 6"></polyline>',sunset:'<path d="M17 18a5 5 0 0 0-10 0"></path><line x1="12" y1="9" x2="12" y2="2"></line><line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line><line x1="1" y1="18" x2="3" y2="18"></line><line x1="21" y1="18" x2="23" y2="18"></line><line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line><line x1="23" y1="22" x2="1" y2="22"></line><polyline points="16 5 12 9 8 5"></polyline>',tablet:'<rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line>',tag:'<path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>',target:'<circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle>',terminal:'<polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line>',thermometer:'<path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"></path>',"thumbs-down":'<path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path>',"thumbs-up":'<path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>',"toggle-left":'<rect x="1" y="5" width="22" height="14" rx="7" ry="7"></rect><circle cx="8" cy="12" r="3"></circle>',"toggle-right":'<rect x="1" y="5" width="22" height="14" rx="7" ry="7"></rect><circle cx="16" cy="12" r="3"></circle>',tool:'<path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>',"trash-2":'<polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line>',trash:'<polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>',trello:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><rect x="7" y="7" width="3" height="9"></rect><rect x="14" y="7" width="3" height="5"></rect>',"trending-down":'<polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline><polyline points="17 18 23 18 23 12"></polyline>',"trending-up":'<polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline>',triangle:'<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>',truck:'<rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle>',tv:'<rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect><polyline points="17 2 12 7 7 2"></polyline>',twitch:'<path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path>',twitter:'<path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>',type:'<polyline points="4 7 4 4 20 4 20 7"></polyline><line x1="9" y1="20" x2="15" y2="20"></line><line x1="12" y1="4" x2="12" y2="20"></line>',umbrella:'<path d="M23 12a11.05 11.05 0 0 0-22 0zm-5 7a3 3 0 0 1-6 0v-7"></path>',underline:'<path d="M6 3v7a6 6 0 0 0 6 6 6 6 0 0 0 6-6V3"></path><line x1="4" y1="21" x2="20" y2="21"></line>',unlock:'<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 9.9-1"></path>',"upload-cloud":'<polyline points="16 16 12 12 8 16"></polyline><line x1="12" y1="12" x2="12" y2="21"></line><path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"></path><polyline points="16 16 12 12 8 16"></polyline>',upload:'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line>',"user-check":'<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><polyline points="17 11 19 13 23 9"></polyline>',"user-minus":'<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="23" y1="11" x2="17" y2="11"></line>',"user-plus":'<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line>',"user-x":'<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="18" y1="8" x2="23" y2="13"></line><line x1="23" y1="8" x2="18" y2="13"></line>',user:'<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>',users:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path>',"video-off":'<path d="M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"></path><line x1="1" y1="1" x2="23" y2="23"></line>',video:'<polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>',voicemail:'<circle cx="5.5" cy="11.5" r="4.5"></circle><circle cx="18.5" cy="11.5" r="4.5"></circle><line x1="5.5" y1="16" x2="18.5" y2="16"></line>',"volume-1":'<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>',"volume-2":'<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>',"volume-x":'<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>',volume:'<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>',watch:'<circle cx="12" cy="12" r="7"></circle><polyline points="12 9 12 12 13.5 13.5"></polyline><path d="M16.51 17.35l-.35 3.83a2 2 0 0 1-2 1.82H9.83a2 2 0 0 1-2-1.82l-.35-3.83m.01-10.7l.35-3.83A2 2 0 0 1 9.83 1h4.35a2 2 0 0 1 2 1.82l.35 3.83"></path>',"wifi-off":'<line x1="1" y1="1" x2="23" y2="23"></line><path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path><path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path><path d="M10.71 5.05A16 16 0 0 1 22.58 9"></path><path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path><line x1="12" y1="20" x2="12.01" y2="20"></line>',wifi:'<path d="M5 12.55a11 11 0 0 1 14.08 0"></path><path d="M1.42 9a16 16 0 0 1 21.16 0"></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path><line x1="12" y1="20" x2="12.01" y2="20"></line>',wind:'<path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"></path>',"x-circle":'<circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line>',"x-octagon":'<polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line>',"x-square":'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="9" x2="15" y2="15"></line><line x1="15" y1="9" x2="9" y2="15"></line>',x:'<line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>',youtube:'<path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>',"zap-off":'<polyline points="12.41 6.75 13 2 10.57 4.92"></polyline><polyline points="18.57 12.91 21 10 15.66 10"></polyline><polyline points="8 8 3 14 12 14 11 22 16 16"></polyline><line x1="1" y1="1" x2="23" y2="23"></line>',zap:'<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>',"zoom-in":'<circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line>',"zoom-out":'<circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="8" y1="11" x2="14" y2="11"></line>'}},"./node_modules/classnames/dedupe.js":function(t,r,i){var s,o;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var a=function(){function l(){}l.prototype=Object.create(null);function c(b,_){for(var M=_.length,h=0;h<M;++h)v(b,_[h])}var u={}.hasOwnProperty;function d(b,_){b[_]=!0}function f(b,_){for(var M in _)u.call(_,M)&&(b[M]=!!_[M])}var p=/\s+/;function m(b,_){for(var M=_.split(p),h=M.length,w=0;w<h;++w)b[M[w]]=!0}function v(b,_){if(_){var M=typeof _;M==="string"?m(b,_):Array.isArray(_)?c(b,_):M==="object"?f(b,_):M==="number"&&d(b,_)}}function x(){for(var b=arguments.length,_=Array(b),M=0;M<b;M++)_[M]=arguments[M];var h=new l;c(h,_);var w=[];for(var y in h)h[y]&&w.push(y);return w.join(" ")}return x}();typeof t!="undefined"&&t.exports?t.exports=a:(s=[],o=function(){return a}.apply(r,s),o!==void 0&&(t.exports=o))})()},"./node_modules/core-js/es/array/from.js":function(t,r,i){i("./node_modules/core-js/modules/es.string.iterator.js"),i("./node_modules/core-js/modules/es.array.from.js");var s=i("./node_modules/core-js/internals/path.js");t.exports=s.Array.from},"./node_modules/core-js/internals/a-function.js":function(t,r){t.exports=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i}},"./node_modules/core-js/internals/an-object.js":function(t,r,i){var s=i("./node_modules/core-js/internals/is-object.js");t.exports=function(o){if(!s(o))throw TypeError(String(o)+" is not an object");return o}},"./node_modules/core-js/internals/array-from.js":function(t,r,i){var s=i("./node_modules/core-js/internals/bind-context.js"),o=i("./node_modules/core-js/internals/to-object.js"),a=i("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),l=i("./node_modules/core-js/internals/is-array-iterator-method.js"),c=i("./node_modules/core-js/internals/to-length.js"),u=i("./node_modules/core-js/internals/create-property.js"),d=i("./node_modules/core-js/internals/get-iterator-method.js");t.exports=function(p){var m=o(p),v=typeof this=="function"?this:Array,x=arguments.length,b=x>1?arguments[1]:void 0,_=b!==void 0,M=0,h=d(m),w,y,E,g;if(_&&(b=s(b,x>2?arguments[2]:void 0,2)),h!=null&&!(v==Array&&l(h)))for(g=h.call(m),y=new v;!(E=g.next()).done;M++)u(y,M,_?a(g,b,[E.value,M],!0):E.value);else for(w=c(m.length),y=new v(w);w>M;M++)u(y,M,_?b(m[M],M):m[M]);return y.length=M,y}},"./node_modules/core-js/internals/array-includes.js":function(t,r,i){var s=i("./node_modules/core-js/internals/to-indexed-object.js"),o=i("./node_modules/core-js/internals/to-length.js"),a=i("./node_modules/core-js/internals/to-absolute-index.js");t.exports=function(l){return function(c,u,d){var f=s(c),p=o(f.length),m=a(d,p),v;if(l&&u!=u){for(;p>m;)if(v=f[m++],v!=v)return!0}else for(;p>m;m++)if((l||m in f)&&f[m]===u)return l||m||0;return!l&&-1}}},"./node_modules/core-js/internals/bind-context.js":function(t,r,i){var s=i("./node_modules/core-js/internals/a-function.js");t.exports=function(o,a,l){if(s(o),a===void 0)return o;switch(l){case 0:return function(){return o.call(a)};case 1:return function(c){return o.call(a,c)};case 2:return function(c,u){return o.call(a,c,u)};case 3:return function(c,u,d){return o.call(a,c,u,d)}}return function(){return o.apply(a,arguments)}}},"./node_modules/core-js/internals/call-with-safe-iteration-closing.js":function(t,r,i){var s=i("./node_modules/core-js/internals/an-object.js");t.exports=function(o,a,l,c){try{return c?a(s(l)[0],l[1]):a(l)}catch(d){var u=o.return;throw u!==void 0&&s(u.call(o)),d}}},"./node_modules/core-js/internals/check-correctness-of-iteration.js":function(t,r,i){var s=i("./node_modules/core-js/internals/well-known-symbol.js"),o=s("iterator"),a=!1;try{var l=0,c={next:function(){return{done:!!l++}},return:function(){a=!0}};c[o]=function(){return this},Array.from(c,function(){throw 2})}catch(u){}t.exports=function(u,d){if(!d&&!a)return!1;var f=!1;try{var p={};p[o]=function(){return{next:function(){return{done:f=!0}}}},u(p)}catch(m){}return f}},"./node_modules/core-js/internals/classof-raw.js":function(t,r){var i={}.toString;t.exports=function(s){return i.call(s).slice(8,-1)}},"./node_modules/core-js/internals/classof.js":function(t,r,i){var s=i("./node_modules/core-js/internals/classof-raw.js"),o=i("./node_modules/core-js/internals/well-known-symbol.js"),a=o("toStringTag"),l=s(function(){return arguments}())=="Arguments",c=function(u,d){try{return u[d]}catch(f){}};t.exports=function(u){var d,f,p;return u===void 0?"Undefined":u===null?"Null":typeof(f=c(d=Object(u),a))=="string"?f:l?s(d):(p=s(d))=="Object"&&typeof d.callee=="function"?"Arguments":p}},"./node_modules/core-js/internals/copy-constructor-properties.js":function(t,r,i){var s=i("./node_modules/core-js/internals/has.js"),o=i("./node_modules/core-js/internals/own-keys.js"),a=i("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),l=i("./node_modules/core-js/internals/object-define-property.js");t.exports=function(c,u){for(var d=o(u),f=l.f,p=a.f,m=0;m<d.length;m++){var v=d[m];s(c,v)||f(c,v,p(u,v))}}},"./node_modules/core-js/internals/correct-prototype-getter.js":function(t,r,i){var s=i("./node_modules/core-js/internals/fails.js");t.exports=!s(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},"./node_modules/core-js/internals/create-iterator-constructor.js":function(t,r,i){var s=i("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,o=i("./node_modules/core-js/internals/object-create.js"),a=i("./node_modules/core-js/internals/create-property-descriptor.js"),l=i("./node_modules/core-js/internals/set-to-string-tag.js"),c=i("./node_modules/core-js/internals/iterators.js"),u=function(){return this};t.exports=function(d,f,p){var m=f+" Iterator";return d.prototype=o(s,{next:a(1,p)}),l(d,m,!1,!0),c[m]=u,d}},"./node_modules/core-js/internals/create-property-descriptor.js":function(t,r){t.exports=function(i,s){return{enumerable:!(i&1),configurable:!(i&2),writable:!(i&4),value:s}}},"./node_modules/core-js/internals/create-property.js":function(t,r,i){var s=i("./node_modules/core-js/internals/to-primitive.js"),o=i("./node_modules/core-js/internals/object-define-property.js"),a=i("./node_modules/core-js/internals/create-property-descriptor.js");t.exports=function(l,c,u){var d=s(c);d in l?o.f(l,d,a(0,u)):l[d]=u}},"./node_modules/core-js/internals/define-iterator.js":function(t,r,i){var s=i("./node_modules/core-js/internals/export.js"),o=i("./node_modules/core-js/internals/create-iterator-constructor.js"),a=i("./node_modules/core-js/internals/object-get-prototype-of.js"),l=i("./node_modules/core-js/internals/object-set-prototype-of.js"),c=i("./node_modules/core-js/internals/set-to-string-tag.js"),u=i("./node_modules/core-js/internals/hide.js"),d=i("./node_modules/core-js/internals/redefine.js"),f=i("./node_modules/core-js/internals/well-known-symbol.js"),p=i("./node_modules/core-js/internals/is-pure.js"),m=i("./node_modules/core-js/internals/iterators.js"),v=i("./node_modules/core-js/internals/iterators-core.js"),x=v.IteratorPrototype,b=v.BUGGY_SAFARI_ITERATORS,_=f("iterator"),M="keys",h="values",w="entries",y=function(){return this};t.exports=function(E,g,I,R,S,k,T){o(I,g,R);var C=function(oe){if(oe===S&&N)return N;if(!b&&oe in O)return O[oe];switch(oe){case M:return function(){return new I(this,oe)};case h:return function(){return new I(this,oe)};case w:return function(){return new I(this,oe)}}return function(){return new I(this)}},D=g+" Iterator",A=!1,O=E.prototype,P=O[_]||O["@@iterator"]||S&&O[S],N=!b&&P||C(S),F=g=="Array"&&O.entries||P,j,J,ie;if(F&&(j=a(F.call(new E)),x!==Object.prototype&&j.next&&(!p&&a(j)!==x&&(l?l(j,x):typeof j[_]!="function"&&u(j,_,y)),c(j,D,!0,!0),p&&(m[D]=y))),S==h&&P&&P.name!==h&&(A=!0,N=function(){return P.call(this)}),(!p||T)&&O[_]!==N&&u(O,_,N),m[g]=N,S)if(J={values:C(h),keys:k?N:C(M),entries:C(w)},T)for(ie in J)(b||A||!(ie in O))&&d(O,ie,J[ie]);else s({target:g,proto:!0,forced:b||A},J);return J}},"./node_modules/core-js/internals/descriptors.js":function(t,r,i){var s=i("./node_modules/core-js/internals/fails.js");t.exports=!s(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},"./node_modules/core-js/internals/document-create-element.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/is-object.js"),a=s.document,l=o(a)&&o(a.createElement);t.exports=function(c){return l?a.createElement(c):{}}},"./node_modules/core-js/internals/enum-bug-keys.js":function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"./node_modules/core-js/internals/export.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,a=i("./node_modules/core-js/internals/hide.js"),l=i("./node_modules/core-js/internals/redefine.js"),c=i("./node_modules/core-js/internals/set-global.js"),u=i("./node_modules/core-js/internals/copy-constructor-properties.js"),d=i("./node_modules/core-js/internals/is-forced.js");t.exports=function(f,p){var m=f.target,v=f.global,x=f.stat,b,_,M,h,w,y;if(v?_=s:x?_=s[m]||c(m,{}):_=(s[m]||{}).prototype,_)for(M in p){if(w=p[M],f.noTargetGet?(y=o(_,M),h=y&&y.value):h=_[M],b=d(v?M:m+(x?".":"#")+M,f.forced),!b&&h!==void 0){if(typeof w==typeof h)continue;u(w,h)}(f.sham||h&&h.sham)&&a(w,"sham",!0),l(_,M,w,f)}}},"./node_modules/core-js/internals/fails.js":function(t,r){t.exports=function(i){try{return!!i()}catch(s){return!0}}},"./node_modules/core-js/internals/function-to-string.js":function(t,r,i){var s=i("./node_modules/core-js/internals/shared.js");t.exports=s("native-function-to-string",Function.toString)},"./node_modules/core-js/internals/get-iterator-method.js":function(t,r,i){var s=i("./node_modules/core-js/internals/classof.js"),o=i("./node_modules/core-js/internals/iterators.js"),a=i("./node_modules/core-js/internals/well-known-symbol.js"),l=a("iterator");t.exports=function(c){if(c!=null)return c[l]||c["@@iterator"]||o[s(c)]}},"./node_modules/core-js/internals/global.js":function(t,r,i){(function(s){var o="object",a=function(l){return l&&l.Math==Math&&l};t.exports=a(typeof globalThis==o&&globalThis)||a(typeof window==o&&window)||a(typeof self==o&&self)||a(typeof s==o&&s)||Function("return this")()}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./node_modules/core-js/internals/has.js":function(t,r){var i={}.hasOwnProperty;t.exports=function(s,o){return i.call(s,o)}},"./node_modules/core-js/internals/hidden-keys.js":function(t,r){t.exports={}},"./node_modules/core-js/internals/hide.js":function(t,r,i){var s=i("./node_modules/core-js/internals/descriptors.js"),o=i("./node_modules/core-js/internals/object-define-property.js"),a=i("./node_modules/core-js/internals/create-property-descriptor.js");t.exports=s?function(l,c,u){return o.f(l,c,a(1,u))}:function(l,c,u){return l[c]=u,l}},"./node_modules/core-js/internals/html.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=s.document;t.exports=o&&o.documentElement},"./node_modules/core-js/internals/ie8-dom-define.js":function(t,r,i){var s=i("./node_modules/core-js/internals/descriptors.js"),o=i("./node_modules/core-js/internals/fails.js"),a=i("./node_modules/core-js/internals/document-create-element.js");t.exports=!s&&!o(function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!=7})},"./node_modules/core-js/internals/indexed-object.js":function(t,r,i){var s=i("./node_modules/core-js/internals/fails.js"),o=i("./node_modules/core-js/internals/classof-raw.js"),a="".split;t.exports=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(l){return o(l)=="String"?a.call(l,""):Object(l)}:Object},"./node_modules/core-js/internals/internal-state.js":function(t,r,i){var s=i("./node_modules/core-js/internals/native-weak-map.js"),o=i("./node_modules/core-js/internals/global.js"),a=i("./node_modules/core-js/internals/is-object.js"),l=i("./node_modules/core-js/internals/hide.js"),c=i("./node_modules/core-js/internals/has.js"),u=i("./node_modules/core-js/internals/shared-key.js"),d=i("./node_modules/core-js/internals/hidden-keys.js"),f=o.WeakMap,p,m,v,x=function(E){return v(E)?m(E):p(E,{})},b=function(E){return function(g){var I;if(!a(g)||(I=m(g)).type!==E)throw TypeError("Incompatible receiver, "+E+" required");return I}};if(s){var _=new f,M=_.get,h=_.has,w=_.set;p=function(E,g){return w.call(_,E,g),g},m=function(E){return M.call(_,E)||{}},v=function(E){return h.call(_,E)}}else{var y=u("state");d[y]=!0,p=function(E,g){return l(E,y,g),g},m=function(E){return c(E,y)?E[y]:{}},v=function(E){return c(E,y)}}t.exports={set:p,get:m,has:v,enforce:x,getterFor:b}},"./node_modules/core-js/internals/is-array-iterator-method.js":function(t,r,i){var s=i("./node_modules/core-js/internals/well-known-symbol.js"),o=i("./node_modules/core-js/internals/iterators.js"),a=s("iterator"),l=Array.prototype;t.exports=function(c){return c!==void 0&&(o.Array===c||l[a]===c)}},"./node_modules/core-js/internals/is-forced.js":function(t,r,i){var s=i("./node_modules/core-js/internals/fails.js"),o=/#|\.prototype\./,a=function(f,p){var m=c[l(f)];return m==d?!0:m==u?!1:typeof p=="function"?s(p):!!p},l=a.normalize=function(f){return String(f).replace(o,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a},"./node_modules/core-js/internals/is-object.js":function(t,r){t.exports=function(i){return typeof i=="object"?i!==null:typeof i=="function"}},"./node_modules/core-js/internals/is-pure.js":function(t,r){t.exports=!1},"./node_modules/core-js/internals/iterators-core.js":function(t,r,i){var s=i("./node_modules/core-js/internals/object-get-prototype-of.js"),o=i("./node_modules/core-js/internals/hide.js"),a=i("./node_modules/core-js/internals/has.js"),l=i("./node_modules/core-js/internals/well-known-symbol.js"),c=i("./node_modules/core-js/internals/is-pure.js"),u=l("iterator"),d=!1,f=function(){return this},p,m,v;[].keys&&(v=[].keys(),"next"in v?(m=s(s(v)),m!==Object.prototype&&(p=m)):d=!0),p==null&&(p={}),!c&&!a(p,u)&&o(p,u,f),t.exports={IteratorPrototype:p,BUGGY_SAFARI_ITERATORS:d}},"./node_modules/core-js/internals/iterators.js":function(t,r){t.exports={}},"./node_modules/core-js/internals/native-symbol.js":function(t,r,i){var s=i("./node_modules/core-js/internals/fails.js");t.exports=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())})},"./node_modules/core-js/internals/native-weak-map.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/function-to-string.js"),a=s.WeakMap;t.exports=typeof a=="function"&&/native code/.test(o.call(a))},"./node_modules/core-js/internals/object-create.js":function(t,r,i){var s=i("./node_modules/core-js/internals/an-object.js"),o=i("./node_modules/core-js/internals/object-define-properties.js"),a=i("./node_modules/core-js/internals/enum-bug-keys.js"),l=i("./node_modules/core-js/internals/hidden-keys.js"),c=i("./node_modules/core-js/internals/html.js"),u=i("./node_modules/core-js/internals/document-create-element.js"),d=i("./node_modules/core-js/internals/shared-key.js"),f=d("IE_PROTO"),p="prototype",m=function(){},v=function(){var x=u("iframe"),b=a.length,_="<",M="script",h=">",w="java"+M+":",y;for(x.style.display="none",c.appendChild(x),x.src=String(w),y=x.contentWindow.document,y.open(),y.write(_+M+h+"document.F=Object"+_+"/"+M+h),y.close(),v=y.F;b--;)delete v[p][a[b]];return v()};t.exports=Object.create||function(b,_){var M;return b!==null?(m[p]=s(b),M=new m,m[p]=null,M[f]=b):M=v(),_===void 0?M:o(M,_)},l[f]=!0},"./node_modules/core-js/internals/object-define-properties.js":function(t,r,i){var s=i("./node_modules/core-js/internals/descriptors.js"),o=i("./node_modules/core-js/internals/object-define-property.js"),a=i("./node_modules/core-js/internals/an-object.js"),l=i("./node_modules/core-js/internals/object-keys.js");t.exports=s?Object.defineProperties:function(u,d){a(u);for(var f=l(d),p=f.length,m=0,v;p>m;)o.f(u,v=f[m++],d[v]);return u}},"./node_modules/core-js/internals/object-define-property.js":function(t,r,i){var s=i("./node_modules/core-js/internals/descriptors.js"),o=i("./node_modules/core-js/internals/ie8-dom-define.js"),a=i("./node_modules/core-js/internals/an-object.js"),l=i("./node_modules/core-js/internals/to-primitive.js"),c=Object.defineProperty;r.f=s?c:function(d,f,p){if(a(d),f=l(f,!0),a(p),o)try{return c(d,f,p)}catch(m){}if("get"in p||"set"in p)throw TypeError("Accessors not supported");return"value"in p&&(d[f]=p.value),d}},"./node_modules/core-js/internals/object-get-own-property-descriptor.js":function(t,r,i){var s=i("./node_modules/core-js/internals/descriptors.js"),o=i("./node_modules/core-js/internals/object-property-is-enumerable.js"),a=i("./node_modules/core-js/internals/create-property-descriptor.js"),l=i("./node_modules/core-js/internals/to-indexed-object.js"),c=i("./node_modules/core-js/internals/to-primitive.js"),u=i("./node_modules/core-js/internals/has.js"),d=i("./node_modules/core-js/internals/ie8-dom-define.js"),f=Object.getOwnPropertyDescriptor;r.f=s?f:function(m,v){if(m=l(m),v=c(v,!0),d)try{return f(m,v)}catch(x){}if(u(m,v))return a(!o.f.call(m,v),m[v])}},"./node_modules/core-js/internals/object-get-own-property-names.js":function(t,r,i){var s=i("./node_modules/core-js/internals/object-keys-internal.js"),o=i("./node_modules/core-js/internals/enum-bug-keys.js"),a=o.concat("length","prototype");r.f=Object.getOwnPropertyNames||function(c){return s(c,a)}},"./node_modules/core-js/internals/object-get-own-property-symbols.js":function(t,r){r.f=Object.getOwnPropertySymbols},"./node_modules/core-js/internals/object-get-prototype-of.js":function(t,r,i){var s=i("./node_modules/core-js/internals/has.js"),o=i("./node_modules/core-js/internals/to-object.js"),a=i("./node_modules/core-js/internals/shared-key.js"),l=i("./node_modules/core-js/internals/correct-prototype-getter.js"),c=a("IE_PROTO"),u=Object.prototype;t.exports=l?Object.getPrototypeOf:function(d){return d=o(d),s(d,c)?d[c]:typeof d.constructor=="function"&&d instanceof d.constructor?d.constructor.prototype:d instanceof Object?u:null}},"./node_modules/core-js/internals/object-keys-internal.js":function(t,r,i){var s=i("./node_modules/core-js/internals/has.js"),o=i("./node_modules/core-js/internals/to-indexed-object.js"),a=i("./node_modules/core-js/internals/array-includes.js"),l=i("./node_modules/core-js/internals/hidden-keys.js"),c=a(!1);t.exports=function(u,d){var f=o(u),p=0,m=[],v;for(v in f)!s(l,v)&&s(f,v)&&m.push(v);for(;d.length>p;)s(f,v=d[p++])&&(~c(m,v)||m.push(v));return m}},"./node_modules/core-js/internals/object-keys.js":function(t,r,i){var s=i("./node_modules/core-js/internals/object-keys-internal.js"),o=i("./node_modules/core-js/internals/enum-bug-keys.js");t.exports=Object.keys||function(l){return s(l,o)}},"./node_modules/core-js/internals/object-property-is-enumerable.js":function(t,r,i){var s={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!s.call({1:2},1);r.f=a?function(c){var u=o(this,c);return!!u&&u.enumerable}:s},"./node_modules/core-js/internals/object-set-prototype-of.js":function(t,r,i){var s=i("./node_modules/core-js/internals/validate-set-prototype-of-arguments.js");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,a={},l;try{l=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,l.call(a,[]),o=a instanceof Array}catch(c){}return function(u,d){return s(u,d),o?l.call(u,d):u.__proto__=d,u}}():void 0)},"./node_modules/core-js/internals/own-keys.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/object-get-own-property-names.js"),a=i("./node_modules/core-js/internals/object-get-own-property-symbols.js"),l=i("./node_modules/core-js/internals/an-object.js"),c=s.Reflect;t.exports=c&&c.ownKeys||function(d){var f=o.f(l(d)),p=a.f;return p?f.concat(p(d)):f}},"./node_modules/core-js/internals/path.js":function(t,r,i){t.exports=i("./node_modules/core-js/internals/global.js")},"./node_modules/core-js/internals/redefine.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/shared.js"),a=i("./node_modules/core-js/internals/hide.js"),l=i("./node_modules/core-js/internals/has.js"),c=i("./node_modules/core-js/internals/set-global.js"),u=i("./node_modules/core-js/internals/function-to-string.js"),d=i("./node_modules/core-js/internals/internal-state.js"),f=d.get,p=d.enforce,m=String(u).split("toString");o("inspectSource",function(v){return u.call(v)}),(t.exports=function(v,x,b,_){var M=_?!!_.unsafe:!1,h=_?!!_.enumerable:!1,w=_?!!_.noTargetGet:!1;if(typeof b=="function"&&(typeof x=="string"&&!l(b,"name")&&a(b,"name",x),p(b).source=m.join(typeof x=="string"?x:"")),v===s){h?v[x]=b:c(x,b);return}else M?!w&&v[x]&&(h=!0):delete v[x];h?v[x]=b:a(v,x,b)})(Function.prototype,"toString",function(){return typeof this=="function"&&f(this).source||u.call(this)})},"./node_modules/core-js/internals/require-object-coercible.js":function(t,r){t.exports=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i}},"./node_modules/core-js/internals/set-global.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/hide.js");t.exports=function(a,l){try{o(s,a,l)}catch(c){s[a]=l}return l}},"./node_modules/core-js/internals/set-to-string-tag.js":function(t,r,i){var s=i("./node_modules/core-js/internals/object-define-property.js").f,o=i("./node_modules/core-js/internals/has.js"),a=i("./node_modules/core-js/internals/well-known-symbol.js"),l=a("toStringTag");t.exports=function(c,u,d){c&&!o(c=d?c:c.prototype,l)&&s(c,l,{configurable:!0,value:u})}},"./node_modules/core-js/internals/shared-key.js":function(t,r,i){var s=i("./node_modules/core-js/internals/shared.js"),o=i("./node_modules/core-js/internals/uid.js"),a=s("keys");t.exports=function(l){return a[l]||(a[l]=o(l))}},"./node_modules/core-js/internals/shared.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/set-global.js"),a=i("./node_modules/core-js/internals/is-pure.js"),l="__core-js_shared__",c=s[l]||o(l,{});(t.exports=function(u,d){return c[u]||(c[u]=d!==void 0?d:{})})("versions",[]).push({version:"3.1.3",mode:a?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/internals/string-at.js":function(t,r,i){var s=i("./node_modules/core-js/internals/to-integer.js"),o=i("./node_modules/core-js/internals/require-object-coercible.js");t.exports=function(a,l,c){var u=String(o(a)),d=s(l),f=u.length,p,m;return d<0||d>=f?c?"":void 0:(p=u.charCodeAt(d),p<55296||p>56319||d+1===f||(m=u.charCodeAt(d+1))<56320||m>57343?c?u.charAt(d):p:c?u.slice(d,d+2):(p-55296<<10)+(m-56320)+65536)}},"./node_modules/core-js/internals/to-absolute-index.js":function(t,r,i){var s=i("./node_modules/core-js/internals/to-integer.js"),o=Math.max,a=Math.min;t.exports=function(l,c){var u=s(l);return u<0?o(u+c,0):a(u,c)}},"./node_modules/core-js/internals/to-indexed-object.js":function(t,r,i){var s=i("./node_modules/core-js/internals/indexed-object.js"),o=i("./node_modules/core-js/internals/require-object-coercible.js");t.exports=function(a){return s(o(a))}},"./node_modules/core-js/internals/to-integer.js":function(t,r){var i=Math.ceil,s=Math.floor;t.exports=function(o){return isNaN(o=+o)?0:(o>0?s:i)(o)}},"./node_modules/core-js/internals/to-length.js":function(t,r,i){var s=i("./node_modules/core-js/internals/to-integer.js"),o=Math.min;t.exports=function(a){return a>0?o(s(a),9007199254740991):0}},"./node_modules/core-js/internals/to-object.js":function(t,r,i){var s=i("./node_modules/core-js/internals/require-object-coercible.js");t.exports=function(o){return Object(s(o))}},"./node_modules/core-js/internals/to-primitive.js":function(t,r,i){var s=i("./node_modules/core-js/internals/is-object.js");t.exports=function(o,a){if(!s(o))return o;var l,c;if(a&&typeof(l=o.toString)=="function"&&!s(c=l.call(o))||typeof(l=o.valueOf)=="function"&&!s(c=l.call(o))||!a&&typeof(l=o.toString)=="function"&&!s(c=l.call(o)))return c;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/internals/uid.js":function(t,r){var i=0,s=Math.random();t.exports=function(o){return"Symbol(".concat(o===void 0?"":o,")_",(++i+s).toString(36))}},"./node_modules/core-js/internals/validate-set-prototype-of-arguments.js":function(t,r,i){var s=i("./node_modules/core-js/internals/is-object.js"),o=i("./node_modules/core-js/internals/an-object.js");t.exports=function(a,l){if(o(a),!s(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype")}},"./node_modules/core-js/internals/well-known-symbol.js":function(t,r,i){var s=i("./node_modules/core-js/internals/global.js"),o=i("./node_modules/core-js/internals/shared.js"),a=i("./node_modules/core-js/internals/uid.js"),l=i("./node_modules/core-js/internals/native-symbol.js"),c=s.Symbol,u=o("wks");t.exports=function(d){return u[d]||(u[d]=l&&c[d]||(l?c:a)("Symbol."+d))}},"./node_modules/core-js/modules/es.array.from.js":function(t,r,i){var s=i("./node_modules/core-js/internals/export.js"),o=i("./node_modules/core-js/internals/array-from.js"),a=i("./node_modules/core-js/internals/check-correctness-of-iteration.js"),l=!a(function(c){Array.from(c)});s({target:"Array",stat:!0,forced:l},{from:o})},"./node_modules/core-js/modules/es.string.iterator.js":function(t,r,i){var s=i("./node_modules/core-js/internals/string-at.js"),o=i("./node_modules/core-js/internals/internal-state.js"),a=i("./node_modules/core-js/internals/define-iterator.js"),l="String Iterator",c=o.set,u=o.getterFor(l);a(String,"String",function(d){c(this,{type:l,string:String(d),index:0})},function(){var f=u(this),p=f.string,m=f.index,v;return m>=p.length?{value:void 0,done:!0}:(v=s(p,m,!0),f.index+=v.length,{value:v,done:!1})})},"./node_modules/webpack/buildin/global.js":function(t,r){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(s){typeof window=="object"&&(i=window)}t.exports=i},"./src/default-attrs.json":function(t){t.exports={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"}},"./src/icon.js":function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(v){for(var x=1;x<arguments.length;x++){var b=arguments[x];for(var _ in b)Object.prototype.hasOwnProperty.call(b,_)&&(v[_]=b[_])}return v},o=function(){function v(x,b){for(var _=0;_<b.length;_++){var M=b[_];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(x,M.key,M)}}return function(x,b,_){return b&&v(x.prototype,b),_&&v(x,_),x}}(),a=i("./node_modules/classnames/dedupe.js"),l=d(a),c=i("./src/default-attrs.json"),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function f(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")}var p=function(){function v(x,b){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];f(this,v),this.name=x,this.contents=b,this.tags=_,this.attrs=s({},u.default,{class:"feather feather-"+x})}return o(v,[{key:"toSvg",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=s({},this.attrs,b,{class:(0,l.default)(this.attrs.class,b.class)});return"<svg "+m(_)+">"+this.contents+"</svg>"}},{key:"toString",value:function(){return this.contents}}]),v}();function m(v){return Object.keys(v).map(function(x){return x+'="'+v[x]+'"'}).join(" ")}r.default=p},"./src/icons.js":function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i("./src/icon.js"),o=d(s),a=i("./dist/icons.json"),l=d(a),c=i("./src/tags.json"),u=d(c);function d(f){return f&&f.__esModule?f:{default:f}}r.default=Object.keys(l.default).map(function(f){return new o.default(f,l.default[f],u.default[f])}).reduce(function(f,p){return f[p.name]=p,f},{})},"./src/index.js":function(t,r,i){var s=i("./src/icons.js"),o=d(s),a=i("./src/to-svg.js"),l=d(a),c=i("./src/replace.js"),u=d(c);function d(f){return f&&f.__esModule?f:{default:f}}t.exports={icons:o.default,toSvg:l.default,replace:u.default}},"./src/replace.js":function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(m){for(var v=1;v<arguments.length;v++){var x=arguments[v];for(var b in x)Object.prototype.hasOwnProperty.call(x,b)&&(m[b]=x[b])}return m},o=i("./node_modules/classnames/dedupe.js"),a=u(o),l=i("./src/icons.js"),c=u(l);function u(m){return m&&m.__esModule?m:{default:m}}function d(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof document=="undefined")throw new Error("`feather.replace()` only works in a browser environment.");var v=document.querySelectorAll("[data-feather]");Array.from(v).forEach(function(x){return f(x,m)})}function f(m){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=p(m),b=x["data-feather"];delete x["data-feather"];var _=c.default[b].toSvg(s({},v,x,{class:(0,a.default)(v.class,x.class)})),M=new DOMParser().parseFromString(_,"image/svg+xml"),h=M.querySelector("svg");m.parentNode.replaceChild(h,m)}function p(m){return Array.from(m.attributes).reduce(function(v,x){return v[x.name]=x.value,v},{})}r.default=d},"./src/tags.json":function(t){t.exports={activity:["pulse","health","action","motion"],airplay:["stream","cast","mirroring"],"alert-circle":["warning","alert","danger"],"alert-octagon":["warning","alert","danger"],"alert-triangle":["warning","alert","danger"],"align-center":["text alignment","center"],"align-justify":["text alignment","justified"],"align-left":["text alignment","left"],"align-right":["text alignment","right"],anchor:[],archive:["index","box"],"at-sign":["mention","at","email","message"],award:["achievement","badge"],aperture:["camera","photo"],"bar-chart":["statistics","diagram","graph"],"bar-chart-2":["statistics","diagram","graph"],battery:["power","electricity"],"battery-charging":["power","electricity"],bell:["alarm","notification","sound"],"bell-off":["alarm","notification","silent"],bluetooth:["wireless"],"book-open":["read","library"],book:["read","dictionary","booklet","magazine","library"],bookmark:["read","clip","marker","tag"],box:["cube"],briefcase:["work","bag","baggage","folder"],calendar:["date"],camera:["photo"],cast:["chromecast","airplay"],circle:["off","zero","record"],clipboard:["copy"],clock:["time","watch","alarm"],"cloud-drizzle":["weather","shower"],"cloud-lightning":["weather","bolt"],"cloud-rain":["weather"],"cloud-snow":["weather","blizzard"],cloud:["weather"],codepen:["logo"],codesandbox:["logo"],code:["source","programming"],coffee:["drink","cup","mug","tea","cafe","hot","beverage"],columns:["layout"],command:["keyboard","cmd","terminal","prompt"],compass:["navigation","safari","travel","direction"],copy:["clone","duplicate"],"corner-down-left":["arrow","return"],"corner-down-right":["arrow"],"corner-left-down":["arrow"],"corner-left-up":["arrow"],"corner-right-down":["arrow"],"corner-right-up":["arrow"],"corner-up-left":["arrow"],"corner-up-right":["arrow"],cpu:["processor","technology"],"credit-card":["purchase","payment","cc"],crop:["photo","image"],crosshair:["aim","target"],database:["storage","memory"],delete:["remove"],disc:["album","cd","dvd","music"],"dollar-sign":["currency","money","payment"],droplet:["water"],edit:["pencil","change"],"edit-2":["pencil","change"],"edit-3":["pencil","change"],eye:["view","watch"],"eye-off":["view","watch","hide","hidden"],"external-link":["outbound"],facebook:["logo","social"],"fast-forward":["music"],figma:["logo","design","tool"],"file-minus":["delete","remove","erase"],"file-plus":["add","create","new"],"file-text":["data","txt","pdf"],film:["movie","video"],filter:["funnel","hopper"],flag:["report"],"folder-minus":["directory"],"folder-plus":["directory"],folder:["directory"],framer:["logo","design","tool"],frown:["emoji","face","bad","sad","emotion"],gift:["present","box","birthday","party"],"git-branch":["code","version control"],"git-commit":["code","version control"],"git-merge":["code","version control"],"git-pull-request":["code","version control"],github:["logo","version control"],gitlab:["logo","version control"],globe:["world","browser","language","translate"],"hard-drive":["computer","server","memory","data"],hash:["hashtag","number","pound"],headphones:["music","audio","sound"],heart:["like","love","emotion"],"help-circle":["question mark"],hexagon:["shape","node.js","logo"],home:["house","living"],image:["picture"],inbox:["email"],instagram:["logo","camera"],key:["password","login","authentication","secure"],layers:["stack"],layout:["window","webpage"],"life-bouy":["help","life ring","support"],link:["chain","url"],"link-2":["chain","url"],linkedin:["logo","social media"],list:["options"],lock:["security","password","secure"],"log-in":["sign in","arrow","enter"],"log-out":["sign out","arrow","exit"],mail:["email","message"],"map-pin":["location","navigation","travel","marker"],map:["location","navigation","travel"],maximize:["fullscreen"],"maximize-2":["fullscreen","arrows","expand"],meh:["emoji","face","neutral","emotion"],menu:["bars","navigation","hamburger"],"message-circle":["comment","chat"],"message-square":["comment","chat"],"mic-off":["record","sound","mute"],mic:["record","sound","listen"],minimize:["exit fullscreen","close"],"minimize-2":["exit fullscreen","arrows","close"],minus:["subtract"],monitor:["tv","screen","display"],moon:["dark","night"],"more-horizontal":["ellipsis"],"more-vertical":["ellipsis"],"mouse-pointer":["arrow","cursor"],move:["arrows"],music:["note"],navigation:["location","travel"],"navigation-2":["location","travel"],octagon:["stop"],package:["box","container"],paperclip:["attachment"],pause:["music","stop"],"pause-circle":["music","audio","stop"],"pen-tool":["vector","drawing"],percent:["discount"],"phone-call":["ring"],"phone-forwarded":["call"],"phone-incoming":["call"],"phone-missed":["call"],"phone-off":["call","mute"],"phone-outgoing":["call"],phone:["call"],play:["music","start"],"pie-chart":["statistics","diagram"],"play-circle":["music","start"],plus:["add","new"],"plus-circle":["add","new"],"plus-square":["add","new"],pocket:["logo","save"],power:["on","off"],printer:["fax","office","device"],radio:["signal"],"refresh-cw":["synchronise","arrows"],"refresh-ccw":["arrows"],repeat:["loop","arrows"],rewind:["music"],"rotate-ccw":["arrow"],"rotate-cw":["arrow"],rss:["feed","subscribe"],save:["floppy disk"],scissors:["cut"],search:["find","magnifier","magnifying glass"],send:["message","mail","email","paper airplane","paper aeroplane"],settings:["cog","edit","gear","preferences"],"share-2":["network","connections"],shield:["security","secure"],"shield-off":["security","insecure"],"shopping-bag":["ecommerce","cart","purchase","store"],"shopping-cart":["ecommerce","cart","purchase","store"],shuffle:["music"],"skip-back":["music"],"skip-forward":["music"],slack:["logo"],slash:["ban","no"],sliders:["settings","controls"],smartphone:["cellphone","device"],smile:["emoji","face","happy","good","emotion"],speaker:["audio","music"],star:["bookmark","favorite","like"],"stop-circle":["media","music"],sun:["brightness","weather","light"],sunrise:["weather","time","morning","day"],sunset:["weather","time","evening","night"],tablet:["device"],tag:["label"],target:["logo","bullseye"],terminal:["code","command line","prompt"],thermometer:["temperature","celsius","fahrenheit","weather"],"thumbs-down":["dislike","bad","emotion"],"thumbs-up":["like","good","emotion"],"toggle-left":["on","off","switch"],"toggle-right":["on","off","switch"],tool:["settings","spanner"],trash:["garbage","delete","remove","bin"],"trash-2":["garbage","delete","remove","bin"],triangle:["delta"],truck:["delivery","van","shipping","transport","lorry"],tv:["television","stream"],twitch:["logo"],twitter:["logo","social"],type:["text"],umbrella:["rain","weather"],unlock:["security"],"user-check":["followed","subscribed"],"user-minus":["delete","remove","unfollow","unsubscribe"],"user-plus":["new","add","create","follow","subscribe"],"user-x":["delete","remove","unfollow","unsubscribe","unavailable"],user:["person","account"],users:["group"],"video-off":["camera","movie","film"],video:["camera","movie","film"],voicemail:["phone"],volume:["music","sound","mute"],"volume-1":["music","sound"],"volume-2":["music","sound"],"volume-x":["music","sound","mute"],watch:["clock","time"],"wifi-off":["disabled"],wifi:["connection","signal","wireless"],wind:["weather","air"],"x-circle":["cancel","close","delete","remove","times","clear"],"x-octagon":["delete","stop","alert","warning","times","clear"],"x-square":["cancel","close","delete","remove","times","clear"],x:["cancel","close","delete","remove","times","clear"],youtube:["logo","video","play"],"zap-off":["flash","camera","lightning"],zap:["flash","camera","lightning"],"zoom-in":["magnifying glass"],"zoom-out":["magnifying glass"]}},"./src/to-svg.js":function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i("./src/icons.js"),o=a(s);function a(c){return c&&c.__esModule?c:{default:c}}function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(console.warn("feather.toSvg() is deprecated. Please use feather.icons[name].toSvg() instead."),!c)throw new Error("The required `key` (icon name) parameter is missing.");if(!o.default[c])throw new Error("No icon matching '"+c+"'. See the complete list of icons at https://feathericons.com");return o.default[c].toSvg(u)}r.default=l},0:function(t,r,i){i("./node_modules/core-js/es/array/from.js"),t.exports=i("./src/index.js")}})})})(uk);var v6=uk.exports;const w0=ck(v6),$w=Object.keys(w0.icons),jo={props:{name:{type:String,required:!0,validator(n){const e=$w.includes(n);return e||(console.groupCollapsed("[frappe-ui] name property for feather-icon must be one of "),console.dir($w),console.groupEnd()),e}},color:{type:String,default:null},strokeWidth:{type:Number,default:1.5}},render(){let n=w0.icons[this.name];return n||(n=w0.icons.circle),gt("svg",nn(n.attrs,{fill:"none",stroke:"currentColor",color:this.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":this.strokeWidth,width:null,height:null,class:[n.attrs.class,"shrink-0"],innerHTML:n.contents},this.$attrs))}},b6={name:"LoadingIndicator"},w6={class:"max-w-xs animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},x6=K("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),S6=K("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),_6=[x6,S6];function C6(n,e,t,r,i,s){return q(),Q("svg",w6,_6)}const k6=je(b6,[["render",C6]]),E6=["disabled","ariaLabel"],Dy=at({__name:"Button",props:{theme:{default:"gray"},size:{default:"sm"},variant:{default:"subtle"},label:{},icon:{},iconLeft:{},iconRight:{},loading:{type:Boolean,default:!1},loadingText:{},disabled:{type:Boolean,default:!1},route:{},link:{}},setup(n){const e=n,t=gy(),r=CC(),i=re(()=>{let u={gray:"text-white bg-gray-900 hover:bg-gray-800 active:bg-gray-700",blue:"text-white bg-blue-500 hover:bg-blue-600 active:bg-blue-700",green:"text-white bg-green-600 hover:bg-green-700 active:bg-green-800",red:"text-white bg-red-600 hover:bg-red-700 active:bg-red-800"}[e.theme],d={gray:"text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300",blue:"text-blue-600 bg-blue-100 hover:bg-blue-200 active:bg-blue-300",green:"text-green-800 bg-green-100 hover:bg-green-200 active:bg-green-300",red:"text-red-700 bg-red-100 hover:bg-red-200 active:bg-red-300"}[e.theme],f={gray:"text-gray-800 bg-white border border-gray-300 hover:border-gray-400 active:border-gray-400 active:bg-gray-300",blue:"text-blue-600 bg-white border border-blue-300 hover:border-blue-400 active:border-blue-400 active:bg-blue-300",green:"text-green-800 bg-white border border-green-400 hover:border-green-500 active:border-green-500 active:bg-green-300",red:"text-red-700 bg-white border border-red-300 hover:border-red-400 active:border-red-400 active:bg-red-200"}[e.theme],p={gray:"text-gray-800 bg-transparent hover:bg-gray-200 active:bg-gray-300",blue:"text-blue-600 bg-transparent hover:bg-blue-200 active:bg-blue-300",green:"text-green-800 bg-transparent hover:bg-green-200 active:bg-green-300",red:"text-red-700 bg-transparent hover:bg-red-200 active:bg-red-300"}[e.theme],m={gray:"focus-visible:ring focus-visible:ring-gray-400",blue:"focus-visible:ring focus-visible:ring-blue-400",green:"focus-visible:ring focus-visible:ring-green-400",red:"focus-visible:ring focus-visible:ring-red-400"}[e.theme],v={subtle:d,solid:u,outline:f,ghost:p}[e.variant],x=`${e.theme}-${e.variant}`,b={gray:"bg-gray-100 text-gray-500","gray-outline":"bg-gray-100 text-gray-500 border border-gray-300","gray-ghost":"text-gray-500","blue-solid":"bg-blue-300 text-white","blue-subtle":"bg-blue-100 text-blue-400","blue-outline":"bg-blue-100 text-blue-400 border border-blue-300","blue-ghost":"text-blue-400",green:"bg-green-100 text-green-500","green-outline":"bg-green-100 text-green-500 border border-green-400","green-ghost":"text-green-500",red:"bg-red-100 text-red-400","red-outline":"bg-red-100 text-red-400 border border-red-300","red-ghost":"text-red-400"},_=b[x]||b[e.theme],M={sm:"h-7 text-base px-2 rounded",md:"h-8 text-base font-medium px-2.5 rounded",lg:"h-10 text-lg font-medium px-3 rounded-md",xl:"h-11.5 text-xl font-medium px-3.5 rounded-lg","2xl":"h-13 text-2xl font-medium px-3.5 rounded-xl"}[e.size];return l.value&&(M={sm:"h-7 w-7 rounded",md:"h-8 w-8 rounded",lg:"h-10 w-10 rounded-md",xl:"h-11.5 w-11.5 rounded-lg","2xl":"h-13 w-13 rounded-xl"}[e.size]),["inline-flex items-center justify-center gap-2 transition-colors focus:outline-none",o.value?_:v,m,M]}),s=re(()=>({sm:"h-4",md:"h-4.5",lg:"h-5",xl:"h-6","2xl":"h-6"})[e.size]),o=re(()=>e.disabled||e.loading),a=re(()=>l.value?e.label:null),l=re(()=>e.icon||t.icon),c=()=>{if(e.route)return r.push(e.route);if(e.link)return window.open(e.link,"_blank")};return(u,d)=>(q(),Q("button",nn(u.$attrs,{class:i.value,onClick:c,disabled:o.value,ariaLabel:a.value}),[u.loading?(q(),dt(k6,{key:0,class:De({"h-3 w-3":u.size=="sm","h-[13.5px] w-[13.5px]":u.size=="md","h-[15px] w-[15px]":u.size=="lg","h-4.5 w-4.5":u.size=="xl"||u.size=="2xl"})},null,8,["class"])):u.$slots.prefix||u.iconLeft?Ye(u.$slots,"prefix",{key:1},()=>[u.iconLeft?(q(),dt(jo,{key:0,name:u.iconLeft,class:De(s.value),"aria-hidden":"true"},null,8,["name","class"])):He("",!0)]):He("",!0),u.loading&&u.loadingText?(q(),Q(lt,{key:2},[Zo(Ge(u.loadingText),1)],64)):l.value&&!u.loading?(q(),Q(lt,{key:3},[u.icon?(q(),dt(jo,{key:0,name:u.icon,class:De(s.value),"aria-label":u.label},null,8,["name","class","aria-label"])):u.$slots.icon?Ye(u.$slots,"icon",{key:1}):He("",!0)],64)):(q(),Q("span",{key:4,class:De({"sr-only":l.value})},[Ye(u.$slots,"default",{},()=>[Zo(Ge(u.label),1)])],2)),Ye(u.$slots,"suffix",{},()=>[u.iconRight?(q(),dt(jo,{key:0,name:u.iconRight,class:De(s.value),"aria-hidden":"true"},null,8,["name","class"])):He("",!0)])],16,E6))}}),T6={name:"Autocomplete",props:["modelValue","options","placeholder","bodyClasses","multiple","hideSearch"],emits:["update:modelValue","update:query","change"],components:{Popover:lk,Button:Dy,FeatherIcon:jo,Combobox:CD,ComboboxInput:ED,ComboboxOptions:TD,ComboboxOption:AD,ComboboxButton:kD},expose:["togglePopover"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var n,e;return this.multiple?Zl((n=this.modelValue)==null?void 0:n[0])==="value"?(e=this.modelValue)==null?void 0:e.map(t=>this.findOption(t)):this.modelValue:this.findOption(this.modelValue)},set(n){if(this.query="",n&&!this.multiple&&(this.showOptions=!1),!this.multiple){this.$emit("update:modelValue",n);return}this.$emit("update:modelValue",n)}},groups(){var e;return!this.options||this.options.length==0?[]:((e=this.options[0])!=null&&e.group?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((t,r)=>({key:r,group:t.group,hideLabel:t.hideLabel||!1,items:this.filterOptions(this.sanitizeOptions(t.items))})).filter(t=>t.items.length>0)},allOptions(){return this.groups.flatMap(n=>n.items)},areAllOptionsSelected(){var n;return this.multiple?this.allOptions.length===((n=this.selectedValue)==null?void 0:n.length):!1}},watch:{query(n){this.$emit("update:query",n)},showOptions(n){n&&Dn(()=>{var e,t;return(t=(e=this.$refs.searchInput)==null?void 0:e.$el)==null?void 0:t.focus()})}},methods:{togglePopover(n){this.showOptions=n!=null?n:!this.showOptions},findOption(n){if(!n)return n;const e=Zl(n)==="value"?n:n.value;return this.allOptions.find(t=>t.value===e)},filterOptions(n){return this.query?n.filter(e=>e.label.toLowerCase().includes(this.query.toLowerCase())||e.value.toLowerCase().includes(this.query.toLowerCase())):n},displayValue(n){return n?this.multiple?Array.isArray(n)?n.map(e=>this.getLabel(this.findOption(e))).join(", "):"":this.getLabel(this.findOption(n)):""},getLabel(n){return Zl(n)==="value"?n:(n==null?void 0:n.label)||(n==null?void 0:n.value)||"No label"},sanitizeOptions(n){return n?n.map(e=>Zl(e)==="option"?e:{label:e,value:e}):[]},isOptionSelected(n){var t,r;if(!this.selectedValue)return!1;const e=Zl(n)==="value"?n:n.value;return this.multiple?(r=this.selectedValue)==null?void 0:r.find(i=>i&&i.value===e):((t=this.selectedValue)==null?void 0:t.value)===e},selectAll(){this.selectedValue=this.allOptions},clearAll(){this.selectedValue=[]}}};function Zl(n){return typeof n=="object"?"option":"value"}const A6={class:"w-full"},M6=["onClick"],R6={class:"flex items-center overflow-hidden"},I6={key:0,class:"truncate text-base leading-5"},O6={key:1,class:"text-base leading-5 text-gray-500"},P6={key:0,class:"sticky top-0 z-10 flex items-stretch space-x-1.5 bg-white py-1.5"},D6={class:"relative w-full"},$6={key:0,class:"sticky top-10 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},N6={class:"flex flex-1 gap-2 overflow-hidden"},L6={key:0,class:"flex-shrink-0"},j6={key:1,class:"h-4 w-4"},F6={class:"flex-1 truncate"},H6={key:0,class:"ml-2 flex-shrink-0"},B6={key:0,class:"text-sm text-gray-600"},z6={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},V6={key:0,class:"border-t p-1"},q6={key:0,class:"flex items-center justify-end"};function U6(n,e,t,r,i,s){const o=mt("FeatherIcon"),a=mt("ComboboxInput"),l=mt("ComboboxOption"),c=mt("ComboboxOptions"),u=mt("Button"),d=mt("Popover"),f=mt("Combobox");return q(),dt(f,{modelValue:s.selectedValue,"onUpdate:modelValue":e[3]||(e[3]=p=>s.selectedValue=p),multiple:t.multiple,nullable:""},{default:Ue(({open:p})=>[ye(d,{class:"w-full",show:i.showOptions,"onUpdate:show":e[2]||(e[2]=m=>i.showOptions=m)},{target:Ue(({open:m,togglePopover:v})=>[Ye(n.$slots,"target",Mr(Yr({open:m,togglePopover:v})),()=>[K("div",A6,[K("button",{class:De(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 px-2 py-1 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",{"bg-gray-200":p}]),onClick:()=>v()},[K("div",R6,[Ye(n.$slots,"prefix"),s.selectedValue?(q(),Q("span",I6,Ge(s.displayValue(s.selectedValue)),1)):(q(),Q("span",O6,Ge(t.placeholder||""),1))]),ye(o,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,M6)])])]),body:Ue(({isOpen:m,togglePopover:v})=>[Xo(K("div",null,[K("div",{class:De(["relative mt-1 rounded-lg bg-white text-base shadow-2xl",t.bodyClasses])},[ye(c,{class:De(["max-h-[15rem] overflow-y-auto px-1.5 pb-1.5",{"pt-1.5":t.hideSearch}]),static:""},{default:Ue(()=>[t.hideSearch?He("",!0):(q(),Q("div",P6,[K("div",D6,[ye(a,{ref:"searchInput",class:"form-input w-full",type:"text",onChange:e[0]||(e[0]=x=>{i.query=x.target.value}),value:i.query,autocomplete:"off",placeholder:"Search"},null,8,["value"]),K("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:e[1]||(e[1]=x=>s.selectedValue=null)},[ye(o,{name:"x",class:"w-4"})])])])),(q(!0),Q(lt,null,Si(s.groups,x=>Xo((q(),Q("div",{key:x.key},[x.group&&!x.hideLabel?(q(),Q("div",$6,Ge(x.group),1)):He("",!0),(q(!0),Q(lt,null,Si(x.items.slice(0,50),(b,_)=>(q(),dt(l,{as:"template",key:(b==null?void 0:b.value)||_,value:b},{default:Ue(({active:M,selected:h})=>[K("li",{class:De(["flex cursor-pointer items-center justify-between rounded px-2.5 py-1.5 text-base",{"bg-gray-100":M}])},[K("div",N6,[n.$slots["item-prefix"]||n.$props.multiple?(q(),Q("div",L6,[Ye(n.$slots,"item-prefix",Mr(Yr({active:M,selected:h,option:b})),()=>[s.isOptionSelected(b)?(q(),dt(o,{key:0,name:"check",class:"h-4 w-4 text-gray-700"})):(q(),Q("div",j6))])])):He("",!0),K("span",F6,Ge(s.getLabel(b)),1)]),n.$slots["item-suffix"]||b!=null&&b.description?(q(),Q("div",H6,[Ye(n.$slots,"item-suffix",Mr(Yr({active:M,selected:h,option:b})),()=>[b!=null&&b.description?(q(),Q("div",B6,Ge(b.description),1)):He("",!0)])])):He("",!0)],2)]),_:2},1032,["value"]))),128))])),[[Qo,x.items.length>0]])),128)),s.groups.length==0?(q(),Q("li",z6," No results found ")):He("",!0)]),_:3},8,["class"]),n.$slots.footer||t.multiple?(q(),Q("div",V6,[Ye(n.$slots,"footer",Mr(Yr({togglePopover:v})),()=>[t.multiple?(q(),Q("div",q6,[s.areAllOptionsSelected?He("",!0):(q(),dt(u,{key:0,label:"Select All",onClick:Wa(s.selectAll,["stop"])},null,8,["onClick"])),s.areAllOptionsSelected?(q(),dt(u,{key:1,label:"Clear All",onClick:Wa(s.clearAll,["stop"])},null,8,["onClick"])):He("",!0)])):He("",!0)])])):He("",!0)],2)],512),[[Qo,m]])]),_:2},1032,["show"])]),_:3},8,["modelValue","multiple"])}const W6=je(T6,[["render",U6]]),J6=["src","alt"],Nw=at({__name:"Avatar",props:{image:{},label:{},size:{default:"md"},shape:{default:"circle"}},setup(n){const e=n,t=re(()=>({circle:"rounded-full",square:{xs:"rounded-[4px]",sm:"rounded-[5px]",md:"rounded-[5px]",lg:"rounded-[6px]",xl:"rounded-[6px]","2xl":"rounded-[8px]","3xl":"rounded-[10px]"}[e.size]})[e.shape]),r=re(()=>({xs:"w-4 h-4",sm:"w-5 h-5",md:"w-6 h-6",lg:"w-7 h-7",xl:"w-8 h-8","2xl":"w-10 h-10","3xl":"w-11.5 h-11.5"})[e.size]),i=re(()=>["font-medium",{xs:"text-2xs",sm:"text-sm",md:"text-base",lg:"text-base",xl:"text-lg","2xl":"text-xl","3xl":"text-2xl"}[e.size]]),s=re(()=>({xs:"-mr-[.1rem] -mb-[.1rem] h-2 w-2",sm:"-mr-[.1rem] -mb-[.1rem] h-[9px] w-[9px]",md:"-mr-[.1rem] -mb-[.1rem] h-2.5 w-2.5",lg:"-mr-[.1rem] -mb-[.1rem] h-3 w-3",xl:"-mr-[.1rem] -mb-[.1rem] h-3 w-3","2xl":"-mr-[.1rem] -mb-[.1rem] h-3.5 w-3.5","3xl":"-mr-[.2rem] -mb-[.2rem] h-4 w-4"})[e.size]),o=re(()=>({xs:"h-1 w-1",sm:"h-[5px] w-[5px]",md:"h-1.5 w-1.5",lg:"h-2 w-2",xl:"h-2 w-2","2xl":"h-2.5 w-2.5","3xl":"h-3 w-3"})[e.size]),a=re(()=>({xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-4 w-4",xl:"h-4 w-4","2xl":"h-5 w-5","3xl":"h-5 w-5"})[e.size]);return(l,c)=>(q(),Q("div",{class:De(["relative inline-block shrink-0",[r.value,t.value]])},[l.image?(q(),Q("img",{key:0,src:l.image,alt:l.label,class:De([t.value,"h-full w-full object-cover"])},null,10,J6)):(q(),Q("div",{key:1,class:De(["flex h-full w-full items-center justify-center bg-gray-100 uppercase text-gray-600",[i.value,t.value]])},[l.$slots.default?(q(),Q("div",{key:0,class:De(a.value)},[Ye(l.$slots,"default")],2)):(q(),Q(lt,{key:1},[Zo(Ge(l.label&&l.label[0]),1)],64))],2)),l.$slots.indicator?(q(),Q("div",{key:2,class:De(["absolute bottom-0 right-0 grid place-items-center rounded-full bg-white",s.value])},[K("div",{class:De(o.value)},[Ye(l.$slots,"indicator")],2)],2)):He("",!0)],2))}}),K6=at({__name:"Badge",props:{theme:{default:"gray"},size:{default:"md"},variant:{default:"subtle"},label:{}},setup(n){const e=n,t=re(()=>{let r={gray:"text-white bg-gray-900",blue:"text-white bg-blue-500",green:"text-white bg-green-600",orange:"text-white bg-amber-600",red:"text-white bg-red-600"}[e.theme],i={gray:"text-gray-700 bg-gray-100",blue:"text-blue-600 bg-blue-100",green:"text-green-800 bg-green-200",orange:"text-amber-700 bg-amber-100",red:"text-red-600 bg-red-100"}[e.theme],s={gray:"text-gray-700 bg-white border border-gray-300",blue:"text-blue-600 bg-white border border-blue-300",green:"text-green-800 bg-white border border-green-300",orange:"text-amber-700 bg-white border border-amber-300",red:"text-red-600 bg-white border border-red-300"}[e.theme],o={gray:"text-gray-700 bg-transparent",blue:"text-blue-600 bg-transparent",green:"text-green-800 bg-transparent",orange:"text-amber-700 bg-transparent",red:"text-red-600 bg-transparent"}[e.theme],a={subtle:i,solid:r,outline:s,ghost:o}[e.variant],l={sm:"h-4 text-xs px-1.5",md:"h-5 text-xs px-1.5",lg:"h-6 text-sm px-2"}[e.size];return[a,l]});return(r,i)=>(q(),Q("div",{class:De(["inline-flex select-none items-center gap-1 rounded-full",t.value])},[r.$slots.prefix?(q(),Q("div",{key:0,class:De([e.size=="lg"?"max-h-6":"max-h-4"])},[Ye(r.$slots,"prefix")],2)):He("",!0),Ye(r.$slots,"default",{},()=>{var s;return[Zo(Ge((s=e.label)==null?void 0:s.toString()),1)]}),r.$slots.suffix?(q(),Q("div",{key:1,class:De([e.size=="lg"?"max-h-6":"max-h-4"])},[Ye(r.$slots,"suffix")],2)):He("",!0)],2))}});var G6=!1;function dk(n){return iy()?(sy(n),!0):!1}function mn(n){return typeof n=="function"?n():we(n)}const fk=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const Y6=Object.prototype.toString,X6=n=>Y6.call(n)==="[object Object]",Z6=()=>{};function Q6(n){return n||Ws()}function e$(n,e={}){if(!Lt(n))return $_(n);const t=Array.isArray(n.value)?Array.from({length:n.value.length}):{};for(const r in n.value)t[r]=hy(()=>({get(){return n.value[r]},set(i){var s;if((s=mn(e.replaceRef))!=null?s:!0)if(Array.isArray(n.value)){const a=[...n.value];a[r]=i,n.value=a}else{const a=Te(Y({},n.value),{[r]:i});Object.setPrototypeOf(a,Object.getPrototypeOf(n.value)),n.value=a}else n.value[r]=i}}));return t}function t$(n,e=!0,t){Q6()?Et(n,t):e?n():Dn(n)}function n$(n){var e;const t=mn(n);return(e=t==null?void 0:t.$el)!=null?e:t}const Op=fk?window:void 0;function Cf(...n){let e,t,r,i;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,r,i]=n,e=Op):[e,t,r,i]=n,!e)return Z6;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,d,f,p)=>(u.addEventListener(d,f,p),()=>u.removeEventListener(d,f,p)),l=At(()=>[n$(e),mn(i)],([u,d])=>{if(o(),!u)return;const f=X6(d)?Y({},d):d;s.push(...t.flatMap(p=>r.map(m=>a(u,p,m,f))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return dk(c),c}function r$(){const n=de(!1),e=Ws();return e&&Et(()=>{n.value=!0},e),n}function i$(n){const e=r$();return re(()=>(e.value,!!n()))}function s$(n,e={}){const{window:t=Op}=e,r=i$(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let i;const s=de(!1),o=c=>{s.value=c.matches},a=()=>{i&&("removeEventListener"in i?i.removeEventListener("change",o):i.removeListener(o))},l=Yt(()=>{r.value&&(a(),i=t.matchMedia(mn(n)),"addEventListener"in i?i.addEventListener("change",o):i.addListener(o),s.value=i.matches)});return dk(()=>{l(),a(),i=void 0}),s}function o$(n,e={}){var t,r;const{pointerTypes:i,preventDefault:s,stopPropagation:o,exact:a,onMove:l,onEnd:c,onStart:u,initialValue:d,axis:f="both",draggingElement:p=Op,containerElement:m,handle:v=n}=e,x=de((t=mn(d))!=null?t:{x:0,y:0}),b=de(),_=E=>i?i.includes(E.pointerType):!0,M=E=>{mn(s)&&E.preventDefault(),mn(o)&&E.stopPropagation()},h=E=>{var g;if(mn(e.disabled)||!_(E)||mn(a)&&E.target!==mn(n))return;const I=mn(m),R=(g=I==null?void 0:I.getBoundingClientRect)==null?void 0:g.call(I),S=mn(n).getBoundingClientRect(),k={x:E.clientX-(I?S.left-R.left+I.scrollLeft:S.left),y:E.clientY-(I?S.top-R.top+I.scrollTop:S.top)};(u==null?void 0:u(k,E))!==!1&&(b.value=k,M(E))},w=E=>{if(mn(e.disabled)||!_(E)||!b.value)return;const g=mn(m),I=mn(n).getBoundingClientRect();let{x:R,y:S}=x.value;(f==="x"||f==="both")&&(R=E.clientX-b.value.x,g&&(R=Math.min(Math.max(0,R),g.scrollWidth-I.width))),(f==="y"||f==="both")&&(S=E.clientY-b.value.y,g&&(S=Math.min(Math.max(0,S),g.scrollHeight-I.height))),x.value={x:R,y:S},l==null||l(x.value,E),M(E)},y=E=>{mn(e.disabled)||!_(E)||b.value&&(b.value=void 0,c==null||c(x.value,E),M(E))};if(fk){const E={capture:(r=e.capture)!=null?r:!0};Cf(v,"pointerdown",h,E),Cf(p,"pointermove",w,E),Cf(p,"pointerup",y,E)}return Te(Y({},e$(x)),{position:x,isDragging:re(()=>!!b.value),style:re(()=>`left:${x.value.x}px;top:${x.value.y}px;`)})}function a$(n={}){const{window:e=Op,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:s=!0}=n,o=de(t),a=de(r),l=()=>{e&&(s?(o.value=e.innerWidth,a.value=e.innerHeight):(o.value=e.document.documentElement.clientWidth,a.value=e.document.documentElement.clientHeight))};if(l(),t$(l),Cf("resize",l,{passive:!0}),i){const c=s$("(orientation: portrait)");At(c,()=>l())}return{width:o,height:a}}let l$=0;function c$(){return++l$}function hk(){return"frappe-ui-"+c$()}const u$=["disabled","id","checked"],d$=["for"],f$=at({__name:"Checkbox",props:{size:{default:"sm"},label:{},checked:{type:Boolean},disabled:{type:Boolean},padding:{type:Boolean,default:!1},modelValue:{type:Boolean},id:{}},setup(n){var o;const e=n,t=nd(),r=(o=e.id)!=null?o:hk(),i=re(()=>[{sm:"text-base font-medium",md:"text-lg font-medium"}[e.size],e.disabled?"text-gray-500":"text-gray-800","select-none"]),s=re(()=>{let a=e.disabled?"border-gray-300 bg-gray-50 text-gray-400":"border-gray-500 text-gray-900 hover:border-gray-600 focus:ring-offset-0 focus:border-gray-900 active:border-gray-700 transition",l=e.disabled?"":e.padding?"focus:ring-0":"hover:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 active:bg-gray-100",c={sm:"w-3.5 h-3.5",md:"w-4 h-4"}[e.size];return[a,l,c]});return(a,l)=>(q(),Q("div",{class:De(["inline-flex items-center space-x-2 rounded transition",{"px-2.5 py-1.5":a.padding&&a.size==="sm","px-3 py-2":a.padding&&a.size==="md","focus-within:bg-gray-100 focus-within:ring-2 focus-within:ring-gray-400 hover:bg-gray-200 active:bg-gray-300":a.padding&&!a.disabled}])},[K("input",nn({class:["rounded-sm",s.value],type:"checkbox",disabled:a.disabled,id:we(r),checked:!!a.modelValue,onChange:l[0]||(l[0]=c=>a.$emit("update:modelValue",c.target.checked))},we(t)),null,16,u$),a.label?(q(),Q("label",{key:0,class:De(["block",i.value]),for:we(r)},Ge(a.label),11,d$)):He("",!0)],2))}});function $y(n,e,t){var r;return function(){var i=this,s=arguments,o=function(){r=void 0,t||n.apply(i,s)},a=t&&!r;clearTimeout(r),r=window.setTimeout(o,e),a&&n.apply(i,s)}}const h$={name:"Input",inheritAttrs:!1,expose:["getInputValue"],components:{FeatherIcon:jo},props:{label:{type:String},type:{type:String,default:"text",validator(n){let e=["text","number","checkbox","textarea","select","email","password","date"].includes(n);return e||console.warn(`Invalid value "${n}" for "type" prop for Input`),e}},modelValue:{type:[String,Number,Boolean,Object,Array]},inputClass:{type:[String,Array,Object]},debounce:{type:Number},options:{type:Array},disabled:{type:Boolean},rows:{type:Number,default:3},placeholder:{type:String},iconLeft:{type:String}},emits:["input","change","update:modelValue"],methods:{focus(){this.$refs.input.focus()},blur(){this.$refs.input.blur()},getInputValue(n){let e=n?n.target:this.$refs.input,t=e.value;return this.type=="checkbox"&&(t=e.checked),t}},computed:{passedInputValue(){return"value"in this.$attrs?this.$attrs.value:this.modelValue||null},inputAttributes(){let n={},e=t=>{this.$emit("input",this.getInputValue(t))};return this.debounce&&(e=$y(e,this.debounce)),this.type=="checkbox"&&(n.checked=this.passedInputValue),Object.assign(n,this.$attrs,{onInput:e,onChange:t=>{this.$emit("change",this.getInputValue(t)),this.$emit("update:modelValue",this.getInputValue(t))}})},selectOptions(){return this.options.map(n=>typeof n=="string"?{label:n,value:n}:n).filter(Boolean)},isNormalInput(){return["text","number","checkbox","email","password","date"].includes(this.type)}}},p$={key:0,class:"mb-2 block text-sm leading-4 text-gray-700"},m$=["type","disabled","placeholder","value"],g$=["placeholder","value","disabled","rows"],y$=["disabled"],v$=["value","disabled","selected"],b$={key:1,class:"ml-2 inline-block text-base leading-4"};function w$(n,e,t,r,i,s){const o=mt("FeatherIcon");return q(),Q("label",{class:De([t.type=="checkbox"?"flex":"block",n.$attrs.class])},[t.label&&t.type!="checkbox"?(q(),Q("span",p$,Ge(t.label),1)):He("",!0),K("div",{class:De(["relative flex",{"items-center":s.isNormalInput||t.type=="select"}])},[t.iconLeft&&t.type!="checkbox"?(q(),dt(o,{key:0,name:t.iconLeft,class:De(["absolute mx-2 h-4 w-4 text-gray-600",{"mt-2":t.type=="textarea"}])},null,8,["name","class"])):He("",!0),s.isNormalInput?(q(),Q("input",nn({key:1},s.inputAttributes,{class:["border-gray-400 placeholder-gray-500",[{"form-input block w-full":t.type!="checkbox","form-checkbox":t.type=="checkbox","pl-8":t.iconLeft&&t.type!="checkbox"},t.inputClass]],ref:"input",type:t.type||"text",disabled:t.disabled,placeholder:t.placeholder,value:s.passedInputValue}),null,16,m$)):He("",!0),t.type==="textarea"?(q(),Q("textarea",nn({key:2},s.inputAttributes,{placeholder:t.placeholder,class:["placeholder-gray-500",["form-textarea block w-full resize-none",t.inputClass,{"pl-8":t.iconLeft}]],ref:"input",value:s.passedInputValue,disabled:t.disabled,rows:t.rows}),null,16,g$)):He("",!0),t.type==="select"?(q(),Q("select",nn({key:3},s.inputAttributes,{class:["form-select block w-full",{"pl-8":t.iconLeft}],ref:"input",disabled:t.disabled}),[(q(!0),Q(lt,null,Si(s.selectOptions,a=>(q(),Q("option",{key:a.value,value:a.value,disabled:a.disabled||!1,selected:s.passedInputValue===a.value},Ge(a.label),9,v$))),128))],16,y$)):He("",!0)],2),t.label&&t.type=="checkbox"?(q(),Q("span",b$,Ge(t.label),1)):He("",!0)],2)}const x$=je(h$,[["render",w$]]),S$={name:"Dialog",props:{modelValue:{type:Boolean,required:!0},options:{type:Object,default(){return{}}}},emits:["update:modelValue","close","after-leave"],components:{HDialog:ZD,DialogPanel:QD,DialogTitle:e4,TransitionChild:XC,TransitionRoot:ZC,Button:Dy,FeatherIcon:jo},data(){return{dialogActions:[]}},watch:{"options.actions":{handler(n){n&&(this.dialogActions=n.map(e=>{let t=de(!1);return Te(Y({},e),{loading:t,onClick:e.onClick?()=>Zt(this,null,function*(){t.value=!0;try{yield e.onClick(this.close)}finally{t.value=!1}}):this.close})}))},immediate:!0}},methods:{close(){this.open=!1}},computed:{open:{get(){return this.modelValue},set(n){this.$emit("update:modelValue",n),n||this.$emit("close")}},icon(){var e;if(!((e=this.options)!=null&&e.icon))return null;let n=this.options.icon;return typeof n=="string"&&(n={name:n}),n},dialogPositionClasses(){var e;let n=((e=this.options)==null?void 0:e.position)||"center";return{"justify-center":n==="center","pt-[20vh]":n==="top"}}}},_$=["data-dialog"],C$={class:"bg-white px-4 pb-6 pt-5 sm:px-6"},k$={class:"flex"},E$={class:"w-full flex-1"},T$={class:"mb-6 flex items-center justify-between"},A$={class:"flex items-center space-x-2"},M$={class:"text-2xl font-semibold leading-6 text-gray-900"},R$=K("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[K("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.8567 3.85355C13.052 3.65829 13.052 3.34171 12.8567 3.14645C12.6615 2.95118 12.3449 2.95118 12.1496 3.14645L8.00201 7.29405L3.85441 3.14645C3.65914 2.95118 3.34256 2.95118 3.1473 3.14645C2.95204 3.34171 2.95204 3.65829 3.1473 3.85355L7.29491 8.00116L3.14645 12.1496C2.95118 12.3449 2.95118 12.6615 3.14645 12.8567C3.34171 13.052 3.65829 13.052 3.85355 12.8567L8.00201 8.70827L12.1505 12.8567C12.3457 13.052 12.6623 13.052 12.8576 12.8567C13.0528 12.6615 13.0528 12.3449 12.8576 12.1496L8.70912 8.00116L12.8567 3.85355Z",fill:"#383838"})],-1),I$={key:0,class:"text-p-base text-gray-700"},O$={key:0,class:"px-4 pb-7 pt-4 sm:px-6"},P$={class:"space-y-2"};function D$(n,e,t,r,i,s){const o=mt("TransitionChild"),a=mt("FeatherIcon"),l=mt("DialogTitle"),c=mt("Button"),u=mt("DialogPanel"),d=mt("HDialog"),f=mt("TransitionRoot");return q(),dt(f,{as:"template",show:s.open,onAfterLeave:e[0]||(e[0]=p=>n.$emit("after-leave"))},{default:Ue(()=>[ye(d,{as:"div",class:"fixed inset-0 z-10 overflow-y-auto",onClose:s.close},{default:Ue(()=>[K("div",{class:De(["flex min-h-screen flex-col items-center px-4 py-4 text-center",s.dialogPositionClasses])},[ye(o,{as:"template",enter:"ease-out duration-150","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-150","leave-from":"opacity-100","leave-to":"opacity-0"},{default:Ue(()=>[K("div",{class:"fixed inset-0 bg-black-overlay-200 transition-opacity","data-dialog":t.options.title},null,8,_$)]),_:1}),ye(o,{as:"template",enter:"ease-out duration-150","enter-from":"opacity-50 translate-y-2 scale-95","enter-to":"opacity-100 translate-y-0 scale-100",leave:"ease-in duration-150","leave-from":"opacity-100 translate-y-0 scale-100","leave-to":"opacity-50 translate-y-4 translate-y-4 scale-95"},{default:Ue(()=>[ye(u,{class:De(["my-8 inline-block w-full transform overflow-hidden rounded-xl bg-white text-left align-middle shadow-xl transition-all",{"max-w-7xl":t.options.size==="7xl","max-w-6xl":t.options.size==="6xl","max-w-5xl":t.options.size==="5xl","max-w-4xl":t.options.size==="4xl","max-w-3xl":t.options.size==="3xl","max-w-2xl":t.options.size==="2xl","max-w-xl":t.options.size==="xl","max-w-lg":t.options.size==="lg"||!t.options.size,"max-w-md":t.options.size==="md","max-w-sm":t.options.size==="sm","max-w-xs":t.options.size==="xs"}])},{default:Ue(()=>[Ye(n.$slots,"body",{},()=>[Ye(n.$slots,"body-main",{},()=>[K("div",C$,[K("div",k$,[K("div",E$,[K("div",T$,[K("div",A$,[s.icon?(q(),Q("div",{key:0,class:De(["flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full",{"bg-gray-100":!s.icon.appearance,"bg-yellow-100":s.icon.appearance==="warning","bg-blue-100":s.icon.appearance==="info","bg-red-100":s.icon.appearance==="danger","bg-green-100":s.icon.appearance==="success"}])},[ye(a,{name:s.icon.name,class:De(["h-4 w-4",{"text-gray-600":!s.icon.appearance,"text-yellow-600":s.icon.appearance==="warning","text-blue-600":s.icon.appearance==="info","text-red-600":s.icon.appearance==="danger","text-green-600":s.icon.appearance==="success"}]),"aria-hidden":"true"},null,8,["name","class"])],2)):He("",!0),ye(l,{as:"header"},{default:Ue(()=>[Ye(n.$slots,"body-title",{},()=>[K("h3",M$,Ge(t.options.title||"Untitled"),1)])]),_:3})]),ye(c,{variant:"ghost",onClick:s.close},{icon:Ue(()=>[R$]),_:1},8,["onClick"])]),Ye(n.$slots,"body-content",{},()=>[t.options.message?(q(),Q("p",I$,Ge(t.options.message),1)):He("",!0)])])])])]),i.dialogActions.length||n.$slots.actions?(q(),Q("div",O$,[Ye(n.$slots,"actions",Mr(Yr({close:s.close})),()=>[K("div",P$,[(q(!0),Q(lt,null,Si(i.dialogActions,p=>(q(),dt(c,nn({class:"w-full",key:p.label},p),{default:Ue(()=>[Zo(Ge(p.label),1)]),_:2},1040))),128))])])])):He("",!0)])]),_:3},8,["class"])]),_:3})],2)]),_:3},8,["onClose"])]),_:3},8,["show"])}const $$=je(S$,[["render",D$]]),N$={name:"ErrorMessage",props:["message"],computed:{errorMessage(){return this.message?this.message instanceof Error?this.message.messages||this.message.message:this.message:""}}},L$=["innerHTML"];function j$(n,e,t,r,i,s){return t.message?(q(),Q("div",{key:0,class:"whitespace-pre-line text-sm text-red-600",role:"alert",innerHTML:s.errorMessage},null,8,L$)):He("",!0)}const F$=je(N$,[["render",j$]]),H$={class:"relative flex items-center"},B$=["type","placeholder","disabled","id","value"],pk=at({__name:"TextInput",props:{type:{default:"text"},size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{}},emits:["update:modelValue"],setup(n,{expose:e,emit:t}){const r=n,i=t,s=gy(),o=nd(),a=de(null);e({el:a});const l=re(()=>r.disabled?"text-gray-600":"text-gray-800"),c=re(()=>{let m={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[r.size],v={sm:["py-1.5",s.prefix?"pl-8":"pl-2",s.suffix?"pr-8":"pr-2"],md:["py-1.5",s.prefix?"pl-9":"pl-2.5",s.suffix?"pr-9":"pr-2.5"],lg:["py-1.5",s.prefix?"pl-10":"pl-3",s.suffix?"pr-10":"pr-3"],xl:["py-1.5",s.prefix?"pl-10":"pl-3",s.suffix?"pr-10":"pr-3"]}[r.size],x=r.disabled?"disabled":r.variant,b={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",r.variant==="outline"?"border-gray-300":"border-transparent"]}[x];return[m,v,b,l.value,"transition-colors w-full"]});let u=re(()=>({sm:"pl-2",md:"pl-2.5",lg:"pl-3",xl:"pl-3"})[r.size]),d=re(()=>({sm:"pr-2",md:"pr-2.5",lg:"pr-3",xl:"pr-3"})[r.size]),f=m=>{i("update:modelValue",m)};r.debounce&&(f=$y(f,r.debounce));let p=m=>{f(m.target.value)};return(m,v)=>(q(),Q("div",H$,[m.$slots.prefix?(q(),Q("div",{key:0,class:De(["absolute inset-y-0 left-0 flex items-center",l.value,we(u)])},[Ye(m.$slots,"prefix")],2)):He("",!0),K("input",nn({ref_key:"inputRef",ref:a,type:m.type,placeholder:m.placeholder,class:c.value,disabled:m.disabled,id:m.id,value:m.modelValue,onInput:v[0]||(v[0]=(...x)=>we(p)&&we(p)(...x)),onChange:v[1]||(v[1]=(...x)=>we(p)&&we(p)(...x))},we(o)),null,16,B$),m.$slots.suffix?(q(),Q("div",{key:1,class:De(["absolute inset-y-0 right-0 flex items-center",l.value,we(d)])},[Ye(m.$slots,"suffix")],2)):He("",!0)]))}}),z$={class:"relative flex items-center"},V$=["disabled","id","value"],q$=["value","disabled","selected"],U$=at({inheritAttrs:!1,__name:"Select",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},options:{}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,r=e;gy();const i=nd();function s(f){r("update:modelValue",f.target.value)}const o=re(()=>{var f;return((f=t.options)==null?void 0:f.map(p=>typeof p=="string"?{label:p,value:p}:p).filter(Boolean))||[]}),a=re(()=>t.disabled?"text-gray-500":"text-gray-800"),l=re(()=>({sm:"text-base",md:"text-base",lg:"text-lg",xl:"text-xl"})[t.size]),c=re(()=>({sm:"px-2",md:"px-2.5",lg:"px-3",xl:"px-3"})[t.size]),u=re(()=>{let f={sm:"rounded h-7",md:"rounded h-8",lg:"rounded-md h-10",xl:"rounded-md h-10"}[t.size],p=t.disabled?"disabled":t.variant,m={subtle:"border border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white hover:border-gray-400 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",ghost:"bg-transparent border-transparent hover:bg-gray-200 focus:bg-gray-200 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border",t.variant!=="ghost"?"bg-gray-50":"",t.variant==="outline"?"border-gray-300":"border-transparent"]}[p];return[f,l.value,c.value,m,a.value,"transition-colors w-full py-0"]});let d=re(()=>({sm:"pl-2",md:"pl-2.5",lg:"pl-3",xl:"pl-3"})[t.size]);return(f,p)=>(q(),Q("div",z$,[f.$slots.prefix?(q(),Q("div",{key:0,class:De(["absolute inset-y-0 left-0 flex items-center",a.value,we(d)])},[Ye(f.$slots,"prefix")],2)):He("",!0),f.placeholder?Xo((q(),Q("div",{key:1,class:De(["pointer-events-none absolute text-gray-500",[l.value,c.value]])},Ge(f.placeholder),3)),[[Qo,!f.modelValue]]):He("",!0),K("select",nn({class:u.value,disabled:f.disabled,id:f.id,value:f.modelValue,onChange:s},we(i)),[(q(!0),Q(lt,null,Si(o.value,m=>(q(),Q("option",{key:m.value,value:m.value,disabled:m.disabled||!1,selected:f.modelValue===m.value},Ge(m.label),9,q$))),128))],16,V$)]))}}),W$=["placeholder","disabled","id","value","rows"],J$=at({__name:"Textarea",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{},rows:{default:3}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,r=e,i=nd(),s=re(()=>{let l={sm:"text-base rounded",md:"text-base rounded",lg:"text-lg rounded-md",xl:"text-xl rounded-md"}[t.size],c={sm:["py-1.5 px-2"],md:["py-1.5 px-2.5"],lg:["py-1.5 px-3"],xl:["py-1.5 px-3"]}[t.size],u=t.disabled?"disabled":t.variant,d={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",t.variant==="outline"?"border-gray-300":"border-transparent"]}[u];return[l,c,d,t.disabled?"text-gray-600":"text-gray-800","transition-colors w-full block"]});let o=l=>{r("update:modelValue",l)};t.debounce&&(o=$y(o,t.debounce));let a=l=>{o(l.target.value)};return(l,c)=>(q(),Q("textarea",nn({placeholder:l.placeholder,class:s.value,disabled:l.disabled,id:l.id,value:l.modelValue,rows:l.rows,onInput:c[0]||(c[0]=(...u)=>we(a)&&we(a)(...u)),onChange:c[1]||(c[1]=(...u)=>we(a)&&we(a)(...u))},we(i)),null,16,W$))}}),K$=["for"],G$={inheritAttrs:!1},Y$=at(Te(Y({},G$),{__name:"FormControl",props:{label:{},description:{},type:{default:"text"},size:{default:"sm"}},setup(n){const e=hk(),t=n,r=nd(),i=re(()=>{let a={};for(let l in r)l!=="class"&&l!=="style"&&(a[l]=r[l]);return a}),s=re(()=>[{sm:"text-xs",md:"text-base"}[t.size],"text-gray-600"]),o=re(()=>[{sm:"text-xs",md:"text-base"}[t.size],"text-gray-600"]);return(a,l)=>a.type!="checkbox"?(q(),Q("div",{key:0,class:De(["space-y-1.5",we(r).class])},[a.label?(q(),Q("label",{key:0,class:De(["block",s.value]),for:we(e)},Ge(a.label),11,K$)):He("",!0),a.type==="select"?(q(),dt(U$,nn({key:1,id:we(e)},Te(Y({},i.value),{size:a.size})),xm({_:2},[a.$slots.prefix?{name:"prefix",fn:Ue(()=>[Ye(a.$slots,"prefix")]),key:"0"}:void 0]),1040,["id"])):a.type==="autocomplete"?(q(),dt(W6,Mr(nn({key:2},Y({},i.value))),xm({_:2},[a.$slots.prefix?{name:"prefix",fn:Ue(()=>[Ye(a.$slots,"prefix")]),key:"0"}:void 0,a.$slots["item-prefix"]?{name:"item-prefix",fn:Ue(c=>[Ye(a.$slots,"item-prefix",Mr(Yr(c)))]),key:"1"}:void 0]),1040)):a.type==="textarea"?(q(),dt(J$,nn({key:3,id:we(e)},Te(Y({},i.value),{size:a.size})),null,16,["id"])):(q(),dt(pk,nn({key:4,id:we(e)},Te(Y({},i.value),{type:a.type,size:a.size})),xm({_:2},[a.$slots.prefix?{name:"prefix",fn:Ue(()=>[Ye(a.$slots,"prefix")]),key:"0"}:void 0,a.$slots.suffix?{name:"suffix",fn:Ue(()=>[Ye(a.$slots,"suffix")]),key:"1"}:void 0]),1040,["id"])),Ye(a.$slots,"description",{},()=>[a.description?(q(),Q("p",{key:0,class:De(o.value)},Ge(a.description),3)):He("",!0)])],2)):(q(),dt(f$,nn({key:1,id:we(e)},Te(Y({},i.value),{label:a.label,size:a.size,class:we(r).class})),null,16,["id"]))}}));function an(n){this.content=n}an.prototype={constructor:an,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(t||n,e):(s[i+1]=e,t&&(s[i]=t)),new an(s)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new an(t)},addToStart:function(n,e){return new an([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new an(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,e,t),new an(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=an.from(n),n.size?new an(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=an.from(n),n.size?new an(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=an.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};an.from=function(n){if(n instanceof an)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new an(e)};function mk(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=mk(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function gk(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=gk(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let Je=class An{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new An(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new An(r,i)}cutByIndex(e,t){return e==t?An.empty:e==0&&t==this.content.length?this:new An(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new An(i,s)}addToStart(e){return new An([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new An(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return mk(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return gk(this,e,t,r)}findIndex(e,t=-1){if(e==0)return zd(0,e);if(e==this.size)return zd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?zd(r+1,o):zd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return An.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new An(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return An.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new An(t||e,r)}static from(e){if(!e)return An.empty;if(e instanceof An)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new An([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};Je.empty=new Je([],0);const $m={index:0,offset:0};function zd(n,e){return $m.index=n,$m.offset=e,$m}function bh(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!bh(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!bh(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let kr=class x0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&bh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return x0.none;if(e instanceof x0)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};kr.none=[];let wh=class extends Error{},Be=class Ea{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=vk(this.content,e+this.openStart,t);return r&&new Ea(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Ea(yk(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Ea.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ea(Je.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new Ea(e,r,i)}};Be.empty=new Be(Je.empty,0,0);function yk(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(yk(s.content,e-i-1,t-i-1)))}function vk(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=vk(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}function X$(n,e,t){if(t.openStart>n.depth)throw new wh("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new wh("Inconsistent open depths");return bk(n,e,t,0)}function bk(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=bk(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Ho(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=Z$(t,n);return Ho(s,xk(n,o,a,e,r))}else return Ho(s,xh(n,e,r))}function wk(n,e){if(!e.type.compatibleContent(n.type))throw new wh("Cannot join "+e.type.name+" onto "+n.type.name)}function S0(n,e,t){let r=n.node(t);return wk(r,e.node(t)),r}function Fo(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Qc(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&(Fo(n.nodeAfter,r),s++));for(let a=s;a<o;a++)Fo(i.child(a),r);e&&e.depth==t&&e.textOffset&&Fo(e.nodeBefore,r)}function Ho(n,e){return n.type.checkContent(e),n.copy(e)}function xk(n,e,t,r,i){let s=n.depth>i&&S0(n,e,i+1),o=r.depth>i&&S0(t,r,i+1),a=[];return Qc(null,n,i,a),s&&o&&e.index(i)==t.index(i)?(wk(s,o),Fo(Ho(s,xk(n,e,t,r,i+1)),a)):(s&&Fo(Ho(s,xh(n,e,i+1)),a),Qc(e,t,i,a),o&&Fo(Ho(o,xh(t,r,i+1)),a)),Qc(r,null,i,a),new Je(a)}function xh(n,e,t){let r=[];if(Qc(null,n,t,r),n.depth>t){let i=S0(n,e,t+1);Fo(Ho(i,xh(n,e,t+1)),r)}return Qc(e,null,t,r),new Je(r)}function Z$(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(Je.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}let Lw=class _0{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return kr.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new e5(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new _0(t,r,s)}static resolveCached(e,t){for(let i=0;i<Nm.length;i++){let s=Nm[i];if(s.pos==t&&s.doc==e)return s}let r=Nm[Lm]=_0.resolve(e,t);return Lm=(Lm+1)%Q$,r}},Nm=[],Lm=0,Q$=12,e5=class{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}};const t5=Object.create(null);let Sk=class C0{constructor(e,t,r,i=kr.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||Je.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&bh(this.attrs,t||e.defaultAttrs||t5)&&kr.sameSet(this.marks,r||kr.none)}copy(e=null){return e==this.content?this:new C0(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new C0(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return Be.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new Be(c,i.depth-o,s.depth-o)}replace(e,t,r){return X$(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Lw.resolveCached(this,e)}resolveNoCache(e){return Lw.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),n5(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=Je.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=kr.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!kr.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=Je.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};Sk.prototype.text=void 0;function n5(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}function r5(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function i5(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function s5(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new o5(n[t]);return e}let o5=class{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}},a5=class _k{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=s5(i.attrs),this.excluded=null;let s=r5(this.attrs);this.instance=s?new kr(this,s):null}create(e=null){return!e&&this.instance?this.instance:new kr(this,i5(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new _k(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}};const Ck=65535,kk=Math.pow(2,16);function l5(n,e){return n+e*kk}function jw(n){return n&Ck}function c5(n){return(n-(n&Ck))/kk}const Ek=1,Tk=2,kf=4,Ak=8;let k0=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Ak)>0}get deletedBefore(){return(this.delInfo&(Ek|kf))>0}get deletedAfter(){return(this.delInfo&(Tk|kf))>0}get deletedAcross(){return(this.delInfo&kf)>0}},bl=class Ta{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ta.empty)return Ta.empty}recover(e){let t=0,r=jw(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+c5(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:l5(a/3,e-l),v=e==l?Tk:e==d?Ek:kf;return(t<0?e!=l:e!=d)&&(v|=Ak),new k0(p,v,m)}i+=u-c}return r?e+i:new k0(e+i,0,null)}touches(e,t){let r=0,i=jw(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Ta(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ta.empty:new Ta(e<0?[0,-e,0]:[0,0,e])}};bl.empty=new bl([]);let u5=class Ef{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new Ef(this.maps,this.mirror,e,t)}copy(){return new Ef(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Ef;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new k0(e,i,null)}};const jm=Object.create(null);let ir=class{getMap(){return bl.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=jm[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in jm)throw new RangeError("Duplicate use of step JSON ID "+e);return jm[e]=t,t.prototype.jsonID=e,t}},Kn=class ac{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ac(e,null)}static fail(e){return new ac(null,e)}static fromReplace(e,t,r,i){try{return ac.ok(e.replace(t,r,i))}catch(s){if(s instanceof wh)return ac.fail(s.message);throw s}}};function Ny(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(Ny(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return Je.fromArray(r)}let Ly=class lc extends ir{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new Be(Ny(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Kn.fromReplace(e,this.from,this.to,s)}invert(){return new cd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new lc(t.pos,r.pos,this.mark)}merge(e){return e instanceof lc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new lc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new lc(t.from,t.to,e.markFromJSON(t.mark))}};ir.jsonID("addMark",Ly);let cd=class cc extends ir{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Be(Ny(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Kn.fromReplace(e,this.from,this.to,r)}invert(){return new Ly(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new cc(t.pos,r.pos,this.mark)}merge(e){return e instanceof cc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new cc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new cc(t.from,t.to,e.markFromJSON(t.mark))}};ir.jsonID("removeMark",cd);let jy=class uc extends ir{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Kn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Kn.fromReplace(e,this.pos,this.pos+1,new Be(Je.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new uc(this.pos,t.marks[i]);return new uc(this.pos,this.mark)}}return new Fy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new uc(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new uc(t.pos,e.markFromJSON(t.mark))}};ir.jsonID("addNodeMark",jy);let Fy=class E0 extends ir{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Kn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Kn.fromReplace(e,this.pos,this.pos+1,new Be(Je.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new jy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new E0(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new E0(t.pos,e.markFromJSON(t.mark))}};ir.jsonID("removeNodeMark",Fy);let Ys=class co extends ir{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&T0(e,this.from,this.to)?Kn.fail("Structure replace would overwrite content"):Kn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new bl([this.from,this.to-this.from,this.slice.size])}invert(e){return new co(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new co(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof co)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Be.empty:new Be(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new co(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Be.empty:new Be(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new co(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new co(t.from,t.to,Be.fromJSON(e,t.slice),!!t.structure)}};ir.jsonID("replace",Ys);let fa=class Tf extends ir{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(T0(e,this.from,this.gapFrom)||T0(e,this.gapTo,this.to)))return Kn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Kn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Kn.fromReplace(e,this.from,this.to,r):Kn.fail("Content does not fit in gap")}getMap(){return new bl([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Tf(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new Tf(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Tf(t.from,t.to,t.gapFrom,t.gapTo,Be.fromJSON(e,t.slice),t.insert,!!t.structure)}};ir.jsonID("replaceAround",fa);function T0(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function d5(n,e,t,r){let i=[],s=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=r.addToSet(d);for(let v=0;v<d.length;v++)d[v].isInSet(m)||(o&&o.to==f&&o.mark.eq(d[v])?o.to=p:i.push(o=new cd(f,p,d[v])));a&&a.to==f?a.to=p:s.push(a=new Ly(f,p,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function f5(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof a5){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let p=0;p<i.length;p++){let m=i[p];m.step==s-1&&d.eq(i[p].style)&&(f=m)}f?(f.to=c,f.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>n.step(new cd(o.from,o.to,o.style)))}function h5(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new Ys(o,c,Be.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new cd(o,c,l.marks[d]))}o=c}if(!r.validEnd){let a=r.fillBefore(Je.empty,!0);n.replace(o,o,new Be(a,0,0))}for(let a=s.length-1;a>=0;a--)n.step(s[a])}function p5(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=Je.empty,d=0;for(let m=s,v=!1;m>t;m--)v||r.index(m)>0?(v=!0,u=Je.from(r.node(m).copy(u)),d++):l--;let f=Je.empty,p=0;for(let m=s,v=!1;m>t;m--)v||i.after(m+1)<i.end(m)?(v=!0,f=Je.from(i.node(m).copy(f)),p++):c++;n.step(new fa(l,c,o,a,new Be(u.append(f),d,p),u.size-d,!0))}function m5(n,e,t){let r=Je.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Je.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new fa(i,s,i,s,new Be(r,0,0),t.length,!0))}function g5(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&y5(n.doc,n.mapping.slice(s).map(a),r)){n.clearIncompatible(n.mapping.slice(s).map(a,1),r);let l=n.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return n.step(new fa(c,u,c+1,u-1,new Be(Je.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function y5(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function v5(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new fa(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new Be(Je.from(o),0,0),1,!0))}function b5(n,e,t=1,r){let i=n.doc.resolve(e),s=Je.empty,o=Je.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){s=Je.from(i.node(a).copy(s));let u=r&&r[c];o=Je.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new Ys(e,e,new Be(s.append(o),t,t),!0))}function w5(n,e,t){let r=new Ys(e-t,e+t,Be.empty,!0);n.step(r)}function x5(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function S5(n,e,t=e,r=Be.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return Mk(i,s,r)?new Ys(e,t,r):new _5(i,s,r).fit()}function Mk(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let _5=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=Je.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Je.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new Be(s,o,a);return e>-1?new fa(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Ys(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Fm(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(Je.from(o),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Fm(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Be(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Fm(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new Be(dc(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new Be(dc(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let v=0;v<i.childCount;v++)u.push(i.child(v));d=d.matchFragment(i)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),x=d.matchType(v.type);if(!x)break;c++,(c>1||l==0||v.content.size)&&(d=x,u.push(Rk(v.mark(f.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=fc(this.placed,t,Je.from(u)),this.frontier[t].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=a;v<p;v++){let b=x.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),x=b.content}this.unplaced=m?e==0?Be.empty:new Be(dc(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new Be(dc(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Hm(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Hm(e,t,i,r,s);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Hm(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=fc(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=fc(this.placed,this.depth,Je.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(Je.empty,!0);t.childCount&&(this.placed=fc(this.placed,this.frontier.length,t))}};function dc(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(dc(n.firstChild.content,e-1,t)))}function fc(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(fc(n.lastChild.content,e-1,t)))}function Fm(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Rk(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Rk(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(Je.empty,!0)))),n.copy(r)}function Hm(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!C5(t,s.content,o)?a:null}function C5(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function k5(n){return n.spec.defining||n.spec.definingForContent}function E5(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(Mk(i,s,r))return n.step(new Ys(e,t,r));let o=Ok(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let f=i.depth,p=i.pos-1;f>0;f--,p--){let m=i.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(f)>-1?a=f:i.before(f)==p&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f].type,m=k5(p);if(m&&i.node(l).type!=p)u=f;else if(m||!p.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),m=c[p];if(m)for(let v=0;v<o.length;v++){let x=o[(v+l)%o.length],b=!0;x<0&&(b=!1,x=-x);let _=i.node(x-1),M=i.index(x-1);if(_.canReplaceWith(M,M,m.type,m.marks))return n.replace(i.before(x),b?s.after(x):t,new Be(Ik(r.content,0,r.openStart,p),p,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let p=o[f];p<0||(e=i.before(p),t=s.after(p))}}function Ik(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(Ik(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(Je.empty,!0))}return n}function T5(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=x5(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new Be(Je.from(r),0,0))}function A5(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=Ok(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function Ok(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}let Pk=class Af extends ir{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Kn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Kn.fromReplace(e,this.pos,this.pos+1,new Be(Je.from(i),0,t.isLeaf?0:1))}getMap(){return bl.empty}invert(e){return new Af(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Af(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Af(t.pos,t.attr,t.value)}};ir.jsonID("attr",Pk);let wl=class extends Error{};wl=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};wl.prototype=Object.create(Error.prototype);wl.prototype.constructor=wl;wl.prototype.name="TransformError";let M5=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new u5}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new wl(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=Be.empty){let i=S5(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new Be(Je.from(r),0,0))}delete(e,t){return this.replace(e,t,Be.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return E5(this,e,t,r),this}replaceRangeWith(e,t,r){return T5(this,e,t,r),this}deleteRange(e,t){return A5(this,e,t),this}lift(e,t){return p5(this,e,t),this}join(e,t=1){return w5(this,e,t),this}wrap(e,t){return m5(this,e,t),this}setBlockType(e,t=e,r,i=null){return g5(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return v5(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new Pk(e,t,r)),this}addNodeMark(e,t){return this.step(new jy(e,t)),this}removeNodeMark(e,t){if(!(t instanceof kr)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Fy(e,t)),this}split(e,t=1,r){return b5(this,e,t,r),this}addMark(e,t,r){return d5(this,e,t,r),this}removeMark(e,t,r){return f5(this,e,t,r),this}clearIncompatible(e,t,r){return h5(this,e,t,r),this}};const Bm=Object.create(null);let wt=class{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new R5(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Be.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?Be.empty:t),a==0&&Bw(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Bw(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new qt(e):Aa(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?Aa(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):Aa(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new eu(e.node(0))}static atStart(e){return Aa(e,e,0,0,1)||new eu(e)}static atEnd(e){return Aa(e,e,e.content.size,e.childCount,-1)||new eu(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Bm[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Bm)throw new RangeError("Duplicate use of selection JSON ID "+e);return Bm[e]=t,t.prototype.jsonID=e,t}getBookmark(){return qt.between(this.$anchor,this.$head).getBookmark()}};wt.prototype.visible=!0;let R5=class{constructor(e,t){this.$from=e,this.$to=t}},Fw=!1;function Hw(n){!Fw&&!n.parent.inlineContent&&(Fw=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}let qt=class hc extends wt{constructor(e,t=e){Hw(e),Hw(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return wt.near(r);let i=e.resolve(t.map(this.anchor));return new hc(i.parent.inlineContent?i:r,r)}replace(e,t=Be.empty){if(super.replace(e,t),t==Be.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof hc&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Dk(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new hc(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=wt.findFrom(t,r,!0)||wt.findFrom(t,-r,!0);if(s)t=s.$head;else return wt.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(wt.findFrom(e,-r,!0)||wt.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new hc(e,t)}};wt.jsonID("text",qt);let Dk=class $k{constructor(e,t){this.anchor=e,this.head=t}map(e){return new $k(e.map(this.anchor),e.map(this.head))}resolve(e){return qt.between(e.resolve(this.anchor),e.resolve(this.head))}},ki=class pc extends wt{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?wt.near(s):new pc(s)}content(){return new Be(Je.from(this.node),0,0)}eq(e){return e instanceof pc&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new I5(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new pc(e.resolve(t.anchor))}static create(e,t){return new pc(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}};ki.prototype.visible=!1;wt.jsonID("node",ki);let I5=class Nk{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Dk(r,r):new Nk(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ki.isSelectable(r)?new ki(t):wt.near(t)}},eu=class Mf extends wt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Be.empty){if(t==Be.empty){e.delete(0,e.doc.content.size);let r=wt.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Mf(e)}map(e){return new Mf(e)}eq(e){return e instanceof Mf}getBookmark(){return O5}};wt.jsonID("all",eu);const O5={map(){return this},resolve(n){return new eu(n)}};function Aa(n,e,t,r,i,s=!1){if(e.inlineContent)return qt.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&ki.isSelectable(a))return ki.create(n,t-(i<0?a.nodeSize:0))}else{let l=Aa(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function Bw(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Ys||i instanceof fa))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(wt.near(n.doc.resolve(o),t))}const zw=1,Vd=2,Vw=4;let P5=class extends M5{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|zw)&~Vd,this.storedMarks=null,this}get selectionSet(){return(this.updated&zw)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Vd,this}ensureMarks(e){return kr.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Vd)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Vd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||kr.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r==null?t:r,!e)return this.deleteRange(t,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,s)),this.selection.empty||this.setSelection(wt.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Vw,this}get scrolledIntoView(){return(this.updated&Vw)>0}};function qw(n,e){return!e||!n?n:n.bind(e)}let mc=class{constructor(e,t,r){this.name=e,this.init=qw(t.init,r),this.apply=qw(t.apply,r)}};const D5=[new mc("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new mc("selection",{init(n,e){return n.selection||wt.atStart(e.doc)},apply(n){return n.selection}}),new mc("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new mc("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class zm{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=D5.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new mc(r.key,r.spec.state,r))})}}class Ja{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:t.length})}}if(!s)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Ja(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new P5(this)}static create(e){let t=new zm(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ja(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new zm(this.schema,e.plugins),r=t.fields,i=new Ja(t);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(t[r]=s.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new zm(e.schema,e.plugins),s=new Ja(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=Sk.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=wt.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){s[o.name]=c.fromJSON.call(l,e,t[a],s);return}}s[o.name]=o.init(e,s)}}),s}}function Lk(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Lk(i,e,{})),t[r]=i}return t}let Bn=class{constructor(e){this.spec=e,this.props={},e.props&&Lk(e.props,this,this.props),this.key=e.key?e.key.key:jk("plugin")}getState(e){return e[this.key]}};const Vm=Object.create(null);function jk(n){return n in Vm?n+"$"+ ++Vm[n]:(Vm[n]=0,n+"$")}let sr=class{constructor(e="key"){this.key=jk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}};function Fk(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=Fk(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function Hk(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=Hk(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let Nt=class Mn{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new Mn(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new Mn(r,i)}cutByIndex(e,t){return e==t?Mn.empty:e==0&&t==this.content.length?this:new Mn(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new Mn(i,s)}addToStart(e){return new Mn([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Mn(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return Fk(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Hk(this,e,t,r)}findIndex(e,t=-1){if(e==0)return qd(0,e);if(e==this.size)return qd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?qd(r+1,o):qd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Mn.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Mn(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Mn.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new Mn(t||e,r)}static from(e){if(!e)return Mn.empty;if(e instanceof Mn)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Mn([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};Nt.empty=new Nt([],0);const qm={index:0,offset:0};function qd(n,e){return qm.index=n,qm.offset=e,qm}function A0(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!A0(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!A0(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let qr=class M0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&A0(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return M0.none;if(e instanceof M0)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};qr.none=[];let $5=class extends Error{},ft=class Ma{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=zk(this.content,e+this.openStart,t);return r&&new Ma(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Ma(Bk(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Ma.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ma(Nt.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new Ma(e,r,i)}};ft.empty=new ft(Nt.empty,0,0);function Bk(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(Bk(s.content,e-i-1,t-i-1)))}function zk(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=zk(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}let Vk=class R0{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Ww(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Ww(this,t,!0);return r.addAll(e,t.from,t.to),ft.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(j5(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Jw(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Jw(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new R0(e,R0.schemaRules(e)))}};const qk={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},N5={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Uk={ol:!0,ul:!0},Sh=1,_h=2,tu=4;function Uw(n,e,t){return e!=null?(e?Sh:0)|(e==="full"?_h:0):n&&n.whitespace=="pre"?Sh|_h:t&~tu}let Ud=class{constructor(e,t,r,i,s,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=qr.none,this.stashMarks=[],this.match=o||(a&tu?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Nt.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Sh)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=Nt.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Nt.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):H5(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!qk.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}},Ww=class{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=Uw(null,t.preserveWhitespace,0)|(r?tu:0);i?s=new Ud(i.type,i.attrs,qr.none,qr.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new Ud(null,null,qr.none,qr.none,!0,null,o):s=new Ud(e.schema.topNodeType,null,qr.none,qr.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style");if(!t)this.addElement(e);else{let r=this.readStyles(F5(t));if(!r)return;let[i,s]=r,o=this.top;for(let a=0;a<s.length;a++)this.removePendingMark(s[a],o);for(let a=0;a<i.length;a++)this.addPendingMark(i[a]);this.addElement(e);for(let a=0;a<i.length;a++)this.removePendingMark(i[a],o);for(let a=0;a<s.length;a++)this.addPendingMark(s[a])}}}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&_h||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Sh)r.options&_h?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;Uk.hasOwnProperty(r)&&this.parser.normalizeLists&&L5(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:N5.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(qk.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(a),this.needsBlock=l}else this.addElementByRule(e,s,s.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=qr.none,r=qr.none;e:for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)continue e;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.forEach(a=>{o.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,r]}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=Uw(e,i,s.options);s.options&tu&&s.content.length==0&&(o|=tu),this.nodes.push(new Ud(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=B5(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}};function L5(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Uk.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function j5(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function F5(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Jw(n){let e={};for(let t in n)e[t]=n[t];return e}function H5(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function B5(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}let Pp=class gc{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Um(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=gc.renderSpec(Um(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&gc.renderSpec(Um(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:p}=gc.renderSpec(e,d,r);if(a.appendChild(f),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new gc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Kw(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Kw(e.marks)}};function Kw(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Um(n){return n.document||window.document}const Wk=65535,Jk=Math.pow(2,16);function z5(n,e){return n+e*Jk}function Gw(n){return n&Wk}function V5(n){return(n-(n&Wk))/Jk}const Kk=1,Gk=2,Rf=4,Yk=8;let Yw=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Yk)>0}get deletedBefore(){return(this.delInfo&(Kk|Rf))>0}get deletedAfter(){return(this.delInfo&(Gk|Rf))>0}get deletedAcross(){return(this.delInfo&Rf)>0}},xl=class Ra{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ra.empty)return Ra.empty}recover(e){let t=0,r=Gw(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+V5(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:z5(a/3,e-l),v=e==l?Gk:e==d?Kk:Rf;return(t<0?e!=l:e!=d)&&(v|=Yk),new Yw(p,v,m)}i+=u-c}return r?e+i:new Yw(e+i,0,null)}touches(e,t){let r=0,i=Gw(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Ra(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ra.empty:new Ra(e<0?[0,-e,0]:[0,0,e])}};xl.empty=new xl([]);const Wm=Object.create(null);let or=class{getMap(){return xl.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Wm[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Wm)throw new RangeError("Duplicate use of step JSON ID "+e);return Wm[e]=t,t.prototype.jsonID=e,t}},Gn=class yc{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new yc(e,null)}static fail(e){return new yc(null,e)}static fromReplace(e,t,r,i){try{return yc.ok(e.replace(t,r,i))}catch(s){if(s instanceof $5)return yc.fail(s.message);throw s}}};function Hy(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(Hy(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return Nt.fromArray(r)}let Xk=class vc extends or{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new ft(Hy(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Gn.fromReplace(e,this.from,this.to,s)}invert(){return new Zk(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new vc(t.pos,r.pos,this.mark)}merge(e){return e instanceof vc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new vc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new vc(t.from,t.to,e.markFromJSON(t.mark))}};or.jsonID("addMark",Xk);let Zk=class bc extends or{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new ft(Hy(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Gn.fromReplace(e,this.from,this.to,r)}invert(){return new Xk(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new bc(t.pos,r.pos,this.mark)}merge(e){return e instanceof bc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new bc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new bc(t.from,t.to,e.markFromJSON(t.mark))}};or.jsonID("removeMark",Zk);let Qk=class wc extends or{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Gn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Gn.fromReplace(e,this.pos,this.pos+1,new ft(Nt.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new wc(this.pos,t.marks[i]);return new wc(this.pos,this.mark)}}return new eE(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wc(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new wc(t.pos,e.markFromJSON(t.mark))}};or.jsonID("addNodeMark",Qk);let eE=class I0 extends or{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Gn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Gn.fromReplace(e,this.pos,this.pos+1,new ft(Nt.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Qk(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new I0(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new I0(t.pos,e.markFromJSON(t.mark))}};or.jsonID("removeNodeMark",eE);let tE=class uo extends or{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&O0(e,this.from,this.to)?Gn.fail("Structure replace would overwrite content"):Gn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new xl([this.from,this.to-this.from,this.slice.size])}invert(e){return new uo(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new uo(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof uo)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?ft.empty:new ft(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new uo(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?ft.empty:new ft(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new uo(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new uo(t.from,t.to,ft.fromJSON(e,t.slice),!!t.structure)}};or.jsonID("replace",tE);let nE=class If extends or{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(O0(e,this.from,this.gapFrom)||O0(e,this.gapTo,this.to)))return Gn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Gn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Gn.fromReplace(e,this.from,this.to,r):Gn.fail("Content does not fit in gap")}getMap(){return new xl([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new If(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new If(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new If(t.from,t.to,t.gapFrom,t.gapTo,ft.fromJSON(e,t.slice),t.insert,!!t.structure)}};or.jsonID("replaceAround",nE);function O0(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function q5(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}let U5=class Of extends or{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Gn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Gn.fromReplace(e,this.pos,this.pos+1,new ft(Nt.from(i),0,t.isLeaf?0:1))}getMap(){return xl.empty}invert(e){return new Of(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Of(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Of(t.pos,t.attr,t.value)}};or.jsonID("attr",U5);let Ou=class extends Error{};Ou=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ou.prototype=Object.create(Error.prototype);Ou.prototype.constructor=Ou;Ou.prototype.name="TransformError";const Jm=Object.create(null);let kt=class{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new W5(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=ft.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?ft.empty:t),a==0&&Qw(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Qw(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new Kt(e):Ia(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?Ia(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):Ia(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new rl(e.node(0))}static atStart(e){return Ia(e,e,0,0,1)||new rl(e)}static atEnd(e){return Ia(e,e,e.content.size,e.childCount,-1)||new rl(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Jm[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Jm)throw new RangeError("Duplicate use of selection JSON ID "+e);return Jm[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Kt.between(this.$anchor,this.$head).getBookmark()}};kt.prototype.visible=!0;let W5=class{constructor(e,t){this.$from=e,this.$to=t}},Xw=!1;function Zw(n){!Xw&&!n.parent.inlineContent&&(Xw=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}let Kt=class xc extends kt{constructor(e,t=e){Zw(e),Zw(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return kt.near(r);let i=e.resolve(t.map(this.anchor));return new xc(i.parent.inlineContent?i:r,r)}replace(e,t=ft.empty){if(super.replace(e,t),t==ft.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof xc&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new rE(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new xc(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=kt.findFrom(t,r,!0)||kt.findFrom(t,-r,!0);if(s)t=s.$head;else return kt.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(kt.findFrom(e,-r,!0)||kt.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new xc(e,t)}};kt.jsonID("text",Kt);let rE=class iE{constructor(e,t){this.anchor=e,this.head=t}map(e){return new iE(e.map(this.anchor),e.map(this.head))}resolve(e){return Kt.between(e.resolve(this.anchor),e.resolve(this.head))}},ht=class Sc extends kt{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?kt.near(s):new Sc(s)}content(){return new ft(Nt.from(this.node),0,0)}eq(e){return e instanceof Sc&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new J5(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Sc(e.resolve(t.anchor))}static create(e,t){return new Sc(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}};ht.prototype.visible=!1;kt.jsonID("node",ht);let J5=class sE{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new rE(r,r):new sE(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ht.isSelectable(r)?new ht(t):kt.near(t)}},rl=class Pf extends kt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=ft.empty){if(t==ft.empty){e.delete(0,e.doc.content.size);let r=kt.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Pf(e)}map(e){return new Pf(e)}eq(e){return e instanceof Pf}getBookmark(){return K5}};kt.jsonID("all",rl);const K5={map(){return this},resolve(n){return new rl(n)}};function Ia(n,e,t,r,i,s=!1){if(e.inlineContent)return Kt.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&ht.isSelectable(a))return ht.create(n,t-(i<0?a.nodeSize:0))}else{let l=Ia(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function Qw(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof tE||i instanceof nE))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(kt.near(n.doc.resolve(o),t))}function e2(n,e){return!e||!n?n:n.bind(e)}let Wd=class{constructor(e,t,r){this.name=e,this.init=e2(t.init,r),this.apply=e2(t.apply,r)}};new Wd("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Wd("selection",{init(n,e){return n.selection||kt.atStart(e.doc)},apply(n){return n.selection}}),new Wd("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Wd("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}});const un=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Pu=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let P0=null;const ji=function(n,e,t){let r=P0||(P0=document.createRange());return r.setEnd(n,t==null?n.nodeValue.length:t),r.setStart(n,e||0),r},G5=function(){P0=null},ta=function(n,e,t,r){return t&&(t2(n,e,t,r,-1)||t2(n,e,t,r,1))},Y5=/^(img|br|input|textarea|hr)$/i;function t2(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:yi(n))){let s=n.parentNode;if(!s||s.nodeType!=1||ud(n)||Y5.test(n.nodeName)||n.contentEditable=="false")return!1;e=un(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?yi(n):0}else return!1}}function yi(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function X5(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=yi(n)}else if(n.parentNode&&!ud(n))e=un(n),n=n.parentNode;else return null}}function Z5(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!ud(n))e=un(n)+1,n=n.parentNode;else return null}}function Q5(n,e,t){for(let r=e==0,i=e==yi(n);r||i;){if(n==t)return!0;let s=un(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==yi(n)}}function ud(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Dp=function(n){return n.focusNode&&ta(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function vo(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function eN(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function tN(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch(r){}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const Ei=typeof navigator!="undefined"?navigator:null,n2=typeof document!="undefined"?document:null,Xs=Ei&&Ei.userAgent||"",D0=/Edge\/(\d+)/.exec(Xs),oE=/MSIE \d/.exec(Xs),$0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Xs),er=!!(oE||$0||D0),js=oE?document.documentMode:$0?+$0[1]:D0?+D0[1]:0,ni=!er&&/gecko\/(\d+)/i.test(Xs);ni&&+(/Firefox\/(\d+)/.exec(Xs)||[0,0])[1];const N0=!er&&/Chrome\/(\d+)/.exec(Xs),$n=!!N0,nN=N0?+N0[1]:0,Ln=!er&&!!Ei&&/Apple Computer/.test(Ei.vendor),Sl=Ln&&(/Mobile\/\w+/.test(Xs)||!!Ei&&Ei.maxTouchPoints>2),Sr=Sl||(Ei?/Mac/.test(Ei.platform):!1),rN=Ei?/Win/.test(Ei.platform):!1,Wr=/Android \d/.test(Xs),dd=!!n2&&"webkitFontSmoothing"in n2.documentElement.style,iN=dd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function sN(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Di(n,e){return typeof n=="number"?n:n[e]}function oN(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function r2(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=t||n.dom;o;o=Pu(o)){if(o.nodeType!=1)continue;let a=o,l=a==s.body,c=l?sN(s):oN(a),u=0,d=0;if(e.top<c.top+Di(r,"top")?d=-(c.top-e.top+Di(i,"top")):e.bottom>c.bottom-Di(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Di(i,"top")-c.top:e.bottom-c.bottom+Di(i,"bottom")),e.left<c.left+Di(r,"left")?u=-(c.left-e.left+Di(i,"left")):e.right>c.right-Di(r,"right")&&(u=e.right-c.right+Di(i,"right")),u||d)if(l)s.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-f,v=a.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function aN(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(s,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:aE(n.dom)}}function aE(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Pu(r));return e}function lN({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;lE(t,r==0?0:r-e)}function lE(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:s}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let wa=null;function cN(n){if(n.setActive)return n.setActive();if(wa)return n.focus(wa);let e=aE(n);n.focus(wa==null?{get preventScroll(){return wa={preventScroll:!0},!0}}:void 0),wa||(wa=!1,lE(e,0))}function cE(n,e){let t,r=2e8,i,s=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=ji(u).getClientRects();else continue;for(let p=0;p<f.length;p++){let m=f[p];if(m.top<=o&&m.bottom>=a){o=Math.max(m.bottom,o),a=Math.min(m.top,a);let v=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(v<r){t=u,r=v,i=v&&t.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&v&&(s=d+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!t&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(s=d+1)}}return!t&&l&&(t=l,i=c,r=0),t&&t.nodeType==3?uN(t,i):!t||r&&t.nodeType==1?{node:n,offset:s}:cE(t,i)}function uN(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=fs(r,1);if(s.top!=s.bottom&&By(e,s))return{node:n,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function By(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function dN(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function fN(n,e,t){let{node:r,offset:i}=cE(e,t),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function hN(n,e,t,r){let i=-1;for(let s=e,o=!1;s!=n.dom;){let a=n.docView.nearestDesc(s,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent&&!o||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&!o&&(o=!0,l.left>r.left||l.top>r.top?i=a.posBefore:(l.right<r.left||l.bottom<r.top)&&(i=a.posAfter)),!a.contentDOM&&i<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}s=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function uE(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(By(e,c))return uE(o,e,c)}}if((s=(s+1)%r)==i)break}return n}function pN(n,e){let t=n.dom.ownerDocument,r,i=0,s=tN(t,e.left,e.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!By(e,c)||(o=uE(n.dom,e,c),!o))return null}if(Ln)for(let c=o;r&&c;c=Pu(c))c.draggable&&(r=void 0);if(o=dN(o,e),r){if(ni&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;dd&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=hN(n,r,i,e))}a==null&&(a=fN(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function i2(n){return n.top<n.bottom||n.left<n.right}function fs(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(i2(r))return r}return Array.prototype.find.call(t,i2)||n.getBoundingClientRect()}const mN=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function dE(n,e,t){let{node:r,offset:i,atom:s}=n.docView.domFromPos(e,t<0?-1:1),o=dd||ni;if(r.nodeType==3)if(o&&(mN.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=fs(ji(r,i,i),t);if(ni&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=fs(ji(r,i-1,i-1),-1);if(c.top==l.top){let u=fs(ji(r,i,i+1),-1);if(u.top!=l.top)return Ql(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,Ql(fs(ji(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(t<0||i==yi(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Km(l.getBoundingClientRect(),!1)}if(s==null&&i<yi(r)){let l=r.childNodes[i];if(l.nodeType==1)return Km(l.getBoundingClientRect(),!0)}return Km(r.getBoundingClientRect(),t>=0)}if(s==null&&i&&(t<0||i==yi(r))){let l=r.childNodes[i-1],c=l.nodeType==3?ji(l,yi(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ql(fs(c,1),!1)}if(s==null&&i<yi(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?ji(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Ql(fs(c,-1),!0)}return Ql(fs(r.nodeType==3?ji(r):r,-t),t>=0)}function Ql(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Km(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function fE(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function gN(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return fE(n,e,()=>{let{node:s}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let o=dE(n,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=ji(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const yN=/[\u0590-\u08ac]/;function vN(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=n.domSelection();return!yN.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?s:o:fE(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:m,focusOffset:v}=n.domSelectionRange(),x=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==v;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch(b){}return f!=null&&(a.caretBidiLevel=f),x})}let s2=null,o2=null,a2=!1;function bN(n,e,t){return s2==e&&o2==t?a2:(s2=e,o2=t,a2=t=="up"||t=="down"?gN(n,e,t):vN(n,e,t))}const $r=0,l2=1,Eo=2,Ti=3;class fd{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=$r,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>un(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return(i==null?r>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!t||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>e||o instanceof pE){i=e-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof hE&&s.side>=0;r--);if(t<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?un(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?un(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(i==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=un(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=un(d.dom);break}t+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let m=this.children[f],v=p+m.size;if(s>p&&o<v)return m.setSelection(e-p-m.border,t-p-m.border,r,i);p=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((ni||Ln)&&e==t){let{node:f,offset:p}=a;if(f.nodeType==3){if(u=!!(p&&f.nodeValue[p-1]==`
`),u&&p==f.nodeValue.length)for(let m=f,v;m;m=m.parentNode){if(v=m.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:un(v)+1});break}let x=m.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let m=f.childNodes[p-1];u=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(ni&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let f=c.focusNode.childNodes[c.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||u&&Ln)&&ta(a.node,a.offset,c.anchorNode,c.anchorOffset)&&ta(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch(f){}}if(!d){if(e>t){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+s.border,l=o-s.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?Eo:l2,e==a&&t==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Ti:s.markDirty(e-a,t-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Eo:Ti}r=o}this.dirty=Eo}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Eo:l2;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class hE extends fd{constructor(e,t,r,i){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==$r&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class wN extends fd{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class na extends fd{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let s=i.nodeViews[t.type.name],o=s&&s(t,i,r);return(!o||!o.dom)&&(o=Pp.renderSpec(document,t.type.spec.toDOM(t,r))),new na(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&Ti||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ti&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=$r){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=$r}}slice(e,t,r){let i=na.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;t<o&&(s=F0(s,t,o,r)),e>0&&(s=F0(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}}class Fs extends fd{constructor(e,t,r,i,s,o,a,l,c){super(e,[],s,o),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,s,o){let a=s.nodeViews[t.type.name],l,c=a&&a(t,s,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Pp.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=yE(u,r,t),c?l=new xN(e,t,r,i,u,d||null,f,c,s,o+1):t.isText?new $p(e,t,r,i,u,f,s):new Fs(e,t,r,i,u,d||null,f,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Nt.empty)}return e}matchesNode(e,t,r){return this.dirty==$r&&e.eq(this.node)&&j0(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new _N(this,o&&o.node,e);EN(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?qr.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,f)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,d,f)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,d,p,e)||l.updateNextNode(c,u,d,e,f,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Eo)&&(o&&this.protectLocalComposition(e,o),mE(this.contentDOM,this.children,e),Sl&&TN(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Kt)||r<t||i>t+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,a=AN(this.node.content,o,r-t,i-t);return a<0?null:{node:s,pos:a,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new wN(this,s,t,i);e.input.compositionNodes.push(o),this.children=F0(this.children,r,r+i.length,e,o)}update(e,t,r,i){return this.dirty==Ti||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=$r}updateOuterDeco(e){if(j0(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=gE(this.dom,this.nodeDOM,L0(this.outerDeco,this.node,t),L0(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function c2(n,e,t,r,i){yE(r,e,n);let s=new Fs(void 0,n,e,t,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class $p extends Fs{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Ti||this.dirty!=$r&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=$r||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=$r,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),s=document.createTextNode(i.text);return new $p(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Ti)}get domAtom(){return!1}isText(e){return this.node.text==e}}class pE extends fd{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==$r&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class xN extends Fs{constructor(e,t,r,i,s,o,a,l,c,u){super(e,t,r,i,s,o,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==Ti)return!1;if(this.spec.update){let s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function mE(n,e,t){let r=n.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=u2(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(o instanceof na){let l=r?r.previousSibling:n.lastChild;mE(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=u2(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const nu=function(n){n&&(this.nodeName=n)};nu.prototype=Object.create(null);const To=[new nu];function L0(n,e,t){if(n.length==0)return To;let r=t?To[0]:new nu,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new nu(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&i.length==1&&i.push(r=new nu(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function gE(n,e,t,r){if(t==To&&r==To)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=To[0]),i=l}SN(i,a||To[0],o)}return i}function SN(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function yE(n,e,t){return gE(n,n,To,L0(e,t,n.nodeType!=1))}function j0(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function u2(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class _N{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=CN(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=$r,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=na.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,i,s){let o=this.top.children[i];return o.dirty==Ti&&o.dom==o.contentDOM&&(o.dirty=Eo),o.update(e,t,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,s,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Fs){let c=this.preMatch.matched.get(l);if(c!=null&&c!=s)return!1;let u=l.dom,d,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Ti&&j0(t,l.outerDeco));if(!f&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,t,r,i,o)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Eo,d.updateChildren(i,o+1),d.dirty=$r),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,s,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=Fs.create(this.top,t,r,i,s,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,s){let o=Fs.create(this.top,e,t,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new hE(this.top,e,t,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof na;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof $p)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ln||$n)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new pE(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function CN(n,e){let t=e,r=t.children.length,i=n.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof na)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}function kN(n,e){return n.type.side-e.type.side}function EN(n,e,t,r){let i=e.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,d;for(;o<i.length&&i[o].to==s;){let x=i[o++];x.widget&&(u?(d||(d=[u])).push(x):u=x)}if(u)if(d){d.sort(kN);for(let x=0;x<d.length;x++)t(d[x],c,!!l)}else t(u,c,!!l);let f,p;if(l)p=-1,f=l,l=null;else if(c<n.childCount)p=c,f=n.child(c++);else break;for(let x=0;x<a.length;x++)a[x].to<=s&&a.splice(x--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let m=s+f.nodeSize;if(f.isText){let x=m;o<i.length&&i[o].from<x&&(x=i[o].from);for(let b=0;b<a.length;b++)a[b].to<x&&(x=a[b].to);x<m&&(l=f.cut(x-s),f=f.cut(0,x-s),m=x,p=-1)}else for(;o<i.length&&i[o].to<m;)o++;let v=f.isInline&&!f.isLeaf?a.filter(x=>!x.inline):a.slice();r(f,v,e.forChild(s,f),p),s=m}}function TN(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function AN(n,e,t,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=t){if(s>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function F0(n,e,t,r,i){let s=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>t&&s.push(l.slice(t-c,l.size,r)))}return s}function zy(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Dp(t)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&ht.isSelectable(u)&&i.parent&&!(u.isInline&&Q5(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new ht(o==d?a:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!s?1:-1;c=Vy(n,l,a,u)}return c}function vE(n){return n.editable?n.hasFocus():wE(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function qi(n,e=!1){let t=n.state.selection;if(bE(n,t),!!vE(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&$n){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&ta(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)RN(n);else{let{anchor:r,head:i}=t,s,o;d2&&!(t instanceof Kt)&&(t.$from.parent.inlineContent||(s=f2(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=f2(n,t.to))),n.docView.setSelection(r,i,n.root,e),d2&&(s&&h2(s),o&&h2(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&MN(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const d2=Ln||$n&&nN<63;function f2(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(Ln&&i&&i.contentEditable=="false")return Gm(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Gm(i);if(s)return Gm(s)}}function Gm(n){return n.contentEditable="true",Ln&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function h2(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function MN(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!vE(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function RN(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,un(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&er&&js<=11&&(r.disabled=!0,r.disabled=!1)}function bE(n,e){if(e instanceof ht){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(p2(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else p2(n)}function p2(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Vy(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||Kt.between(e,t,r)}function m2(n){return n.editable&&!n.hasFocus()?!1:wE(n)}function wE(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function IN(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return ta(e.node,e.offset,t.anchorNode,t.anchorOffset)}function H0(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&kt.findFrom(s,e)}function ws(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function g2(n,e,t){let r=n.state.selection;if(r instanceof Kt)if(t.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return ws(n,new Kt(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=H0(n.state,e);return i&&i instanceof ht?ws(n,i):!1}else if(!(Sr&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?ht.isSelectable(s)?ws(n,new ht(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):dd?ws(n,new Kt(n.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ht&&r.node.isInline)return ws(n,new Kt(e>0?r.$to:r.$from));{let i=H0(n.state,e);return i?ws(n,i):!1}}}function Ch(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ru(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function xa(n,e){return e<0?ON(n):PN(n)}function ON(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(ni&&t.nodeType==1&&r<Ch(t)&&ru(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(ru(a,-1))i=t,s=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(xE(t))break;{let a=t.previousSibling;for(;a&&ru(a,-1);)i=t.parentNode,s=un(a),a=a.previousSibling;if(a)t=a,r=Ch(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?B0(n,t,r):i&&B0(n,i,s)}function PN(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Ch(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(ru(a,1))s=t,o=++r;else break}else{if(xE(t))break;{let a=t.nextSibling;for(;a&&ru(a,1);)s=a.parentNode,o=un(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=Ch(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&B0(n,s,o)}function xE(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function DN(n,e){for(;n&&e==n.childNodes.length&&!ud(n);)e=un(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function $N(n,e){for(;n&&!e&&!ud(n);)e=un(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function B0(n,e,t){if(e.nodeType!=3){let s,o;(o=DN(e,t))?(e=o,t=0):(s=$N(e,t))&&(e=s,t=s.nodeValue.length)}let r=n.domSelection();if(Dp(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&qi(n)},50)}function y2(n,e){let t=n.state.doc.resolve(e);if(!($n||rN)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let s=n.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<t.end()){let s=n.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function v2(n,e,t){let r=n.state.selection;if(r instanceof Kt&&!r.empty||t.indexOf("s")>-1||Sr&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=H0(n.state,e);if(o&&o instanceof ht)return ws(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof rl?kt.near(o,e):kt.findFrom(o,e);return a?ws(n,a):!1}return!1}function b2(n,e){if(!(n.state.selection instanceof Kt))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function w2(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function NN(n){if(!Ln||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;w2(n,r,"true"),setTimeout(()=>w2(n,r,"false"),20)}return!1}function LN(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function jN(n,e){let t=e.keyCode,r=LN(e);if(t==8||Sr&&t==72&&r=="c")return b2(n,-1)||xa(n,-1);if(t==46&&!e.shiftKey||Sr&&t==68&&r=="c")return b2(n,1)||xa(n,1);if(t==13||t==27)return!0;if(t==37||Sr&&t==66&&r=="c"){let i=t==37?y2(n,n.state.selection.from)=="ltr"?-1:1:-1;return g2(n,i,r)||xa(n,i)}else if(t==39||Sr&&t==70&&r=="c"){let i=t==39?y2(n,n.state.selection.from)=="ltr"?1:-1:1;return g2(n,i,r)||xa(n,i)}else{if(t==38||Sr&&t==80&&r=="c")return v2(n,-1,r)||xa(n,-1);if(t==40||Sr&&t==78&&r=="c")return NN(n)||v2(n,1,r)||xa(n,1);if(r==(Sr?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function SE(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=n.someProp("clipboardSerializer")||Pp.fromSchema(n.state.schema),a=AE(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=TE[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f}}function _E(n,e,t,r,i){let s=i.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||s||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,s||r,n)}),s)return e?new ft(Nt.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):ft.empty;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:p}=n.state,m=Pp.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let x=o.appendChild(document.createElement("p"));v&&x.appendChild(m.serializeNode(p.text(v,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=BN(t),dd&&zN(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Vk.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!FN.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=VN(x2(a,+u[1],+u[2]),u[4]);else if(a=ft.maxOpen(HN(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=x2(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const FN=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function HN(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&kE(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=EE(o[o.length-1],s.length));let u=CE(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return Nt.from(o)}return n}function CE(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,Nt.from(n));return n}function kE(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=kE(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(Nt.from(CE(t,n,i+1))))}}function EE(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,EE(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(Nt.empty,!0);return n.copy(t.append(r))}function z0(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(s=0),i<r-1&&(a=z0(a,e,t,r,i+1,s)),i>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(Nt.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function x2(n,e,t){return e<n.openStart&&(n=new ft(z0(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new ft(z0(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const TE={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let S2=null;function AE(){return S2||(S2=document.implementation.createHTMLDocument("title"))}function BN(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=AE().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&TE[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=n,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function zN(n){let e=n.querySelectorAll($n?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function VN(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch(a){return n}let{content:i,openStart:s,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=Nt.from(l.create(r[a+1],i)),s++,o++}return new ft(i,s,o)}const jn={},Fn={},qN={touchstart:!0,touchmove:!0};class UN{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function WN(n){for(let e in jn){let t=jn[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{KN(n,r)&&!qy(n,r)&&(n.editable||!(r.type in Fn))&&t(n,r)},qN[e]?{passive:!0}:void 0)}Ln&&n.dom.addEventListener("input",()=>null),V0(n)}function Is(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function JN(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function V0(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>qy(n,r))})}function qy(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function KN(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function GN(n,e){!qy(n,e)&&jn[e.type]&&(n.editable||!(e.type in Fn))&&jn[e.type](n,e)}Fn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!RE(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Wr&&$n&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Sl&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,vo(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||jN(n,t)?t.preventDefault():Is(n,"key")};Fn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Fn.keypress=(n,e)=>{let t=e;if(RE(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Sr&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof Kt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Np(n){return{left:n.clientX,top:n.clientY}}function YN(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Uy(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,a=>o>s.depth?a(n,t,s.nodeAfter,s.before(o),i,!0):a(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function il(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function XN(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&ht.isSelectable(r)?(il(n,new ht(t),"pointer"),!0):!1}function ZN(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof ht&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(ht.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(il(n,ht.create(n.state.doc,i),"pointer"),!0):!1}function QN(n,e,t,r,i){return Uy(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?ZN(n,t):XN(n,t))}function e7(n,e,t,r){return Uy(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function t7(n,e,t,r){return Uy(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||n7(n,t,r)}function n7(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(il(n,Kt.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)il(n,Kt.create(r,a+1,a+1+o.content.size),"pointer");else if(ht.isSelectable(o))il(n,ht.create(r,a),"pointer");else continue;return!0}}function Wy(n){return kh(n)}const ME=Sr?"metaKey":"ctrlKey";jn.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Wy(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&YN(t,n.input.lastClick)&&!t[ME]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let o=n.posAtCoords(Np(t));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new r7(n,o,t,!!r)):(s=="doubleClick"?e7:t7)(n,o.pos,o.inside,t)?t.preventDefault():Is(n,"pointer"))};let r7=class{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[ME],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof ht&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ni&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Is(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>qi(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Np(e))),this.updateAllowDefault(e),this.allowDefault||!t?Is(this.view,"pointer"):QN(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ln&&this.mightDrag&&!this.mightDrag.node.isAtom||$n&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(il(this.view,kt.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Is(this.view,"pointer")}move(e){this.updateAllowDefault(e),Is(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}};jn.touchstart=n=>{n.input.lastTouch=Date.now(),Wy(n),Is(n,"pointer")};jn.touchmove=n=>{n.input.lastTouch=Date.now(),Is(n,"pointer")};jn.contextmenu=n=>Wy(n);function RE(n,e){return n.composing?!0:Ln&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const i7=Wr?5e3:-1;Fn.compositionstart=Fn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),kh(n,!0),n.markCursor=null;else if(kh(n),ni&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}IE(n,i7)};Fn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,IE(n,20))};function IE(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>kh(n),e))}function OE(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=o7());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function s7(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=X5(e.focusNode,e.focusOffset),r=Z5(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t}function o7(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function kh(n,e=!1){if(!(Wr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),OE(n),e||n.docView&&n.docView.dirty){let t=zy(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function a7(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Du=er&&js<15||Sl&&iN<604;jn.copy=Fn.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=Du?null:t.clipboardData,o=r.content(),{dom:a,text:l}=SE(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):a7(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function l7(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function c7(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?$u(n,r.value,null,i,e):$u(n,r.textContent,r.innerHTML,i,e)},50)}function $u(n,e,t,r,i){let s=_E(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,s||ft.empty)))return!0;if(!s)return!1;let o=l7(s),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function PE(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Fn.paste=(n,e)=>{let t=e;if(n.composing&&!Wr)return;let r=Du?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&$u(n,PE(r),r.getData("text/html"),i,t)?t.preventDefault():c7(n,t)};let DE=class{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}};const $E=Sr?"altKey":"ctrlKey";jn.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(Np(t)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof ht?i.to-1:i.to))){if(r&&r.mightDrag)o=ht.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let u=n.docView.nearestDesc(t.target,!0);u&&u.node.type.spec.draggable&&u!=n.docView&&(o=ht.create(n.state.doc,u.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c}=SE(n,a);t.dataTransfer.clearData(),t.dataTransfer.setData(Du?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Du||t.dataTransfer.setData("text/plain",c),n.dragging=new DE(a,!t[$E],o)};jn.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Fn.dragover=Fn.dragenter=(n,e)=>e.preventDefault();Fn.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Np(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",m=>{o=m(o,n)}):o=_E(n,PE(t.dataTransfer),Du?null:t.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&!t[$E]);if(n.someProp("handleDrop",m=>m(n,t,o||ft.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?q5(n.state.doc,s.pos,o):s.pos;l==null&&(l=s.pos);let c=n.state.tr;if(a){let{node:m}=r;m?m.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let p=c.doc.resolve(u);if(d&&ht.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new ht(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,x,b,_)=>m=_),c.setSelection(Vy(n,p,c.doc.resolve(m)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};jn.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&qi(n)},20))};jn.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};jn.beforeinput=(n,e)=>{if($n&&Wr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,vo(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Fn)jn[n]=Fn[n];function Nu(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}let _2=class NE{constructor(e,t){this.toDOM=e,this.spec=t||Bo,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new Zs(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof NE&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Nu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}},iu=class q0{constructor(e,t){this.attrs=e,this.spec=t||Bo}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Zs(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof q0&&Nu(this.attrs,e.attrs)&&Nu(this.spec,e.spec)}static is(e){return e.type instanceof q0}destroy(){}},u7=class LE{constructor(e,t){this.attrs=e,this.spec=t||Bo}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Zs(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof LE&&Nu(this.attrs,e.attrs)&&Nu(this.spec,e.spec)}destroy(){}},Zs=class _c{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new _c(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new _c(e,e,new _2(t,r))}static inline(e,t,r,i){return new _c(e,t,new iu(r,i))}static node(e,t,r,i){return new _c(e,t,new u7(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof iu}get widget(){return this.type instanceof _2}};const Oa=[],Bo={};let Nr=class hs{constructor(e,t){this.local=e.length?e:Oa,this.children=t.length?t:Oa}static create(e,t){return t.length?Eh(t,e,0,Bo):gn}find(e,t,r){let i=[];return this.findInner(e==null?0:e,t==null?1e9:t,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,i+a,s)}}map(e,t,r){return this==gn||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Bo)}mapInner(e,t,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?d7(this.children,o||[],e,t,r,i,s):o?new hs(o.sort(zo),Oa):gn}add(e,t){return t.length?this==gn?hs.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((a,l)=>{let c=l+r,u;if(u=HE(t,a,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,Eh(u,a,c+1,Bo)),s+=3}});let o=FE(s?BE(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new hs(o.length?this.local.concat(o).sort(zo):this.local,i||this.children)}remove(e){return e.length==0||this==gn?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+t,l=r[s+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=gn?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new hs(i,r):gn}forChild(e,t){if(this==gn)return this;if(t.isLeaf)return hs.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof iu){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new hs(i.sort(zo),Oa);return r?new jE([a,r]):a}return r||gn}eq(e){if(this==e)return!0;if(!(e instanceof hs)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Jy(this.localsInner(e))}localsInner(e){if(this==gn)return Oa;if(e.inlineContent||!this.local.some(iu.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof iu||t.push(this.local[r]);return t}};Nr.empty=new Nr([],[]);Nr.removeOverlap=Jy;const gn=Nr.empty;let jE=class Pa{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Bo));return Pa.from(r)}forChild(e,t){if(t.isLeaf)return Nr.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=gn&&(s instanceof Pa?r=r.concat(s.members):r.push(s))}return Pa.from(r)}eq(e){if(!(e instanceof Pa)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?Jy(r?t:t.sort(zo)):Oa}static from(e){switch(e.length){case 0:return gn;case 1:return e[0];default:return new Pa(e.every(t=>t instanceof Nr)?e:e.reduce((t,r)=>t.concat(r instanceof Nr?r:r.members),[]))}}};function d7(n,e,t,r,i,s,o){let a=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,p,m,v)=>{let x=v-m-(p-f);for(let b=0;b<a.length;b+=3){let _=a[b+1];if(_<0||f>_+u-d)continue;let M=a[b]+u-d;p>=M?a[b+1]=f<=M?-2:-1:f>=u&&x&&(a[b]+=x,a[b+1]+=x)}d+=x}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+s),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+s,-1),p=f-i,{index:m,offset:v}=r.content.findIndex(d),x=r.maybeChild(m);if(x&&v==d&&v+x.nodeSize==p){let b=a[c+2].mapInner(t,x,u+1,n[c]+s+1,o);b!=gn?(a[c]=d,a[c+1]=p,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=f7(a,n,e,t,i,s,o),u=Eh(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let p=u.children[d];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Nr(e.sort(zo),a)}function FE(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Zs(i.from+e,i.to+e,i.type))}return t}function f7(n,e,t,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+s+1);return t}function HE(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function BE(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Eh(n,e,t,r){let i=[],s=!1;e.forEach((a,l)=>{let c=HE(n,a,l+t);if(c){s=!0;let u=Eh(c,a,t+l+1,r);u!=gn&&i.push(l,l+a.nodeSize,u)}});let o=FE(s?BE(n):n,-t).sort(zo);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new Nr(o,i):gn}function zo(n,e){return n.from-e.from||n.to-e.to}function Jy(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),C2(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),C2(e,i,r.copy(s.from,r.to)));break}}}return e}function C2(n,e,t){for(;e<n.length&&zo(t,n[e])>0;)e++;n.splice(e,0,t)}function Ym(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=gn&&e.push(r)}),n.cursorWrapper&&e.push(Nr.create(n.state.doc,[n.cursorWrapper.deco])),jE.from(e)}const h7={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},p7=er&&js<=11;class m7{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class g7{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new m7,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);er&&js<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),p7&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,h7)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(m2(this.view)){if(this.suppressingSelectionUpdates)return qi(this.view);if(er&&js<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ta(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let s=e.focusNode;s;s=Pu(s))t.add(s);for(let s=e.anchorNode;s;s=Pu(s))if(t.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&m2(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(ni&&l.length>1){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let d=u[0],f=u[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Dp(r)&&(c=zy(e))&&c.eq(kt.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,qi(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),y7(e)),this.handleDOMChange(s,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||qi(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)t.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(er&&js<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let o=i&&i.parentNode==e.target?un(i)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=s&&s.parentNode==e.target?un(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let k2=new WeakMap,E2=!1;function y7(n){if(!k2.has(n)&&(k2.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=ni,E2)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),E2=!0}}function v7(n){let e;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=n.domAtPos(n.state.selection.anchor);return ta(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function b7(n,e,t){let{node:r,fromOffset:i,toOffset:s,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Dp(l)||c.push({node:l.focusNode,offset:l.focusOffset})),$n&&n.input.lastKeyCode===8)for(let x=s;x>i;x--){let b=r.childNodes[x-1],_=b.pmViewDesc;if(b.nodeName=="BR"&&!_){s=x;break}if(!_||_.size)break}let d=n.state.doc,f=n.someProp("domParser")||Vk.fromSchema(n.state.schema),p=d.resolve(o),m=null,v=f.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:w7,context:p});if(c&&c[0].pos!=null){let x=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=x),m={anchor:x+o,head:b+o}}return{doc:v,sel:m,from:o,to:a}}function w7(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ln&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Ln&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const x7=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function S7(n,e,t,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let I=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,R=zy(n,I);if(R&&!n.state.selection.eq(R)){if($n&&Wr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",k=>k(n,vo(13,"Enter"))))return;let S=n.state.tr.setSelection(R);I=="pointer"?S.setMeta("pointer",!0):I=="key"&&S.scrollIntoView(),s&&S.setMeta("composition",s),n.dispatch(S)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=b7(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),f,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,p="end"):(f=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let m=k7(d.content,c.doc.content,c.from,f,p);if((Sl&&n.input.lastIOSEnter>Date.now()-225||Wr)&&i.some(I=>I.nodeType==1&&!x7.test(I.nodeName))&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",I=>I(n,vo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof Kt&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let I=T2(n,n.state.doc,c.sel);if(I&&!I.eq(n.state.selection)){let R=n.state.tr.setSelection(I);s&&R.setMeta("composition",s),n.dispatch(R)}}return}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof Kt&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),er&&js<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" "&&(m.start--,m.endA--,m.endB--);let v=c.doc.resolveNoCache(m.start-c.from),x=c.doc.resolveNoCache(m.endB-c.from),b=u.resolve(m.start),_=v.sameParent(x)&&v.parent.inlineContent&&b.end()>=m.endA,M;if((Sl&&n.input.lastIOSEnter>Date.now()-225&&(!_||i.some(I=>I.nodeName=="DIV"||I.nodeName=="P"))||!_&&v.pos<c.doc.content.size&&!v.sameParent(x)&&(M=kt.findFrom(c.doc.resolve(v.pos+1),1,!0))&&M.head==x.pos)&&n.someProp("handleKeyDown",I=>I(n,vo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&C7(u,m.start,m.endA,v,x)&&n.someProp("handleKeyDown",I=>I(n,vo(8,"Backspace")))){Wr&&$n&&n.domObserver.suppressSelectionUpdates();return}$n&&Wr&&m.endB==m.start&&(n.input.lastAndroidDelete=Date.now()),Wr&&!_&&v.start()!=x.start()&&x.parentOffset==0&&v.depth==x.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,x=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(I){return I(n,vo(13,"Enter"))})},20));let h=m.start,w=m.endA,y,E,g;if(_){if(v.pos==x.pos)er&&js<=11&&v.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>qi(n),20)),y=n.state.tr.delete(h,w),E=u.resolve(m.start).marksAcross(u.resolve(m.endA));else if(m.endA==m.endB&&(g=_7(v.parent.content.cut(v.parentOffset,x.parentOffset),b.parent.content.cut(b.parentOffset,m.endA-b.start()))))y=n.state.tr,g.type=="add"?y.addMark(h,w,g.mark):y.removeMark(h,w,g.mark);else if(v.parent.child(v.index()).isText&&v.index()==x.index()-(x.textOffset?0:1)){let I=v.parent.textBetween(v.parentOffset,x.parentOffset);if(n.someProp("handleTextInput",R=>R(n,h,w,I)))return;y=n.state.tr.insertText(I,h,w)}}if(y||(y=n.state.tr.replace(h,w,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let I=T2(n,y.doc,c.sel);I&&!($n&&Wr&&n.composing&&I.empty&&(m.start!=m.endB||n.input.lastAndroidDelete<Date.now()-100)&&(I.head==h||I.head==y.mapping.map(w)-1)||er&&I.empty&&I.head==h)&&y.setSelection(I)}E&&y.ensureMarks(E),s&&y.setMeta("composition",s),n.dispatch(y.scrollIntoView())}function T2(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Vy(n,e.resolve(t.anchor),e.resolve(t.head))}function _7(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,s=r,o,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)s=t[u].removeFromSet(s);if(i.length==1&&s.length==0)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&s.length==1)a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(Nt.from(c).eq(n))return{mark:a,type:o}}function C7(n,e,t,r,i){if(t-e<=i.pos-r.pos||Xm(r,!0,!1)<i.pos)return!1;let s=n.resolve(e);if(!r.parent.isTextblock){let a=s.nodeAfter;return a!=null&&t==e+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(Xm(s,!0,!0));return!o.parent.isTextblock||o.pos>t||Xm(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Xm(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function k7(n,e,t,r,i){let s=n.findDiffStart(e,t);if(s==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}if(o<s&&n.size<e.size){let l=r<=s&&r>=o?s-r:0;s-=l,s&&s<e.size&&A2(e.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-o),o=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,s&&s<n.size&&A2(n.textBetween(s-1,s+1))&&(s+=l?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}function A2(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class E7{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new UN,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(P2),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=I2(this),R2(this),this.nodeViews=O2(this),this.docView=c2(this.state.doc,M2(this),Ym(this),this.dom,this),this.domObserver=new g7(this,(r,i,s,o)=>S7(this,r,i,s,o)),this.domObserver.start(),WN(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&V0(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(P2),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(OE(this),o=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=O2(this);A7(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&V0(this),this.editable=I2(this),R2(this);let l=Ym(this),c=M2(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(o=!0);let f=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&aN(this);if(o){this.domObserver.stop();let p=d&&(er||$n)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&T7(i.selection,e.selection);if(d){let m=$n?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=s7(this)),(s||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=c2(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&IN(this))?qi(this,p):(bE(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&lN(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof ht){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&r2(this,t.getBoundingClientRect(),e)}else r2(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-t.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new DE(e.slice,e.move,i<0?void 0:ht.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(i=t?t(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(er){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&cN(this.dom),qi(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return pN(this,e)}coordsAtPos(e,t=1){return dE(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return bN(this,t||this.state,e)}pasteHTML(e,t){return $u(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return $u(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(JN(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Ym(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,G5())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return GN(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Ln&&this.root.nodeType===11&&eN(this.dom.ownerDocument)==this.dom?v7(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function M2(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Zs.node(0,n.state.doc.content.size,e)]}function R2(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Zs.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function I2(n){return!n.someProp("editable",e=>e(n.state)===!1)}function T7(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function O2(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function A7(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function P2(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ki={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Th={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},D2=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent),M7=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),R7=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),I7=M7||D2&&+D2[1]<57;for(var dn=0;dn<10;dn++)Ki[48+dn]=Ki[96+dn]=String(dn);for(var dn=1;dn<=24;dn++)Ki[dn+111]="F"+dn;for(var dn=65;dn<=90;dn++)Ki[dn]=String.fromCharCode(dn+32),Th[dn]=String.fromCharCode(dn);for(var Zm in Ki)Th.hasOwnProperty(Zm)||(Th[Zm]=Ki[Zm]);function zE(n){var e=I7&&(n.ctrlKey||n.altKey||n.metaKey)||R7&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Th:Ki)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function VE(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=VE(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function qE(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=qE(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let Gi=class Rn{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new Rn(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new Rn(r,i)}cutByIndex(e,t){return e==t?Rn.empty:e==0&&t==this.content.length?this:new Rn(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new Rn(i,s)}addToStart(e){return new Rn([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Rn(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return VE(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return qE(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Jd(0,e);if(e==this.size)return Jd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Jd(r+1,o):Jd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Rn.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Rn(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Rn.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new Rn(t||e,r)}static from(e){if(!e)return Rn.empty;if(e instanceof Rn)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Rn([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};Gi.empty=new Gi([],0);const Qm={index:0,offset:0};function Jd(n,e){return Qm.index=n,Qm.offset=e,Qm}let O7=class extends Error{},Ht=class Da{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=WE(this.content,e+this.openStart,t);return r&&new Da(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Da(UE(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Da.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Da(Gi.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new Da(e,r,i)}};Ht.empty=new Ht(Gi.empty,0,0);function UE(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(UE(s.content,e-i-1,t-i-1)))}function WE(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=WE(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}const JE=65535,KE=Math.pow(2,16);function P7(n,e){return n+e*KE}function $2(n){return n&JE}function D7(n){return(n-(n&JE))/KE}const GE=1,YE=2,Df=4,XE=8;let N2=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&XE)>0}get deletedBefore(){return(this.delInfo&(GE|Df))>0}get deletedAfter(){return(this.delInfo&(YE|Df))>0}get deletedAcross(){return(this.delInfo&Df)>0}},_l=class $a{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&$a.empty)return $a.empty}recover(e){let t=0,r=$2(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+D7(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:P7(a/3,e-l),v=e==l?YE:e==d?GE:Df;return(t<0?e!=l:e!=d)&&(v|=XE),new N2(p,v,m)}i+=u-c}return r?e+i:new N2(e+i,0,null)}touches(e,t){let r=0,i=$2(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new $a(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?$a.empty:new $a(e<0?[0,-e,0]:[0,0,e])}};_l.empty=new _l([]);const eg=Object.create(null);let ar=class{getMap(){return _l.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=eg[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in eg)throw new RangeError("Duplicate use of step JSON ID "+e);return eg[e]=t,t.prototype.jsonID=e,t}},Yn=class Cc{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Cc(e,null)}static fail(e){return new Cc(null,e)}static fromReplace(e,t,r,i){try{return Cc.ok(e.replace(t,r,i))}catch(s){if(s instanceof O7)return Cc.fail(s.message);throw s}}};function Ky(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(Ky(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return Gi.fromArray(r)}let ZE=class kc extends ar{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new Ht(Ky(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Yn.fromReplace(e,this.from,this.to,s)}invert(){return new QE(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new kc(t.pos,r.pos,this.mark)}merge(e){return e instanceof kc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new kc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new kc(t.from,t.to,e.markFromJSON(t.mark))}};ar.jsonID("addMark",ZE);let QE=class Ec extends ar{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Ht(Ky(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Yn.fromReplace(e,this.from,this.to,r)}invert(){return new ZE(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ec(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ec&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ec(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ec(t.from,t.to,e.markFromJSON(t.mark))}};ar.jsonID("removeMark",QE);let eT=class Tc extends ar{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Yn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Yn.fromReplace(e,this.pos,this.pos+1,new Ht(Gi.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Tc(this.pos,t.marks[i]);return new Tc(this.pos,this.mark)}}return new tT(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Tc(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Tc(t.pos,e.markFromJSON(t.mark))}};ar.jsonID("addNodeMark",eT);let tT=class U0 extends ar{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Yn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Yn.fromReplace(e,this.pos,this.pos+1,new Ht(Gi.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new eT(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new U0(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new U0(t.pos,e.markFromJSON(t.mark))}};ar.jsonID("removeNodeMark",tT);let nT=class fo extends ar{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&W0(e,this.from,this.to)?Yn.fail("Structure replace would overwrite content"):Yn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new _l([this.from,this.to-this.from,this.slice.size])}invert(e){return new fo(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new fo(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof fo)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Ht.empty:new Ht(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new fo(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Ht.empty:new Ht(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new fo(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new fo(t.from,t.to,Ht.fromJSON(e,t.slice),!!t.structure)}};ar.jsonID("replace",nT);let rT=class $f extends ar{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(W0(e,this.from,this.gapFrom)||W0(e,this.gapTo,this.to)))return Yn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Yn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Yn.fromReplace(e,this.from,this.to,r):Yn.fail("Content does not fit in gap")}getMap(){return new _l([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new $f(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new $f(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new $f(t.from,t.to,t.gapFrom,t.gapTo,Ht.fromJSON(e,t.slice),t.insert,!!t.structure)}};ar.jsonID("replaceAround",rT);function W0(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}let $7=class Nf extends ar{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Yn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Yn.fromReplace(e,this.pos,this.pos+1,new Ht(Gi.from(i),0,t.isLeaf?0:1))}getMap(){return _l.empty}invert(e){return new Nf(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Nf(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Nf(t.pos,t.attr,t.value)}};ar.jsonID("attr",$7);let Lu=class extends Error{};Lu=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Lu.prototype=Object.create(Error.prototype);Lu.prototype.constructor=Lu;Lu.prototype.name="TransformError";const tg=Object.create(null);let en=class{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new N7(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Ht.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?Ht.empty:t),a==0&&F2(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),F2(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new ju(e):Na(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?Na(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):Na(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new su(e.node(0))}static atStart(e){return Na(e,e,0,0,1)||new su(e)}static atEnd(e){return Na(e,e,e.content.size,e.childCount,-1)||new su(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=tg[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in tg)throw new RangeError("Duplicate use of selection JSON ID "+e);return tg[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ju.between(this.$anchor,this.$head).getBookmark()}};en.prototype.visible=!0;let N7=class{constructor(e,t){this.$from=e,this.$to=t}},L2=!1;function j2(n){!L2&&!n.parent.inlineContent&&(L2=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}let ju=class Ac extends en{constructor(e,t=e){j2(e),j2(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return en.near(r);let i=e.resolve(t.map(this.anchor));return new Ac(i.parent.inlineContent?i:r,r)}replace(e,t=Ht.empty){if(super.replace(e,t),t==Ht.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ac&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new iT(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ac(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=en.findFrom(t,r,!0)||en.findFrom(t,-r,!0);if(s)t=s.$head;else return en.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(en.findFrom(e,-r,!0)||en.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new Ac(e,t)}};en.jsonID("text",ju);let iT=class sT{constructor(e,t){this.anchor=e,this.head=t}map(e){return new sT(e.map(this.anchor),e.map(this.head))}resolve(e){return ju.between(e.resolve(this.anchor),e.resolve(this.head))}},Cl=class Mc extends en{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?en.near(s):new Mc(s)}content(){return new Ht(Gi.from(this.node),0,0)}eq(e){return e instanceof Mc&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new L7(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Mc(e.resolve(t.anchor))}static create(e,t){return new Mc(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}};Cl.prototype.visible=!1;en.jsonID("node",Cl);let L7=class oT{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new iT(r,r):new oT(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&Cl.isSelectable(r)?new Cl(t):en.near(t)}},su=class Lf extends en{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Ht.empty){if(t==Ht.empty){e.delete(0,e.doc.content.size);let r=en.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Lf(e)}map(e){return new Lf(e)}eq(e){return e instanceof Lf}getBookmark(){return j7}};en.jsonID("all",su);const j7={map(){return this},resolve(n){return new su(n)}};function Na(n,e,t,r,i,s=!1){if(e.inlineContent)return ju.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&Cl.isSelectable(a))return Cl.create(n,t-(i<0?a.nodeSize:0))}else{let l=Na(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function F2(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof nT||i instanceof rT))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(en.near(n.doc.resolve(o),t))}function H2(n,e){return!e||!n?n:n.bind(e)}let Kd=class{constructor(e,t,r){this.name=e,this.init=H2(t.init,r),this.apply=H2(t.apply,r)}};new Kd("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Kd("selection",{init(n,e){return n.selection||en.atStart(e.doc)},apply(n){return n.selection}}),new Kd("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Kd("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}});function aT(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=aT(i,e,{})),t[r]=i}return t}let F7=class{constructor(e){this.spec=e,this.props={},e.props&&aT(e.props,this,this.props),this.key=e.key?e.key.key:H7("plugin")}getState(e){return e[this.key]}};const ng=Object.create(null);function H7(n){return n in ng?n+"$"+ ++ng[n]:(ng[n]=0,n+"$")}const B7=typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function z7(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))B7?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function V7(n){let e=Object.create(null);for(let t in n)e[z7(t)]=n[t];return e}function rg(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function q7(n){return new F7({props:{handleKeyDown:U7(n)}})}function U7(n){let e=V7(n);return function(t,r){let i=zE(r),s,o=e[rg(i,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[rg(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=Ki[r.keyCode])&&s!=i){let a=e[rg(s,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}function lT(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=lT(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function cT(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=cT(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let Pt=class In{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:s+=r),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new In(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new In(r,i)}cutByIndex(e,t){return e==t?In.empty:e==0&&t==this.content.length?this:new In(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new In(i,s)}addToStart(e){return new In([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new In(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return lT(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return cT(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Gd(0,e);if(e==this.size)return Gd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Gd(r+1,o):Gd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return In.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new In(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return In.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new In(t||e,r)}static from(e){if(!e)return In.empty;if(e instanceof In)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new In([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};Pt.empty=new Pt([],0);const ig={index:0,offset:0};function Gd(n,e){return ig.index=n,ig.offset=e,ig}function Ah(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Ah(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Ah(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Ct=class J0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ah(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return J0.none;if(e instanceof J0)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};Ct.none=[];let K0=class extends Error{},kl=class La{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=dT(this.content,e+this.openStart,t);return r&&new La(r,this.openStart,this.openEnd)}removeBetween(e,t){return new La(uT(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return La.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new La(Pt.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new La(e,r,i)}};kl.empty=new kl(Pt.empty,0,0);function uT(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(uT(s.content,e-i-1,t-i-1)))}function dT(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=dT(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}function W7(n,e,t){if(t.openStart>n.depth)throw new K0("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new K0("Inconsistent open depths");return fT(n,e,t,0)}function fT(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=fT(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return qo(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=J7(t,n);return qo(s,pT(n,o,a,e,r))}else return qo(s,Mh(n,e,r))}function hT(n,e){if(!e.type.compatibleContent(n.type))throw new K0("Cannot join "+e.type.name+" onto "+n.type.name)}function G0(n,e,t){let r=n.node(t);return hT(r,e.node(t)),r}function Vo(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function ou(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&(Vo(n.nodeAfter,r),s++));for(let a=s;a<o;a++)Vo(i.child(a),r);e&&e.depth==t&&e.textOffset&&Vo(e.nodeBefore,r)}function qo(n,e){return n.type.checkContent(e),n.copy(e)}function pT(n,e,t,r,i){let s=n.depth>i&&G0(n,e,i+1),o=r.depth>i&&G0(t,r,i+1),a=[];return ou(null,n,i,a),s&&o&&e.index(i)==t.index(i)?(hT(s,o),Vo(qo(s,pT(n,e,t,r,i+1)),a)):(s&&Vo(qo(s,Mh(n,e,i+1)),a),ou(e,t,i,a),o&&Vo(qo(o,Mh(t,r,i+1)),a)),ou(r,null,i,a),new Pt(a)}function Mh(n,e,t){let r=[];if(ou(null,n,t,r),n.depth>t){let i=G0(n,e,t+1);Vo(qo(i,Mh(n,e,t+1)),r)}return ou(e,null,t,r),new Pt(r)}function J7(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(Pt.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Fu{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Ct.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new G7(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new Fu(t,r,s)}static resolveCached(e,t){for(let i=0;i<sg.length;i++){let s=sg[i];if(s.pos==t&&s.doc==e)return s}let r=sg[og]=Fu.resolve(e,t);return og=(og+1)%K7,r}}let sg=[],og=0,K7=12,G7=class{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}};const Y7=Object.create(null);let sl=class Y0{constructor(e,t,r,i=Ct.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||Pt.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Ah(this.attrs,t||e.defaultAttrs||Y7)&&Ct.sameSet(this.marks,r||Ct.none)}copy(e=null){return e==this.content?this:new Y0(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Y0(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return kl.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new kl(c,i.depth-o,s.depth-o)}replace(e,t,r){return W7(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Fu.resolveCached(this,e)}resolveNoCache(e){return Fu.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),mT(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=Pt.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Ct.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!Ct.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=Pt.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};sl.prototype.text=void 0;class Rh extends sl{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):mT(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Rh(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Rh(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function mT(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class ra{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new X7(e,t);if(r.next==null)return ra.empty;let i=gT(r);r.next&&r.err("Unexpected trailing text");let s=iL(rL(i));return sL(s,r),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let s=t;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function s(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return Pt.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=s(d,a.concat(u));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}ra.empty=new ra(!0);class X7{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function gT(n){let e=[];do e.push(Z7(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Z7(n){let e=[];do e.push(Q7(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Q7(n){let e=nL(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=eL(n,e);else break;return e}function B2(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function eL(n,e){let t=B2(n),r=t;return n.eat(",")&&(n.next!="}"?r=B2(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function tL(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let s in t){let o=t[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function nL(n){if(n.eat("(")){let e=gT(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=tL(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function rL(n){let e=[[]];return i(s(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}function s(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),i(s(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(s(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();i(s(o.expr,l),u),l=u}if(o.max==-1)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function yT(n,e){return e-n}function z2(n,e){let t=[];return r(e),t.sort(yT);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&t.indexOf(l)==-1&&r(l)}}}function iL(n){let e=Object.create(null);return t(z2(n,0));function t(r){let i=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);z2(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new ra(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(yT);s.next.push({type:i[o][0],next:e[a.join(",")]||t(a)})}return s}}function sL(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function vT(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function bT(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function wT(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new oL(n[t]);return e}let V2=class xT{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=wT(r.attrs),this.defaultAttrs=vT(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ra.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:bT(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new sl(this,this.computeAttrs(e),Pt.from(t),Ct.setFrom(r))}createChecked(e=null,t,r){return t=Pt.from(t),this.checkContent(t),new sl(this,this.computeAttrs(e),t,Ct.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=Pt.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(Pt.empty,!0);return s?new sl(this,e,t.append(s),Ct.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Ct.none:e}static compile(e,t){let r=Object.create(null);e.forEach((s,o)=>r[s]=new xT(s,t,o));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}},oL=class{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}},aL=class ST{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=wT(i.attrs),this.excluded=null;let s=vT(this.attrs);this.instance=s?new Ct(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Ct(this,bT(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new ST(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}};class lL{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=an.from(e.nodes),t.marks=an.from(e.marks||{}),this.nodes=V2.compile(this.spec.nodes,this),this.marks=aL.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",a=s.spec.marks;s.contentMatch=r[o]||(r[o]=ra.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=a=="_"?null:a?q2(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:q2(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof V2){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Rh(r,r.defaultAttrs,e,Ct.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return sl.fromJSON(this,e)}markFromJSON(e){return Ct.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function q2(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],s=n.marks[i],o=s;if(s)t.push(s);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}let cL=class X0{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new W2(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new W2(this,t,!0);return r.addAll(e,t.from,t.to),kl.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(fL(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=J2(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=J2(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new X0(e,X0.schemaRules(e)))}};const _T={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},uL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},CT={ol:!0,ul:!0},Ih=1,Oh=2,au=4;function U2(n,e,t){return e!=null?(e?Ih:0)|(e==="full"?Oh:0):n&&n.whitespace=="pre"?Ih|Oh:t&~au}let Yd=class{constructor(e,t,r,i,s,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=Ct.none,this.stashMarks=[],this.match=o||(a&au?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Pt.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ih)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=Pt.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Pt.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):pL(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!_T.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}},W2=class{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=U2(null,t.preserveWhitespace,0)|(r?au:0);i?s=new Yd(i.type,i.attrs,Ct.none,Ct.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new Yd(null,null,Ct.none,Ct.none,!0,null,o):s=new Yd(e.schema.topNodeType,null,Ct.none,Ct.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let i=this.readStyles(hL(r));if(!i)return;let[s,o]=i,a=this.top;for(let l=0;l<o.length;l++)this.removePendingMark(o[l],a);for(let l=0;l<s.length;l++)this.addPendingMark(s[l]);t();for(let l=0;l<s.length;l++)this.removePendingMark(s[l],a);for(let l=0;l<o.length;l++)this.addPendingMark(o[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&Oh||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Ih)r.options&Oh?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;CT.hasOwnProperty(r)&&this.parser.normalizeLists&&dL(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:uL.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(_T.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}s&&s.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,s,s.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Ct.none,r=Ct.none;for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{o.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,r]}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=U2(e,i,s.options);s.options&au&&s.content.length==0&&(o|=au),this.nodes.push(new Yd(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=mL(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}};function dL(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&CT.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function fL(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function hL(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function J2(n){let e={};for(let t in n)e[t]=n[t];return e}function pL(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function mL(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}let gL=class Rc{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=ag(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Rc.renderSpec(ag(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Rc.renderSpec(ag(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:p}=Rc.renderSpec(e,d,r);if(a.appendChild(f),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Rc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=K2(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return K2(e.marks)}};function K2(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function ag(n){return n.document||window.document}function kT(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=kT(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function ET(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=ET(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let st=class On{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new On(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new On(r,i)}cutByIndex(e,t){return e==t?On.empty:e==0&&t==this.content.length?this:new On(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new On(i,s)}addToStart(e){return new On([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new On(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return kT(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return ET(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Xd(0,e);if(e==this.size)return Xd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Xd(r+1,o):Xd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return On.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new On(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return On.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new On(t||e,r)}static from(e){if(!e)return On.empty;if(e instanceof On)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new On([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};st.empty=new st([],0);const lg={index:0,offset:0};function Xd(n,e){return lg.index=n,lg.offset=e,lg}function Z0(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Z0(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Z0(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Ph=class Q0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Z0(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Q0.none;if(e instanceof Q0)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};Ph.none=[];let yL=class extends Error{},et=class ja{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=AT(this.content,e+this.openStart,t);return r&&new ja(r,this.openStart,this.openEnd)}removeBetween(e,t){return new ja(TT(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return ja.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ja(st.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new ja(e,r,i)}};et.empty=new et(st.empty,0,0);function TT(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(TT(s.content,e-i-1,t-i-1)))}function AT(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=AT(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}function vL(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function bL(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function wL(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new xL(n[t]);return e}let xL=class{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}},SL=class MT{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=wL(i.attrs),this.excluded=null;let s=vL(this.attrs);this.instance=s?new Ph(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Ph(this,bL(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new MT(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}};const RT=65535,IT=Math.pow(2,16);function _L(n,e){return n+e*IT}function G2(n){return n&RT}function CL(n){return(n-(n&RT))/IT}const OT=1,PT=2,jf=4,DT=8;let e1=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&DT)>0}get deletedBefore(){return(this.delInfo&(OT|jf))>0}get deletedAfter(){return(this.delInfo&(PT|jf))>0}get deletedAcross(){return(this.delInfo&jf)>0}},ia=class Fa{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Fa.empty)return Fa.empty}recover(e){let t=0,r=G2(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+CL(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:_L(a/3,e-l),v=e==l?PT:e==d?OT:jf;return(t<0?e!=l:e!=d)&&(v|=DT),new e1(p,v,m)}i+=u-c}return r?e+i:new e1(e+i,0,null)}touches(e,t){let r=0,i=G2(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Fa(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Fa.empty:new Fa(e<0?[0,-e,0]:[0,0,e])}};ia.empty=new ia([]);let kL=class Ff{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new Ff(this.maps,this.mirror,e,t)}copy(){return new Ff(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Ff;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new e1(e,i,null)}};const cg=Object.create(null);let Sn=class{getMap(){return ia.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=cg[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in cg)throw new RangeError("Duplicate use of step JSON ID "+e);return cg[e]=t,t.prototype.jsonID=e,t}},Nn=class Ic{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ic(e,null)}static fail(e){return new Ic(null,e)}static fromReplace(e,t,r,i){try{return Ic.ok(e.replace(t,r,i))}catch(s){if(s instanceof yL)return Ic.fail(s.message);throw s}}};function Gy(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(Gy(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return st.fromArray(r)}let Yy=class Oc extends Sn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new et(Gy(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Nn.fromReplace(e,this.from,this.to,s)}invert(){return new hd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Oc(t.pos,r.pos,this.mark)}merge(e){return e instanceof Oc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Oc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Oc(t.from,t.to,e.markFromJSON(t.mark))}};Sn.jsonID("addMark",Yy);let hd=class Pc extends Sn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new et(Gy(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Nn.fromReplace(e,this.from,this.to,r)}invert(){return new Yy(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Pc(t.pos,r.pos,this.mark)}merge(e){return e instanceof Pc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Pc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Pc(t.from,t.to,e.markFromJSON(t.mark))}};Sn.jsonID("removeMark",hd);let Xy=class Dc extends Sn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Nn.fromReplace(e,this.pos,this.pos+1,new et(st.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Dc(this.pos,t.marks[i]);return new Dc(this.pos,this.mark)}}return new Zy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Dc(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Dc(t.pos,e.markFromJSON(t.mark))}};Sn.jsonID("addNodeMark",Xy);let Zy=class t1 extends Sn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Nn.fromReplace(e,this.pos,this.pos+1,new et(st.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Xy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new t1(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new t1(t.pos,e.markFromJSON(t.mark))}};Sn.jsonID("removeNodeMark",Zy);let Yi=class ho extends Sn{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&n1(e,this.from,this.to)?Nn.fail("Structure replace would overwrite content"):Nn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ia([this.from,this.to-this.from,this.slice.size])}invert(e){return new ho(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ho(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof ho)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?et.empty:new et(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ho(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?et.empty:new et(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ho(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ho(t.from,t.to,et.fromJSON(e,t.slice),!!t.structure)}};Sn.jsonID("replace",Yi);let ha=class Hf extends Sn{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(n1(e,this.from,this.gapFrom)||n1(e,this.gapTo,this.to)))return Nn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Nn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Nn.fromReplace(e,this.from,this.to,r):Nn.fail("Content does not fit in gap")}getMap(){return new ia([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Hf(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new Hf(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Hf(t.from,t.to,t.gapFrom,t.gapTo,et.fromJSON(e,t.slice),t.insert,!!t.structure)}};Sn.jsonID("replaceAround",ha);function n1(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function EL(n,e,t,r){let i=[],s=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=r.addToSet(d);for(let v=0;v<d.length;v++)d[v].isInSet(m)||(o&&o.to==f&&o.mark.eq(d[v])?o.to=p:i.push(o=new hd(f,p,d[v])));a&&a.to==f?a.to=p:s.push(a=new Yy(f,p,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function TL(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof SL){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let p=0;p<i.length;p++){let m=i[p];m.step==s-1&&d.eq(i[p].style)&&(f=m)}f?(f.to=c,f.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>n.step(new hd(o.from,o.to,o.style)))}function AL(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new Yi(o,c,et.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new hd(o,c,l.marks[d]));if(l.isText&&!t.spec.code){let d,f=/\r?\n|\r/g,p;for(;d=f.exec(l.text);)p||(p=new et(st.from(t.schema.text(" ",t.allowedMarks(l.marks))),0,0)),s.push(new Yi(o+d.index,o+d.index+d[0].length,p))}}o=c}if(!r.validEnd){let a=r.fillBefore(st.empty,!0);n.replace(o,o,new et(a,0,0))}for(let a=s.length-1;a>=0;a--)n.step(s[a])}function ML(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function RL(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!ML(i,s,o))break}return null}function IL(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=st.empty,d=0;for(let m=s,v=!1;m>t;m--)v||r.index(m)>0?(v=!0,u=st.from(r.node(m).copy(u)),d++):l--;let f=st.empty,p=0;for(let m=s,v=!1;m>t;m--)v||i.after(m+1)<i.end(m)?(v=!0,f=st.from(i.node(m).copy(f)),p++):c++;n.step(new ha(l,c,o,a,new et(u.append(f),d,p),u.size-d,!0))}function OL(n,e,t=null,r=n){let i=PL(n,e),s=i&&DL(r,e);return s?i.map(Y2).concat({type:e,attrs:t}).concat(s.map(Y2)):null}function Y2(n){return{type:n,attrs:null}}function PL(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function DL(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function $L(n,e,t){let r=st.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=st.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new ha(i,s,i,s,new et(r,0,0),t.length,!0))}function NL(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&LL(n.doc,n.mapping.slice(s).map(a),r)){n.clearIncompatible(n.mapping.slice(s).map(a,1),r);let l=n.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return n.step(new ha(c,u,c+1,u-1,new et(st.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function LL(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function jL(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ha(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new et(st.from(o),0,0),1,!0))}function Bf(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(f,d.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let v=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!v.type.validContent(p))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function FL(n,e,t=1,r){let i=n.doc.resolve(e),s=st.empty,o=st.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){s=st.from(i.node(a).copy(s));let u=r&&r[c];o=st.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new Yi(e,e,new et(s.append(o),t,t),!0))}function Qy(n,e){let t=n.resolve(e),r=t.index();return $T(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function $T(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function NT(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let s,o,a=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):t>0?(s=r.node(i+1),a++,o=r.node(i).maybeChild(a)):(s=r.node(i).maybeChild(a-1),o=r.node(i+1)),s&&!s.isTextblock&&$T(s,o)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function HL(n,e,t){let r=new Yi(e-t,e+t,et.empty,!0);n.step(r)}function BL(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function zL(n,e,t=e,r=et.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return LT(i,s,r)?new Yi(e,t,r):new VL(i,s,r).fit()}function LT(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let VL=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=st.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=st.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new et(s,o,a);return e>-1?new ha(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Yi(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=ug(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(st.from(o),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ug(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new et(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ug(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new et($c(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new et($c(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let v=0;v<i.childCount;v++)u.push(i.child(v));d=d.matchFragment(i)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),x=d.matchType(v.type);if(!x)break;c++,(c>1||l==0||v.content.size)&&(d=x,u.push(jT(v.mark(f.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=Nc(this.placed,t,st.from(u)),this.frontier[t].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=a;v<p;v++){let b=x.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),x=b.content}this.unplaced=m?e==0?et.empty:new et($c(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new et($c(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!dg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=dg(e,t,i,r,s);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=dg(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Nc(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Nc(this.placed,this.depth,st.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(st.empty,!0);t.childCount&&(this.placed=Nc(this.placed,this.frontier.length,t))}};function $c(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy($c(n.firstChild.content,e-1,t)))}function Nc(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Nc(n.lastChild.content,e-1,t)))}function ug(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function jT(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,jT(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(st.empty,!0)))),n.copy(r)}function dg(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!qL(t,s.content,o)?a:null}function qL(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function UL(n){return n.spec.defining||n.spec.definingForContent}function WL(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(LT(i,s,r))return n.step(new Yi(e,t,r));let o=HT(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let f=i.depth,p=i.pos-1;f>0;f--,p--){let m=i.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(f)>-1?a=f:i.before(f)==p&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f],m=UL(p.type);if(m&&!p.sameMarkup(i.node(Math.abs(a)-1)))u=f;else if(m||!p.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),m=c[p];if(m)for(let v=0;v<o.length;v++){let x=o[(v+l)%o.length],b=!0;x<0&&(b=!1,x=-x);let _=i.node(x-1),M=i.index(x-1);if(_.canReplaceWith(M,M,m.type,m.marks))return n.replace(i.before(x),b?s.after(x):t,new et(FT(r.content,0,r.openStart,p),p,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let p=o[f];p<0||(e=i.before(p),t=s.after(p))}}function FT(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(FT(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(st.empty,!0))}return n}function JL(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=BL(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new et(st.from(r),0,0))}function KL(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=HT(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function HT(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}let BT=class zf extends Sn{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Nn.fromReplace(e,this.pos,this.pos+1,new et(st.from(i),0,t.isLeaf?0:1))}getMap(){return ia.empty}invert(e){return new zf(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new zf(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new zf(t.pos,t.attr,t.value)}};Sn.jsonID("attr",BT);let zT=class r1 extends Sn{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Nn.ok(r)}getMap(){return ia.empty}invert(e){return new r1(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new r1(t.attr,t.value)}};Sn.jsonID("docAttr",zT);let El=class extends Error{};El=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};El.prototype=Object.create(Error.prototype);El.prototype.constructor=El;El.prototype.name="TransformError";let GL=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new kL}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new El(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=et.empty){let i=zL(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new et(st.from(r),0,0))}delete(e,t){return this.replace(e,t,et.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return WL(this,e,t,r),this}replaceRangeWith(e,t,r){return JL(this,e,t,r),this}deleteRange(e,t){return KL(this,e,t),this}lift(e,t){return IL(this,e,t),this}join(e,t=1){return HL(this,e,t),this}wrap(e,t){return $L(this,e,t),this}setBlockType(e,t=e,r,i=null){return NL(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return jL(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new BT(e,t,r)),this}setDocAttribute(e,t){return this.step(new zT(e,t)),this}addNodeMark(e,t){return this.step(new Xy(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Ph)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Zy(e,t)),this}split(e,t=1,r){return FL(this,e,t,r),this}addMark(e,t,r){return EL(this,e,t,r),this}removeMark(e,t,r){return TL(this,e,t,r),this}clearIncompatible(e,t,r){return AL(this,e,t,r),this}};function VT(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=VT(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function qT(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=qT(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class ce{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,t-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new ce(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),i+=a.nodeSize),o=l}return new ce(r,i)}cutByIndex(e,t){return e==t?ce.empty:e==0&&t==this.content.length?this:new ce(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new ce(i,s)}addToStart(e){return new ce([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ce(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return VT(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return qT(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Zd(0,e);if(e==this.size)return Zd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Zd(r+1,o):Zd(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return ce.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new ce(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ce.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new ce(t||e,r)}static from(e){if(!e)return ce.empty;if(e instanceof ce)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ce([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ce.empty=new ce([],0);const fg={index:0,offset:0};function Zd(n,e){return fg.index=n,fg.offset=e,fg}function i1(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!i1(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!i1(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let dr=class s1{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&i1(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return s1.none;if(e instanceof s1)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};dr.none=[];class UT extends Error{}class fe{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=JT(this.content,e+this.openStart,t);return r&&new fe(r,this.openStart,this.openEnd)}removeBetween(e,t){return new fe(WT(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return fe.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new fe(ce.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new fe(e,r,i)}}fe.empty=new fe(ce.empty,0,0);function WT(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(i==e||s.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(WT(s.content,e-i-1,t-i-1)))}function JT(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=JT(o.content,e-s-1,t);return a&&n.replaceChild(i,o.copy(a))}class o1{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}function YL(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function XL(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function ZL(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new QL(n[t]);return e}class QL{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class ev{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=ZL(i.attrs),this.excluded=null;let s=YL(this.attrs);this.instance=s?new dr(this,s):null}create(e=null){return!e&&this.instance?this.instance:new dr(this,XL(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new ev(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}let KT=class a1{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Z2(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Z2(this,t,!0);return r.addAll(e,t.from,t.to),fe.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(nj(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Q2(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Q2(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new a1(e,a1.schemaRules(e)))}};const GT={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ej={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},YT={ol:!0,ul:!0},Dh=1,$h=2,lu=4;function X2(n,e,t){return e!=null?(e?Dh:0)|(e==="full"?$h:0):n&&n.whitespace=="pre"?Dh|$h:t&~lu}class Qd{constructor(e,t,r,i,s,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=dr.none,this.stashMarks=[],this.match=o||(a&lu?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(ce.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Dh)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=ce.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(ce.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):ij(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!GT.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Z2{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=X2(null,t.preserveWhitespace,0)|(r?lu:0);i?s=new Qd(i.type,i.attrs,dr.none,dr.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new Qd(null,null,dr.none,dr.none,!0,null,o):s=new Qd(e.schema.topNodeType,null,dr.none,dr.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style");if(!t)this.addElement(e);else{let r=this.readStyles(rj(t));if(!r)return;let[i,s]=r,o=this.top;for(let a=0;a<s.length;a++)this.removePendingMark(s[a],o);for(let a=0;a<i.length;a++)this.addPendingMark(i[a]);this.addElement(e);for(let a=0;a<i.length;a++)this.removePendingMark(i[a],o);for(let a=0;a<s.length;a++)this.addPendingMark(s[a])}}}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&$h||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Dh)r.options&$h?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;YT.hasOwnProperty(r)&&this.parser.normalizeLists&&tj(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:ej.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(GT.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(a),this.needsBlock=l}else this.addElementByRule(e,s,s.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=dr.none,r=dr.none;e:for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)continue e;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.forEach(a=>{o.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,r]}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=X2(e,i,s.options);s.options&lu&&s.content.length==0&&(o|=lu),this.nodes.push(new Qd(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=sj(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}}function tj(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&YT.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function nj(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function rj(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Q2(n){let e={};for(let t in n)e[t]=n[t];return e}function ij(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function sj(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Ao{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=hg(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Ao.renderSpec(hg(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Ao.renderSpec(hg(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:p}=Ao.renderSpec(e,d,r);if(a.appendChild(f),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ao(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=ex(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return ex(e.marks)}}function ex(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function hg(n){return n.document||window.document}const XT=65535,ZT=Math.pow(2,16);function oj(n,e){return n+e*ZT}function tx(n){return n&XT}function aj(n){return(n-(n&XT))/ZT}const QT=1,e3=2,Vf=4,t3=8;let l1=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&t3)>0}get deletedBefore(){return(this.delInfo&(QT|Vf))>0}get deletedAfter(){return(this.delInfo&(e3|Vf))>0}get deletedAcross(){return(this.delInfo&Vf)>0}},Tl=class Ha{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ha.empty)return Ha.empty}recover(e){let t=0,r=tx(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+aj(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:oj(a/3,e-l),v=e==l?e3:e==d?QT:Vf;return(t<0?e!=l:e!=d)&&(v|=t3),new l1(p,v,m)}i+=u-c}return r?e+i:new l1(e+i,0,null)}touches(e,t){let r=0,i=tx(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Ha(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ha.empty:new Ha(e<0?[0,-e,0]:[0,0,e])}};Tl.empty=new Tl([]);class ol{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new ol(this.maps,this.mirror,e,t)}copy(){return new ol(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new ol;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new l1(e,i,null)}}const pg=Object.create(null);let lr=class{getMap(){return Tl.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=pg[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in pg)throw new RangeError("Duplicate use of step JSON ID "+e);return pg[e]=t,t.prototype.jsonID=e,t}},Xn=class Lc{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Lc(e,null)}static fail(e){return new Lc(null,e)}static fromReplace(e,t,r,i){try{return Lc.ok(e.replace(t,r,i))}catch(s){if(s instanceof UT)return Lc.fail(s.message);throw s}}};function tv(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(tv(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return ce.fromArray(r)}let nv=class jc extends lr{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new fe(tv(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Xn.fromReplace(e,this.from,this.to,s)}invert(){return new pd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new jc(t.pos,r.pos,this.mark)}merge(e){return e instanceof jc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new jc(t.from,t.to,e.markFromJSON(t.mark))}};lr.jsonID("addMark",nv);let pd=class Fc extends lr{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new fe(tv(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Xn.fromReplace(e,this.from,this.to,r)}invert(){return new nv(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Fc(t.pos,r.pos,this.mark)}merge(e){return e instanceof Fc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Fc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Fc(t.from,t.to,e.markFromJSON(t.mark))}};lr.jsonID("removeMark",pd);let rv=class Hc extends lr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Xn.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Hc(this.pos,t.marks[i]);return new Hc(this.pos,this.mark)}}return new iv(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hc(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Hc(t.pos,e.markFromJSON(t.mark))}};lr.jsonID("addNodeMark",rv);let iv=class c1 extends lr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Xn.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new rv(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new c1(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new c1(t.pos,e.markFromJSON(t.mark))}};lr.jsonID("removeNodeMark",iv);let ts=class po extends lr{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&u1(e,this.from,this.to)?Xn.fail("Structure replace would overwrite content"):Xn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Tl([this.from,this.to-this.from,this.slice.size])}invert(e){return new po(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new po(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof po)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new po(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new po(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new po(t.from,t.to,fe.fromJSON(e,t.slice),!!t.structure)}};lr.jsonID("replace",ts);let Xi=class qf extends lr{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(u1(e,this.from,this.gapFrom)||u1(e,this.gapTo,this.to)))return Xn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Xn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Xn.fromReplace(e,this.from,this.to,r):Xn.fail("Content does not fit in gap")}getMap(){return new Tl([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new qf(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new qf(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new qf(t.from,t.to,t.gapFrom,t.gapTo,fe.fromJSON(e,t.slice),t.insert,!!t.structure)}};lr.jsonID("replaceAround",Xi);function u1(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function lj(n,e,t,r){let i=[],s=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=r.addToSet(d);for(let v=0;v<d.length;v++)d[v].isInSet(m)||(o&&o.to==f&&o.mark.eq(d[v])?o.to=p:i.push(o=new pd(f,p,d[v])));a&&a.to==f?a.to=p:s.push(a=new nv(f,p,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function cj(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof ev){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],f;for(let p=0;p<i.length;p++){let m=i[p];m.step==s-1&&d.eq(i[p].style)&&(f=m)}f?(f.to=c,f.step=s):i.push({style:d,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>n.step(new pd(o.from,o.to,o.style)))}function uj(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new ts(o,c,fe.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new pd(o,c,l.marks[d]))}o=c}if(!r.validEnd){let a=r.fillBefore(ce.empty,!0);n.replace(o,o,new fe(a,0,0))}for(let a=s.length-1;a>=0;a--)n.step(s[a])}function dj(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Lp(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!dj(i,s,o))break}return null}function fj(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=ce.empty,d=0;for(let m=s,v=!1;m>t;m--)v||r.index(m)>0?(v=!0,u=ce.from(r.node(m).copy(u)),d++):l--;let f=ce.empty,p=0;for(let m=s,v=!1;m>t;m--)v||i.after(m+1)<i.end(m)?(v=!0,f=ce.from(i.node(m).copy(f)),p++):c++;n.step(new Xi(l,c,o,a,new fe(u.append(f),d,p),u.size-d,!0))}function hj(n,e,t=null,r=n){let i=pj(n,e),s=i&&mj(r,e);return s?i.map(nx).concat({type:e,attrs:t}).concat(s.map(nx)):null}function nx(n){return{type:n,attrs:null}}function pj(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function mj(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function gj(n,e,t){let r=ce.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ce.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new Xi(i,s,i,s,new fe(r,0,0),t.length,!0))}function yj(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&vj(n.doc,n.mapping.slice(s).map(a),r)){n.clearIncompatible(n.mapping.slice(s).map(a,1),r);let l=n.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return n.step(new Xi(c,u,c+1,u-1,new fe(ce.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function vj(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function bj(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Xi(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new fe(ce.from(o),0,0),1,!0))}function wj(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(f,d.childCount),m=r&&r[u]||d;if(m!=d&&(p=p.replaceChild(0,m.type.create(m.attrs))),!d.canReplace(f+1,d.childCount)||!m.type.validContent(p))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function xj(n,e,t=1,r){let i=n.doc.resolve(e),s=ce.empty,o=ce.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){s=ce.from(i.node(a).copy(s));let u=r&&r[c];o=ce.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new ts(e,e,new fe(s.append(o),t,t),!0))}function jp(n,e){let t=n.resolve(e),r=t.index();return n3(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function n3(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function r3(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let s,o,a=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):t>0?(s=r.node(i+1),a++,o=r.node(i).maybeChild(a)):(s=r.node(i).maybeChild(a-1),o=r.node(i+1)),s&&!s.isTextblock&&n3(s,o)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function Sj(n,e,t){let r=new ts(e-t,e+t,fe.empty,!0);n.step(r)}function _j(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function i3(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Fp(n,e,t=e,r=fe.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return s3(i,s,r)?new ts(e,t,r):new Cj(i,s,r).fit()}function s3(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Cj{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=ce.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=ce.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new fe(s,o,a);return e>-1?new Xi(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ts(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=mg(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(ce.from(o),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=mg(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new fe(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=mg(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new fe(Bc(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new fe(Bc(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(i){for(let v=0;v<i.childCount;v++)u.push(i.child(v));d=d.matchFragment(i)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),x=d.matchType(v.type);if(!x)break;c++,(c>1||l==0||v.content.size)&&(d=x,u.push(o3(v.mark(f.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=zc(this.placed,t,ce.from(u)),this.frontier[t].match=d,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=a;v<p;v++){let b=x.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),x=b.content}this.unplaced=m?e==0?fe.empty:new fe(Bc(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new fe(Bc(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!gg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=gg(e,t,i,r,s);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=gg(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=zc(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=zc(this.placed,this.depth,ce.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(ce.empty,!0);t.childCount&&(this.placed=zc(this.placed,this.frontier.length,t))}}function Bc(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Bc(n.firstChild.content,e-1,t)))}function zc(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(zc(n.lastChild.content,e-1,t)))}function mg(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function o3(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,o3(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(ce.empty,!0)))),n.copy(r)}function gg(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!kj(t,s.content,o)?a:null}function kj(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Ej(n){return n.spec.defining||n.spec.definingForContent}function Tj(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(s3(i,s,r))return n.step(new ts(e,t,r));let o=l3(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let f=i.depth,p=i.pos-1;f>0;f--,p--){let m=i.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(f)>-1?a=f:i.before(f)==p&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f].type,m=Ej(p);if(m&&i.node(l).type!=p)u=f;else if(m||!p.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),m=c[p];if(m)for(let v=0;v<o.length;v++){let x=o[(v+l)%o.length],b=!0;x<0&&(b=!1,x=-x);let _=i.node(x-1),M=i.index(x-1);if(_.canReplaceWith(M,M,m.type,m.marks))return n.replace(i.before(x),b?s.after(x):t,new fe(a3(r.content,0,r.openStart,p),p,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let p=o[f];p<0||(e=i.before(p),t=s.after(p))}}function a3(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(a3(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(ce.empty,!0))}return n}function Aj(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=_j(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new fe(ce.from(r),0,0))}function Mj(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=l3(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function l3(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}let c3=class Uf extends lr{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Xn.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(i),0,t.isLeaf?0:1))}getMap(){return Tl.empty}invert(e){return new Uf(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Uf(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Uf(t.pos,t.attr,t.value)}};lr.jsonID("attr",c3);let Al=class extends Error{};Al=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Al.prototype=Object.create(Error.prototype);Al.prototype.constructor=Al;Al.prototype.name="TransformError";class Rj{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ol}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Al(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=fe.empty){let i=Fp(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new fe(ce.from(r),0,0))}delete(e,t){return this.replace(e,t,fe.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Tj(this,e,t,r),this}replaceRangeWith(e,t,r){return Aj(this,e,t,r),this}deleteRange(e,t){return Mj(this,e,t),this}lift(e,t){return fj(this,e,t),this}join(e,t=1){return Sj(this,e,t),this}wrap(e,t){return gj(this,e,t),this}setBlockType(e,t=e,r,i=null){return yj(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return bj(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new c3(e,t,r)),this}addNodeMark(e,t){return this.step(new rv(e,t)),this}removeNodeMark(e,t){if(!(t instanceof dr)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new iv(e,t)),this}split(e,t=1,r){return xj(this,e,t,r),this}addMark(e,t,r){return lj(this,e,t,r),this}removeMark(e,t,r){return cj(this,e,t,r),this}clearIncompatible(e,t,r){return uj(this,e,t,r),this}}const yg=Object.create(null);class We{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new u3(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=fe.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?fe.empty:t),a==0&&sx(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),sx(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new ot(e):Ba(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?Ba(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):Ba(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Zr(e.node(0))}static atStart(e){return Ba(e,e,0,0,1)||new Zr(e)}static atEnd(e){return Ba(e,e,e.content.size,e.childCount,-1)||new Zr(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=yg[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in yg)throw new RangeError("Duplicate use of selection JSON ID "+e);return yg[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ot.between(this.$anchor,this.$head).getBookmark()}}We.prototype.visible=!0;class u3{constructor(e,t){this.$from=e,this.$to=t}}let rx=!1;function ix(n){!rx&&!n.parent.inlineContent&&(rx=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ot extends We{constructor(e,t=e){ix(e),ix(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return We.near(r);let i=e.resolve(t.map(this.anchor));return new ot(i.parent.inlineContent?i:r,r)}replace(e,t=fe.empty){if(super.replace(e,t),t==fe.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ot&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Hp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ot(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=We.findFrom(t,r,!0)||We.findFrom(t,-r,!0);if(s)t=s.$head;else return We.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(We.findFrom(e,-r,!0)||We.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new ot(e,t)}}We.jsonID("text",ot);class Hp{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Hp(e.map(this.anchor),e.map(this.head))}resolve(e){return ot.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ne extends We{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?We.near(s):new Ne(s)}content(){return new fe(ce.from(this.node),0,0)}eq(e){return e instanceof Ne&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new sv(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ne(e.resolve(t.anchor))}static create(e,t){return new Ne(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ne.prototype.visible=!1;We.jsonID("node",Ne);class sv{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Hp(r,r):new sv(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&Ne.isSelectable(r)?new Ne(t):We.near(t)}}class Zr extends We{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=fe.empty){if(t==fe.empty){e.delete(0,e.doc.content.size);let r=We.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Zr(e)}map(e){return new Zr(e)}eq(e){return e instanceof Zr}getBookmark(){return Ij}}We.jsonID("all",Zr);const Ij={map(){return this},resolve(n){return new Zr(n)}};function Ba(n,e,t,r,i,s=!1){if(e.inlineContent)return ot.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&Ne.isSelectable(a))return Ne.create(n,t-(i<0?a.nodeSize:0))}else{let l=Ba(n,a,t+i,i<0?a.childCount:0,i,s);if(l)return l}t+=a.nodeSize*i}return null}function sx(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof ts||i instanceof Xi))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(We.near(n.doc.resolve(o),t))}function ox(n,e){return!e||!n?n:n.bind(e)}class ef{constructor(e,t,r){this.name=e,this.init=ox(t.init,r),this.apply=ox(t.apply,r)}}new ef("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new ef("selection",{init(n,e){return n.selection||We.atStart(e.doc)},apply(n){return n.selection}}),new ef("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new ef("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}});function d3(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=d3(i,e,{})),t[r]=i}return t}class zl{constructor(e){this.spec=e,this.props={},e.props&&d3(e.props,this,this.props),this.key=e.key?e.key.key:f3("plugin")}getState(e){return e[this.key]}}const vg=Object.create(null);function f3(n){return n in vg?n+"$"+ ++vg[n]:(vg[n]=0,n+"$")}class md{constructor(e="key"){this.key=f3(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Oj=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function h3(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Pj=(n,e,t)=>{let r=h3(n,t);if(!r)return!1;let i=ov(r);if(!i){let o=r.blockRange(),a=o&&Lp(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&y3(n,i,e))return!0;if(r.parent.content.size==0&&(Ml(s,"end")||Ne.isSelectable(s))){let o=Fp(n.doc,r.before(),r.after(),fe.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Ml(s,"end")?We.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):Ne.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Dj=(n,e,t)=>{let r=h3(n,t);if(!r)return!1;let i=ov(r);return i?p3(n,i,e):!1},$j=(n,e,t)=>{let r=m3(n,t);if(!r)return!1;let i=av(r);return i?p3(n,i,e):!1};function p3(n,e,t){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Fp(n.doc,s,l,fe.empty);if(!c||c.from!=s||c instanceof ts&&c.slice.size>=l-s)return!1;if(t){let u=n.tr.step(c);u.setSelection(ot.create(u.doc,s)),t(u.scrollIntoView())}return!0}function Ml(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Nj=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=ov(r)}let o=s&&s.nodeBefore;return!o||!Ne.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ne.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function ov(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function m3(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Lj=(n,e,t)=>{let r=m3(n,t);if(!r)return!1;let i=av(r);if(!i)return!1;let s=i.nodeAfter;if(y3(n,i,e))return!0;if(r.parent.content.size==0&&(Ml(s,"start")||Ne.isSelectable(s))){let o=Fp(n.doc,r.before(),r.after(),fe.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Ml(s,"start")?We.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):Ne.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},jj=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=av(r)}let o=s&&s.nodeAfter;return!o||!Ne.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ne.create(n.doc,s.pos)).scrollIntoView()),!0)};function av(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Fj=(n,e)=>{let t=n.selection,r=t instanceof Ne,i;if(r){if(t.node.isTextblock||!jp(n.doc,t.from))return!1;i=t.from}else if(i=r3(n.doc,t.from,-1),i==null)return!1;if(e){let s=n.tr.join(i);r&&s.setSelection(Ne.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},Hj=(n,e)=>{let t=n.selection,r;if(t instanceof Ne){if(t.node.isTextblock||!jp(n.doc,t.to))return!1;r=t.to}else if(r=r3(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Bj=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),s=i&&Lp(i);return s==null?!1:(e&&e(n.tr.lift(i,s).scrollIntoView()),!0)},zj=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function g3(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Vj=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=g3(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(We.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},qj=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Zr||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=g3(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(o,s.createAndFill());a.setSelection(ot.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},Uj=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(wj(n.doc,s))return e&&e(n.tr.split(s).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Lp(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},Wj=(n,e)=>{let{$from:t,to:r}=n.selection,i,s=t.sharedDepth(r);return s==0?!1:(i=t.before(s),e&&e(n.tr.setSelection(Ne.create(n.doc,i))),!0)};function Jj(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||jp(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function y3(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Jj(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,f=ce.empty;for(let v=s.length-1;v>=0;v--)f=ce.from(s[v].create(null,f));f=ce.from(r.copy(f));let p=n.tr.step(new Xi(e.pos-1,d,e.pos,d,new fe(f,1,0),s.length,!0)),m=d+2*s.length;jp(p.doc,m)&&p.join(m),t(p.scrollIntoView())}return!0}let l=We.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&Lp(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&Ml(i,"start",!0)&&Ml(r,"end")){let d=r,f=[];for(;f.push(d),!d.isTextblock;)d=d.lastChild;let p=i,m=1;for(;!p.isTextblock;p=p.firstChild)m++;if(d.canReplace(d.childCount,d.childCount,p.content)){if(t){let v=ce.empty;for(let b=f.length-1;b>=0;b--)v=ce.from(f[b].copy(v));let x=n.tr.step(new Xi(e.pos-f.length,e.pos+i.nodeSize,e.pos+m,e.pos+i.nodeSize-m,new fe(v,f.length,0),0,!0));t(x.scrollIntoView())}return!0}}return!1}function v3(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(ot.create(e.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const Kj=v3(-1),Gj=v3(1);function Yj(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),a=o&&hj(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function ax(n,e=null){return function(t,r){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[s];t.doc.nodesBetween(o,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];s.setBlockType(a,l,n,e)}r(s.scrollIntoView())}return!0}}typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os!="undefined"&&os.platform&&os.platform()=="darwin";const b3=65535,w3=Math.pow(2,16);function Xj(n,e){return n+e*w3}function lx(n){return n&b3}function Zj(n){return(n-(n&b3))/w3}const x3=1,S3=2,Wf=4,_3=8;class cx{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&_3)>0}get deletedBefore(){return(this.delInfo&(x3|Wf))>0}get deletedAfter(){return(this.delInfo&(S3|Wf))>0}get deletedAcross(){return(this.delInfo&Wf)>0}}class fr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&fr.empty)return fr.empty}recover(e){let t=0,r=lx(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Zj(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,p=l+i+(f<0?0:u);if(r)return p;let m=e==(t<0?l:d)?null:Xj(a/3,e-l),v=e==l?S3:e==d?x3:Wf;return(t<0?e!=l:e!=d)&&(v|=_3),new cx(p,v,m)}i+=u-c}return r?e+i:new cx(e+i,0,null)}touches(e,t){let r=0,i=lx(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new fr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?fr.empty:new fr(e<0?[0,-e,0]:[0,0,e])}}fr.empty=new fr([]);const bg=Object.create(null);class _n{getMap(){return fr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=bg[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in bg)throw new RangeError("Duplicate use of step JSON ID "+e);return bg[e]=t,t.prototype.jsonID=e,t}}class zt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new zt(e,null)}static fail(e){return new zt(null,e)}static fromReplace(e,t,r,i){try{return zt.ok(e.replace(t,r,i))}catch(s){if(s instanceof UT)return zt.fail(s.message);throw s}}}function lv(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(lv(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return ce.fromArray(r)}class Mo extends _n{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new fe(lv(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return zt.fromReplace(e,this.from,this.to,s)}invert(){return new Ro(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Mo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Mo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Mo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Mo(t.from,t.to,e.markFromJSON(t.mark))}}_n.jsonID("addMark",Mo);class Ro extends _n{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new fe(lv(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return zt.fromReplace(e,this.from,this.to,r)}invert(){return new Mo(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ro(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ro&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ro(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ro(t.from,t.to,e.markFromJSON(t.mark))}}_n.jsonID("removeMark",Ro);class Io extends _n{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return zt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return zt.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Io(this.pos,t.marks[i]);return new Io(this.pos,this.mark)}}return new Hu(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Io(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Io(t.pos,e.markFromJSON(t.mark))}}_n.jsonID("addNodeMark",Io);class Hu extends _n{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return zt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return zt.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Io(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Hu(t.pos,e.markFromJSON(t.mark))}}_n.jsonID("removeNodeMark",Hu);class xs extends _n{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&d1(e,this.from,this.to)?zt.fail("Structure replace would overwrite content"):zt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new fr([this.from,this.to-this.from,this.slice.size])}invert(e){return new xs(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new xs(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof xs)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new xs(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new xs(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new xs(t.from,t.to,fe.fromJSON(e,t.slice),!!t.structure)}}_n.jsonID("replace",xs);class Ui extends _n{constructor(e,t,r,i,s,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(d1(e,this.from,this.gapFrom)||d1(e,this.gapTo,this.to)))return zt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return zt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?zt.fromReplace(e,this.from,this.to,r):zt.fail("Content does not fit in gap")}getMap(){return new fr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ui(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new Ui(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ui(t.from,t.to,t.gapFrom,t.gapTo,fe.fromJSON(e,t.slice),t.insert,!!t.structure)}}_n.jsonID("replaceAround",Ui);function d1(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Qj(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function e9(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!Qj(i,s,o))break}return null}function t9(n,e,t=null,r=n){let i=n9(n,e),s=i&&r9(r,e);return s?i.map(ux).concat({type:e,attrs:t}).concat(s.map(ux)):null}function ux(n){return{type:n,attrs:null}}function n9(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function r9(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function i9(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),f=i.index(c);if(d.type.spec.isolating)return!1;let p=d.content.cutByIndex(f,d.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let v=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!v.type.validContent(p))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function s9(n,e){let t=n.resolve(e),r=t.index();return o9(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function o9(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}class cu extends _n{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return zt.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return zt.fromReplace(e,this.pos,this.pos+1,new fe(ce.from(i),0,t.isLeaf?0:1))}getMap(){return fr.empty}invert(e){return new cu(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new cu(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new cu(t.pos,t.attr,t.value)}}_n.jsonID("attr",cu);class Nh extends _n{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return zt.ok(r)}getMap(){return fr.empty}invert(e){return new Nh(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Nh(t.attr,t.value)}}_n.jsonID("docAttr",Nh);let Bu=class extends Error{};Bu=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Bu.prototype=Object.create(Error.prototype);Bu.prototype.constructor=Bu;Bu.prototype.name="TransformError";function a9(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let u=t.doc.resolve(o.start-2);l=new o1(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new o1(i,t.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let c=t9(l,n,e,o);return c?(r&&r(l9(t.tr,o,c,a,n).scrollIntoView()),!0):!1}}function l9(n,e,t,r,i){let s=ce.empty;for(let u=t.length-1;u>=0;u--)s=ce.from(t[u].type.create(t[u].attrs,s));n.step(new Ui(e.start-(r?2:0),e.end,e.start,e.end,new fe(s,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==i&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,f=!0;u<d;u++,f=!1)!f&&i9(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function c9(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?u9(e,t,n,s):d9(e,t,s):!0:!1}}function u9(n,e,t,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new Ui(s-1,o,s,o,new fe(ce.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new o1(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=e9(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(s,-1)-1;return s9(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}function d9(n,e,t){let r=n.tr,i=t.parent;for(let p=t.end,m=t.endIndex-1,v=t.startIndex;m>v;m--)p-=i.child(m).nodeSize,r.delete(p-1,p+1);let s=r.doc.resolve(t.start),o=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?ce.empty:ce.from(i))))return!1;let d=s.pos,f=d+o.nodeSize;return r.step(new Ui(d-(a?1:0),f+(l?1:0),d+1,f-1,new fe((a?ce.empty:ce.from(i.copy(ce.empty))).append(l?ce.empty:ce.from(i.copy(ce.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function f9(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=ce.from(c?n.create():null),d=new fe(ce.from(n.create(null,ce.from(a.type.create(null,u)))),c?3:1,0),f=s.start,p=s.end;t(e.tr.step(new Ui(f-(c?3:1),p,f,p,d,1,!0)).scrollIntoView())}return!0}}function Bp(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:s}=t;return Te(Y({},e),{apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,s=t.storedMarks,t}})}class zp{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a=[],l=!!e,c=e||s.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(f=>f===!0)),d=Te(Y({},Object.fromEntries(Object.entries(r).map(([f,p])=>[f,(...v)=>{const x=this.buildProps(c,t),b=p(...v)(x);return a.push(b),d}]))),{run:u});return d}createCan(e){const{rawCommands:t,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i),a=Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)(Te(Y({},o),{dispatch:void 0}))]));return Te(Y({},a),{chain:()=>this.createChain(s,i)})}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a={tr:e,editor:i,view:o,state:Bp({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}let h9=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}};function xe(n,e,t){return n.config[e]===void 0&&n.parent?xe(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind(Te(Y({},t),{parent:n.parent?xe(n.parent,e,t):null})):n.config[e]}function Vp(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function C3(n){const e=[],{nodeExtensions:t,markExtensions:r}=Vp(n),i=[...t,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=xe(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,p])=>{e.push({type:d,name:f,attribute:Y(Y({},s),p)})})})})}),i.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=xe(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const f=Y(Y({},s),d);typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:o.name,name:u,attribute:f})})}),e}function sn(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function rt(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r=Y({},e);return Object.entries(t).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const a=s?s.split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else i==="style"?r[i]=[r[i],s].join("; "):r[i]=s}),r},{})}function f1(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>rt(t,r),{})}function k3(n){return typeof n=="function"}function Ve(n,e=void 0,...t){return k3(n)?e?n.bind(e)(...t):n(...t):n}function p9(n={}){return Object.keys(n).length===0&&n.constructor===Object}function m9(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function dx(n,e){return n.style?n:Te(Y({},n),{getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):m9(t.getAttribute(o.name));return a==null?s:Te(Y({},s),{[o.name]:a})},{});return Y(Y({},r),i)}})}function fx(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&p9(t)?!1:t!=null))}function g9(n,e){var t;const r=C3(n),{nodeExtensions:i,markExtensions:s}=Vp(n),o=(t=i.find(c=>xe(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((b,_)=>{const M=xe(_,"extendNodeSchema",d);return Y(Y({},b),M?M(c):{})},{}),p=fx(Te(Y({},f),{content:Ve(xe(c,"content",d)),marks:Ve(xe(c,"marks",d)),group:Ve(xe(c,"group",d)),inline:Ve(xe(c,"inline",d)),atom:Ve(xe(c,"atom",d)),selectable:Ve(xe(c,"selectable",d)),draggable:Ve(xe(c,"draggable",d)),code:Ve(xe(c,"code",d)),defining:Ve(xe(c,"defining",d)),isolating:Ve(xe(c,"isolating",d)),attrs:Object.fromEntries(u.map(b=>{var _;return[b.name,{default:(_=b==null?void 0:b.attribute)===null||_===void 0?void 0:_.default}]}))})),m=Ve(xe(c,"parseHTML",d));m&&(p.parseDOM=m.map(b=>dx(b,u)));const v=xe(c,"renderHTML",d);v&&(p.toDOM=b=>v({node:b,HTMLAttributes:f1(b,u)}));const x=xe(c,"renderText",d);return x&&(p.toText=x),[c.name,p]})),l=Object.fromEntries(s.map(c=>{const u=r.filter(x=>x.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((x,b)=>{const _=xe(b,"extendMarkSchema",d);return Y(Y({},x),_?_(c):{})},{}),p=fx(Te(Y({},f),{inclusive:Ve(xe(c,"inclusive",d)),excludes:Ve(xe(c,"excludes",d)),group:Ve(xe(c,"group",d)),spanning:Ve(xe(c,"spanning",d)),code:Ve(xe(c,"code",d)),attrs:Object.fromEntries(u.map(x=>{var b;return[x.name,{default:(b=x==null?void 0:x.attribute)===null||b===void 0?void 0:b.default}]}))})),m=Ve(xe(c,"parseHTML",d));m&&(p.parseDOM=m.map(x=>dx(x,u)));const v=xe(c,"renderHTML",d);return v&&(p.toDOM=x=>v({mark:x,HTMLAttributes:f1(x,u)})),[c.name,p]}));return new lL({topNode:o,nodes:a,marks:l})}function wg(n,e){return e.nodes[n]||e.marks[n]||null}function hx(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const y9=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:s,parent:o,index:a}))||i.textContent||"%leaf%";t+=u.slice(0,Math.max(0,r-s))}),t};function cv(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class gd{constructor(e){this.find=e.find,this.handler=e.handler}}const v9=(n,e)=>{if(cv(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function xg(n){var e;const{editor:t,from:r,to:i,text:s,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const d=y9(c)+s;return o.forEach(f=>{if(u)return;const p=v9(d,f.find);if(!p)return;const m=l.state.tr,v=Bp({state:l.state,transaction:m}),x={from:r-(p[0].length-s.length),to:i},{commands:b,chain:_,can:M}=new zp({editor:t,state:v});f.handler({state:v,range:x,match:p,commands:b,chain:_,can:M})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:i,text:s}),l.dispatch(m),u=!0)}),u}function b9(n){const{editor:e,rules:t}=n,r=new Bn({state:{init(){return null},apply(i,s){const o=i.getMeta(r);return o||(i.selectionSet||i.docChanged?null:s)}},props:{handleTextInput(i,s,o,a){return xg({editor:e,from:s,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&xg({editor:e,from:s.pos,to:s.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?xg({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function w9(n){return typeof n=="number"}class x9{constructor(e){this.find=e.find,this.handler=e.handler}}const S9=(n,e,t)=>{if(cv(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=n,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function _9(n){const{editor:e,state:t,from:r,to:i,rule:s,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new zp({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,i,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const v=Math.max(r,m),x=Math.min(i,m+p.content.size),b=p.textBetween(v-m,x-m,void 0,"");S9(b,s.find,o).forEach(M=>{if(M.index===void 0)return;const h=v+M.index+1,w=h+M[0].length,y={from:t.tr.mapping.map(h),to:t.tr.mapping.map(w)},E=s.handler({state:t,range:y,match:M,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});d.push(E)})}),d.every(p=>p!==null)}function C9(n){const{editor:e,rules:t}=n;let r=null,i=!1,s=!1,o=typeof ClipboardEvent!="undefined"?new ClipboardEvent("paste"):null,a=typeof DragEvent!="undefined"?new DragEvent("drop"):null;return t.map(c=>new Bn({view(u){const d=f=>{var p;r=!((p=u.dom.parentElement)===null||p===void 0)&&p.contains(f.target)?u.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:(u,d)=>(s=r===u.dom.parentElement,a=d,!1),paste:(u,d)=>{var f;const p=(f=d.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return o=d,i=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(u,d,f)=>{const p=u[0],m=p.getMeta("uiEvent")==="paste"&&!i,v=p.getMeta("uiEvent")==="drop"&&!s;if(!m&&!v)return;const x=d.doc.content.findDiffStart(f.doc.content),b=d.doc.content.findDiffEnd(f.doc.content);if(!w9(x)||!b||x===b.b)return;const _=f.tr,M=Bp({state:f,transaction:_});if(!(!_9({editor:e,state:M,from:Math.max(x-1,0),to:b.b-1,rule:c,pasteEvent:o,dropEvent:a})||!_.steps.length))return a=typeof DragEvent!="undefined"?new DragEvent("drop"):null,o=typeof ClipboardEvent!="undefined"?new ClipboardEvent("paste"):null,_}}))}function k9(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class Ka{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Ka.resolve(e),this.schema=g9(this.extensions,t),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const s={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:wg(r.name,this.schema)};r.type==="mark"&&(!((i=Ve(xe(r,"keepOnSplit",s)))!==null&&i!==void 0)||i)&&this.splittableMarks.push(r.name);const o=xe(r,"onBeforeCreate",s);o&&this.editor.on("beforeCreate",o);const a=xe(r,"onCreate",s);a&&this.editor.on("create",a);const l=xe(r,"onUpdate",s);l&&this.editor.on("update",l);const c=xe(r,"onSelectionUpdate",s);c&&this.editor.on("selectionUpdate",c);const u=xe(r,"onTransaction",s);u&&this.editor.on("transaction",u);const d=xe(r,"onFocus",s);d&&this.editor.on("focus",d);const f=xe(r,"onBlur",s);f&&this.editor.on("blur",f);const p=xe(r,"onDestroy",s);p&&this.editor.on("destroy",p)})}static resolve(e){const t=Ka.sort(Ka.flatten(e)),r=k9(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=xe(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=xe(r,"priority")||100,o=xe(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:wg(t.name,this.schema)},i=xe(t,"addCommands",r);return i?Y(Y({},e),i()):e},{})}get plugins(){const{editor:e}=this,t=Ka.sort([...this.extensions].reverse()),r=[],i=[],s=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:wg(o.name,this.schema)},l=[],c=xe(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>mr.handleExit({editor:e,mark:o})),c){const v=Object.fromEntries(Object.entries(c()).map(([x,b])=>[x,()=>b({editor:e})]));u=Y(Y({},u),v)}const d=q7(u);l.push(d);const f=xe(o,"addInputRules",a);hx(o,e.options.enableInputRules)&&f&&r.push(...f());const p=xe(o,"addPasteRules",a);hx(o,e.options.enablePasteRules)&&p&&i.push(...p());const m=xe(o,"addProseMirrorPlugins",a);if(m){const v=m();l.push(...v)}return l}).flat();return[b9({editor:e,rules:r}),...C9({editor:e,rules:i}),...s]}get attributes(){return C3(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Vp(this.extensions);return Object.fromEntries(t.filter(r=>!!xe(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:sn(r.name,this.schema)},o=xe(r,"addNodeView",s);if(!o)return[];const a=(l,c,u,d)=>{const f=f1(l,i);return o()({editor:e,node:l,getPos:u,decorations:d,HTMLAttributes:f,extension:r})};return[r.name,a]}))}}function E9(n){return Object.prototype.toString.call(n).slice(8,-1)}function Sg(n){return E9(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function qp(n,e){const t=Y({},n);return Sg(n)&&Sg(e)&&Object.keys(e).forEach(r=>{Sg(e[r])?r in n?t[r]=qp(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class Xt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Y(Y({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ve(xe(this,"addOptions",{name:this.name}))),this.storage=Ve(xe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Xt(e)}configure(e={}){const t=this.extend();return t.options=qp(this.options,e),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Xt(Y(Y({},this.config),e));return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Ve(xe(t,"addOptions",{name:t.name})),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}}function E3(n,e,t){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=t||{};let a="",l=!0;return n.nodesBetween(r,i,(c,u,d,f)=>{var p;const m=o==null?void 0:o[c.type.name];m?(c.isBlock&&!l&&(a+=s,l=!0),d&&(a+=m({node:c,pos:u,parent:d,index:f,range:e}))):c.isText?(a+=(p=c==null?void 0:c.text)===null||p===void 0?void 0:p.slice(Math.max(r,u)-u,i-u),l=!1):c.isBlock&&!l&&(a+=s,l=!0)}),a}function T3(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const T9=Xt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Bn({key:new sr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),a=Math.max(...s.map(u=>u.$to.pos)),l=T3(t);return E3(r,{from:o,to:a},{textSerializers:l})}}})]}}),A9=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),M9=(n=!1)=>({commands:e})=>e.setContent("",n),R9=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),p=d.blockRange(f);if(!p)return;const m=RL(p);if(a.type.isTextblock){const{defaultType:v}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,v)}(m||m===0)&&e.lift(p,m)})}),!0},I9=n=>e=>n(e),O9=()=>({state:n,dispatch:e})=>qj(n,e),P9=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,s=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,s.content),r.setSelection(new qt(r.doc.resolve(o-1))),!0},D9=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const a=i.before(s),l=i.after(s);n.delete(a,l).scrollIntoView()}return!0}return!1},$9=n=>({tr:e,state:t,dispatch:r})=>{const i=sn(n,t.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const l=s.before(o),c=s.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},N9=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},L9=()=>({state:n,dispatch:e})=>Oj(n,e),j9=()=>({commands:n})=>n.keyboardShortcut("Enter"),F9=()=>({state:n,dispatch:e})=>Vj(n,e);function Lh(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:cv(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function h1(n,e,t={}){return n.find(r=>r.type===e&&Lh(r.attrs,t))}function H9(n,e,t={}){return!!h1(n,e,t)}function uv(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const i=h1([...r.node.marks],e,t);if(!i)return;let s=r.index,o=n.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(h1([...r.node.marks],e,t);s>0&&i.isInSet(n.parent.child(s-1).marks);)s-=1,o-=n.parent.child(s).nodeSize;for(;a<n.parent.childCount&&H9([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Qs(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const B9=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const s=Qs(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const d=uv(l,s,e);if(d&&d.from<=c&&d.to>=u){const f=qt.create(o,d.from,d.to);t.setSelection(f)}}return!0},z9=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function dv(n){return n instanceof qt}function zi(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function A3(n,e=null){if(!e)return null;const t=wt.atStart(n),r=wt.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,s=r.to;return e==="all"?qt.create(n,zi(0,i,s),zi(n.content.size,i,s)):qt.create(n,zi(e,i,s),zi(e,i,s))}function fv(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const V9=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:s})=>{e=Y({scrollIntoView:!0},e);const o=()=>{fv()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(s&&n===null&&!dv(t.state.selection))return o(),!0;const a=A3(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},q9=(n,e)=>t=>n.every((r,i)=>e(r,Te(Y({},t),{index:i}))),U9=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),M3=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&M3(r)}return n};function px(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return M3(t)}function jh(n,e,t){if(t=Y({slice:!0,parseOptions:{}},t),typeof n=="object"&&n!==null)try{return Array.isArray(n)&&n.length>0?Pt.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),jh("",e,t)}if(typeof n=="string"){const r=cL.fromSchema(e);return t.slice?r.parseSlice(px(n),t.parseOptions).content:r.parse(px(n),t.parseOptions)}return jh("",e,t)}function W9(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof Yi||i instanceof ha))return;const s=n.mapping.maps[r];let o=0;s.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(wt.near(n.doc.resolve(o),t))}const J9=n=>n.toString().startsWith("<"),K9=(n,e,t)=>({tr:r,dispatch:i,editor:s})=>{if(i){t=Y({parseOptions:{},updateSelection:!0},t);const o=jh(e,s.schema,{parseOptions:Y({preserveWhitespace:"full"},t.parseOptions)});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,u=!0;if((J9(o)?o:[o]).forEach(f=>{f.check(),c=c?f.isText&&f.marks.length===0:!1,u=u?f.isBlock:!1}),a===l&&u){const{parent:f}=r.doc.resolve(a);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(a-=1,l+=1)}c?Array.isArray(e)?r.insertText(e.map(f=>f.text||"").join(""),a,l):typeof e=="object"&&e&&e.text?r.insertText(e.text,a,l):r.insertText(e,a,l):r.replaceWith(a,l,o),t.updateSelection&&W9(r,r.steps.length-1,-1)}return!0},G9=()=>({state:n,dispatch:e})=>Fj(n,e),Y9=()=>({state:n,dispatch:e})=>Hj(n,e),X9=()=>({state:n,dispatch:e})=>Pj(n,e),Z9=()=>({state:n,dispatch:e})=>Lj(n,e),Q9=()=>({tr:n,state:e,dispatch:t})=>{try{const r=NT(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch(r){return!1}},eF=()=>({state:n,dispatch:e,tr:t})=>{try{const r=NT(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch(r){return!1}},tF=()=>({state:n,dispatch:e})=>Dj(n,e),nF=()=>({state:n,dispatch:e})=>$j(n,e);function hv(){return typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1}function rF(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))fv()||hv()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}const iF=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const s=rF(n).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function zu(n,e,t={}){const{from:r,to:i,empty:s}=n.selection,o=e?sn(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const p=Math.max(r,f),m=Math.min(i,f+d.nodeSize);a.push({node:d,from:p,to:m})});const l=i-r,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Lh(d.node.attrs,t,{strict:!1}));return s?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=l}const sF=(n,e={})=>({state:t,dispatch:r})=>{const i=sn(n,t.schema);return zu(t,i,e)?Bj(t,r):!1},oF=()=>({state:n,dispatch:e})=>Uj(n,e),aF=n=>({state:e,dispatch:t})=>{const r=sn(n,e.schema);return c9(r)(e,t)},lF=()=>({state:n,dispatch:e})=>zj(n,e);function Up(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function mx(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const cF=(n,e)=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const a=Up(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(s=sn(n,r.schema)),a==="mark"&&(o=Qs(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{s&&s===c.type&&t.setNodeMarkup(u,void 0,mx(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&t.addMark(u,u+c.nodeSize,o.create(mx(d.attrs,e)))})})}),!0):!1},uF=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),dF=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),fF=()=>({state:n,dispatch:e})=>Nj(n,e),hF=()=>({state:n,dispatch:e})=>jj(n,e),pF=()=>({state:n,dispatch:e})=>Wj(n,e),mF=()=>({state:n,dispatch:e})=>Gj(n,e),gF=()=>({state:n,dispatch:e})=>Kj(n,e);function R3(n,e,t={}){return jh(n,e,{slice:!1,parseOptions:t})}const yF=(n,e=!1,t={})=>({tr:r,editor:i,dispatch:s})=>{const{doc:o}=r,a=R3(n,i.schema,t);return s&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0};function yd(n,e){const t=Qs(e,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?Y({},a.attrs):{}}function vF(n,e){const t=new GL(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function bF(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function wF(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,s)=>{t(i)&&r.push({node:i,pos:s})}),r}function I3(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function pv(n){return e=>I3(e.$from,n)}function xF(n,e){const t=gL.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function SF(n,e){const t={from:0,to:n.content.size};return E3(n,t,e)}function _F(n,e){const t=sn(e,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,a=>{s.push(a)});const o=s.reverse().find(a=>a.type.name===t.name);return o?Y({},o.attrs):{}}function O3(n,e){const t=Up(typeof e=="string"?e:e.name,n.schema);return t==="node"?_F(n,e):t==="mark"?yd(n,e):{}}function CF(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function kF(n){const e=CF(n);return e.length===1?e:e.filter((t,r)=>!e.filter((s,o)=>o!==r).some(s=>t.oldRange.from>=s.oldRange.from&&t.oldRange.to<=s.oldRange.to&&t.newRange.from>=s.newRange.from&&t.newRange.to<=s.newRange.to))}function EF(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=t[s];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=e.slice(s).map(a,-1),u=e.slice(s).map(l),d=e.invert().map(c,-1),f=e.invert().map(u);r.push({oldRange:{from:d,to:f},newRange:{from:c,to:u}})})}),kF(r)}function mv(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const s=t.resolve(n-1),o=uv(s,i.type);o&&r.push(Y({mark:i},o))}):t.nodesBetween(n,e,(i,s)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function Jf(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function p1(n,e,t={}){const{empty:r,ranges:i}=n.selection,s=e?Qs(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>Lh(d.attrs,t,{strict:!1}));let o=0;const a=[];if(i.forEach(({$from:d,$to:f})=>{const p=d.pos,m=f.pos;n.doc.nodesBetween(p,m,(v,x)=>{if(!v.isText&&!v.marks.length)return;const b=Math.max(p,x),_=Math.min(m,x+v.nodeSize),M=_-b;o+=M,a.push(...v.marks.map(h=>({mark:h,from:b,to:_})))})}),o===0)return!1;const l=a.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>Lh(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=a.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,f)=>d+f.to-f.from,0);return(l>0?l+c:l)>=o}function TF(n,e,t={}){if(!e)return zu(n,null,t)||p1(n,null,t);const r=Up(e,n.schema);return r==="node"?zu(n,e,t):r==="mark"?p1(n,e,t):!1}function gx(n,e){const{nodeExtensions:t}=Vp(e),r=t.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=Ve(xe(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function AF(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function MF(n){return n instanceof ki}function P3(n,e,t){const i=n.state.doc.content.size,s=zi(e,0,i),o=zi(t,0,i),a=n.coordsAtPos(s),l=n.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),f=Math.max(a.right,l.right),p=f-d,m=u-c,b={top:c,bottom:u,left:d,right:f,width:p,height:m,x:d,y:c};return Te(Y({},b),{toJSON:()=>b})}function RF(n,e,t){var r;const{selection:i}=e;let s=null;if(dv(i)&&(s=i.$cursor),s){const a=(r=n.storedMarks)!==null&&r!==void 0?r:s.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=i;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,f)=>{if(c)return!1;if(u.isInline){const p=!f||f.type.allowsMarkType(t),m=!!t.isInSet(u.marks)||!u.marks.some(v=>v.type.excludes(t));c=p&&m}return!c}),c})}const IF=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:s}=t,{empty:o,ranges:a}=s,l=Qs(n,r.schema);if(i)if(o){const c=yd(r,l);t.addStoredMark(l.create(Y(Y({},c),e)))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(f,p)=>{const m=Math.max(p,u),v=Math.min(p+f.nodeSize,d);f.marks.find(b=>b.type===l)?f.marks.forEach(b=>{l===b.type&&t.addMark(m,v,l.create(Y(Y({},b.attrs),e)))}):t.addMark(m,v,l.create(e))})});return RF(r,t,l)},OF=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),PF=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const s=sn(n,t.schema);return s.isTextblock?i().command(({commands:o})=>ax(s,e)(t)?!0:o.clearNodes()).command(({state:o})=>ax(s,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},DF=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=zi(n,0,r.content.size),s=ki.create(r,i);e.setSelection(s)}return!0},$F=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=qt.atStart(r).from,a=qt.atEnd(r).to,l=zi(i,o,a),c=zi(s,o,a),u=qt.create(r,l,c);e.setSelection(u)}return!0},NF=n=>({state:e,dispatch:t})=>{const r=sn(n,e.schema);return f9(r)(e,t)};function yx(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e==null?void 0:e.includes(i.type.name));n.tr.ensureMarks(r)}}const LF=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:a,$to:l}=s,c=i.extensionManager.attributes,u=Jf(c,a.node().type.name,a.node().attrs);if(s instanceof ki&&s.node.isBlock)return!a.parentOffset||!Bf(o,a.pos)?!1:(r&&(n&&yx(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;s instanceof qt&&e.deleteSelection();const f=a.depth===0?void 0:bF(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&f?[{type:f,attrs:u}]:void 0,m=Bf(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&Bf(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:u}]:void 0),m&&(e.split(e.mapping.map(a.pos),1,p),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const v=e.mapping.map(a.before()),x=e.doc.resolve(v);a.node(-1).canReplaceWith(x.index(),x.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&yx(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},jF=n=>({tr:e,state:t,dispatch:r,editor:i})=>{var s;const o=sn(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const d=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let x=Pt.empty;const b=a.index(-1)?1:a.index(-2)?2:3;for(let E=a.depth-b;E>=a.depth-3;E-=1)x=Pt.from(a.node(E).copy(x));const _=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,M=Jf(d,a.node().type.name,a.node().attrs),h=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(M))||void 0;x=x.append(Pt.from(o.createAndFill(null,h)||void 0));const w=a.before(a.depth-(b-1));e.replace(w,a.after(-_),new kl(x,4-b,0));let y=-1;e.doc.nodesBetween(w,e.doc.content.size,(E,g)=>{if(y>-1)return!1;E.isTextblock&&E.content.size===0&&(y=g+1)}),y>-1&&e.setSelection(qt.near(e.doc.resolve(y))),e.scrollIntoView()}return!0}const f=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,p=Jf(d,u.type.name,u.attrs),m=Jf(d,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const v=f?[{type:o,attrs:p},{type:f,attrs:m}]:[{type:o,attrs:p}];if(!Bf(e.doc,a.pos,2))return!1;if(r){const{selection:x,storedMarks:b}=t,{splittableMarks:_}=i.extensionManager,M=b||x.$to.parentOffset&&x.$from.marks();if(e.split(a.pos,2,v).scrollIntoView(),!M||!r)return!0;const h=M.filter(w=>_.includes(w.type.name));e.ensureMarks(h)}return!0},_g=(n,e)=>{const t=pv(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Qy(n.doc,t.pos)&&n.join(t.pos),!0},Cg=(n,e)=>{const t=pv(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Qy(n.doc,r)&&n.join(r),!0},FF=(n,e,t,r={})=>({editor:i,tr:s,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,p=sn(n,o.schema),m=sn(e,o.schema),{selection:v,storedMarks:x}=o,{$from:b,$to:_}=v,M=b.blockRange(_),h=x||v.$to.parentOffset&&v.$from.marks();if(!M)return!1;const w=pv(y=>gx(y.type.name,d))(v);if(M.depth>=1&&w&&M.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(m);if(gx(w.node.type.name,d)&&p.validContent(w.node.content)&&a)return l().command(()=>(s.setNodeMarkup(w.pos,p),!0)).command(()=>_g(s,p)).command(()=>Cg(s,p)).run()}return!t||!h||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>_g(s,p)).command(()=>Cg(s,p)).run():l().command(()=>{const y=u().wrapInList(p,r),E=h.filter(g=>f.includes(g.type.name));return s.ensureMarks(E),y?!0:c.clearNodes()}).wrapInList(p,r).command(()=>_g(s,p)).command(()=>Cg(s,p)).run()},HF=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=t,o=Qs(n,r.schema);return p1(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},BF=(n,e,t={})=>({state:r,commands:i})=>{const s=sn(n,r.schema),o=sn(e,r.schema);return zu(r,s,t)?i.setNode(o):i.setNode(s,t)},zF=(n,e={})=>({state:t,commands:r})=>{const i=sn(n,t.schema);return zu(t,i,e)?r.lift(i):r.wrapIn(i,e)},VF=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(e){const o=n.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,l))}else o.delete(s.from,s.to)}return!0}}return!1},qF=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},UF=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=Qs(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&o){let{from:f,to:p}=a;const m=(s=c.marks().find(x=>x.type===l))===null||s===void 0?void 0:s.attrs,v=uv(c,l,m);v&&(f=v.from,p=v.to),t.removeMark(f,p,l)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},WF=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const a=Up(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(s=sn(n,r.schema)),a==="mark"&&(o=Qs(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(d,f)=>{s&&s===d.type&&t.setNodeMarkup(f,void 0,Y(Y({},d.attrs),e)),o&&d.marks.length&&d.marks.forEach(p=>{if(o===p.type){const m=Math.max(f,c),v=Math.min(f+d.nodeSize,u);t.addMark(m,v,o.create(Y(Y({},p.attrs),e)))}})})}),!0):!1},JF=(n,e={})=>({state:t,dispatch:r})=>{const i=sn(n,t.schema);return Yj(i,e)(t,r)},KF=(n,e={})=>({state:t,dispatch:r})=>{const i=sn(n,t.schema);return a9(i,e)(t,r)};var GF=Object.freeze({__proto__:null,blur:A9,clearContent:M9,clearNodes:R9,command:I9,createParagraphNear:O9,cut:P9,deleteCurrentNode:D9,deleteNode:$9,deleteRange:N9,deleteSelection:L9,enter:j9,exitCode:F9,extendMarkRange:B9,first:z9,focus:V9,forEach:q9,insertContent:U9,insertContentAt:K9,joinUp:G9,joinDown:Y9,joinBackward:X9,joinForward:Z9,joinItemBackward:Q9,joinItemForward:eF,joinTextblockBackward:tF,joinTextblockForward:nF,keyboardShortcut:iF,lift:sF,liftEmptyBlock:oF,liftListItem:aF,newlineInCode:lF,resetAttributes:cF,scrollIntoView:uF,selectAll:dF,selectNodeBackward:fF,selectNodeForward:hF,selectParentNode:pF,selectTextblockEnd:mF,selectTextblockStart:gF,setContent:yF,setMark:IF,setMeta:OF,setNode:PF,setNodeSelection:DF,setTextSelection:$F,sinkListItem:NF,splitBlock:LF,splitListItem:jF,toggleList:FF,toggleMark:HF,toggleNode:BF,toggleWrap:zF,undoInputRule:VF,unsetAllMarks:qF,unsetMark:UF,updateAttributes:WF,wrapIn:JF,wrapInList:KF});const YF=Xt.create({name:"commands",addCommands(){return Y({},GF)}}),XF=Xt.create({name:"editable",addProseMirrorPlugins(){return[new Bn({key:new sr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ZF=Xt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Bn({key:new sr("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),QF=Xt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:f,parent:p}=d,m=d.parent.isTextblock?a.doc.resolve(f-1):d,v=m.parent.type.spec.isolating,x=d.pos-d.parentOffset,b=v&&m.parent.childCount===1?x===d.pos:wt.atStart(c).from===f;return!u||!b||!p.type.isTextblock||p.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i=Y({},r),s=Te(Y({},r),{"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return fv()||hv()?s:i},addProseMirrorPlugins(){return[new Bn({key:new sr("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(m=>m.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:s,to:o}=e.selection,a=wt.atStart(e.doc).from,l=wt.atEnd(e.doc).to;if(i||!(s===a&&o===l)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,f=Bp({state:t,transaction:d}),{commands:p}=new zp({editor:this.editor,state:f});if(p.clearNodes(),!!d.steps.length)return d}})]}}),eH=Xt.create({name:"tabindex",addProseMirrorPlugins(){return[new Bn({key:new sr("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var tH=Object.freeze({__proto__:null,ClipboardTextSerializer:T9,Commands:YF,Editable:XF,FocusEvents:ZF,Keymap:QF,Tabindex:eH});class bo{constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new bo(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new bo(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new bo(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,s=this.pos+r+(i?0:1),o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const a=new bo(o,this.editor,i,i?t:null);i&&(a.actualDepth=this.depth+1),e.push(new bo(o,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const s=i.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(s[l]!==t[l])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];return this.isBlock||!this.children||this.children.length===0||this.children.forEach(s=>{if(s.node.type.name===e){if(Object.keys(t).length>0){const o=s.node.attrs,a=Object.keys(t);for(let l=0;l<a.length;l+=1){const c=a[l];if(o[c]!==t[c])return}}if(i.push(s),r)return}i=i.concat(s.querySelectorAll(e))}),i}setAttribute(e){const t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}const nH=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function rH(n,e,t){const r=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}let iH=class extends h9{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=rH(nH,this.options.injectNonce))}setOptions(e={}){this.options=Y(Y({},this.options),e),!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=k3(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(tH):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Ka(t,this)}createCommandManager(){this.commandManager=new zp({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=R3(this.options.content,this.schema,this.options.parseOptions),t=A3(e,this.options.autofocus);this.view=new E7(this.options.element,Te(Y({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:Ja.create({doc:e,selection:t||void 0})}));const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return O3(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return TF(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return xF(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return SF(this.state.doc,{blockSeparator:t,textSerializers:Y(Y({},T3(this.schema)),r)})}get isEmpty(){return AF(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new bo(t,this)}get $doc(){return this.$pos(0)}};function sa(n){return new gd({find:n.find,handler:({state:e,range:t,match:r})=>{const i=Ve(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(mv(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===n.type&&v!==p.mark.type)).filter(p=>p.to>c).length)return null;u<t.to&&s.delete(u,t.to),c>t.from&&s.delete(t.from+l,c);const f=t.from+l+o.length;s.addMark(t.from+l,f,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}function D3(n){return new gd({find:n.find,handler:({state:e,range:t,match:r})=>{const i=Ve(n.getAttributes,void 0,r)||{},{tr:s}=e,o=t.from;let a=t.to;const l=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];s.insertText(d,o+r[0].length-1),s.replaceWith(u,a,l)}else r[0]&&s.insert(o-1,n.type.create(i)).delete(s.mapping.map(o),s.mapping.map(a));s.scrollIntoView()}})}function m1(n){return new gd({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),s=Ve(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,s)}})}function Dt(n){return new gd({find:n.find,handler:({state:e,range:t,match:r})=>{let i=n.replace,s=t.from;const o=t.to;if(r[1]){const a=r[0].lastIndexOf(r[1]);i+=r[0].slice(a+r[1].length),s+=a;const l=s-o;l>0&&(i=r[0].slice(a-l,a)+i,s=o)}e.tr.insertText(i,s,o)}})}function Vu(n){return new gd({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const s=Ve(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&OL(l,n.type,s);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:p}=n.editor.extensionManager,m=f||d.$to.parentOffset&&d.$from.marks();if(m){const v=m.filter(x=>p.includes(x.type.name));o.ensureMarks(v)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,s).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Qy(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}class mr{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Y(Y({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ve(xe(this,"addOptions",{name:this.name}))),this.storage=Ve(xe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new mr(e)}configure(e={}){const t=this.extend();return t.options=qp(this.options,e),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new mr(Y(Y({},this.config),e));return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Ve(xe(t,"addOptions",{name:t.name})),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}let Wt=class g1{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Y(Y({},this.config),e),this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ve(xe(this,"addOptions",{name:this.name}))),this.storage=Ve(xe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new g1(e)}configure(e={}){const t=this.extend();return t.options=qp(this.options,e),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new g1(Y(Y({},this.config),e));return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Ve(xe(t,"addOptions",{name:t.name})),t.storage=Ve(xe(t,"addStorage",{name:t.name,options:t.options})),t}};function zs(n){return new x9({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const s=Ve(n.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),d=t.from+l.indexOf(a),f=d+a.length;if(mv(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(x=>x===n.type&&x!==m.mark.type)).filter(m=>m.to>d).length)return null;f<t.to&&o.delete(f,t.to),d>t.from&&o.delete(t.from+u,d),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(s||{})),o.removeStoredMark(n.type)}}})}function sH(n){return n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var tr="top",Hr="bottom",Br="right",nr="left",gv="auto",vd=[tr,Hr,Br,nr],Rl="start",qu="end",oH="clippingParents",$3="viewport",ec="popper",aH="reference",vx=vd.reduce(function(n,e){return n.concat([e+"-"+Rl,e+"-"+qu])},[]),N3=[].concat(vd,[gv]).reduce(function(n,e){return n.concat([e,e+"-"+Rl,e+"-"+qu])},[]),lH="beforeRead",cH="read",uH="afterRead",dH="beforeMain",fH="main",hH="afterMain",pH="beforeWrite",mH="write",gH="afterWrite",yH=[lH,cH,uH,dH,fH,hH,pH,mH,gH];function Ai(n){return n?(n.nodeName||"").toLowerCase():null}function gr(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function oa(n){var e=gr(n).Element;return n instanceof e||n instanceof Element}function Lr(n){var e=gr(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function yv(n){if(typeof ShadowRoot=="undefined")return!1;var e=gr(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function vH(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},s=e.elements[t];!Lr(s)||!Ai(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function bH(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!Lr(i)||!Ai(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const L3={name:"applyStyles",enabled:!0,phase:"write",fn:vH,effect:bH,requires:["computeStyles"]};function bi(n){return n.split("-")[0]}var Uo=Math.max,Fh=Math.min,Il=Math.round;function y1(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function j3(){return!/^((?!chrome|android).)*safari/i.test(y1())}function Ol(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,s=1;e&&Lr(n)&&(i=n.offsetWidth>0&&Il(r.width)/n.offsetWidth||1,s=n.offsetHeight>0&&Il(r.height)/n.offsetHeight||1);var o=oa(n)?gr(n):window,a=o.visualViewport,l=!j3()&&t,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/s,d=r.width/i,f=r.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function vv(n){var e=Ol(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function F3(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&yv(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Zi(n){return gr(n).getComputedStyle(n)}function wH(n){return["table","td","th"].indexOf(Ai(n))>=0}function eo(n){return((oa(n)?n.ownerDocument:n.document)||window.document).documentElement}function Wp(n){return Ai(n)==="html"?n:n.assignedSlot||n.parentNode||(yv(n)?n.host:null)||eo(n)}function bx(n){return!Lr(n)||Zi(n).position==="fixed"?null:n.offsetParent}function xH(n){var e=/firefox/i.test(y1()),t=/Trident/i.test(y1());if(t&&Lr(n)){var r=Zi(n);if(r.position==="fixed")return null}var i=Wp(n);for(yv(i)&&(i=i.host);Lr(i)&&["html","body"].indexOf(Ai(i))<0;){var s=Zi(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function bd(n){for(var e=gr(n),t=bx(n);t&&wH(t)&&Zi(t).position==="static";)t=bx(t);return t&&(Ai(t)==="html"||Ai(t)==="body"&&Zi(t).position==="static")?e:t||xH(n)||e}function bv(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function uu(n,e,t){return Uo(n,Fh(e,t))}function SH(n,e,t){var r=uu(n,e,t);return r>t?t:r}function H3(){return{top:0,right:0,bottom:0,left:0}}function B3(n){return Object.assign({},H3(),n)}function z3(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var _H=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,B3(typeof e!="number"?e:z3(e,vd))};function CH(n){var e,t=n.state,r=n.name,i=n.options,s=t.elements.arrow,o=t.modifiersData.popperOffsets,a=bi(t.placement),l=bv(a),c=[nr,Br].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var d=_H(i.padding,t),f=vv(s),p=l==="y"?tr:nr,m=l==="y"?Hr:Br,v=t.rects.reference[u]+t.rects.reference[l]-o[l]-t.rects.popper[u],x=o[l]-t.rects.reference[l],b=bd(s),_=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,M=v/2-x/2,h=d[p],w=_-f[u]-d[m],y=_/2-f[u]/2+M,E=uu(h,y,w),g=l;t.modifiersData[r]=(e={},e[g]=E,e.centerOffset=E-y,e)}}function kH(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||F3(e.elements.popper,i)&&(e.elements.arrow=i))}const EH={name:"arrow",enabled:!0,phase:"main",fn:CH,effect:kH,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Pl(n){return n.split("-")[1]}var TH={top:"auto",right:"auto",bottom:"auto",left:"auto"};function AH(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:Il(t*i)/i||0,y:Il(r*i)/i||0}}function wx(n){var e,t=n.popper,r=n.popperRect,i=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,f=o.x,p=f===void 0?0:f,m=o.y,v=m===void 0?0:m,x=typeof u=="function"?u({x:p,y:v}):{x:p,y:v};p=x.x,v=x.y;var b=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),M=nr,h=tr,w=window;if(c){var y=bd(t),E="clientHeight",g="clientWidth";if(y===gr(t)&&(y=eo(t),Zi(y).position!=="static"&&a==="absolute"&&(E="scrollHeight",g="scrollWidth")),y=y,i===tr||(i===nr||i===Br)&&s===qu){h=Hr;var I=d&&y===w&&w.visualViewport?w.visualViewport.height:y[E];v-=I-r.height,v*=l?1:-1}if(i===nr||(i===tr||i===Hr)&&s===qu){M=Br;var R=d&&y===w&&w.visualViewport?w.visualViewport.width:y[g];p-=R-r.width,p*=l?1:-1}}var S=Object.assign({position:a},c&&TH),k=u===!0?AH({x:p,y:v},gr(t)):{x:p,y:v};if(p=k.x,v=k.y,l){var T;return Object.assign({},S,(T={},T[h]=_?"0":"",T[M]=b?"0":"",T.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",T))}return Object.assign({},S,(e={},e[h]=_?v+"px":"",e[M]=b?p+"px":"",e.transform="",e))}function MH(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,s=t.adaptive,o=s===void 0?!0:s,a=t.roundOffsets,l=a===void 0?!0:a,c={placement:bi(e.placement),variation:Pl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wx(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wx(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const RH={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:MH,data:{}};var tf={passive:!0};function IH(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,a=o===void 0?!0:o,l=gr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,tf)}),a&&l.addEventListener("resize",t.update,tf),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,tf)}),a&&l.removeEventListener("resize",t.update,tf)}}const OH={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:IH,data:{}};var PH={left:"right",right:"left",bottom:"top",top:"bottom"};function Kf(n){return n.replace(/left|right|bottom|top/g,function(e){return PH[e]})}var DH={start:"end",end:"start"};function xx(n){return n.replace(/start|end/g,function(e){return DH[e]})}function wv(n){var e=gr(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function xv(n){return Ol(eo(n)).left+wv(n).scrollLeft}function $H(n,e){var t=gr(n),r=eo(n),i=t.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var c=j3();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+xv(n),y:l}}function NH(n){var e,t=eo(n),r=wv(n),i=(e=n.ownerDocument)==null?void 0:e.body,s=Uo(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Uo(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+xv(n),l=-r.scrollTop;return Zi(i||t).direction==="rtl"&&(a+=Uo(t.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Sv(n){var e=Zi(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function V3(n){return["html","body","#document"].indexOf(Ai(n))>=0?n.ownerDocument.body:Lr(n)&&Sv(n)?n:V3(Wp(n))}function du(n,e){var t;e===void 0&&(e=[]);var r=V3(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),s=gr(r),o=i?[s].concat(s.visualViewport||[],Sv(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(du(Wp(o)))}function v1(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function LH(n,e){var t=Ol(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Sx(n,e,t){return e===$3?v1($H(n,t)):oa(e)?LH(e,t):v1(NH(eo(n)))}function jH(n){var e=du(Wp(n)),t=["absolute","fixed"].indexOf(Zi(n).position)>=0,r=t&&Lr(n)?bd(n):n;return oa(r)?e.filter(function(i){return oa(i)&&F3(i,r)&&Ai(i)!=="body"}):[]}function FH(n,e,t,r){var i=e==="clippingParents"?jH(n):[].concat(e),s=[].concat(i,[t]),o=s[0],a=s.reduce(function(l,c){var u=Sx(n,c,r);return l.top=Uo(u.top,l.top),l.right=Fh(u.right,l.right),l.bottom=Fh(u.bottom,l.bottom),l.left=Uo(u.left,l.left),l},Sx(n,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function q3(n){var e=n.reference,t=n.element,r=n.placement,i=r?bi(r):null,s=r?Pl(r):null,o=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case tr:l={x:o,y:e.y-t.height};break;case Hr:l={x:o,y:e.y+e.height};break;case Br:l={x:e.x+e.width,y:a};break;case nr:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?bv(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case Rl:l[c]=l[c]-(e[u]/2-t[u]/2);break;case qu:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function Uu(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,s=t.strategy,o=s===void 0?n.strategy:s,a=t.boundary,l=a===void 0?oH:a,c=t.rootBoundary,u=c===void 0?$3:c,d=t.elementContext,f=d===void 0?ec:d,p=t.altBoundary,m=p===void 0?!1:p,v=t.padding,x=v===void 0?0:v,b=B3(typeof x!="number"?x:z3(x,vd)),_=f===ec?aH:ec,M=n.rects.popper,h=n.elements[m?_:f],w=FH(oa(h)?h:h.contextElement||eo(n.elements.popper),l,u,o),y=Ol(n.elements.reference),E=q3({reference:y,element:M,strategy:"absolute",placement:i}),g=v1(Object.assign({},M,E)),I=f===ec?g:y,R={top:w.top-I.top+b.top,bottom:I.bottom-w.bottom+b.bottom,left:w.left-I.left+b.left,right:I.right-w.right+b.right},S=n.modifiersData.offset;if(f===ec&&S){var k=S[i];Object.keys(R).forEach(function(T){var C=[Br,Hr].indexOf(T)>=0?1:-1,D=[tr,Hr].indexOf(T)>=0?"y":"x";R[T]+=k[D]*C})}return R}function HH(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?N3:l,u=Pl(r),d=u?a?vx:vx.filter(function(m){return Pl(m)===u}):vd,f=d.filter(function(m){return c.indexOf(m)>=0});f.length===0&&(f=d);var p=f.reduce(function(m,v){return m[v]=Uu(n,{placement:v,boundary:i,rootBoundary:s,padding:o})[bi(v)],m},{});return Object.keys(p).sort(function(m,v){return p[m]-p[v]})}function BH(n){if(bi(n)===gv)return[];var e=Kf(n);return[xx(n),e,xx(e)]}function zH(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!0:o,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,f=t.altBoundary,p=t.flipVariations,m=p===void 0?!0:p,v=t.allowedAutoPlacements,x=e.options.placement,b=bi(x),_=b===x,M=l||(_||!m?[Kf(x)]:BH(x)),h=[x].concat(M).reduce(function(oe,he){return oe.concat(bi(he)===gv?HH(e,{placement:he,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:v}):he)},[]),w=e.rects.reference,y=e.rects.popper,E=new Map,g=!0,I=h[0],R=0;R<h.length;R++){var S=h[R],k=bi(S),T=Pl(S)===Rl,C=[tr,Hr].indexOf(k)>=0,D=C?"width":"height",A=Uu(e,{placement:S,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),O=C?T?Br:nr:T?Hr:tr;w[D]>y[D]&&(O=Kf(O));var P=Kf(O),N=[];if(s&&N.push(A[k]<=0),a&&N.push(A[O]<=0,A[P]<=0),N.every(function(oe){return oe})){I=S,g=!1;break}E.set(S,N)}if(g)for(var F=m?3:1,j=function(he){var ae=h.find(function(B){var ee=E.get(B);if(ee)return ee.slice(0,he).every(function(le){return le})});if(ae)return I=ae,"break"},J=F;J>0;J--){var ie=j(J);if(ie==="break")break}e.placement!==I&&(e.modifiersData[r]._skip=!0,e.placement=I,e.reset=!0)}}const VH={name:"flip",enabled:!0,phase:"main",fn:zH,requiresIfExists:["offset"],data:{_skip:!1}};function _x(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Cx(n){return[tr,Br,Hr,nr].some(function(e){return n[e]>=0})}function qH(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Uu(e,{elementContext:"reference"}),a=Uu(e,{altBoundary:!0}),l=_x(o,r),c=_x(a,i,s),u=Cx(l),d=Cx(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const UH={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:qH};function WH(n,e,t){var r=bi(n),i=[nr,tr].indexOf(r)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[nr,Br].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function JH(n){var e=n.state,t=n.options,r=n.name,i=t.offset,s=i===void 0?[0,0]:i,o=N3.reduce(function(u,d){return u[d]=WH(d,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const KH={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:JH};function GH(n){var e=n.state,t=n.name;e.modifiersData[t]=q3({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const YH={name:"popperOffsets",enabled:!0,phase:"read",fn:GH,data:{}};function XH(n){return n==="x"?"y":"x"}function ZH(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,s=i===void 0?!0:i,o=t.altAxis,a=o===void 0?!1:o,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,f=t.tether,p=f===void 0?!0:f,m=t.tetherOffset,v=m===void 0?0:m,x=Uu(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=bi(e.placement),_=Pl(e.placement),M=!_,h=bv(b),w=XH(h),y=e.modifiersData.popperOffsets,E=e.rects.reference,g=e.rects.popper,I=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,R=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),S=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(y){if(s){var T,C=h==="y"?tr:nr,D=h==="y"?Hr:Br,A=h==="y"?"height":"width",O=y[h],P=O+x[C],N=O-x[D],F=p?-g[A]/2:0,j=_===Rl?E[A]:g[A],J=_===Rl?-g[A]:-E[A],ie=e.elements.arrow,oe=p&&ie?vv(ie):{width:0,height:0},he=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:H3(),ae=he[C],B=he[D],ee=uu(0,E[A],oe[A]),le=M?E[A]/2-F-ee-ae-R.mainAxis:j-ee-ae-R.mainAxis,me=M?-E[A]/2+F+ee+B+R.mainAxis:J+ee+B+R.mainAxis,$e=e.elements.arrow&&bd(e.elements.arrow),Ke=$e?h==="y"?$e.clientTop||0:$e.clientLeft||0:0,$=(T=S==null?void 0:S[h])!=null?T:0,L=O+le-$-Ke,V=O+me-$,H=uu(p?Fh(P,L):P,O,p?Uo(N,V):N);y[h]=H,k[h]=H-O}if(a){var z,U=h==="x"?tr:nr,ne=h==="x"?Hr:Br,G=y[w],te=w==="y"?"height":"width",se=G+x[U],pe=G-x[ne],Ce=[tr,nr].indexOf(b)!==-1,_e=(z=S==null?void 0:S[w])!=null?z:0,Ae=Ce?se:G-E[te]-g[te]-_e+R.altAxis,Fe=Ce?G+E[te]+g[te]-_e-R.altAxis:pe,Xe=p&&Ce?SH(Ae,G,Fe):uu(p?Ae:se,G,p?Fe:pe);y[w]=Xe,k[w]=Xe-G}e.modifiersData[r]=k}}const QH={name:"preventOverflow",enabled:!0,phase:"main",fn:ZH,requiresIfExists:["offset"]};function eB(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function tB(n){return n===gr(n)||!Lr(n)?wv(n):eB(n)}function nB(n){var e=n.getBoundingClientRect(),t=Il(e.width)/n.offsetWidth||1,r=Il(e.height)/n.offsetHeight||1;return t!==1||r!==1}function rB(n,e,t){t===void 0&&(t=!1);var r=Lr(e),i=Lr(e)&&nB(e),s=eo(e),o=Ol(n,i,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((Ai(e)!=="body"||Sv(s))&&(a=tB(e)),Lr(e)?(l=Ol(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=xv(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function iB(n){var e=new Map,t=new Set,r=[];n.forEach(function(s){e.set(s.name,s)});function i(s){t.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(s)}return n.forEach(function(s){t.has(s.name)||i(s)}),r}function sB(n){var e=iB(n);return yH.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function oB(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function aB(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var kx={placement:"bottom",modifiers:[],strategy:"absolute"};function Ex(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function lB(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,s=i===void 0?kx:i;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},kx,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(b){var _=typeof b=="function"?b(u.options):b;v(),u.options=Object.assign({},s,u.options,_),u.scrollParents={reference:oa(a)?du(a):a.contextElement?du(a.contextElement):[],popper:du(l)};var M=sB(aB([].concat(r,u.options.modifiers)));return u.orderedModifiers=M.filter(function(h){return h.enabled}),m(),p.update()},forceUpdate:function(){if(!f){var b=u.elements,_=b.reference,M=b.popper;if(Ex(_,M)){u.rects={reference:rB(_,bd(M),u.options.strategy==="fixed"),popper:vv(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(R){return u.modifiersData[R.name]=Object.assign({},R.data)});for(var h=0;h<u.orderedModifiers.length;h++){if(u.reset===!0){u.reset=!1,h=-1;continue}var w=u.orderedModifiers[h],y=w.fn,E=w.options,g=E===void 0?{}:E,I=w.name;typeof y=="function"&&(u=y({state:u,options:g,name:I,instance:p})||u)}}}},update:oB(function(){return new Promise(function(x){p.forceUpdate(),x(u)})}),destroy:function(){v(),f=!0}};if(!Ex(a,l))return p;p.setOptions(c).then(function(x){!f&&c.onFirstUpdate&&c.onFirstUpdate(x)});function m(){u.orderedModifiers.forEach(function(x){var b=x.name,_=x.options,M=_===void 0?{}:_,h=x.effect;if(typeof h=="function"){var w=h({state:u,name:b,instance:p,options:M}),y=function(){};d.push(w||y)}})}function v(){d.forEach(function(x){return x()}),d=[]}return p}}var cB=[OH,YH,RH,L3,KH,VH,QH,EH,UH],uB=lB({defaultModifiers:cB}),dB="tippy-box",U3="tippy-content",fB="tippy-backdrop",W3="tippy-arrow",J3="tippy-svg-arrow",mo={passive:!0,capture:!0},K3=function(){return document.body};function kg(n,e,t){if(Array.isArray(n)){var r=n[e];return r==null?Array.isArray(t)?t[e]:t:r}return n}function _v(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function G3(n,e){return typeof n=="function"?n.apply(void 0,e):n}function Tx(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function hB(n){return n.split(/\s+/).filter(Boolean)}function za(n){return[].concat(n)}function Ax(n,e){n.indexOf(e)===-1&&n.push(e)}function pB(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function mB(n){return n.split("-")[0]}function Hh(n){return[].slice.call(n)}function Mx(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function fu(){return document.createElement("div")}function Jp(n){return["Element","Fragment"].some(function(e){return _v(n,e)})}function gB(n){return _v(n,"NodeList")}function yB(n){return _v(n,"MouseEvent")}function vB(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function bB(n){return Jp(n)?[n]:gB(n)?Hh(n):Array.isArray(n)?n:Hh(document.querySelectorAll(n))}function Eg(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function Rx(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function wB(n){var e,t=za(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function xB(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var s=i.popperRect,o=i.popperState,a=i.props,l=a.interactiveBorder,c=mB(o.placement),u=o.modifiersData.offset;if(!u)return!0;var d=c==="bottom"?u.top.y:0,f=c==="top"?u.bottom.y:0,p=c==="right"?u.left.x:0,m=c==="left"?u.right.x:0,v=s.top-r+d>l,x=r-s.bottom-f>l,b=s.left-t+p>l,_=t-s.right-m>l;return v||x||b||_})}function Tg(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function Ix(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var hi={isTouch:!1},Ox=0;function SB(){hi.isTouch||(hi.isTouch=!0,window.performance&&document.addEventListener("mousemove",Y3))}function Y3(){var n=performance.now();n-Ox<20&&(hi.isTouch=!1,document.removeEventListener("mousemove",Y3)),Ox=n}function _B(){var n=document.activeElement;if(vB(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function CB(){document.addEventListener("touchstart",SB,mo),window.addEventListener("blur",_B)}var kB=typeof window!="undefined"&&typeof document!="undefined",EB=kB?!!window.msCrypto:!1,TB={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},AB={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Xr=Object.assign({appendTo:K3,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},TB,AB),MB=Object.keys(Xr),RB=function(e){var t=Object.keys(e);t.forEach(function(r){Xr[r]=e[r]})};function X3(n){var e=n.plugins||[],t=e.reduce(function(r,i){var s=i.name,o=i.defaultValue;if(s){var a;r[s]=n[s]!==void 0?n[s]:(a=Xr[s])!=null?a:o}return r},{});return Object.assign({},n,t)}function IB(n,e){var t=e?Object.keys(X3(Object.assign({},Xr,{plugins:e}))):MB,r=t.reduce(function(i,s){var o=(n.getAttribute("data-tippy-"+s)||"").trim();if(!o)return i;if(s==="content")i[s]=o;else try{i[s]=JSON.parse(o)}catch(a){i[s]=o}return i},{});return r}function Px(n,e){var t=Object.assign({},e,{content:G3(e.content,[n])},e.ignoreAttributes?{}:IB(n,e.plugins));return t.aria=Object.assign({},Xr.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var OB=function(){return"innerHTML"};function b1(n,e){n[OB()]=e}function Dx(n){var e=fu();return n===!0?e.className=W3:(e.className=J3,Jp(n)?e.appendChild(n):b1(e,n)),e}function $x(n,e){Jp(e.content)?(b1(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?b1(n,e.content):n.textContent=e.content)}function w1(n){var e=n.firstElementChild,t=Hh(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(U3)}),arrow:t.find(function(r){return r.classList.contains(W3)||r.classList.contains(J3)}),backdrop:t.find(function(r){return r.classList.contains(fB)})}}function Z3(n){var e=fu(),t=fu();t.className=dB,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=fu();r.className=U3,r.setAttribute("data-state","hidden"),$x(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(s,o){var a=w1(e),l=a.box,c=a.content,u=a.arrow;o.theme?l.setAttribute("data-theme",o.theme):l.removeAttribute("data-theme"),typeof o.animation=="string"?l.setAttribute("data-animation",o.animation):l.removeAttribute("data-animation"),o.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?l.setAttribute("role",o.role):l.removeAttribute("role"),(s.content!==o.content||s.allowHTML!==o.allowHTML)&&$x(c,n.props),o.arrow?u?s.arrow!==o.arrow&&(l.removeChild(u),l.appendChild(Dx(o.arrow))):l.appendChild(Dx(o.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}Z3.$$tippy=!0;var PB=1,nf=[],Ag=[];function DB(n,e){var t=Px(n,Object.assign({},Xr,X3(Mx(e)))),r,i,s,o=!1,a=!1,l=!1,c=!1,u,d,f,p=[],m=Tx(L,t.interactiveDebounce),v,x=PB++,b=null,_=pB(t.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},h={id:x,reference:n,popper:fu(),popperInstance:b,props:t,state:M,plugins:_,clearDelayTimeouts:Ae,setProps:Fe,setContent:Xe,show:vt,hide:jt,hideWithInteractivity:cr,enable:Ce,disable:_e,unmount:rs,destroy:kd};if(!t.render)return h;var w=t.render(h),y=w.popper,E=w.onUpdate;y.setAttribute("data-tippy-root",""),y.id="tippy-"+h.id,h.popper=y,n._tippy=h,y._tippy=h;var g=_.map(function(Z){return Z.fn(h)}),I=n.hasAttribute("aria-expanded");return $e(),F(),O(),P("onCreate",[h]),t.showOnCreate&&se(),y.addEventListener("mouseenter",function(){h.props.interactive&&h.state.isVisible&&h.clearDelayTimeouts()}),y.addEventListener("mouseleave",function(){h.props.interactive&&h.props.trigger.indexOf("mouseenter")>=0&&C().addEventListener("mousemove",m)}),h;function R(){var Z=h.props.touch;return Array.isArray(Z)?Z:[Z,0]}function S(){return R()[0]==="hold"}function k(){var Z;return!!((Z=h.props.render)!=null&&Z.$$tippy)}function T(){return v||n}function C(){var Z=T().parentNode;return Z?wB(Z):document}function D(){return w1(y)}function A(Z){return h.state.isMounted&&!h.state.isVisible||hi.isTouch||u&&u.type==="focus"?0:kg(h.props.delay,Z?0:1,Xr.delay)}function O(Z){Z===void 0&&(Z=!1),y.style.pointerEvents=h.props.interactive&&!Z?"":"none",y.style.zIndex=""+h.props.zIndex}function P(Z,Se,ke){if(ke===void 0&&(ke=!0),g.forEach(function(Ze){Ze[Z]&&Ze[Z].apply(Ze,Se)}),ke){var qe;(qe=h.props)[Z].apply(qe,Se)}}function N(){var Z=h.props.aria;if(Z.content){var Se="aria-"+Z.content,ke=y.id,qe=za(h.props.triggerTarget||n);qe.forEach(function(Ze){var kn=Ze.getAttribute(Se);if(h.state.isVisible)Ze.setAttribute(Se,kn?kn+" "+ke:ke);else{var br=kn&&kn.replace(ke,"").trim();br?Ze.setAttribute(Se,br):Ze.removeAttribute(Se)}})}}function F(){if(!(I||!h.props.aria.expanded)){var Z=za(h.props.triggerTarget||n);Z.forEach(function(Se){h.props.interactive?Se.setAttribute("aria-expanded",h.state.isVisible&&Se===T()?"true":"false"):Se.removeAttribute("aria-expanded")})}}function j(){C().removeEventListener("mousemove",m),nf=nf.filter(function(Z){return Z!==m})}function J(Z){if(!(hi.isTouch&&(l||Z.type==="mousedown"))){var Se=Z.composedPath&&Z.composedPath()[0]||Z.target;if(!(h.props.interactive&&Ix(y,Se))){if(za(h.props.triggerTarget||n).some(function(ke){return Ix(ke,Se)})){if(hi.isTouch||h.state.isVisible&&h.props.trigger.indexOf("click")>=0)return}else P("onClickOutside",[h,Z]);h.props.hideOnClick===!0&&(h.clearDelayTimeouts(),h.hide(),a=!0,setTimeout(function(){a=!1}),h.state.isMounted||ae())}}}function ie(){l=!0}function oe(){l=!1}function he(){var Z=C();Z.addEventListener("mousedown",J,!0),Z.addEventListener("touchend",J,mo),Z.addEventListener("touchstart",oe,mo),Z.addEventListener("touchmove",ie,mo)}function ae(){var Z=C();Z.removeEventListener("mousedown",J,!0),Z.removeEventListener("touchend",J,mo),Z.removeEventListener("touchstart",oe,mo),Z.removeEventListener("touchmove",ie,mo)}function B(Z,Se){le(Z,function(){!h.state.isVisible&&y.parentNode&&y.parentNode.contains(y)&&Se()})}function ee(Z,Se){le(Z,Se)}function le(Z,Se){var ke=D().box;function qe(Ze){Ze.target===ke&&(Tg(ke,"remove",qe),Se())}if(Z===0)return Se();Tg(ke,"remove",d),Tg(ke,"add",qe),d=qe}function me(Z,Se,ke){ke===void 0&&(ke=!1);var qe=za(h.props.triggerTarget||n);qe.forEach(function(Ze){Ze.addEventListener(Z,Se,ke),p.push({node:Ze,eventType:Z,handler:Se,options:ke})})}function $e(){S()&&(me("touchstart",$,{passive:!0}),me("touchend",V,{passive:!0})),hB(h.props.trigger).forEach(function(Z){if(Z!=="manual")switch(me(Z,$),Z){case"mouseenter":me("mouseleave",V);break;case"focus":me(EB?"focusout":"blur",H);break;case"focusin":me("focusout",H);break}})}function Ke(){p.forEach(function(Z){var Se=Z.node,ke=Z.eventType,qe=Z.handler,Ze=Z.options;Se.removeEventListener(ke,qe,Ze)}),p=[]}function $(Z){var Se,ke=!1;if(!(!h.state.isEnabled||z(Z)||a)){var qe=((Se=u)==null?void 0:Se.type)==="focus";u=Z,v=Z.currentTarget,F(),!h.state.isVisible&&yB(Z)&&nf.forEach(function(Ze){return Ze(Z)}),Z.type==="click"&&(h.props.trigger.indexOf("mouseenter")<0||o)&&h.props.hideOnClick!==!1&&h.state.isVisible?ke=!0:se(Z),Z.type==="click"&&(o=!ke),ke&&!qe&&pe(Z)}}function L(Z){var Se=Z.target,ke=T().contains(Se)||y.contains(Se);if(!(Z.type==="mousemove"&&ke)){var qe=te().concat(y).map(function(Ze){var kn,br=Ze._tippy,ya=(kn=br.popperInstance)==null?void 0:kn.state;return ya?{popperRect:Ze.getBoundingClientRect(),popperState:ya,props:t}:null}).filter(Boolean);xB(qe,Z)&&(j(),pe(Z))}}function V(Z){var Se=z(Z)||h.props.trigger.indexOf("click")>=0&&o;if(!Se){if(h.props.interactive){h.hideWithInteractivity(Z);return}pe(Z)}}function H(Z){h.props.trigger.indexOf("focusin")<0&&Z.target!==T()||h.props.interactive&&Z.relatedTarget&&y.contains(Z.relatedTarget)||pe(Z)}function z(Z){return hi.isTouch?S()!==Z.type.indexOf("touch")>=0:!1}function U(){ne();var Z=h.props,Se=Z.popperOptions,ke=Z.placement,qe=Z.offset,Ze=Z.getReferenceClientRect,kn=Z.moveTransition,br=k()?w1(y).arrow:null,ya=Ze?{getBoundingClientRect:Ze,contextElement:Ze.contextElement||T()}:n,db={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ed){var va=Ed.state;if(k()){var oR=D(),pm=oR.box;["placement","reference-hidden","escaped"].forEach(function(Td){Td==="placement"?pm.setAttribute("data-placement",va.placement):va.attributes.popper["data-popper-"+Td]?pm.setAttribute("data-"+Td,""):pm.removeAttribute("data-"+Td)}),va.attributes.popper={}}}},no=[{name:"offset",options:{offset:qe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!kn}},db];k()&&br&&no.push({name:"arrow",options:{element:br,padding:3}}),no.push.apply(no,(Se==null?void 0:Se.modifiers)||[]),h.popperInstance=uB(ya,y,Object.assign({},Se,{placement:ke,onFirstUpdate:f,modifiers:no}))}function ne(){h.popperInstance&&(h.popperInstance.destroy(),h.popperInstance=null)}function G(){var Z=h.props.appendTo,Se,ke=T();h.props.interactive&&Z===K3||Z==="parent"?Se=ke.parentNode:Se=G3(Z,[ke]),Se.contains(y)||Se.appendChild(y),h.state.isMounted=!0,U()}function te(){return Hh(y.querySelectorAll("[data-tippy-root]"))}function se(Z){h.clearDelayTimeouts(),Z&&P("onTrigger",[h,Z]),he();var Se=A(!0),ke=R(),qe=ke[0],Ze=ke[1];hi.isTouch&&qe==="hold"&&Ze&&(Se=Ze),Se?r=setTimeout(function(){h.show()},Se):h.show()}function pe(Z){if(h.clearDelayTimeouts(),P("onUntrigger",[h,Z]),!h.state.isVisible){ae();return}if(!(h.props.trigger.indexOf("mouseenter")>=0&&h.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(Z.type)>=0&&o)){var Se=A(!1);Se?i=setTimeout(function(){h.state.isVisible&&h.hide()},Se):s=requestAnimationFrame(function(){h.hide()})}}function Ce(){h.state.isEnabled=!0}function _e(){h.hide(),h.state.isEnabled=!1}function Ae(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(s)}function Fe(Z){if(!h.state.isDestroyed){P("onBeforeUpdate",[h,Z]),Ke();var Se=h.props,ke=Px(n,Object.assign({},Se,Mx(Z),{ignoreAttributes:!0}));h.props=ke,$e(),Se.interactiveDebounce!==ke.interactiveDebounce&&(j(),m=Tx(L,ke.interactiveDebounce)),Se.triggerTarget&&!ke.triggerTarget?za(Se.triggerTarget).forEach(function(qe){qe.removeAttribute("aria-expanded")}):ke.triggerTarget&&n.removeAttribute("aria-expanded"),F(),O(),E&&E(Se,ke),h.popperInstance&&(U(),te().forEach(function(qe){requestAnimationFrame(qe._tippy.popperInstance.forceUpdate)})),P("onAfterUpdate",[h,Z])}}function Xe(Z){h.setProps({content:Z})}function vt(){var Z=h.state.isVisible,Se=h.state.isDestroyed,ke=!h.state.isEnabled,qe=hi.isTouch&&!h.props.touch,Ze=kg(h.props.duration,0,Xr.duration);if(!(Z||Se||ke||qe)&&!T().hasAttribute("disabled")&&(P("onShow",[h],!1),h.props.onShow(h)!==!1)){if(h.state.isVisible=!0,k()&&(y.style.visibility="visible"),O(),he(),h.state.isMounted||(y.style.transition="none"),k()){var kn=D(),br=kn.box,ya=kn.content;Eg([br,ya],0)}f=function(){var no;if(!(!h.state.isVisible||c)){if(c=!0,y.offsetHeight,y.style.transition=h.props.moveTransition,k()&&h.props.animation){var hm=D(),Ed=hm.box,va=hm.content;Eg([Ed,va],Ze),Rx([Ed,va],"visible")}N(),F(),Ax(Ag,h),(no=h.popperInstance)==null||no.forceUpdate(),P("onMount",[h]),h.props.animation&&k()&&ee(Ze,function(){h.state.isShown=!0,P("onShown",[h])})}},G()}}function jt(){var Z=!h.state.isVisible,Se=h.state.isDestroyed,ke=!h.state.isEnabled,qe=kg(h.props.duration,1,Xr.duration);if(!(Z||Se||ke)&&(P("onHide",[h],!1),h.props.onHide(h)!==!1)){if(h.state.isVisible=!1,h.state.isShown=!1,c=!1,o=!1,k()&&(y.style.visibility="hidden"),j(),ae(),O(!0),k()){var Ze=D(),kn=Ze.box,br=Ze.content;h.props.animation&&(Eg([kn,br],qe),Rx([kn,br],"hidden"))}N(),F(),h.props.animation?k()&&B(qe,h.unmount):h.unmount()}}function cr(Z){C().addEventListener("mousemove",m),Ax(nf,m),m(Z)}function rs(){h.state.isVisible&&h.hide(),h.state.isMounted&&(ne(),te().forEach(function(Z){Z._tippy.unmount()}),y.parentNode&&y.parentNode.removeChild(y),Ag=Ag.filter(function(Z){return Z!==h}),h.state.isMounted=!1,P("onHidden",[h]))}function kd(){h.state.isDestroyed||(h.clearDelayTimeouts(),h.unmount(),Ke(),delete n._tippy,h.state.isDestroyed=!0,P("onDestroy",[h]))}}function pa(n,e){e===void 0&&(e={});var t=Xr.plugins.concat(e.plugins||[]);CB();var r=Object.assign({},e,{plugins:t}),i=bB(n),s=i.reduce(function(o,a){var l=a&&DB(a,r);return l&&o.push(l),o},[]);return Jp(n)?s[0]:s}pa.defaultProps=Xr;pa.setDefaultProps=RB;pa.currentInput=hi;Object.assign({},L3,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});pa.setDefaultProps({render:Z3});class $B{constructor({editor:e,element:t,view:r,tippyOptions:i={},updateDelay:s=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:f}=l,{empty:p}=f,m=!d.textBetween(c,u).length&&dv(l.selection),v=this.element.contains(document.activeElement);return!(!(a.hasFocus()||v)||p||m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,u,l)},this.updateDelay))},this.updateHandler=(a,l,c,u)=>{var d,f,p;const{state:m,composing:v}=a,{selection:x}=m;if(v||!l&&!c)return;this.createTooltip();const{ranges:_}=x,M=Math.min(..._.map(y=>y.$from.pos)),h=Math.max(..._.map(y=>y.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,view:a,state:m,oldState:u,from:M,to:h}))){this.hide();return}(f=this.tippy)===null||f===void 0||f.setProps({getReferenceClientRect:((p=this.tippyOptions)===null||p===void 0?void 0:p.getReferenceClientRect)||(()=>{if(MF(m.selection)){let y=a.nodeDOM(M);const E=y.dataset.nodeViewWrapper?y:y.querySelector("[data-node-view-wrapper]");if(E&&(y=E.firstChild),y)return y.getBoundingClientRect()}return P3(a,M,h)})}),this.show()},this.editor=e,this.element=t,this.view=r,this.updateDelay=s,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=pa(e,Y({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:r}=e,i=r.selection.$from.pos!==r.selection.$to.pos;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,t);return}const s=!(t!=null&&t.selection.eq(e.state.selection)),o=!(t!=null&&t.doc.eq(e.state.doc));this.updateHandler(e,s,o,t)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Q3=n=>new Bn({key:typeof n.pluginKey=="string"?new sr(n.pluginKey):n.pluginKey,view:e=>new $B(Y({view:e},n))});Xt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[Q3({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class NB{constructor({editor:e,element:t,view:r,tippyOptions:i={},shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:l}=a,{$anchor:c,empty:u}=l,d=c.depth===1,f=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent;return!(!o.hasFocus()||!u||!d||!f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}o!=null&&o.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(o.relatedTarget))||this.hide()},this.tippyBlurHandler=o=>{this.blurHandler({event:o})},this.editor=e,this.element=t,this.view=r,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=pa(e,Y({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){var r,i,s;const{state:o}=e,{doc:a,selection:l}=o,{from:c,to:u}=l;if(t&&t.doc.eq(a)&&t.selection.eq(l))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:o,oldState:t}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((s=this.tippyOptions)===null||s===void 0?void 0:s.getReferenceClientRect)||(()=>P3(e,c,u))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const eA=n=>new Bn({key:typeof n.pluginKey=="string"?new sr(n.pluginKey):n.pluginKey,view:e=>new NB(Y({view:e},n))});Xt.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[eA({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const LB=at({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(n,{slots:e}){const t=de(null);return Et(()=>{const{updateDelay:r,editor:i,pluginKey:s,shouldShow:o,tippyOptions:a}=n;i.registerPlugin(Q3({updateDelay:r,editor:i,element:t.value,pluginKey:s,shouldShow:o,tippyOptions:a}))}),td(()=>{const{pluginKey:r,editor:i}=n;i.unregisterPlugin(r)}),()=>{var r;return gt("div",{ref:t},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});function Nx(n){return hy((e,t)=>({get(){return e(),n},set(r){n=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}class jB extends iH{constructor(e={}){return super(e),this.vueRenderers=zr(new Map),this.contentComponent=null,this.reactiveState=Nx(this.view.state),this.reactiveExtensionStorage=Nx(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),Hl(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){super.registerPlugin(e,t),this.reactiveState.value=this.view.state}unregisterPlugin(e){super.unregisterPlugin(e),this.reactiveState.value=this.view.state}}const FB=at({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const e=de(),t=Ws();return Yt(()=>{const r=n.editor;r&&r.options.element&&e.value&&Dn(()=>{if(!e.value||!r.options.element.firstChild)return;const i=we(e.value);e.value.append(...r.options.element.childNodes),r.contentComponent=t.ctx._,r.setOptions({element:i}),r.createNodeViews()})}),td(()=>{const r=n.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const i=document.createElement("div");i.append(...r.options.element.childNodes),r.setOptions({element:i})}),{rootEl:e}},render(){const n=[];return this.editor&&this.editor.vueRenderers.forEach(e=>{const t=gt(wy,{to:e.teleportElement,key:e.id},gt(e.component,Y({ref:e.id},e.props)));n.push(t)}),gt("div",{ref:e=>{this.rootEl=e}},...n)}}),HB=at({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(n,{slots:e}){const t=de(null);return Et(()=>{const{pluginKey:r,editor:i,tippyOptions:s,shouldShow:o}=n;i.registerPlugin(eA({pluginKey:r,editor:i,element:t.value,tippyOptions:s,shouldShow:o}))}),td(()=>{const{pluginKey:r,editor:i}=n;i.unregisterPlugin(r)}),()=>{var r;return gt("div",{ref:t},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});class BB{constructor(e,{props:t={},editor:r}){if(this.id=Math.floor(Math.random()*4294967295).toString(),this.editor=r,this.component=Hl(e),this.teleportElement=document.createElement("div"),this.element=this.teleportElement,this.props=zr(t),this.editor.vueRenderers.set(this.id,this),this.editor.contentComponent){if(this.editor.contentComponent.update(),this.teleportElement.children.length!==1)throw Error("VueRenderer doesnt support multiple child elements.");this.element=this.teleportElement.firstElementChild}}get ref(){var e;return(e=this.editor.contentComponent)===null||e===void 0?void 0:e.refs[this.id]}updateProps(e={}){Object.entries(e).forEach(([t,r])=>{this.props[t]=r})}destroy(){this.editor.vueRenderers.delete(this.id)}}const zB=/^\s*>\s$/,VB=Wt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Vu({find:zB,type:this.type})]}}),qB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,UB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,WB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,JB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,KB=mr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[sa({find:qB,type:this.type}),sa({find:WB,type:this.type})]},addPasteRules(){return[zs({find:UB,type:this.type}),zs({find:JB,type:this.type})]}}),GB=Wt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",rt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Lx=mr.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=yd(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),jx=/^\s*([-+*])\s$/,YB=Wt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(GB.name,this.editor.getAttributes(Lx.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Vu({find:jx,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Vu({find:jx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Lx.name),editor:this.editor})),[n]}}),XB=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,ZB=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,QB=mr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[sa({find:XB,type:this.type})]},addPasteRules(){return[zs({find:ZB,type:this.type})]}}),ez=/^```([a-z]+)?[\s\n]$/,tz=/^~~~([a-z]+)?[\s\n]$/,nz=Wt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,s=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",rt(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:s}=t;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[m1({find:ez,type:this.type,getAttributes:n=>({language:n[1]})}),m1({find:tz,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Bn({key:new sr("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!t||!s)return!1;const{tr:o}=n.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(qt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(t.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),rz=Wt.create({name:"doc",topNode:!0,content:"block+"});function iz(n={}){return new zl({view(e){return new sz(e,n)}})}class sz{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let s,o;if(!i||i==document.body&&getComputedStyle(i).position=="static")s=-pageXOffset,o=-pageYOffset;else{let a=i.getBoundingClientRect();s=a.left-i.scrollLeft,o=a.top-i.scrollTop}this.element.style.left=r.left-s+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!s){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=i3(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const oz=Xt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[iz(this.options)]}}),az=typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function lz(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))az?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function cz(n){let e=Object.create(null);for(let t in n)e[lz(t)]=n[t];return e}function Mg(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function tA(n){let e=cz(n);return function(t,r){let i=zE(r),s,o=e[Mg(i,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[Mg(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=Ki[r.keyCode])&&s!=i){let a=e[Mg(s,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const wd=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},nA=function(n,e,t,r){return t&&(Fx(n,e,t,r,-1)||Fx(n,e,t,r,1))},uz=/^(img|br|input|textarea|hr)$/i;function Fx(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Bh(n))){let s=n.parentNode;if(!s||s.nodeType!=1||fz(n)||uz.test(n.nodeName)||n.contentEditable=="false")return!1;e=wd(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Bh(n):0}else return!1}}function Bh(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function dz(n,e,t){for(let r=e==0,i=e==Bh(n);r||i;){if(n==t)return!0;let s=wd(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Bh(n)}}function fz(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const rA=function(n){return n.focusNode&&nA(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function iA(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}const Vs=typeof navigator!="undefined"?navigator:null,Hx=typeof document!="undefined"?document:null,to=Vs&&Vs.userAgent||"",x1=/Edge\/(\d+)/.exec(to),sA=/MSIE \d/.exec(to),S1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(to),xd=!!(sA||S1||x1),oA=sA?document.documentMode:S1?+S1[1]:x1?+x1[1]:0,Kp=!xd&&/gecko\/(\d+)/i.test(to);Kp&&+(/Firefox\/(\d+)/.exec(to)||[0,0])[1];const _1=!xd&&/Chrome\/(\d+)/.exec(to),Vl=!!_1,hz=_1?+_1[1]:0,ma=!xd&&!!Vs&&/Apple Computer/.test(Vs.vendor),Cv=ma&&(/Mobile\/\w+/.test(to)||!!Vs&&Vs.maxTouchPoints>2),_r=Cv||(Vs?/Mac/.test(Vs.platform):!1),Sd=/Android \d/.test(to),kv=!!Hx&&"webkitFontSmoothing"in Hx.documentElement.style,pz=kv?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function mz(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(rA(t)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&Ne.isSelectable(u)&&i.parent&&!(u.isInline&&dz(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new Ne(o==d?a:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!s?1:-1;c=lA(n,l,a,u)}return c}function aA(n){return n.editable?n.hasFocus():bz(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Ev(n,e=!1){let t=n.state.selection;if(vz(n,t),!!aA(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Vl){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&nA(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)yz(n);else{let{anchor:r,head:i}=t,s,o;Bx&&!(t instanceof ot)&&(t.$from.parent.inlineContent||(s=zx(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=zx(n,t.to))),n.docView.setSelection(r,i,n.root,e),Bx&&(s&&Vx(s),o&&Vx(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&gz(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Bx=ma||Vl&&hz<63;function zx(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(ma&&i&&i.contentEditable=="false")return Rg(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Rg(i);if(s)return Rg(s)}}function Rg(n){return n.contentEditable="true",ma&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Vx(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function gz(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!aA(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function yz(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,wd(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&xd&&oA<=11&&(r.disabled=!0,r.disabled=!1)}function vz(n,e){if(e instanceof Ne){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(qx(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else qx(n)}function qx(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function lA(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||ot.between(e,t,r)}function bz(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function C1(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&We.findFrom(s,e)}function wo(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Ux(n,e,t){let r=n.state.selection;if(r instanceof ot){if(!r.empty||t.indexOf("s")>-1)return!1;if(n.endOfTextblock(e>0?"right":"left")){let i=C1(n.state,e);return i&&i instanceof Ne?wo(n,i):!1}else if(!(_r&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?Ne.isSelectable(s)?wo(n,new Ne(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):kv?wo(n,new ot(n.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else{if(r instanceof Ne&&r.node.isInline)return wo(n,new ot(e>0?r.$to:r.$from));{let i=C1(n.state,e);return i?wo(n,i):!1}}}function zh(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function hu(n){let e=n.pmViewDesc;return e&&e.size==0&&(n.nextSibling||n.nodeName!="BR")}function Ig(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(Kp&&t.nodeType==1&&r<zh(t)&&hu(t.childNodes[r])&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(hu(a))i=t,s=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(cA(t))break;{let a=t.previousSibling;for(;a&&hu(a);)i=t.parentNode,s=wd(a),a=a.previousSibling;if(a)t=a,r=zh(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?k1(n,t,r):i&&k1(n,i,s)}function Og(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=zh(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(hu(a))s=t,o=++r;else break}else{if(cA(t))break;{let a=t.nextSibling;for(;a&&hu(a);)s=a.parentNode,o=wd(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=zh(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&k1(n,s,o)}function cA(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function k1(n,e,t){let r=n.domSelection();if(rA(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Ev(n)},50)}function Wx(n,e,t){let r=n.state.selection;if(r instanceof ot&&!r.empty||t.indexOf("s")>-1||_r&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=C1(n.state,e);if(o&&o instanceof Ne)return wo(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof Zr?We.near(o,e):We.findFrom(o,e);return a?wo(n,a):!1}return!1}function Jx(n,e){if(!(n.state.selection instanceof ot))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function Kx(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function wz(n){if(!ma||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Kx(n,r,"true"),setTimeout(()=>Kx(n,r,"false"),20)}return!1}function xz(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function Sz(n,e){let t=e.keyCode,r=xz(e);return t==8||_r&&t==72&&r=="c"?Jx(n,-1)||Ig(n):t==46||_r&&t==68&&r=="c"?Jx(n,1)||Og(n):t==13||t==27?!0:t==37||_r&&t==66&&r=="c"?Ux(n,-1,r)||Ig(n):t==39||_r&&t==70&&r=="c"?Ux(n,1,r)||Og(n):t==38||_r&&t==80&&r=="c"?Wx(n,-1,r)||Ig(n):t==40||_r&&t==78&&r=="c"?wz(n)||Wx(n,1,r)||Og(n):r==(_r?"m":"c")&&(t==66||t==73||t==89||t==90)}function uA(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=n.someProp("clipboardSerializer")||Ao.fromSchema(n.state.schema),a=gA(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=mA[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f}}function dA(n,e,t,r,i){let s=i.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||s||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,s||r,n)}),s)return e?new fe(ce.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):fe.empty;let d=n.someProp("clipboardTextParser",f=>f(e,i,r,n));if(d)a=d;else{let f=i.marks(),{schema:p}=n.state,m=Ao.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let x=o.appendChild(document.createElement("p"));v&&x.appendChild(m.serializeNode(p.text(v,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=kz(t),kv&&Ez(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||KT.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!_z.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=Tz(Gx(a,+u[1],+u[2]),u[4]);else if(a=fe.maxOpen(Cz(a.content,i),!0),a.openStart||a.openEnd){let d=0,f=0;for(let p=a.content.firstChild;d<a.openStart&&!p.type.spec.isolating;d++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=Gx(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const _z=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Cz(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&hA(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=pA(o[o.length-1],s.length));let u=fA(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return ce.from(o)}return n}function fA(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,ce.from(n));return n}function hA(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=hA(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(ce.from(fA(t,n,i+1))))}}function pA(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,pA(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(ce.empty,!0);return n.copy(t.append(r))}function E1(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,a=o.content;return i<r-1&&(a=E1(a,e,t,r,i+1,s)),i>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,n.childCount>1||s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(ce.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function Gx(n,e,t){return e<n.openStart&&(n=new fe(E1(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new fe(E1(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const mA={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Yx=null;function gA(){return Yx||(Yx=document.implementation.createHTMLDocument("title"))}function kz(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=gA().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&mA[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=n,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function Ez(n){let e=n.querySelectorAll(Vl?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function Tz(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch(a){return n}let{content:i,openStart:s,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=ce.from(l.create(r[a+1],i)),s++,o++}return new fe(i,s,o)}const ii={},yr={};function Os(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}yr.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!vA(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Sd&&Vl&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Cv&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,iA(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||Sz(n,t)?t.preventDefault():Os(n,"key")};yr.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};yr.keypress=(n,e)=>{let t=e;if(vA(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||_r&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ot)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Gp(n){return{left:n.clientX,top:n.clientY}}function Az(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Tv(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,a=>o>s.depth?a(n,t,s.nodeAfter,s.before(o),i,!0):a(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function al(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function Mz(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&Ne.isSelectable(r)?(al(n,new Ne(t),"pointer"),!0):!1}function Rz(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof Ne&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(Ne.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(al(n,Ne.create(n.state.doc,i),"pointer"),!0):!1}function Iz(n,e,t,r,i){return Tv(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?Rz(n,t):Mz(n,t))}function Oz(n,e,t,r){return Tv(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function Pz(n,e,t,r){return Tv(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||Dz(n,t,r)}function Dz(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(al(n,ot.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)al(n,ot.create(r,a+1,a+1+o.content.size),"pointer");else if(Ne.isSelectable(o))al(n,Ne.create(r,a),"pointer");else continue;return!0}}function Av(n){return Vh(n)}const yA=_r?"metaKey":"ctrlKey";ii.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Av(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&Az(t,n.input.lastClick)&&!t[yA]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let o=n.posAtCoords(Gp(t));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new $z(n,o,t,!!r)):(s=="doubleClick"?Oz:Pz)(n,o.pos,o.inside,t)?t.preventDefault():Os(n,"pointer"))};class $z{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[yA],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof Ne&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Kp&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Os(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ev(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Gp(e))),this.updateAllowDefault(e),this.allowDefault||!t?Os(this.view,"pointer"):Iz(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ma&&this.mightDrag&&!this.mightDrag.node.isAtom||Vl&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(al(this.view,We.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Os(this.view,"pointer")}move(e){this.updateAllowDefault(e),Os(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ii.touchstart=n=>{n.input.lastTouch=Date.now(),Av(n),Os(n,"pointer")};ii.touchmove=n=>{n.input.lastTouch=Date.now(),Os(n,"pointer")};ii.contextmenu=n=>Av(n);function vA(n,e){return n.composing?!0:ma&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const Nz=Sd?5e3:-1;yr.compositionstart=yr.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Vh(n,!0),n.markCursor=null;else if(Vh(n),Kp&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}bA(n,Nz)};yr.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,bA(n,20))};function bA(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Vh(n),e))}function Lz(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=jz());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function jz(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Vh(n,e=!1){if(!(Sd&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Lz(n),e||n.docView&&n.docView.dirty){let t=mz(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function Fz(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Dl=xd&&oA<15||Cv&&pz<604;ii.copy=yr.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=Dl?null:t.clipboardData,o=r.content(),{dom:a,text:l}=uA(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):Fz(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Hz(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Bz(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?T1(n,r.value,null,n.input.shiftKey,e):T1(n,r.textContent,r.innerHTML,n.input.shiftKey,e)},50)}function T1(n,e,t,r,i){let s=dA(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,s||fe.empty)))return!0;if(!s)return!1;let o=Hz(s),a=o?n.state.tr.replaceSelectionWith(o,n.input.shiftKey):n.state.tr.replaceSelection(s);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}yr.paste=(n,e)=>{let t=e;if(n.composing&&!Sd)return;let r=Dl?null:t.clipboardData;r&&T1(n,r.getData("text/plain"),r.getData("text/html"),n.input.shiftKey,t)?t.preventDefault():Bz(n,t)};class zz{constructor(e,t){this.slice=e,this.move=t}}const wA=_r?"altKey":"ctrlKey";ii.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(Gp(t));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Ne?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(Ne.create(n.state.doc,r.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&n.dispatch(n.state.tr.setSelection(Ne.create(n.state.doc,c.posBefore)))}}let o=n.state.selection.content(),{dom:a,text:l}=uA(n,o);t.dataTransfer.clearData(),t.dataTransfer.setData(Dl?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",Dl||t.dataTransfer.setData("text/plain",l),n.dragging=new zz(o,!t[wA])};ii.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};yr.dragover=yr.dragenter=(n,e)=>e.preventDefault();yr.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Gp(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",m=>{o=m(o,n)}):o=dA(n,t.dataTransfer.getData(Dl?"Text":"text/plain"),Dl?null:t.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&!t[wA]);if(n.someProp("handleDrop",m=>m(n,t,o||fe.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?i3(n.state.doc,s.pos,o):s.pos;l==null&&(l=s.pos);let c=n.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let p=c.doc.resolve(u);if(d&&Ne.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Ne(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,x,b,_)=>m=_),c.setSelection(lA(n,p,c.doc.resolve(m)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};ii.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Ev(n)},20))};ii.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};ii.beforeinput=(n,e)=>{if(Vl&&Sd&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,iA(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in yr)ii[n]=yr[n];function Wu(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Mv{constructor(e,t){this.toDOM=e,this.spec=t||Wo,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new Rr(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Mv&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Wu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Hs{constructor(e,t){this.attrs=e,this.spec=t||Wo}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Rr(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Hs&&Wu(this.attrs,e.attrs)&&Wu(this.spec,e.spec)}static is(e){return e.type instanceof Hs}destroy(){}}class Rv{constructor(e,t){this.attrs=e,this.spec=t||Wo}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Rr(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof Rv&&Wu(this.attrs,e.attrs)&&Wu(this.spec,e.spec)}destroy(){}}class Rr{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Rr(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Rr(e,e,new Mv(t,r))}static inline(e,t,r,i){return new Rr(e,t,new Hs(r,i))}static node(e,t,r,i){return new Rr(e,t,new Rv(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Hs}}const Va=[],Wo={};class $t{constructor(e,t){this.local=e.length?e:Va,this.children=t.length?t:Va}static create(e,t){return t.length?qh(t,e,0,Wo):Pn}find(e,t,r){let i=[];return this.findInner(e==null?0:e,t==null?1e9:t,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,i+a,s)}}map(e,t,r){return this==Pn||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Wo)}mapInner(e,t,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?Vz(this.children,o||[],e,t,r,i,s):o?new $t(o.sort(Jo),Va):Pn}add(e,t){return t.length?this==Pn?$t.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((a,l)=>{let c=l+r,u;if(u=SA(t,a,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,qh(u,a,c+1,Wo)),s+=3}});let o=xA(s?_A(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new $t(o.length?this.local.concat(o).sort(Jo):this.local,i||this.children)}remove(e){return e.length==0||this==Pn?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+t,l=r[s+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=Pn?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new $t(i,r):Pn}forChild(e,t){if(this==Pn)return this;if(t.isLeaf)return $t.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Hs){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new $t(i.sort(Jo),Va);return r?new xo([a,r]):a}return r||Pn}eq(e){if(this==e)return!0;if(!(e instanceof $t)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Iv(this.localsInner(e))}localsInner(e){if(this==Pn)return Va;if(e.inlineContent||!this.local.some(Hs.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Hs||t.push(this.local[r]);return t}}$t.empty=new $t([],[]);$t.removeOverlap=Iv;const Pn=$t.empty;class xo{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Wo));return xo.from(r)}forChild(e,t){if(t.isLeaf)return $t.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=Pn&&(s instanceof xo?r=r.concat(s.members):r.push(s))}return xo.from(r)}eq(e){if(!(e instanceof xo)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?Iv(r?t:t.sort(Jo)):Va}static from(e){switch(e.length){case 0:return Pn;case 1:return e[0];default:return new xo(e.every(t=>t instanceof $t)?e:e.reduce((t,r)=>t.concat(r instanceof $t?r:r.members),[]))}}}function Vz(n,e,t,r,i,s,o){let a=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,p,m,v)=>{let x=v-m-(p-f);for(let b=0;b<a.length;b+=3){let _=a[b+1];if(_<0||f>_+u-d)continue;let M=a[b]+u-d;p>=M?a[b+1]=f<=M?-2:-1:m>=i&&x&&(a[b]+=x,a[b+1]+=x)}d+=x}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+s),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+s,-1),p=f-i,{index:m,offset:v}=r.content.findIndex(d),x=r.maybeChild(m);if(x&&v==d&&v+x.nodeSize==p){let b=a[c+2].mapInner(t,x,u+1,n[c]+s+1,o);b!=Pn?(a[c]=d,a[c+1]=p,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=qz(a,n,e,t,i,s,o),u=qh(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let p=u.children[d];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new $t(e.sort(Jo),a)}function xA(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Rr(i.from+e,i.to+e,i.type))}return t}function qz(n,e,t,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+s+1);return t}function SA(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function _A(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function qh(n,e,t,r){let i=[],s=!1;e.forEach((a,l)=>{let c=SA(n,a,l+t);if(c){s=!0;let u=qh(c,a,t+l+1,r);u!=Pn&&i.push(l,l+a.nodeSize,u)}});let o=xA(s?_A(n):n,-t).sort(Jo);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new $t(o,i):Pn}function Jo(n,e){return n.from-e.from||n.to-e.to}function Iv(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),Xx(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),Xx(e,i,r.copy(s.from,r.to)));break}}}return e}function Xx(n,e,t){for(;e<n.length&&Jo(t,n[e])>0;)e++;n.splice(e,0,t)}class It extends We{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return It.valid(r)?new It(r):We.near(r)}content(){return fe.empty}eq(e){return e instanceof It&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new It(e.resolve(t.pos))}getBookmark(){return new Ov(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!Uz(e)||!Wz(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&It.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){s=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=t;let l=e.doc.resolve(i);if(It.valid(l))return l}for(;;){let o=t>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Ne.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*t),r=!1;continue e}break}s=o,i+=t;let a=e.doc.resolve(i);if(It.valid(a))return a}return null}}}It.prototype.visible=!1;It.findFrom=It.findGapCursorFrom;We.jsonID("gapcursor",It);class Ov{constructor(e){this.pos=e}map(e){return new Ov(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return It.valid(t)?new It(t):We.near(t)}}function Uz(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Wz(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Jz(){return new zl({props:{decorations:Xz,createSelectionBetween(n,e,t){return e.pos==t.pos&&It.valid(t)?new It(t):null},handleClick:Gz,handleKeyDown:Kz,handleDOMEvents:{beforeinput:Yz}}})}const Kz=tA({ArrowLeft:rf("horiz",-1),ArrowRight:rf("horiz",1),ArrowUp:rf("vert",-1),ArrowDown:rf("vert",1)});function rf(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ot){if(!s.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=It.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new It(c))),!0):!1}}function Gz(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!It.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&Ne.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new It(r))),!0)}function Yz(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof It))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=ce.empty;for(let o=r.length-1;o>=0;o--)i=ce.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(t.pos,t.pos,new fe(i,0,0));return s.setSelection(ot.near(s.doc.resolve(t.pos+1))),n.dispatch(s),!1}function Xz(n){if(!(n.selection instanceof It))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",$t.create(n.doc,[Rr.widget(n.selection.head,e,{key:"gapcursor"})])}const Zz=Xt.create({name:"gapCursor",addProseMirrorPlugins(){return[Jz()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Ve(xe(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),Qz=Wt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",rt(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(f=>a.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),eV=Wt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,rt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>Te(Y({},n),{[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>m1({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Uh=200,hn=function(){};hn.prototype.append=function(e){return e.length?(e=hn.from(e),!this.length&&e||e.length<Uh&&this.leafAppend(e)||this.length<Uh&&e.leafPrepend(this)||this.appendInner(e)):this};hn.prototype.prepend=function(e){return e.length?hn.from(e).append(this):this};hn.prototype.appendInner=function(e){return new tV(this,e)};hn.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?hn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};hn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};hn.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};hn.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,r),i};hn.from=function(e){return e instanceof hn?e:e&&e.length?new CA(e):hn.empty};var CA=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Uh)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Uh)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(hn);hn.empty=new CA([]);var tV=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(s,a),o)===!1||s>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(i,a),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(hn),kA=hn;const nV=500;class Jr{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),s=i.maps.length),s--,u.push(d);return}if(i){u.push(new li(d.map));let p=d.step.map(i.slice(s)),m;p&&o.maybeStep(p).doc&&(m=o.mapping.maps[o.mapping.maps.length-1],c.push(new li(m,void 0,void 0,c.length+u.length))),s--,m&&i.appendMap(m,s)}else o.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(s)):d.selection,l=new Jr(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new li(e.mapping.maps[u],d,t),p;(p=l&&l.merge(f))&&(f=p,u?s.pop():a=a.slice(0,a.length-1)),s.push(f),t&&(o++,t=void 0),i||(l=f)}let c=o-r.depth;return c>iV&&(a=rV(a,c),o-=c),new Jr(a.append(s),o)}remapping(e,t){let r=new ol;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new Jr(this.items.append(e.map(t=>new li(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},i);let l=t;this.items.forEach(f=>{let p=s.getMirror(--l);if(p==null)return;o=Math.min(o,p);let m=s.maps[p];if(f.step){let v=e.steps[p].invert(e.docs[p]),x=f.selection&&f.selection.map(s.slice(l+1,p));x&&a++,r.push(new li(m,v,x))}else r.push(new li(m))},i);let c=[];for(let f=t;f<o;f++)c.push(new li(s.maps[f]));let u=this.items.slice(0,i).append(c).append(r),d=new Jr(u,a);return d.emptyItemCount()>nV&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=e)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&s++;let d=new li(c.invert(),l,u),f,p=i.length-1;(f=i.length&&i[p].merge(d))?i[p]=f:i.push(d)}}else o.map&&r--},this.items.length,0),new Jr(kA.from(i.reverse()),s)}}Jr.empty=new Jr(kA.empty,0);function rV(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class li{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new li(t.getMap().invert(),t,this.selection)}}}class Ss{constructor(e,t,r,i,s){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const iV=20;function sV(n,e,t,r){let i=t.getMeta(Ko),s;if(i)return i.historyState;t.getMeta(lV)&&(n=new Ss(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Ko))return o.getMeta(Ko).redo?new Ss(n.done.addTransform(t,void 0,r,Gf(e)),n.undone,Zx(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new Ss(n.done,n.undone.addTransform(t,void 0,r,Gf(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!oV(t,n.prevRanges)),c=o?Pg(n.prevRanges,t.mapping):Zx(t.mapping.maps[t.steps.length-1]);return new Ss(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Gf(e)),Jr.empty,c,t.time,a==null?n.prevComposition:a)}else return(s=t.getMeta("rebased"))?new Ss(n.done.rebased(t,s),n.undone.rebased(t,s),Pg(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Ss(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Pg(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function oV(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function Zx(n){let e=[];return n.forEach((t,r,i,s)=>e.push(i,s)),e}function Pg(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),s=e.map(n[r+1],-1);i<=s&&t.push(i,s)}return t}function aV(n,e,t){let r=Gf(e),i=Ko.get(e).spec.config,s=(t?n.undone:n.done).popEvent(e,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(t?n.done:n.undone).addTransform(s.transform,e.selection.getBookmark(),i,r),l=new Ss(t?a:s.remaining,t?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(Ko,{redo:t,historyState:l})}let Dg=!1,Qx=null;function Gf(n){let e=n.plugins;if(Qx!=e){Dg=!1,Qx=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Dg=!0;break}}return Dg}const Ko=new md("history"),lV=new md("closeHistory");function cV(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new zl({key:Ko,state:{init(){return new Ss(Jr.empty,Jr.empty,null,0,-1)},apply(e,t,r){return sV(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?TA:r=="historyRedo"?AA:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function EA(n,e){return(t,r)=>{let i=Ko.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let s=aV(i,t,n);s&&r(e?s.scrollIntoView():s)}return!0}}const TA=EA(!1,!0),AA=EA(!0,!0),uV=Xt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>TA(n,e),redo:()=>({state:n,dispatch:e})=>AA(n,e)}},addProseMirrorPlugins(){return[cV(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),dV=Wt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",rt(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:i,dispatch:s})=>{var o;if(s){const{$to:a}=i.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?i.setSelection(qt.create(i.doc,a.pos+1)):a.nodeAfter.isBlock?i.setSelection(ki.create(i.doc,a.pos)):i.setSelection(qt.create(i.doc,a.pos));else{const c=(o=a.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();c&&(i.insert(l,c),i.setSelection(qt.create(i.doc,l+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[D3({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),fV=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,hV=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,pV=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,mV=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,gV=mr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[sa({find:fV,type:this.type}),sa({find:pV,type:this.type})]},addPasteRules(){return[zs({find:hV,type:this.type}),zs({find:mV,type:this.type})]}}),yV=Wt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",rt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),vV=Wt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",rt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),eS=mr.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=yd(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),tS=/^(\d+)\.\s$/,bV=Wt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const r=n,{start:e}=r,t=En(r,["start"]);return e===1?["ol",rt(this.options.HTMLAttributes,t),0]:["ol",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(vV.name,this.editor.getAttributes(eS.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Vu({find:tS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Vu({find:tS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>Y({start:+e[1]},this.editor.getAttributes(eS.name)),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),wV=Wt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),xV=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,SV=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,_V=mr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){const n={};return hv()?n["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():n["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),n},addInputRules(){return[sa({find:xV,type:this.type})]},addPasteRules(){return[zs({find:SV,type:this.type})]}}),CV=Wt.create({name:"text",group:"inline"}),kV=Xt.create({name:"starterKit",addExtensions(){var n,e,t,r,i,s,o,a,l,c,u,d,f,p,m,v,x,b;const _=[];return this.options.blockquote!==!1&&_.push(VB.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&_.push(KB.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&_.push(YB.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&_.push(QB.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&_.push(nz.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&_.push(rz.configure((s=this.options)===null||s===void 0?void 0:s.document)),this.options.dropcursor!==!1&&_.push(oz.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&_.push(Zz.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&_.push(Qz.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&_.push(eV.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&_.push(uV.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&_.push(dV.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&_.push(gV.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&_.push(yV.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&_.push(bV.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&_.push(wV.configure((v=this.options)===null||v===void 0?void 0:v.paragraph)),this.options.strike!==!1&&_.push(_V.configure((x=this.options)===null||x===void 0?void 0:x.strike)),this.options.text!==!1&&_.push(CV.configure((b=this.options)===null||b===void 0?void 0:b.text)),_}}),EV=Xt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,considerAnyAsEmpty:!1,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Bn({key:new sr("placeholder"),props:{decorations:({doc:n,selection:e})=>{var t;const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,s=[];if(!r)return null;const{firstChild:o}=n.content,a=o&&o.type.isLeaf,l=o&&o.isAtom,c=this.options.considerAnyAsEmpty?!0:o&&o.type.name===((t=n.type.contentMatch.defaultType)===null||t===void 0?void 0:t.name),u=n.content.childCount<=1&&o&&c&&o.nodeSize<=2&&(!a||!l);return n.descendants((d,f)=>{const p=i>=f&&i<=f+d.nodeSize,m=!d.isLeaf&&!d.childCount;if((p||!this.options.showOnlyCurrent)&&m){const v=[this.options.emptyNodeClass];u&&v.push(this.options.emptyEditorClass);const x=Zs.node(f,f+d.nodeSize,{class:v.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:d,pos:f,hasAnchor:p}):this.options.placeholder});s.push(x)}return this.options.includeChildren}),Nr.create(n,s)}}})]}}),TV=Xt.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>n.style.textAlign||this.options.defaultAlignment,renderHTML:n=>n.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${n.textAlign}`}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.every(t=>e.updateAttributes(t,{textAlign:n})):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.every(e=>n.resetAttributes(e,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});var A1,M1;if(typeof WeakMap!="undefined"){let n=new WeakMap;A1=e=>n.get(e),M1=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;A1=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},M1=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var Ot=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let s=r+1,o=i+1;for(let a=1;s<this.width&&this.map[e+a]==t;a++)s++;for(let a=1;o<this.height&&this.map[e+this.width*a]==t;a++)o++;return{left:r,top:i,right:s,bottom:o}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:s,bottom:o}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[s*this.width+(t<0?r-1:i)]:(t<0?s==0:o==this.height)?null:this.map[r+this.width*(t<0?s-1:o)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:s}=this.findCell(n),{left:o,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(t,o),top:Math.min(i,l),right:Math.max(r,a),bottom:Math.max(s,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const s=r*this.width+i,o=this.map[s];t[o]||(t[o]=!0,!(i==n.left&&i&&this.map[s-1]==o||r==n.top&&r&&this.map[s-this.width]==o)&&e.push(o))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const s=i+t.child(r).nodeSize;if(r==n){let o=e+n*this.width;const a=(n+1)*this.width;for(;o<a&&this.map[o]<i;)o++;return o==a?s-1:this.map[o]}i=s}}static get(n){return A1(n)||M1(n,AV(n))}};function AV(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=MV(n),t=n.childCount,r=[];let i=0,s=null;const o=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const d=n.child(c);u++;for(let m=0;;m++){for(;i<r.length&&r[i]!=0;)i++;if(m==d.childCount)break;const v=d.child(m),{colspan:x,rowspan:b,colwidth:_}=v.attrs;for(let M=0;M<b;M++){if(M+c>=t){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:b-M});break}const h=i+M*e;for(let w=0;w<x;w++){r[h+w]==0?r[h+w]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:x-w});const y=_&&_[w];if(y){const E=(h+w)%e*2,g=o[E];g==null||g!=y&&o[E+1]==1?(o[E]=y,o[E+1]=1):g==y&&o[E+1]++}}}i+=x,u+=v.nodeSize}const f=(c+1)*e;let p=0;for(;i<f;)r[i++]==0&&p++;p&&(s||(s=[])).push({type:"missing",row:c,n:p}),u++}const a=new Ot(e,t,r,s);let l=!1;for(let c=0;!l&&c<o.length;c+=2)o[c]!=null&&o[c+1]<t&&(l=!0);return l&&RV(a,o,n),a}function MV(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let s=0;if(t)for(let o=0;o<r;o++){const a=n.child(o);for(let l=0;l<a.childCount;l++){const c=a.child(l);o+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const a=i.child(o);s+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function RV(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const s=n.map[i];if(r[s])continue;r[s]=!0;const o=t.nodeAt(s);if(!o)throw new RangeError(`No cell with offset ${s} found`);let a=null;const l=o.attrs;for(let c=0;c<l.colspan;c++){const u=(i+c)%n.width,d=e[u*2];d!=null&&(!l.colwidth||l.colwidth[c]!=d)&&((a||(a=IV(l)))[c]=d)}a&&n.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:a})}}function IV(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function wn(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var Ts=new md("selectingCells");function ql(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function OV(n){for(let e=n.depth;e>0;e--){const t=n.node(e).type.spec.tableRole;if(t==="cell"||t==="header_cell")return n.node(e)}return null}function si(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Yp(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=ql(e.$head)||PV(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function PV(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function R1(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function DV(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function Pv(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function MA(n,e,t){const r=n.node(-1),i=Ot.get(r),s=n.start(-1),o=i.nextCell(n.pos-s,e,t);return o==null?null:n.node(0).resolve(s+o)}function aa(n,e,t=1){const r=Te(Y({},n),{colspan:n.colspan-t});return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function RA(n,e,t=1){const r=Te(Y({},n),{colspan:n.colspan+t});if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<t;i++)r.colwidth.splice(e,0,0)}return r}function $V(n,e,t){const r=wn(e.type.schema).header_cell;for(let i=0;i<n.height;i++)if(e.nodeAt(n.map[t+i*n.width]).type!=r)return!1;return!0}var xt=class Ni extends We{constructor(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.rectBetween(e.pos-s,t.pos-s),a=e.node(0),l=i.cellsInRect(o).filter(u=>u!=t.pos-s);l.unshift(t.pos-s);const c=l.map(u=>{const d=r.nodeAt(u);if(!d)throw RangeError(`No cell with offset ${u} found`);const f=s+u+1;return new u3(a.resolve(f),a.resolve(f+d.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(R1(r)&&R1(i)&&Pv(r,i)){const s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Ni.rowSelection(r,i):s&&this.isColSelection()?Ni.colSelection(r,i):new Ni(r,i)}return ot.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=Ot.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},o=[];for(let l=i.top;l<i.bottom;l++){const c=[];for(let u=l*t.width+i.left,d=i.left;d<i.right;d++,u++){const f=t.map[u];if(s[f])continue;s[f]=!0;const p=t.findCell(f);let m=e.nodeAt(f);if(!m)throw RangeError(`No cell with offset ${f} found`);const v=i.left-p.left,x=p.right-i.right;if(v>0||x>0){let b=m.attrs;if(v>0&&(b=aa(b,0,v)),x>0&&(b=aa(b,b.colspan-x,x)),p.left<i.left){if(m=m.type.createAndFill(b),!m)throw RangeError(`Could not create cell with attrs ${JSON.stringify(b)}`)}else m=m.type.create(b,m.content)}if(p.top<i.top||p.bottom>i.bottom){const b=Te(Y({},m.attrs),{rowspan:Math.min(p.bottom,i.bottom)-Math.max(p.top,i.top)});p.top<i.top?m=m.type.createAndFill(b):m=m.type.create(b,m.content)}c.push(m)}o.push(e.child(l).copy(ce.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:o;return new fe(ce.from(a),1,1)}replace(e,t=fe.empty){const r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:a,$to:l}=i[o],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),o?fe.empty:t)}const s=We.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,t){this.replace(e,new fe(ce.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=Ot.get(t),i=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<s.length;o++)e(t.nodeAt(s[o]),i+s[o])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.findCell(e.pos-s),a=i.findCell(t.pos-s),l=e.node(0);return o.top<=a.top?(o.top>0&&(e=l.resolve(s+i.map[o.left])),a.bottom<i.height&&(t=l.resolve(s+i.map[i.width*(i.height-1)+a.right-1]))):(a.top>0&&(t=l.resolve(s+i.map[a.left])),o.bottom<i.height&&(e=l.resolve(s+i.map[i.width*(i.height-1)+o.right-1]))),new Ni(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=Ot.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),s=t.colCount(this.$headCell.pos-r);if(Math.min(i,s)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,a=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,a)==t.width}eq(e){return e instanceof Ni&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.findCell(e.pos-s),a=i.findCell(t.pos-s),l=e.node(0);return o.left<=a.left?(o.left>0&&(e=l.resolve(s+i.map[o.top*i.width])),a.right<i.width&&(t=l.resolve(s+i.map[i.width*(a.top+1)-1]))):(a.left>0&&(t=l.resolve(s+i.map[a.top*i.width])),o.right<i.width&&(e=l.resolve(s+i.map[i.width*(o.top+1)-1]))),new Ni(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Ni(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Ni(e.resolve(t),e.resolve(r))}getBookmark(){return new NV(this.$anchorCell.pos,this.$headCell.pos)}};xt.prototype.visible=!1;We.jsonID("cell",xt);var NV=class IA{constructor(e,t){this.anchor=e,this.head=t}map(e){return new IA(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&Pv(t,r)?new xt(t,r):We.near(r,1)}};function LV(n){if(!(n.selection instanceof xt))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Rr.node(r,r+t.nodeSize,{class:"selectedCell"}))}),$t.create(n.doc,e)}function jV({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function FV({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const s=n.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){t=s;break}}for(let i=e.depth;i>0;i--){const s=e.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return t!==r&&e.parentOffset===0}function HV(n,e,t){const r=(e||n).selection,i=(e||n).doc;let s,o;if(r instanceof Ne&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")s=xt.create(i,r.from);else if(o=="row"){const a=i.resolve(r.from+1);s=xt.rowSelection(a,a)}else if(!t){const a=Ot.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];s=xt.create(i,l+1,c)}}else r instanceof ot&&jV(r)?s=ot.create(i,r.from):r instanceof ot&&FV(r)&&(s=ot.create(i,r.$from.start(),r.$from.end()));return s&&(e||(e=n.tr)).setSelection(s),e}var BV=new md("fix-tables");function OA(n,e,t,r){const i=n.childCount,s=e.childCount;e:for(let o=0,a=0;o<s;o++){const l=e.child(o);for(let c=a,u=Math.min(i,o+3);c<u;c++)if(n.child(c)==l){a=c+1,t+=l.nodeSize;continue e}r(l,t),a<i&&n.child(a).sameMarkup(l)?OA(n.child(a),l,t+1,r):l.nodesBetween(0,l.content.size,r,t+1),t+=l.nodeSize}}function PA(n,e){let t;const r=(i,s)=>{i.type.spec.tableRole=="table"&&(t=zV(n,i,s,t))};return e?e.doc!=n.doc&&OA(e.doc,n.doc,0,r):n.doc.descendants(r),t}function zV(n,e,t,r){const i=Ot.get(e);if(!i.problems)return r;r||(r=n.tr);const s=[];for(let l=0;l<i.height;l++)s.push(0);for(let l=0;l<i.problems.length;l++){const c=i.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const d=u.attrs;for(let f=0;f<d.rowspan;f++)s[c.row+f]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,aa(d,d.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Te(Y({},u.attrs),{rowspan:u.attrs.rowspan-c.n}))}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Te(Y({},u.attrs),{colwidth:c.colwidth}))}}let o,a;for(let l=0;l<s.length;l++)s[l]&&(o==null&&(o=l),a=l);for(let l=0,c=t+1;l<i.height;l++){const u=e.child(l),d=c+u.nodeSize,f=s[l];if(f>0){let p="cell";u.firstChild&&(p=u.firstChild.type.spec.tableRole);const m=[];for(let x=0;x<f;x++){const b=wn(n.schema)[p].createAndFill();b&&m.push(b)}const v=(l==0||o==l-1)&&a==l?c+1:d-1;r.insert(r.mapping.map(v),m)}c=d}return r.setMeta(BV,{fixTables:!0})}function VV(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),s=i.type.spec.tableRole,o=i.type.schema,a=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,t-1),d=l<e.childCount-1?0:Math.max(0,r-1);(u||d)&&(c=I1(wn(o).row,new fe(c,u,d)).content),a.push(c)}else if(s=="cell"||s=="header_cell")a.push(t||r?I1(wn(o).row,new fe(e,t,r)).content:e);else return null;return qV(o,a)}function qV(n,e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];for(let o=s.childCount-1;o>=0;o--){const{rowspan:a,colspan:l}=s.child(o).attrs;for(let c=i;c<i+a;c++)t[c]=(t[c]||0)+l}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(ce.empty),t[i]<r){const s=wn(n).cell.createAndFill(),o=[];for(let a=t[i];a<r;a++)o.push(s);e[i]=e[i].append(ce.from(o))}return{height:e.length,width:r,rows:e}}function I1(n,e){const t=n.createAndFill();return new Rj(t).replace(0,t.content.size,e).doc}function UV({width:n,height:e,rows:t},r,i){if(n!=r){const s=[],o=[];for(let a=0;a<t.length;a++){const l=t[a],c=[];for(let u=s[a]||0,d=0;u<r;d++){let f=l.child(d%l.childCount);u+f.attrs.colspan>r&&(f=f.type.createChecked(aa(f.attrs,f.attrs.colspan,u+f.attrs.colspan-r),f.content)),c.push(f),u+=f.attrs.colspan;for(let p=1;p<f.attrs.rowspan;p++)s[a+p]=(s[a+p]||0)+f.attrs.colspan}o.push(ce.from(c))}t=o,n=r}if(e!=i){const s=[];for(let o=0,a=0;o<i;o++,a++){const l=[],c=t[a%e];for(let u=0;u<c.childCount;u++){let d=c.child(u);o+d.attrs.rowspan>i&&(d=d.type.create(Te(Y({},d.attrs),{rowspan:Math.max(1,i-d.attrs.rowspan)}),d.content)),l.push(d)}s.push(ce.from(l))}t=s,e=i}return{width:n,height:e,rows:t}}function WV(n,e,t,r,i,s,o){const a=n.doc.type.schema,l=wn(a);let c,u;if(i>e.width)for(let d=0,f=0;d<e.height;d++){const p=t.child(d);f+=p.nodeSize;const m=[];let v;p.lastChild==null||p.lastChild.type==l.cell?v=c||(c=l.cell.createAndFill()):v=u||(u=l.header_cell.createAndFill());for(let x=e.width;x<i;x++)m.push(v);n.insert(n.mapping.slice(o).map(f-1+r),m)}if(s>e.height){const d=[];for(let m=0,v=(e.height-1)*e.width;m<Math.max(e.width,i);m++){const x=m>=e.width?!1:t.nodeAt(e.map[v+m]).type==l.header_cell;d.push(x?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const f=l.row.create(null,ce.from(d)),p=[];for(let m=e.height;m<s;m++)p.push(f);n.insert(n.mapping.slice(o).map(r+t.nodeSize-2),p)}return!!(c||u)}function nS(n,e,t,r,i,s,o,a){if(o==0||o==e.height)return!1;let l=!1;for(let c=i;c<s;c++){const u=o*e.width+c,d=e.map[u];if(e.map[u-e.width]==d){l=!0;const f=t.nodeAt(d),{top:p,left:m}=e.findCell(d);n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,Te(Y({},f.attrs),{rowspan:o-p})),n.insert(n.mapping.slice(a).map(e.positionAt(o,m,t)),f.type.createAndFill(Te(Y({},f.attrs),{rowspan:p+f.attrs.rowspan-o}))),c+=f.attrs.colspan-1}}return l}function rS(n,e,t,r,i,s,o,a){if(o==0||o==e.width)return!1;let l=!1;for(let c=i;c<s;c++){const u=c*e.width+o,d=e.map[u];if(e.map[u-1]==d){l=!0;const f=t.nodeAt(d),p=e.colCount(d),m=n.mapping.slice(a).map(d+r);n.setNodeMarkup(m,null,aa(f.attrs,o-p,f.attrs.colspan-(o-p))),n.insert(m+f.nodeSize,f.type.createAndFill(aa(f.attrs,0,o-p))),c+=f.attrs.rowspan-1}}return l}function iS(n,e,t,r,i){let s=t?n.doc.nodeAt(t-1):n.doc;if(!s)throw new Error("No table found");let o=Ot.get(s);const{top:a,left:l}=r,c=l+i.width,u=a+i.height,d=n.tr;let f=0;function p(){if(s=t?d.doc.nodeAt(t-1):d.doc,!s)throw new Error("No table found");o=Ot.get(s),f=d.mapping.maps.length}WV(d,o,s,t,c,u,f)&&p(),nS(d,o,s,t,l,c,a,f)&&p(),nS(d,o,s,t,l,c,u,f)&&p(),rS(d,o,s,t,a,u,l,f)&&p(),rS(d,o,s,t,a,u,c,f)&&p();for(let m=a;m<u;m++){const v=o.positionAt(m,l,s),x=o.positionAt(m,c,s);d.replace(d.mapping.slice(f).map(v+t),d.mapping.slice(f).map(x+t),new fe(i.rows[m-a],0,0))}p(),d.setSelection(new xt(d.doc.resolve(t+o.positionAt(a,l,s)),d.doc.resolve(t+o.positionAt(u-1,c-1,s)))),e(d)}var JV=tA({ArrowLeft:sf("horiz",-1),ArrowRight:sf("horiz",1),ArrowUp:sf("vert",-1),ArrowDown:sf("vert",1),"Shift-ArrowLeft":of("horiz",-1),"Shift-ArrowRight":of("horiz",1),"Shift-ArrowUp":of("vert",-1),"Shift-ArrowDown":of("vert",1),Backspace:af,"Mod-Backspace":af,Delete:af,"Mod-Delete":af});function Yf(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function sf(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;if(s instanceof xt)return Yf(t,r,We.near(s.$headCell,e));if(n!="horiz"&&!s.empty)return!1;const o=DA(i,n,e);if(o==null)return!1;if(n=="horiz")return Yf(t,r,We.near(t.doc.resolve(s.head+e),e));{const a=t.doc.resolve(o),l=MA(a,n,e);let c;return l?c=We.near(l,1):e<0?c=We.near(t.doc.resolve(a.before(-1)),-1):c=We.near(t.doc.resolve(a.after(-1)),1),Yf(t,r,c)}}}function of(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;let o;if(s instanceof xt)o=s;else{const l=DA(i,n,e);if(l==null)return!1;o=new xt(t.doc.resolve(l))}const a=MA(o.$headCell,n,e);return a?Yf(t,r,new xt(o.$anchorCell,a)):!1}}function af(n,e){const t=n.selection;if(!(t instanceof xt))return!1;if(e){const r=n.tr,i=wn(n.schema).cell.createAndFill().content;t.forEachCell((s,o)=>{s.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+s.nodeSize-1),new fe(i,0,0))}),r.docChanged&&e(r)}return!0}function KV(n,e){const t=n.state.doc,r=ql(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new xt(r))),!0):!1}function GV(n,e,t){if(!si(n.state))return!1;let r=VV(t);const i=n.state.selection;if(i instanceof xt){r||(r={width:1,height:1,rows:[ce.from(I1(wn(n.state.schema).cell,t))]});const s=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),a=Ot.get(s).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=UV(r,a.right-a.left,a.bottom-a.top),iS(n.state,n.dispatch,o,a,r),!0}else if(r){const s=Yp(n.state),o=s.start(-1);return iS(n.state,n.dispatch,o,Ot.get(s.node(-1)).findCell(s.pos-o),r),!0}else return!1}function YV(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=sS(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof xt)s(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=ql(n.state.selection.$anchor))!=null&&((t=$g(n,e))==null?void 0:t.pos)!=i.pos)s(i,e),e.preventDefault();else if(!r)return;function s(l,c){let u=$g(n,c);const d=Ts.getState(n.state)==null;if(!u||!Pv(l,u))if(d)u=l;else return;const f=new xt(l,u);if(d||!n.state.selection.eq(f)){const p=n.state.tr.setSelection(f);d&&p.setMeta(Ts,l.pos),n.dispatch(p)}}function o(){n.root.removeEventListener("mouseup",o),n.root.removeEventListener("dragstart",o),n.root.removeEventListener("mousemove",a),Ts.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Ts,-1))}function a(l){const c=l,u=Ts.getState(n.state);let d;if(u!=null)d=n.state.doc.resolve(u);else if(sS(n,c.target)!=r&&(d=$g(n,e),!d))return o();d&&s(d,c)}n.root.addEventListener("mouseup",o),n.root.addEventListener("dragstart",o),n.root.addEventListener("mousemove",a)}function DA(n,e,t){if(!(n.state.selection instanceof ot))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const s=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const a=r.before(i),l=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(l)?a:null}}return null}function sS(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function $g(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?ql(n.state.doc.resolve(t.pos)):null}var XV=class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),O1(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,O1(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function O1(n,e,t,r,i,s){var o;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u){for(let d=0,f=0;d<u.childCount;d++){const{colspan:p,colwidth:m}=u.child(d).attrs;for(let v=0;v<p;v++,f++){const x=i==f?s:m&&m[v],b=x?x+"px":"";a+=x||r,x||(l=!1),c?(c.style.width!=b&&(c.style.width=b),c=c.nextSibling):e.appendChild(document.createElement("col")).style.width=b}}for(;c;){const d=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=d}l?(t.style.width=a+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=a+"px")}}var Er=new md("tableColumnResizing");function ZV({handleWidth:n=5,cellMinWidth:e=25,View:t=XV,lastColumnResizable:r=!0}={}){const i=new zl({key:Er,state:{init(s,o){return i.spec.props.nodeViews[wn(o.schema).table.name]=(a,l)=>new t(a,e,l),new QV(-1,!1)},apply(s,o){return o.apply(s)}},props:{attributes:s=>{const o=Er.getState(s);return o&&o.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(s,o)=>{eq(s,o,n,e,r)},mouseleave:s=>{tq(s)},mousedown:(s,o)=>{nq(s,o,e)}},decorations:s=>{const o=Er.getState(s);if(o&&o.activeHandle>-1)return lq(s,o.activeHandle)},nodeViews:{}}});return i}var QV=class Xf{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(Er);if(r&&r.setHandle!=null)return new Xf(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Xf(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return R1(e.doc.resolve(i))||(i=-1),new Xf(i,t.dragging)}return t}};function eq(n,e,t,r,i){const s=Er.getState(n.state);if(s&&!s.dragging){const o=iq(e.target);let a=-1;if(o){const{left:l,right:c}=o.getBoundingClientRect();e.clientX-l<=t?a=oS(n,e,"left",t):c-e.clientX<=t&&(a=oS(n,e,"right",t))}if(a!=s.activeHandle){if(!i&&a!==-1){const l=n.state.doc.resolve(a),c=l.node(-1),u=Ot.get(c),d=l.start(-1);if(u.colCount(l.pos-d)+l.nodeAfter.attrs.colspan-1==u.width-1)return}$A(n,a)}}}function tq(n){const e=Er.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&$A(n,-1)}function nq(n,e,t){var r;const i=(r=n.dom.ownerDocument.defaultView)!=null?r:window,s=Er.getState(n.state);if(!s||s.activeHandle==-1||s.dragging)return!1;const o=n.state.doc.nodeAt(s.activeHandle),a=rq(n,s.activeHandle,o.attrs);n.dispatch(n.state.tr.setMeta(Er,{setDragging:{startX:e.clientX,startWidth:a}}));function l(u){i.removeEventListener("mouseup",l),i.removeEventListener("mousemove",c);const d=Er.getState(n.state);d!=null&&d.dragging&&(sq(n,d.activeHandle,aS(d.dragging,u,t)),n.dispatch(n.state.tr.setMeta(Er,{setDragging:null})))}function c(u){if(!u.which)return l(u);const d=Er.getState(n.state);if(d&&d.dragging){const f=aS(d.dragging,u,t);oq(n,d.activeHandle,f,t)}}return i.addEventListener("mouseup",l),i.addEventListener("mousemove",c),e.preventDefault(),!0}function rq(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const s=n.domAtPos(e);let a=s.node.childNodes[s.offset].offsetWidth,l=t;if(r)for(let c=0;c<t;c++)r[c]&&(a-=r[c],l--);return a/l}function iq(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function oS(n,e,t,r){const i=t=="right"?-r:r,s=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!s)return-1;const{pos:o}=s,a=ql(n.state.doc.resolve(o));if(!a)return-1;if(t=="right")return a.pos;const l=Ot.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function aS(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function $A(n,e){n.dispatch(n.state.tr.setMeta(Er,{setHandle:e}))}function sq(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),s=Ot.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,l=n.state.tr;for(let c=0;c<s.height;c++){const u=c*s.width+a;if(c&&s.map[u]==s.map[u-s.width])continue;const d=s.map[u],f=i.nodeAt(d).attrs,p=f.colspan==1?0:a-s.colCount(d);if(f.colwidth&&f.colwidth[p]==t)continue;const m=f.colwidth?f.colwidth.slice():aq(f.colspan);m[p]=t,l.setNodeMarkup(o+d,null,Te(Y({},f),{colwidth:m}))}l.docChanged&&n.dispatch(l)}function oq(n,e,t,r){const i=n.state.doc.resolve(e),s=i.node(-1),o=i.start(-1),a=Ot.get(s).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let l=n.domAtPos(i.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&O1(s,l.firstChild,l,r,a,t)}function aq(n){return Array(n).fill(0)}function lq(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return $t.empty;const s=Ot.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan;for(let l=0;l<s.height;l++){const c=a+l*s.width-1;if((a==s.width||s.map[c]!=s.map[c+1])&&(l==0||s.map[c]!=s.map[c-s.width])){const u=s.map[c],d=o+u+i.nodeAt(u).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",t.push(Rr.widget(d,f))}}return $t.create(n.doc,t)}function Ii(n){const e=n.selection,t=Yp(n),r=t.node(-1),i=t.start(-1),s=Ot.get(r),o=e instanceof xt?s.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):s.findCell(t.pos-i);return Te(Y({},o),{tableStart:i,map:s,table:r})}function NA(n,{map:e,tableStart:t,table:r},i){let s=i>0?-1:0;$V(e,r,i+s)&&(s=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){const a=o*e.width+i;if(i>0&&i<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);n.setNodeMarkup(n.mapping.map(t+l),null,RA(c.attrs,i-e.colCount(l))),o+=c.attrs.rowspan-1}else{const l=s==null?wn(r.type.schema).cell:r.nodeAt(e.map[a+s]).type,c=e.positionAt(o,i,r);n.insert(n.mapping.map(t+c),l.createAndFill())}}return n}function cq(n,e){if(!si(n))return!1;if(e){const t=Ii(n);e(NA(n.tr,t,t.left))}return!0}function uq(n,e){if(!si(n))return!1;if(e){const t=Ii(n);e(NA(n.tr,t,t.right))}return!0}function dq(n,{map:e,table:t,tableStart:r},i){const s=n.mapping.maps.length;for(let o=0;o<e.height;){const a=o*e.width+i,l=e.map[a],c=t.nodeAt(l),u=c.attrs;if(i>0&&e.map[a-1]==l||i<e.width-1&&e.map[a+1]==l)n.setNodeMarkup(n.mapping.slice(s).map(r+l),null,aa(u,i-e.colCount(l)));else{const d=n.mapping.slice(s).map(r+l);n.delete(d,d+c.nodeSize)}o+=u.rowspan}}function fq(n,e){if(!si(n))return!1;if(e){const t=Ii(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let i=t.right-1;dq(r,t,i),i!=t.left;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=Ot.get(s)}e(r)}return!0}function hq(n,e,t){var r;const i=wn(e.type.schema).header_cell;for(let s=0;s<n.width;s++)if(((r=e.nodeAt(n.map[s+t*n.width]))==null?void 0:r.type)!=i)return!1;return!0}function LA(n,{map:e,tableStart:t,table:r},i){var s;let o=t;for(let c=0;c<i;c++)o+=r.child(c).nodeSize;const a=[];let l=i>0?-1:0;hq(e,r,i+l)&&(l=i==0||i==e.height?null:0);for(let c=0,u=e.width*i;c<e.width;c++,u++)if(i>0&&i<e.height&&e.map[u]==e.map[u-e.width]){const d=e.map[u],f=r.nodeAt(d).attrs;n.setNodeMarkup(t+d,null,Te(Y({},f),{rowspan:f.rowspan+1})),c+=f.colspan-1}else{const d=l==null?wn(r.type.schema).cell:(s=r.nodeAt(e.map[u+l*e.width]))==null?void 0:s.type,f=d==null?void 0:d.createAndFill();f&&a.push(f)}return n.insert(o,wn(r.type.schema).row.create(null,a)),n}function pq(n,e){if(!si(n))return!1;if(e){const t=Ii(n);e(LA(n.tr,t,t.top))}return!0}function mq(n,e){if(!si(n))return!1;if(e){const t=Ii(n);e(LA(n.tr,t,t.bottom))}return!0}function gq(n,{map:e,table:t,tableStart:r},i){let s=0;for(let c=0;c<i;c++)s+=t.child(c).nodeSize;const o=s+t.child(i).nodeSize,a=n.mapping.maps.length;n.delete(s+r,o+r);const l=new Set;for(let c=0,u=i*e.width;c<e.width;c++,u++){const d=e.map[u];if(!l.has(d)){if(l.add(d),i>0&&d==e.map[u-e.width]){const f=t.nodeAt(d).attrs;n.setNodeMarkup(n.mapping.slice(a).map(d+r),null,Te(Y({},f),{rowspan:f.rowspan-1})),c+=f.colspan-1}else if(i<e.height&&d==e.map[u+e.width]){const f=t.nodeAt(d),p=f.attrs,m=f.type.create(Te(Y({},p),{rowspan:f.attrs.rowspan-1}),f.content),v=e.positionAt(i+1,c,t);n.insert(n.mapping.slice(a).map(r+v),m),c+=p.colspan-1}}}}function yq(n,e){if(!si(n))return!1;if(e){const t=Ii(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let i=t.bottom-1;gq(r,t,i),i!=t.top;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=Ot.get(t.table)}e(r)}return!0}function lS(n){const e=n.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function vq({width:n,height:e,map:t},r){let i=r.top*n+r.left,s=i,o=(r.bottom-1)*n+r.left,a=i+(r.right-r.left-1);for(let l=r.top;l<r.bottom;l++){if(r.left>0&&t[s]==t[s-1]||r.right<n&&t[a]==t[a+1])return!0;s+=n,a+=n}for(let l=r.left;l<r.right;l++){if(r.top>0&&t[i]==t[i-n]||r.bottom<e&&t[o]==t[o+n])return!0;i++,o++}return!1}function cS(n,e){const t=n.selection;if(!(t instanceof xt)||t.$anchorCell.pos==t.$headCell.pos)return!1;const r=Ii(n),{map:i}=r;if(vq(i,r))return!1;if(e){const s=n.tr,o={};let a=ce.empty,l,c;for(let u=r.top;u<r.bottom;u++)for(let d=r.left;d<r.right;d++){const f=i.map[u*i.width+d],p=r.table.nodeAt(f);if(!(o[f]||!p))if(o[f]=!0,l==null)l=f,c=p;else{lS(p)||(a=a.append(p.content));const m=s.mapping.map(f+r.tableStart);s.delete(m,m+p.nodeSize)}}if(l==null||c==null)return!0;if(s.setNodeMarkup(l+r.tableStart,null,Te(Y({},RA(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan)),{rowspan:r.bottom-r.top})),a.size){const u=l+1+c.content.size,d=lS(c)?l+1:u;s.replaceWith(d+r.tableStart,u+r.tableStart,a)}s.setSelection(new xt(s.doc.resolve(l+r.tableStart))),e(s)}return!0}function uS(n,e){const t=wn(n.schema);return bq(({node:r})=>t[r.type.spec.tableRole])(n,e)}function bq(n){return(e,t)=>{var r;const i=e.selection;let s,o;if(i instanceof xt){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;s=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(s=OV(i.$from),!s)return!1;o=(r=ql(i.$from))==null?void 0:r.pos}if(s==null||o==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(t){let a=s.attrs;const l=[],c=a.colwidth;a.rowspan>1&&(a=Te(Y({},a),{rowspan:1})),a.colspan>1&&(a=Te(Y({},a),{colspan:1}));const u=Ii(e),d=e.tr;for(let p=0;p<u.right-u.left;p++)l.push(c?Te(Y({},a),{colwidth:c&&c[p]?[c[p]]:null}):a);let f;for(let p=u.top;p<u.bottom;p++){let m=u.map.positionAt(p,u.left,u.table);p==u.top&&(m+=s.nodeSize);for(let v=u.left,x=0;v<u.right;v++,x++)v==u.left&&p==u.top||d.insert(f=d.mapping.map(m+u.tableStart,1),n({node:s,row:p,col:v}).createAndFill(l[x]))}d.setNodeMarkup(o,n({node:s,row:u.top,col:u.left}),l[0]),i instanceof xt&&d.setSelection(new xt(d.doc.resolve(i.$anchorCell.pos),f?d.doc.resolve(f):void 0)),t(d)}return!0}}function wq(n,e){return function(t,r){if(!si(t))return!1;const i=Yp(t);if(i.nodeAfter.attrs[n]===e)return!1;if(r){const s=t.tr;t.selection instanceof xt?t.selection.forEachCell((o,a)=>{o.attrs[n]!==e&&s.setNodeMarkup(a,null,Te(Y({},o.attrs),{[n]:e}))}):s.setNodeMarkup(i.pos,null,Te(Y({},i.nodeAfter.attrs),{[n]:e})),r(s)}return!0}}function xq(n){return function(e,t){if(!si(e))return!1;if(t){const r=wn(e.schema),i=Ii(e),s=e.tr,o=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),a=o.map(l=>i.table.nodeAt(l));for(let l=0;l<o.length;l++)a[l].type==r.header_cell&&s.setNodeMarkup(i.tableStart+o[l],r.cell,a[l].attrs);if(s.steps.length==0)for(let l=0;l<o.length;l++)s.setNodeMarkup(i.tableStart+o[l],r.header_cell,a[l].attrs);t(s)}return!0}}function dS(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const s=e.table.nodeAt(r[i]);if(s&&s.type!==t.header_cell)return!1}return!0}function Ju(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?xq(n):function(t,r){if(!si(t))return!1;if(r){const i=wn(t.schema),s=Ii(t),o=t.tr,a=dS("row",s,i),l=dS("column",s,i),u=(n==="column"?a:n==="row"?l:!1)?1:0,d=n=="column"?{left:0,top:u,right:1,bottom:s.map.height}:n=="row"?{left:u,top:0,right:s.map.width,bottom:1}:s,f=n=="column"?l?i.cell:i.header_cell:n=="row"?a?i.cell:i.header_cell:i.cell;s.map.cellsInRect(d).forEach(p=>{const m=p+s.tableStart,v=o.doc.nodeAt(m);v&&o.setNodeMarkup(m,f,v.attrs)}),r(o)}return!0}}Ju("row",{useDeprecatedLogic:!0});Ju("column",{useDeprecatedLogic:!0});var Sq=Ju("cell",{useDeprecatedLogic:!0});function _q(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,i=n.before();r>=0;r--){const s=n.node(-1).child(r),o=s.lastChild;if(o)return i-1-o.nodeSize;i-=s.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),i=n.after();r<t.childCount;r++){const s=t.child(r);if(s.childCount)return i+1;i+=s.nodeSize}}return null}function fS(n){return function(e,t){if(!si(e))return!1;const r=_q(Yp(e),n);if(r==null)return!1;if(t){const i=e.doc.resolve(r);t(e.tr.setSelection(ot.between(i,DV(i))).scrollIntoView())}return!0}}function Cq(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function kq({allowTableNodeSelection:n=!1}={}){return new zl({key:Ts,state:{init(){return null},apply(e,t){const r=e.getMeta(Ts);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:s}=e.mapping.mapResult(t);return i?null:s}},props:{decorations:LV,handleDOMEvents:{mousedown:YV},createSelectionBetween(e){return Ts.getState(e.state)!=null?e.state.selection:null},handleTripleClick:KV,handleKeyDown:JV,handlePaste:GV},appendTransaction(e,t,r){return HV(r,PA(r,t),n)}})}function hS(n,e,t,r,i,s){let o=0,a=!0,l=e.firstChild;const c=n.firstChild;for(let u=0,d=0;u<c.childCount;u+=1){const{colspan:f,colwidth:p}=c.child(u).attrs;for(let m=0;m<f;m+=1,d+=1){const v=i===d?s:p&&p[m],x=v?`${v}px`:"";o+=v||r,v||(a=!1),l?(l.style.width!==x&&(l.style.width=x),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=x}}for(;l;){const u=l.nextSibling;l.parentNode.removeChild(l),l=u}a?(t.style.width=`${o}px`,t.style.minWidth=""):(t.style.width="",t.style.minWidth=`${o}px`)}class Eq{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),hS(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,hS(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function Tq(n,e,t,r){let i=0,s=!0;const o=[],a=n.firstChild;if(!a)return{};for(let d=0,f=0;d<a.childCount;d+=1){const{colspan:p,colwidth:m}=a.child(d).attrs;for(let v=0;v<p;v+=1,f+=1){const x=t===f?r:m&&m[v],b=x?`${x}px`:"";i+=x||e,x||(s=!1),o.push(["col",b?{style:`width: ${b}`}:{}])}}const l=s?`${i}px`:"",c=s?"":`${i}px`;return{colgroup:["colgroup",{},...o],tableWidth:l,tableMinWidth:c}}function pS(n,e){return e?n.createChecked(null,e):n.createAndFill()}function Aq(n){if(n.cached.tableNodeTypes)return n.cached.tableNodeTypes;const e={};return Object.keys(n.nodes).forEach(t=>{const r=n.nodes[t];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),n.cached.tableNodeTypes=e,e}function Mq(n,e,t,r,i){const s=Aq(n),o=[],a=[];for(let c=0;c<t;c+=1){const u=pS(s.cell,i);if(u&&a.push(u),r){const d=pS(s.header_cell,i);d&&o.push(d)}}const l=[];for(let c=0;c<e;c+=1)l.push(s.row.createChecked(null,r&&c===0?o:a));return s.table.createChecked(null,l)}function Rq(n){return n instanceof xt}const lf=({editor:n})=>{const{selection:e}=n.state;if(!Rq(e))return!1;let t=0;const r=I3(e.ranges[0].$from,s=>s.type.name==="table");return r==null||r.node.descendants(s=>{if(s.type.name==="table")return!1;["tableCell","tableHeader"].includes(s.type.name)&&(t+=1)}),t===e.ranges.length?(n.commands.deleteTable(),!0):!1},Iq=Wt.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Eq,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:n,HTMLAttributes:e}){const{colgroup:t,tableWidth:r,tableMinWidth:i}=Tq(n,this.options.cellMinWidth);return["table",rt(this.options.HTMLAttributes,e,{style:r?`width: ${r}`:`minWidth: ${i}`}),t,["tbody",0]]},addCommands(){return{insertTable:({rows:n=3,cols:e=3,withHeaderRow:t=!0}={})=>({tr:r,dispatch:i,editor:s})=>{const o=Mq(s.schema,n,e,t);if(i){const a=r.selection.anchor+1;r.replaceSelectionWith(o).scrollIntoView().setSelection(qt.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:n,dispatch:e})=>cq(n,e),addColumnAfter:()=>({state:n,dispatch:e})=>uq(n,e),deleteColumn:()=>({state:n,dispatch:e})=>fq(n,e),addRowBefore:()=>({state:n,dispatch:e})=>pq(n,e),addRowAfter:()=>({state:n,dispatch:e})=>mq(n,e),deleteRow:()=>({state:n,dispatch:e})=>yq(n,e),deleteTable:()=>({state:n,dispatch:e})=>Cq(n,e),mergeCells:()=>({state:n,dispatch:e})=>cS(n,e),splitCell:()=>({state:n,dispatch:e})=>uS(n,e),toggleHeaderColumn:()=>({state:n,dispatch:e})=>Ju("column")(n,e),toggleHeaderRow:()=>({state:n,dispatch:e})=>Ju("row")(n,e),toggleHeaderCell:()=>({state:n,dispatch:e})=>Sq(n,e),mergeOrSplit:()=>({state:n,dispatch:e})=>cS(n,e)?!0:uS(n,e),setCellAttribute:(n,e)=>({state:t,dispatch:r})=>wq(n,e)(t,r),goToNextCell:()=>({state:n,dispatch:e})=>fS(1)(n,e),goToPreviousCell:()=>({state:n,dispatch:e})=>fS(-1)(n,e),fixTables:()=>({state:n,dispatch:e})=>(e&&PA(n),!0),setCellSelection:n=>({tr:e,dispatch:t})=>{if(t){const r=xt.create(e.doc,n.anchorCell,n.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:lf,"Mod-Backspace":lf,Delete:lf,"Mod-Delete":lf}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[ZV({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],kq({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(n){const e={name:n.name,options:n.options,storage:n.storage};return{tableRole:Ve(xe(n,"tableRole",e))}}}),Oq=Wt.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:n}){return["td",rt(this.options.HTMLAttributes,n),0]}}),Pq=Wt.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:n}){return["th",rt(this.options.HTMLAttributes,n),0]}}),Dq=Wt.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:n}){return["tr",rt(this.options.HTMLAttributes,n),0]}}),mS=n=>new Promise(e=>{let t=new FileReader;t.onloadend=()=>{e(t.result)},t.readAsDataURL(n)}),$q=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Nq=Wt.create({name:"image",addOptions(){return{inline:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:"img[src]"}]},renderHTML({HTMLAttributes:n}){return["img",rt(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[D3({find:$q,type:this.type,getAttributes:n=>{const[,,e,t,r]=n;return{src:t,alt:e,title:r}}})]},addProseMirrorPlugins(){return[Lq()]}}),Lq=()=>new zl({props:{handlePaste(n,e,t){var s;const r=Array.from(((s=e.clipboardData)==null?void 0:s.items)||[]),{schema:i}=n.state;return r.forEach(o=>{const a=o.getAsFile();a&&o.type.indexOf("image")===0&&(e.preventDefault(),mS(a).then(l=>{const c=i.nodes.image.create({src:l}),u=n.state.tr.replaceSelectionWith(c);n.dispatch(u)}))}),!1},handleDOMEvents:{drop:(n,e)=>{var o,a;if(!(e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length))return!1;const r=Array.from((a=(o=e.dataTransfer)==null?void 0:o.files)!=null?a:[]).filter(l=>/image/i.test(l.type));if(r.length===0)return!1;e.preventDefault();const{schema:i}=n.state,s=n.posAtCoords({left:e.clientX,top:e.clientY});return s?(r.forEach(l=>Zt(void 0,null,function*(){mS(l).then(c=>{const u=i.nodes.image.create({src:c}),d=n.state.tr.insert(s.pos,u);n.dispatch(d)})})),!0):!1}}}}),jq=Wt.create({name:"video",group:"block",selectable:!0,draggable:!0,atom:!0,addAttributes(){return{src:{default:null}}},parseHTML(){return[{tag:"video"}]},renderHTML({HTMLAttributes:n}){return["video",rt(n)]},addNodeView(){return({editor:n,node:e})=>{const t=document.createElement("div");t.className="relative aspect-w-16 aspect-h-9"+(n.isEditable?" cursor-pointer":"");const r=document.createElement("video");if(n.isEditable&&(r.className="pointer-events-none"),r.src=e.attrs.src,!n.isEditable)r.setAttribute("controls","");else{let i=document.createElement("div");i.className="absolute top-0 right-0 text-xs m-2 bg-gray-800 text-white px-2 py-1 rounded-md",i.innerHTML="Video",t.append(i)}return t.append(r),{dom:t}}}}),Fq="aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Hq="1213426321653223333353565455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",$l=(n,e)=>{for(const t in e)n[t]=e[t];return n},P1="numeric",D1="ascii",$1="alpha",Zf="asciinumeric",cf="alphanumeric",N1="domain",jA="emoji",Bq="scheme",zq="slashscheme",gS="whitespace";function Vq(n,e){return n in e||(e[n]=[]),e[n]}function Oo(n,e,t){e[P1]&&(e[Zf]=!0,e[cf]=!0),e[D1]&&(e[Zf]=!0,e[$1]=!0),e[Zf]&&(e[cf]=!0),e[$1]&&(e[cf]=!0),e[cf]&&(e[N1]=!0),e[jA]&&(e[N1]=!0);for(const r in e){const i=Vq(r,t);i.indexOf(n)<0&&i.push(n)}}function qq(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function Un(n){n===void 0&&(n=null),this.j={},this.jr=[],this.jd=null,this.t=n}Un.groups={};Un.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],s=e.jr[r][1];if(s&&i.test(n))return s}return e.jd},has(n,e){return e===void 0&&(e=!1),e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let i=0;i<n.length;i++)this.tt(n[i],e,t,r)},tr(n,e,t,r){r=r||Un.groups;let i;return e&&e.j?i=e:(i=new Un(e),t&&r&&Oo(e,t,r)),this.jr.push([n,i]),i},ts(n,e,t,r){let i=this;const s=n.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(n[o]);return i.tt(n[s-1],e,t,r)},tt(n,e,t,r){r=r||Un.groups;const i=this;if(e&&e.j)return i.j[n]=e,e;const s=e;let o,a=i.go(n);if(a?(o=new Un,$l(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new Un,s){if(r)if(o.t&&typeof o.t=="string"){const l=$l(qq(o.t,r),t);Oo(s,l,r)}else t&&Oo(s,t,r);o.t=s}return i.j[n]=o,o}};const Ee=(n,e,t,r,i)=>n.ta(e,t,r,i),xr=(n,e,t,r,i)=>n.tr(e,t,r,i),yS=(n,e,t,r,i)=>n.ts(e,t,r,i),ue=(n,e,t,r,i)=>n.tt(e,t,r,i),Li="WORD",L1="UWORD",Ku="LOCALHOST",j1="TLD",F1="UTLD",Qf="SCHEME",qa="SLASH_SCHEME",Dv="NUM",FA="WS",$v="NL",Ga="OPENBRACE",pu="OPENBRACKET",mu="OPENANGLEBRACKET",gu="OPENPAREN",So="CLOSEBRACE",Ya="CLOSEBRACKET",Xa="CLOSEANGLEBRACKET",_o="CLOSEPAREN",Wh="AMPERSAND",Jh="APOSTROPHE",Kh="ASTERISK",_s="AT",Gh="BACKSLASH",Yh="BACKTICK",Xh="CARET",As="COLON",Nv="COMMA",Zh="DOLLAR",ci="DOT",Qh="EQUALS",Lv="EXCLAMATION",ui="HYPHEN",ep="PERCENT",tp="PIPE",np="PLUS",rp="POUND",ip="QUERY",jv="QUOTE",Fv="SEMI",di="SLASH",yu="TILDE",sp="UNDERSCORE",HA="EMOJI",op="SYM";var BA=Object.freeze({__proto__:null,WORD:Li,UWORD:L1,LOCALHOST:Ku,TLD:j1,UTLD:F1,SCHEME:Qf,SLASH_SCHEME:qa,NUM:Dv,WS:FA,NL:$v,OPENBRACE:Ga,OPENBRACKET:pu,OPENANGLEBRACKET:mu,OPENPAREN:gu,CLOSEBRACE:So,CLOSEBRACKET:Ya,CLOSEANGLEBRACKET:Xa,CLOSEPAREN:_o,AMPERSAND:Wh,APOSTROPHE:Jh,ASTERISK:Kh,AT:_s,BACKSLASH:Gh,BACKTICK:Yh,CARET:Xh,COLON:As,COMMA:Nv,DOLLAR:Zh,DOT:ci,EQUALS:Qh,EXCLAMATION:Lv,HYPHEN:ui,PERCENT:ep,PIPE:tp,PLUS:np,POUND:rp,QUERY:ip,QUOTE:jv,SEMI:Fv,SLASH:di,TILDE:yu,UNDERSCORE:sp,EMOJI:HA,SYM:op});const Sa=/[a-z]/,Ng=new RegExp("\\p{L}","u"),Lg=new RegExp("\\p{Emoji}","u"),jg=/\d/,vS=/\s/,bS=`
`,Uq="",Wq="";let uf=null,df=null;function Jq(n){n===void 0&&(n=[]);const e={};Un.groups=e;const t=new Un;uf==null&&(uf=wS(Fq)),df==null&&(df=wS(Hq)),ue(t,"'",Jh),ue(t,"{",Ga),ue(t,"[",pu),ue(t,"<",mu),ue(t,"(",gu),ue(t,"}",So),ue(t,"]",Ya),ue(t,">",Xa),ue(t,")",_o),ue(t,"&",Wh),ue(t,"*",Kh),ue(t,"@",_s),ue(t,"`",Yh),ue(t,"^",Xh),ue(t,":",As),ue(t,",",Nv),ue(t,"$",Zh),ue(t,".",ci),ue(t,"=",Qh),ue(t,"!",Lv),ue(t,"-",ui),ue(t,"%",ep),ue(t,"|",tp),ue(t,"+",np),ue(t,"#",rp),ue(t,"?",ip),ue(t,'"',jv),ue(t,"/",di),ue(t,";",Fv),ue(t,"~",yu),ue(t,"_",sp),ue(t,"\\",Gh);const r=xr(t,jg,Dv,{[P1]:!0});xr(r,jg,r);const i=xr(t,Sa,Li,{[D1]:!0});xr(i,Sa,i);const s=xr(t,Ng,L1,{[$1]:!0});xr(s,Sa),xr(s,Ng,s);const o=xr(t,vS,FA,{[gS]:!0});ue(t,bS,$v,{[gS]:!0}),ue(o,bS),xr(o,vS,o);const a=xr(t,Lg,HA,{[jA]:!0});xr(a,Lg,a),ue(a,Uq,a);const l=ue(a,Wq);xr(l,Lg,a);const c=[[Sa,i]],u=[[Sa,null],[Ng,s]];for(let d=0;d<uf.length;d++)us(t,uf[d],j1,Li,c);for(let d=0;d<df.length;d++)us(t,df[d],F1,L1,u);Oo(j1,{tld:!0,ascii:!0},e),Oo(F1,{utld:!0,alpha:!0},e),us(t,"file",Qf,Li,c),us(t,"mailto",Qf,Li,c),us(t,"http",qa,Li,c),us(t,"https",qa,Li,c),us(t,"ftp",qa,Li,c),us(t,"ftps",qa,Li,c),Oo(Qf,{scheme:!0,ascii:!0},e),Oo(qa,{slashscheme:!0,ascii:!0},e),n=n.sort((d,f)=>d[0]>f[0]?1:-1);for(let d=0;d<n.length;d++){const f=n[d][0],m=n[d][1]?{[Bq]:!0}:{[zq]:!0};f.indexOf("-")>=0?m[N1]=!0:Sa.test(f)?jg.test(f)?m[Zf]=!0:m[D1]=!0:m[P1]=!0,yS(t,f,f,m)}return yS(t,"localhost",Ku,{ascii:!0}),t.jd=new Un(op),{start:t,tokens:$l({groups:e},BA)}}function Kq(n,e){const t=Gq(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=t.length,i=[];let s=0,o=0;for(;o<r;){let a=n,l=null,c=0,u=null,d=-1,f=-1;for(;o<r&&(l=a.go(t[o]));)a=l,a.accepts()?(d=0,f=0,u=a):d>=0&&(d+=t[o].length,f++),c+=t[o].length,s+=t[o].length,o++;s-=d,o-=f,c-=d,i.push({t:u.t,v:e.slice(s-c,s),s:s-c,e:s})}return i}function Gq(n){const e=[],t=n.length;let r=0;for(;r<t;){let i=n.charCodeAt(r),s,o=i<55296||i>56319||r+1===t||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function us(n,e,t,r,i){let s;const o=e.length;for(let a=0;a<o-1;a++){const l=e[a];n.j[l]?s=n.j[l]:(s=new Un(r),s.jr=i.slice(),n.j[l]=s),n=s}return s=new Un(t),s.jr=i.slice(),n.j[e[o-1]]=s,s}function wS(n){const e=[],t=[];let r=0,i="0123456789";for(;r<n.length;){let s=0;for(;i.indexOf(n[r+s])>=0;)s++;if(s>0){e.push(t.join(""));for(let o=parseInt(n.substring(r,r+s),10);o>0;o--)t.pop();r+=s}else t.push(n[r]),r++}return e}const Gu={defaultProtocol:"http",events:null,format:xS,formatHref:xS,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Hv(n,e){e===void 0&&(e=null);let t=$l({},Gu);n&&(t=$l(t,n instanceof Hv?n.o:n));const r=t.ignoreTags,i=[];for(let s=0;s<r.length;s++)i.push(r[s].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}Hv.prototype={o:Gu,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:Gu[n],typeof i=="function"&&r&&(i=i(e,t))):typeof i=="function"&&r&&(i=i(e,t.t,t)),i)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function xS(n){return n}function zA(n,e){this.t="token",this.v=n,this.tk=e}zA.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n){return n===void 0&&(n=Gu.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),i=n.get("tagName",t,e),s=this.toFormattedString(n),o={},a=n.get("className",t,e),l=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),d=n.getObj("events",t,e);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&$l(o,u),{tagName:i,attributes:o,content:s,eventListeners:d}}};function Xp(n,e){class t extends zA{constructor(i,s){super(i,s),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const SS=Xp("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),_S=Xp("text"),Yq=Xp("nl"),lo=Xp("url",{isLink:!0,toHref(n){return n===void 0&&(n=Gu.defaultProtocol),this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Ku&&n[1].t===As}}),Qt=n=>new Un(n);function Xq(n){let{groups:e}=n;const t=e.domain.concat([Wh,Kh,_s,Gh,Yh,Xh,Zh,Qh,ui,Dv,ep,tp,np,rp,di,op,yu,sp]),r=[Jh,Xa,So,Ya,_o,As,Nv,ci,Lv,mu,Ga,pu,gu,ip,jv,Fv],i=[Wh,Jh,Kh,Gh,Yh,Xh,So,Zh,Qh,ui,Ga,ep,tp,np,rp,ip,di,op,yu,sp],s=Qt(),o=ue(s,yu);Ee(o,i,o),Ee(o,e.domain,o);const a=Qt(),l=Qt(),c=Qt();Ee(s,e.domain,a),Ee(s,e.scheme,l),Ee(s,e.slashscheme,c),Ee(a,i,o),Ee(a,e.domain,a);const u=ue(a,_s);ue(o,_s,u),ue(l,_s,u),ue(c,_s,u);const d=ue(o,ci);Ee(d,i,o),Ee(d,e.domain,o);const f=Qt();Ee(u,e.domain,f),Ee(f,e.domain,f);const p=ue(f,ci);Ee(p,e.domain,f);const m=Qt(SS);Ee(p,e.tld,m),Ee(p,e.utld,m),ue(u,Ku,m);const v=ue(f,ui);Ee(v,e.domain,f),Ee(m,e.domain,f),ue(m,ci,p),ue(m,ui,v);const x=ue(m,As);Ee(x,e.numeric,SS);const b=ue(a,ui),_=ue(a,ci);Ee(b,e.domain,a),Ee(_,i,o),Ee(_,e.domain,a);const M=Qt(lo);Ee(_,e.tld,M),Ee(_,e.utld,M),Ee(M,e.domain,a),Ee(M,i,o),ue(M,ci,_),ue(M,ui,b),ue(M,_s,u);const h=ue(M,As),w=Qt(lo);Ee(h,e.numeric,w);const y=Qt(lo),E=Qt();Ee(y,t,y),Ee(y,r,E),Ee(E,t,y),Ee(E,r,E),ue(M,di,y),ue(w,di,y);const g=ue(l,As),I=ue(c,As),R=ue(I,di),S=ue(R,di);Ee(l,e.domain,a),ue(l,ci,_),ue(l,ui,b),Ee(c,e.domain,a),ue(c,ci,_),ue(c,ui,b),Ee(g,e.domain,y),ue(g,di,y),Ee(S,e.domain,y),Ee(S,t,y),ue(S,di,y);const k=ue(y,Ga),T=ue(y,pu),C=ue(y,mu),D=ue(y,gu);ue(E,Ga,k),ue(E,pu,T),ue(E,mu,C),ue(E,gu,D),ue(k,So,y),ue(T,Ya,y),ue(C,Xa,y),ue(D,_o,y),ue(k,So,y);const A=Qt(lo),O=Qt(lo),P=Qt(lo),N=Qt(lo);Ee(k,t,A),Ee(T,t,O),Ee(C,t,P),Ee(D,t,N);const F=Qt(),j=Qt(),J=Qt(),ie=Qt();return Ee(k,r),Ee(T,r),Ee(C,r),Ee(D,r),Ee(A,t,A),Ee(O,t,O),Ee(P,t,P),Ee(N,t,N),Ee(A,r,A),Ee(O,r,O),Ee(P,r,P),Ee(N,r,N),Ee(F,t,F),Ee(j,t,O),Ee(J,t,P),Ee(ie,t,N),Ee(F,r,F),Ee(j,r,j),Ee(J,r,J),Ee(ie,r,ie),ue(O,Ya,y),ue(P,Xa,y),ue(N,_o,y),ue(A,So,y),ue(j,Ya,y),ue(J,Xa,y),ue(ie,_o,y),ue(F,_o,y),ue(s,Ku,M),ue(s,$v,Yq),{start:s,tokens:BA}}function Zq(n,e,t){let r=t.length,i=0,s=[],o=[];for(;i<r;){let a=n,l=null,c=null,u=0,d=null,f=-1;for(;i<r&&!(l=a.go(t[i].t));)o.push(t[i++]);for(;i<r&&(c=l||a.go(t[i].t));)l=null,a=c,a.accepts()?(f=0,d=a):f>=0&&f++,i++,u++;if(f<0)i-=u,i<r&&(o.push(t[i]),i++);else{o.length>0&&(s.push(Fg(_S,e,o)),o=[]),i-=f,u-=f;const p=d.t,m=t.slice(i-u,i);s.push(Fg(p,e,m))}}return o.length>0&&s.push(Fg(_S,e,o)),s}function Fg(n,e,t){const r=t[0].s,i=t[t.length-1].e,s=e.slice(r,i);return new n(s,t)}const Qq=typeof console!="undefined"&&console&&console.warn||(()=>{}),eU="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Tt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function tU(){Un.groups={},Tt.scanner=null,Tt.parser=null,Tt.tokenQueue=[],Tt.pluginQueue=[],Tt.customSchemes=[],Tt.initialized=!1}function CS(n,e){if(e===void 0&&(e=!1),Tt.initialized&&Qq(`linkifyjs: already initialized - will not register custom scheme "${n}" ${eU}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
 1. Must only contain digits, lowercase ASCII letters or "-"
 2. Cannot start or end with "-"
 3. "-" cannot repeat`);Tt.customSchemes.push([n,e])}function nU(){Tt.scanner=Jq(Tt.customSchemes);for(let n=0;n<Tt.tokenQueue.length;n++)Tt.tokenQueue[n][1]({scanner:Tt.scanner});Tt.parser=Xq(Tt.scanner.tokens);for(let n=0;n<Tt.pluginQueue.length;n++)Tt.pluginQueue[n][1]({scanner:Tt.scanner,parser:Tt.parser});Tt.initialized=!0}function VA(n){return Tt.initialized||nU(),Zq(Tt.parser.start,n,Kq(Tt.scanner.start,n))}function qA(n,e,t){if(e===void 0&&(e=null),t===void 0&&(t=null),e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new Hv(t),i=VA(n),s=[];for(let o=0;o<i.length;o++){const a=i[o];a.isLink&&(!e||a.t===e)&&s.push(a.toFormattedObject(r))}return s}function rU(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function iU(n){return new Bn({key:new sr("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),s=e.some(c=>c.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,a=vF(t.doc,[...e]);if(EF(a).forEach(({newRange:c})=>{const u=wF(r.doc,c,p=>p.isTextblock);let d,f;if(u.length>1?(d=u[0],f=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],f=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&f){const p=f.split(" ").filter(b=>b!=="");if(p.length<=0)return!1;const m=p[p.length-1],v=d.pos+f.lastIndexOf(m);if(!m)return!1;const x=VA(m).map(b=>b.toObject());if(!rU(x))return!1;x.filter(b=>b.isLink).map(b=>Te(Y({},b),{from:v+b.start+1,to:v+b.end+1})).filter(b=>r.schema.marks.code?!r.doc.rangeHasMark(b.from,b.to,r.schema.marks.code):!0).filter(b=>n.validate?n.validate(b.value):!0).forEach(b=>{mv(b.from,b.to,r.doc).some(_=>_.mark.type===n.type)||o.addMark(b.from,b.to,n.type.create({href:b.href}))})}}),!!o.steps.length)return o}})}function sU(n){return new Bn({key:new sr("handleClickLink"),props:{handleClick:(e,t,r)=>{var i,s;if(r.button!==0)return!1;let o=r.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(f=>f.nodeName==="A"))return!1;const l=O3(e.state,n.type.name),c=r.target,u=(i=c==null?void 0:c.href)!==null&&i!==void 0?i:l.href,d=(s=c==null?void 0:c.target)!==null&&s!==void 0?s:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function oU(n){return new Bn({key:new sr("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{state:i}=e,{selection:s}=i,{empty:o}=s;if(o)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=qA(a).find(c=>c.isLink&&c.value===a);return!a||!l?!1:(n.editor.commands.setMark(n.type,{href:l.href}),!0)}}})}const aU=mr.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(n=>{if(typeof n=="string"){CS(n);return}CS(n.scheme,n.optionalSlashes)})},onDestroy(){tU()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:n}){var e;return!((e=n.href)===null||e===void 0)&&e.startsWith("javascript:")?["a",rt(this.options.HTMLAttributes,Te(Y({},n),{href:""})),0]:["a",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setLink:n=>({chain:e})=>e().setMark(this.name,n).setMeta("preventAutolink",!0).run(),toggleLink:n=>({chain:e})=>e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[zs({find:n=>{const e=[];if(n){const t=qA(n).filter(r=>r.isLink);t.length&&t.forEach(r=>e.push({text:r.value,data:{href:r.href},index:r.start}))}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[];return this.options.autolink&&n.push(iU({type:this.type,validate:this.options.validate})),this.options.openOnClick&&n.push(sU({type:this.type})),this.options.linkOnPaste&&n.push(oU({editor:this.editor,type:this.type})),n}}),lU=n=>Dt({find:/--$/,replace:n!=null?n:""}),cU=n=>Dt({find:/\.\.\.$/,replace:n!=null?n:""}),uU=n=>Dt({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:n!=null?n:""}),dU=n=>Dt({find:/"$/,replace:n!=null?n:""}),fU=n=>Dt({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:n!=null?n:""}),hU=n=>Dt({find:/'$/,replace:n!=null?n:""}),pU=n=>Dt({find:/<-$/,replace:n!=null?n:""}),mU=n=>Dt({find:/->$/,replace:n!=null?n:""}),gU=n=>Dt({find:/\(c\)$/,replace:n!=null?n:""}),yU=n=>Dt({find:/\(tm\)$/,replace:n!=null?n:""}),vU=n=>Dt({find:/\(sm\)$/,replace:n!=null?n:""}),bU=n=>Dt({find:/\(r\)$/,replace:n!=null?n:""}),wU=n=>Dt({find:/(?:^|\s)(1\/2)\s$/,replace:n!=null?n:""}),xU=n=>Dt({find:/\+\/-$/,replace:n!=null?n:""}),SU=n=>Dt({find:/!=$/,replace:n!=null?n:""}),_U=n=>Dt({find:/<<$/,replace:n!=null?n:""}),CU=n=>Dt({find:/>>$/,replace:n!=null?n:""}),kU=n=>Dt({find:/\d+\s?([*x])\s?\d+$/,replace:n!=null?n:""}),EU=n=>Dt({find:/\^2$/,replace:n!=null?n:""}),TU=n=>Dt({find:/\^3$/,replace:n!=null?n:""}),AU=n=>Dt({find:/(?:^|\s)(1\/4)\s$/,replace:n!=null?n:""}),MU=n=>Dt({find:/(?:^|\s)(3\/4)\s$/,replace:n!=null?n:""}),RU=Xt.create({name:"typography",addInputRules(){const n=[];return this.options.emDash!==!1&&n.push(lU(this.options.emDash)),this.options.ellipsis!==!1&&n.push(cU(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&n.push(uU(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&n.push(dU(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&n.push(fU(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&n.push(hU(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&n.push(pU(this.options.leftArrow)),this.options.rightArrow!==!1&&n.push(mU(this.options.rightArrow)),this.options.copyright!==!1&&n.push(gU(this.options.copyright)),this.options.trademark!==!1&&n.push(yU(this.options.trademark)),this.options.servicemark!==!1&&n.push(vU(this.options.servicemark)),this.options.registeredTrademark!==!1&&n.push(bU(this.options.registeredTrademark)),this.options.oneHalf!==!1&&n.push(wU(this.options.oneHalf)),this.options.plusMinus!==!1&&n.push(xU(this.options.plusMinus)),this.options.notEqual!==!1&&n.push(SU(this.options.notEqual)),this.options.laquo!==!1&&n.push(_U(this.options.laquo)),this.options.raquo!==!1&&n.push(CU(this.options.raquo)),this.options.multiplication!==!1&&n.push(kU(this.options.multiplication)),this.options.superscriptTwo!==!1&&n.push(EU(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&n.push(TU(this.options.superscriptThree)),this.options.oneQuarter!==!1&&n.push(AU(this.options.oneQuarter)),this.options.threeQuarters!==!1&&n.push(MU(this.options.threeQuarters)),n}}),IU=mr.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=yd(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),OU=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,PU=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,DU=mr.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",rt(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[sa({find:OU,type:this.type})]},addPasteRules(){return[zs({find:PU,type:this.type})]}}),$U=Xt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var e;return(e=n.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:e})=>e().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}});function NU(n){var e;const{char:t,allowSpaces:r,allowedPrefixes:i,startOfLine:s,$position:o}=n,a=sH(t),l=new RegExp(`\\s${a}$`),c=s?"^":"",u=r?new RegExp(`${c}${a}.*?(?=\\s${a}|$)`,"gm"):new RegExp(`${c}(?:^)?${a}[^\\s${a}]*`,"gm"),d=((e=o.nodeBefore)===null||e===void 0?void 0:e.isText)&&o.nodeBefore.text;if(!d)return null;const f=o.pos-d.length,p=Array.from(d.matchAll(u)).pop();if(!p||p.input===void 0||p.index===void 0)return null;const m=p.input.slice(Math.max(0,p.index-1),p.index),v=new RegExp(`^[${i==null?void 0:i.join("")}\0]?$`).test(m);if(i!==null&&!v)return null;const x=f+p.index;let b=x+p[0].length;return r&&l.test(d.slice(b-1,b+1))&&(p[0]+=" ",b+=1),x<o.pos&&b>=o.pos?{range:{from:x,to:b},query:p[0].slice(t.length),text:p[0]}:null}const LU=new sr("suggestion");function jU({pluginKey:n=LU,editor:e,char:t="@",allowSpaces:r=!1,allowedPrefixes:i=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:a="suggestion",command:l=()=>null,items:c=()=>[],render:u=()=>({}),allow:d=()=>!0,findSuggestionMatch:f=NU}){let p;const m=u==null?void 0:u(),v=new Bn({key:n,view(){return{update:(x,b)=>Zt(this,null,function*(){var _,M,h,w,y,E,g;const I=(_=this.key)===null||_===void 0?void 0:_.getState(b),R=(M=this.key)===null||M===void 0?void 0:M.getState(x.state),S=I.active&&R.active&&I.range.from!==R.range.from,k=!I.active&&R.active,T=I.active&&!R.active,C=!k&&!T&&I.query!==R.query,D=k||S,A=C&&!S,O=T||S;if(!D&&!A&&!O)return;const P=O&&!D?I:R,N=x.dom.querySelector(`[data-decoration-id="${P.decorationId}"]`);p={editor:e,range:P.range,query:P.query,text:P.text,items:[],command:F=>{l({editor:e,range:P.range,props:F})},decorationNode:N,clientRect:N?()=>{var F;const{decorationId:j}=(F=this.key)===null||F===void 0?void 0:F.getState(e.state),J=x.dom.querySelector(`[data-decoration-id="${j}"]`);return(J==null?void 0:J.getBoundingClientRect())||null}:null},D&&((h=m==null?void 0:m.onBeforeStart)===null||h===void 0||h.call(m,p)),A&&((w=m==null?void 0:m.onBeforeUpdate)===null||w===void 0||w.call(m,p)),(A||D)&&(p.items=yield c({editor:e,query:P.query})),O&&((y=m==null?void 0:m.onExit)===null||y===void 0||y.call(m,p)),A&&((E=m==null?void 0:m.onUpdate)===null||E===void 0||E.call(m,p)),D&&((g=m==null?void 0:m.onStart)===null||g===void 0||g.call(m,p))}),destroy:()=>{var x;p&&((x=m==null?void 0:m.onExit)===null||x===void 0||x.call(m,p))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(x,b,_,M){const{isEditable:h}=e,{composing:w}=e.view,{selection:y}=x,{empty:E,from:g}=y,I=Y({},b);if(I.composing=w,h&&(E||e.view.composing)){(g<b.range.from||g>b.range.to)&&!w&&!b.composing&&(I.active=!1);const R=f({char:t,allowSpaces:r,allowedPrefixes:i,startOfLine:s,$position:y.$from}),S=`id_${Math.floor(Math.random()*4294967295)}`;R&&d({editor:e,state:M,range:R.range})?(I.active=!0,I.decorationId=b.decorationId?b.decorationId:S,I.range=R.range,I.query=R.query,I.text=R.text):I.active=!1}else I.active=!1;return I.active||(I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null),I}},props:{handleKeyDown(x,b){var _;const{active:M,range:h}=v.getState(x.state);return M&&((_=m==null?void 0:m.onKeyDown)===null||_===void 0?void 0:_.call(m,{view:x,event:b,range:h}))||!1},decorations(x){const{active:b,range:_,decorationId:M}=v.getState(x);return b?Nr.create(x.doc,[Zs.inline(_.from,_.to,{nodeName:o,class:a,"data-decoration-id":M})]):null}}});return v}const FU=new sr("mention"),HU=Wt.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderText({options:n,node:e}){var t;return`${n.suggestion.char}${(t=e.attrs.label)!==null&&t!==void 0?t:e.attrs.id}`},renderHTML({options:n,node:e}){var t;return["span",rt(this.HTMLAttributes,n.HTMLAttributes),`${n.suggestion.char}${(t=e.attrs.label)!==null&&t!==void 0?t:e.attrs.id}`]},suggestion:{char:"@",pluginKey:FU,command:({editor:n,range:e,props:t})=>{var r,i;const s=n.view.state.selection.$to.nodeAfter;((r=s==null?void 0:s.text)===null||r===void 0?void 0:r.startsWith(" "))&&(e.to+=1),n.chain().focus().insertContentAt(e,[{type:this.name,attrs:t},{type:"text",text:" "}]).run(),(i=window.getSelection())===null||i===void 0||i.collapseToEnd()},allow:({state:n,range:e})=>{const t=n.doc.resolve(e.from),r=n.schema.nodes[this.name];return!!t.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:n=>n.getAttribute("data-id"),renderHTML:n=>n.id?{"data-id":n.id}:{}},label:{default:null,parseHTML:n=>n.getAttribute("data-label"),renderHTML:n=>n.label?{"data-label":n.label}:{}}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:n,HTMLAttributes:e}){if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",rt({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:n})];const t=Y({},this.options);t.HTMLAttributes=rt({"data-type":this.name},this.options.HTMLAttributes,e);const r=this.options.renderHTML({options:t,node:n});return typeof r=="string"?["span",rt({"data-type":this.name},this.options.HTMLAttributes,e),r]:r},renderText({node:n}){return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel({options:this.options,node:n})):this.options.renderText({options:this.options,node:n})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:n,state:e})=>{let t=!1;const{selection:r}=e,{empty:i,anchor:s}=r;return i?(e.doc.nodesBetween(s-1,s,(o,a)=>{if(o.type.name===this.name)return t=!0,n.insertText(this.options.suggestion.char||"",a,a+o.nodeSize),!1}),t):!1})}},addProseMirrorPlugins(){return[jU(Y({editor:this.editor},this.options.suggestion))]}}),BU={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:n}){return n.key==="ArrowUp"?(this.upHandler(),!0):n.key==="ArrowDown"?(this.downHandler(),!0):n.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(n){const e=this.items[n];e&&this.command({id:e.value,label:e.label})}}},zU={key:0,class:"min-w-40 rounded-lg border bg-white p-1 text-base shadow-lg"},VU=["onClick","onMouseover"];function qU(n,e,t,r,i,s){return q(),Q("div",null,[t.items.length?(q(),Q("div",zU,[(q(!0),Q(lt,null,Si(t.items,(o,a)=>(q(),Q("button",{class:De([a===i.selectedIndex?"bg-gray-100":"text-gray-900","flex w-full items-center whitespace-nowrap rounded-md px-2 py-2 text-sm"]),key:a,onClick:l=>s.selectItem(a),onMouseover:l=>i.selectedIndex=a},Ge(o.label),43,VU))),128))])):He("",!0)])}const UU=je(BU,[["render",qU]]);function WU(n){return HU.configure({HTMLAttributes:{class:"mention"},suggestion:JU(n)})}function JU(n){return{items:({query:e})=>n.filter(t=>t.label.toLowerCase().startsWith(e.toLowerCase())).slice(0,5),render:()=>{let e,t;return{onStart:r=>{e=new BB(UU,{props:r,editor:r.editor}),r.clientRect&&(t=pa("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:e.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){e.updateProps(r),r.clientRect&&t[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){var i;return r.event.key==="Escape"?(t[0].hide(),!0):(i=e.ref)==null?void 0:i.onKeyDown(r)},onExit(){t[0].destroy(),e.destroy()}}}}}const KU={name:"TipTapMenu",props:["buttons"],inject:["editor"],components:{Popover:lk},methods:{onButtonClick(n){n.action(this.editor)}}},GU={class:"inline-flex bg-white px-1 py-1"},YU={class:"inline-flex items-center gap-1"},XU={key:0,class:"h-4 w-[2px] border-l"},ZU={key:1,class:"shrink-0"},QU=["onClick","set"],eW={key:1},tW={class:"rounded border bg-white p-1 shadow-md"},nW={class:"w-full"},rW=["onClick"],iW=["onClick","title"],sW={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function oW(n,e,t,r,i,s){const o=mt("Popover");return q(),Q("div",GU,[K("div",YU,[(q(!0),Q(lt,null,Si(t.buttons,a=>(q(),Q(lt,{key:a.label},[a.type==="separator"?(q(),Q("div",XU)):a.map?(q(),Q("div",ZU,[ye(o,null,{target:Ue(({togglePopover:l})=>[K("button",{class:"rounded px-2 py-1 text-base font-medium text-gray-800 transition-colors hover:bg-gray-100",onClick:l,set:n.activeBtn=a.find(c=>c.isActive(s.editor))||a[0]},[n.activeBtn.icon?(q(),dt(bf(n.activeBtn.icon),{key:0,class:"h-4 w-4"})):(q(),Q("span",eW,Ge(n.activeBtn.label),1))],8,QU)]),body:Ue(({close:l})=>[K("ul",tW,[(q(!0),Q(lt,null,Si(a,c=>Xo((q(),Q("li",nW,[K("button",{class:"w-full rounded px-2 py-1 text-left text-base hover:bg-gray-50",onClick:()=>{s.onButtonClick(c),l()}},Ge(c.label),9,rW)],512)),[[Qo,c.isDisabled?!c.isDisabled(s.editor):!0]])),256))])]),_:2},1024)])):(q(),dt(bf(a.component||"div"),Mr(nn({key:2},{editor:s.editor})),{default:Ue(l=>[K("button",{class:De(["flex rounded p-1 text-gray-800 transition-colors",a.isActive(s.editor)||l!=null&&l.isActive?"bg-gray-100":"hover:bg-gray-100"]),onClick:c=>l!=null&&l.onClick?l.onClick(a):s.onButtonClick(a),title:a.label},[a.icon?(q(),dt(bf(a.icon),{key:0,class:"h-4 w-4"})):(q(),Q("span",sW,Ge(a.text),1))],10,iW)]),_:2},1040))],64))),128))])])}const UA=je(KU,[["render",oW]]),aW={},lW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},cW=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),uW=K("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm8-12v12h-2v-9.796l-2 .536V8.67L19.5 8H21z",fill:"currentColor"},null,-1),dW=[cW,uW];function fW(n,e){return q(),Q("svg",lW,dW)}const hW=je(aW,[["render",fW]]),pW={},mW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},gW=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),yW=K("path",{d:"M4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 4c2.071 0 3.75 1.679 3.75 3.75 0 .857-.288 1.648-.772 2.28l-.148.18L18.034 18H22v2h-7v-1.556l4.82-5.546c.268-.307.43-.709.43-1.148 0-.966-.784-1.75-1.75-1.75-.918 0-1.671.707-1.744 1.606l-.006.144h-2C14.75 9.679 16.429 8 18.5 8z",fill:"currentColor"},null,-1),vW=[gW,yW];function bW(n,e){return q(),Q("svg",mW,vW)}const wW=je(pW,[["render",bW]]),xW={},SW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},_W=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),CW=K("path",{d:"M22 8l-.002 2-2.505 2.883c1.59.435 2.757 1.89 2.757 3.617 0 2.071-1.679 3.75-3.75 3.75-1.826 0-3.347-1.305-3.682-3.033l1.964-.382c.156.806.866 1.415 1.718 1.415.966 0 1.75-.784 1.75-1.75s-.784-1.75-1.75-1.75c-.286 0-.556.069-.794.19l-1.307-1.547L19.35 10H15V8h7zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1),kW=[_W,CW];function EW(n,e){return q(),Q("svg",SW,kW)}const TW=je(xW,[["render",EW]]),AW={},MW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},RW=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),IW=K("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm9-12v8h1.5v2H22v2h-2v-2h-5.5v-1.34l5-8.66H22zm-2 3.133L17.19 16H20v-4.867z",fill:"currentColor"},null,-1),OW=[RW,IW];function PW(n,e){return q(),Q("svg",MW,OW)}const DW=je(AW,[["render",PW]]),$W={},NW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},LW=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),jW=K("path",{d:"M22 8v2h-4.323l-.464 2.636c.33-.089.678-.136 1.037-.136 2.21 0 4 1.79 4 4s-1.79 4-4 4c-1.827 0-3.367-1.224-3.846-2.897l1.923-.551c.24.836 1.01 1.448 1.923 1.448 1.105 0 2-.895 2-2s-.895-2-2-2c-.63 0-1.193.292-1.56.748l-1.81-.904L16 8h6zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1),FW=[LW,jW];function HW(n,e){return q(),Q("svg",NW,FW)}const BW=je($W,[["render",HW]]),zW={},VW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},qW=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),UW=K("path",{d:"M21.097 8l-2.598 4.5c2.21 0 4.001 1.79 4.001 4s-1.79 4-4 4-4-1.79-4-4c0-.736.199-1.426.546-2.019L18.788 8h2.309zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 10.5c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z",fill:"currentColor"},null,-1),WW=[qW,UW];function JW(n,e){return q(),Q("svg",VW,WW)}const KW=je(zW,[["render",JW]]),GW={},YW={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},XW=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),ZW=K("path",{d:"M13 6v15h-2V6H5V4h14v2z",fill:"currentColor"},null,-1),QW=[XW,ZW];function eJ(n,e){return q(),Q("svg",YW,QW)}const tJ=je(GW,[["render",eJ]]),nJ={},rJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},iJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),sJ=K("path",{d:"M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z",fill:"currentColor"},null,-1),oJ=[iJ,sJ];function aJ(n,e){return q(),Q("svg",rJ,oJ)}const lJ=je(nJ,[["render",aJ]]),cJ={},uJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},dJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),fJ=K("path",{d:"M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z",fill:"currentColor"},null,-1),hJ=[dJ,fJ];function pJ(n,e){return q(),Q("svg",uJ,hJ)}const mJ=je(cJ,[["render",pJ]]),gJ={},yJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},vJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),bJ=K("path",{d:"M8 3v9a4 4 0 1 0 8 0V3h2v9a6 6 0 1 1-12 0V3h2zM4 20h16v2H4v-2z",fill:"currentColor"},null,-1),wJ=[vJ,bJ];function xJ(n,e){return q(),Q("svg",yJ,wJ)}const SJ=je(gJ,[["render",xJ]]),_J={},CJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},kJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),EJ=K("path",{d:"M3 4h18v2H3V4zm2 15h14v2H5v-2zm-2-5h18v2H3v-2zm2-5h14v2H5V9z",fill:"currentColor"},null,-1),TJ=[kJ,EJ];function AJ(n,e){return q(),Q("svg",CJ,TJ)}const MJ=je(_J,[["render",AJ]]),RJ={},IJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},OJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),PJ=K("path",{d:"M3 4h18v2H3V4zm0 15h14v2H3v-2zm0-5h18v2H3v-2zm0-5h14v2H3V9z",fill:"currentColor"},null,-1),DJ=[OJ,PJ];function $J(n,e){return q(),Q("svg",IJ,DJ)}const NJ=je(RJ,[["render",$J]]),LJ={},jJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},FJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),HJ=K("path",{d:"M3 4h18v2H3V4zm4 15h14v2H7v-2zm-4-5h18v2H3v-2zm4-5h14v2H7V9z",fill:"currentColor"},null,-1),BJ=[FJ,HJ];function zJ(n,e){return q(),Q("svg",jJ,BJ)}const VJ=je(LJ,[["render",zJ]]),qJ={},UJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},WJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),JJ=K("path",{d:"M15.246 14H8.754l-1.6 4H5l6-15h2l6 15h-2.154l-1.6-4zm-.8-2L12 5.885 9.554 12h4.892zM3 20h18v2H3v-2z",fill:"currentColor"},null,-1),KJ=[WJ,JJ];function GJ(n,e){return q(),Q("svg",UJ,KJ)}const YJ=je(qJ,[["render",GJ]]),XJ={},ZJ={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},QJ=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),eK=K("path",{d:"M8 4h13v2H8V4zM5 3v3h1v1H3V6h1V4H3V3h2zM3 14v-2.5h2V11H3v-1h3v2.5H4v.5h2v1H3zm2 5.5H3v-1h2V18H3v-1h3v4H3v-1h2v-.5zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1),tK=[QJ,eK];function nK(n,e){return q(),Q("svg",ZJ,tK)}const rK=je(XJ,[["render",nK]]),iK={},sK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},oK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),aK=K("path",{d:"M8 4h13v2H8V4zM4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 6.9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1),lK=[oK,aK];function cK(n,e){return q(),Q("svg",sK,lK)}const uK=je(iK,[["render",cK]]),dK={},fK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},hK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),pK=K("path",{d:"M19.417 6.679C20.447 7.773 21 9 21 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311-1.804-.167-3.226-1.648-3.226-3.489a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179zm-10 0C10.447 7.773 11 9 11 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311C4.591 12.322 3.17 10.841 3.17 9a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179z",fill:"currentColor"},null,-1),mK=[hK,pK];function gK(n,e){return q(),Q("svg",fK,mK)}const yK=je(dK,[["render",gK]]),vK={},bK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},wK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),xK=K("path",{d:"M16.95 8.464l1.414-1.414 4.95 4.95-4.95 4.95-1.414-1.414L20.485 12 16.95 8.464zm-9.9 0L3.515 12l3.535 3.536-1.414 1.414L.686 12l4.95-4.95L7.05 8.464z",fill:"currentColor"},null,-1),SK=[wK,xK];function _K(n,e){return q(),Q("svg",bK,SK)}const CK=je(vK,[["render",_K]]),kK={},EK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},TK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),AK=K("path",{d:"M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z",fill:"currentColor"},null,-1),MK=[TK,AK];function RK(n,e){return q(),Q("svg",EK,MK)}const IK=je(kK,[["render",RK]]),OK={},PK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},DK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),$K=K("path",{d:"M21 15v3h3v2h-3v3h-2v-3h-3v-2h3v-3h2zm.008-12c.548 0 .992.445.992.993V13h-2V5H4v13.999L14 9l3 3v2.829l-3-3L6.827 19H14v2H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016zM8 7a2 2 0 1 1 0 4 2 2 0 0 1 0-4z",fill:"currentColor"},null,-1),NK=[DK,$K];function LK(n,e){return q(),Q("svg",PK,NK)}const jK=je(OK,[["render",LK]]),FK={},HK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},BK=K("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),zK=K("path",{d:"M16 4c.552 0 1 .448 1 1v4.2l5.213-3.65c.226-.158.538-.103.697.124.058.084.09.184.09.286v12.08c0 .276-.224.5-.5.5-.103 0-.203-.032-.287-.09L17 14.8V19c0 .552-.448 1-1 1H2c-.552 0-1-.448-1-1V5c0-.552.448-1 1-1h14zm-1 2H3v12h12V6zM8 8h2v3h3v2H9.999L10 16H8l-.001-3H5v-2h3V8zm13 .841l-4 2.8v.718l4 2.8V8.84z",fill:"currentColor"},null,-1),VK=[BK,zK];function qK(n,e){return q(),Q("svg",HK,VK)}const UK=je(FK,[["render",qK]]),WK={},JK={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},KK=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),GK=K("path",{d:"M5.828 7l2.536 2.536L6.95 10.95 2 6l4.95-4.95 1.414 1.414L5.828 5H13a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H5.828z",fill:"currentColor"},null,-1),YK=[KK,GK];function XK(n,e){return q(),Q("svg",JK,YK)}const ZK=je(WK,[["render",XK]]),QK={},eG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},tG=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),nG=K("path",{d:"M18.172 7H11a6 6 0 1 0 0 12h9v2h-9a8 8 0 1 1 0-16h7.172l-2.536-2.536L17.05 1.05 22 6l-4.95 4.95-1.414-1.414L18.172 7z",fill:"currentColor"},null,-1),rG=[tG,nG];function iG(n,e){return q(),Q("svg",eG,rG)}const sG=je(QK,[["render",iG]]),oG={},aG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},lG=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),cG=K("path",{d:"M2 11h2v2H2v-2zm4 0h12v2H6v-2zm14 0h2v2h-2v-2z",fill:"currentColor"},null,-1),uG=[lG,cG];function dG(n,e){return q(),Q("svg",aG,uG)}const fG=je(oG,[["render",dG]]),hG={},pG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},mG=K("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),gG=K("path",{d:"M13 10v4h6v-4h-6zm-2 0H5v4h6v-4zm2 9h6v-3h-6v3zm-2 0v-3H5v3h6zm2-14v3h6V5h-6zm-2 0H5v3h6V5zM4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z",fill:"currentColor"},null,-1),yG=[mG,gG];function vG(n,e){return q(),Q("svg",pG,yG)}const bG=je(hG,[["render",vG]]),wG={Paragraph:{label:"Paragraph",icon:tJ,action:n=>n.chain().focus().setParagraph().run(),isActive:n=>n.isActive("paragraph")},"Heading 1":{label:"Heading 1",text:"H1",icon:hW,action:n=>n.chain().focus().toggleHeading({level:1}).run(),isActive:n=>n.isActive("heading",{level:1})},"Heading 2":{label:"Heading 2",text:"H2",icon:wW,action:n=>n.chain().focus().toggleHeading({level:2}).run(),isActive:n=>n.isActive("heading",{level:2})},"Heading 3":{label:"Heading 3",text:"H3",icon:TW,action:n=>n.chain().focus().toggleHeading({level:3}).run(),isActive:n=>n.isActive("heading",{level:3})},"Heading 4":{label:"Heading 4",text:"H4",icon:DW,action:n=>n.chain().focus().toggleHeading({level:4}).run(),isActive:n=>n.isActive("heading",{level:4})},"Heading 5":{label:"Heading 5",text:"H5",icon:BW,action:n=>n.chain().focus().toggleHeading({level:5}).run(),isActive:n=>n.isActive("heading",{level:5})},"Heading 6":{label:"Heading 6",text:"H6",icon:KW,action:n=>n.chain().focus().toggleHeading({level:6}).run(),isActive:n=>n.isActive("heading",{level:6})},Bold:{label:"Bold",icon:lJ,action:n=>n.chain().focus().toggleBold().run(),isActive:n=>n.isActive("bold")},Italic:{label:"Italic",icon:mJ,action:n=>n.chain().focus().toggleItalic().run(),isActive:n=>n.isActive("italic")},Underline:{label:"Underline",icon:SJ,action:n=>n.chain().focus().toggleUnderline().run(),isActive:n=>n.isActive("underline")},"Bullet List":{label:"Bullet List",icon:uK,action:n=>n.chain().focus().toggleBulletList().run(),isActive:n=>n.isActive("bulletList")},"Numbered List":{label:"Numbered List",icon:rK,action:n=>n.chain().focus().toggleOrderedList().run(),isActive:n=>n.isActive("orderedList")},"Align Center":{label:"Align Center",icon:MJ,action:n=>n.chain().focus().setTextAlign("center").run(),isActive:n=>n.isActive({textAlign:"center"})},"Align Left":{label:"Align Left",icon:NJ,action:n=>n.chain().focus().setTextAlign("left").run(),isActive:n=>n.isActive({textAlign:"left"})},"Align Right":{label:"Align Right",icon:VJ,action:n=>n.chain().focus().setTextAlign("right").run(),isActive:n=>n.isActive({textAlign:"right"})},FontColor:{label:"Font Color",icon:YJ,isActive:n=>n.isActive("textStyle")||n.isActive("highlight"),component:Nd(()=>sc(()=>import("./FontColor-Bj3I4-H_.js"),[]))},Blockquote:{label:"Blockquote",icon:yK,action:n=>n.chain().focus().toggleBlockquote().run(),isActive:n=>n.isActive("blockquote")},Code:{label:"Code",icon:CK,action:n=>n.chain().focus().toggleCodeBlock().run(),isActive:n=>n.isActive("codeBlock")},"Horizontal Rule":{label:"Horizontal Rule",icon:fG,action:n=>n.chain().focus().setHorizontalRule().run(),isActive:n=>!1},Link:{label:"Link",icon:IK,isActive:n=>n.isActive("link"),component:Nd(()=>sc(()=>import("./InsertLink-BZESDwUA.js"),[]))},Image:{label:"Image",icon:jK,isActive:n=>!1,component:Nd(()=>sc(()=>import("./InsertImage-AeHOCj4n.js"),[]))},Video:{label:"Video",icon:UK,isActive:n=>!1,component:Nd(()=>sc(()=>import("./InsertVideo-Dt71z7Lg.js"),[]))},Undo:{label:"Undo",icon:ZK,action:n=>n.chain().focus().undo().run(),isActive:n=>!1},Redo:{label:"Redo",icon:sG,action:n=>n.chain().focus().redo().run(),isActive:n=>!1},InsertTable:{label:"Insert Table",icon:bG,action:n=>n.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),isActive:n=>!1},AddColumnBefore:{label:"Add Column Before",action:n=>n.chain().focus().addColumnBefore().run(),isActive:n=>!1,isDisabled:n=>!n.can().addColumnBefore()},AddColumnAfter:{label:"Add Column After",action:n=>n.chain().focus().addColumnAfter().run(),isActive:n=>!1,isDisabled:n=>!n.can().addColumnAfter()},DeleteColumn:{label:"Delete Column",action:n=>n.chain().focus().deleteColumn().run(),isActive:n=>!1,isDisabled:n=>!n.can().deleteColumn()},AddRowBefore:{label:"Add Row Before",action:n=>n.chain().focus().addRowBefore().run(),isActive:n=>!1,isDisabled:n=>!n.can().addRowBefore()},AddRowAfter:{label:"Add Row After",action:n=>n.chain().focus().addRowAfter().run(),isActive:n=>!1,isDisabled:n=>!n.can().addRowAfter()},DeleteRow:{label:"Delete Row",action:n=>n.chain().focus().deleteRow().run(),isActive:n=>!1,isDisabled:n=>!n.can().deleteRow()},DeleteTable:{label:"Delete Table",action:n=>n.chain().focus().deleteTable().run(),isActive:n=>!1,isDisabled:n=>!n.can().deleteTable()},MergeCells:{label:"Merge Cells",action:n=>n.chain().focus().mergeCells().run(),isActive:n=>!1,isDisabled:n=>!n.can().mergeCells()},SplitCell:{label:"Split Cell",action:n=>n.chain().focus().splitCell().run(),isActive:n=>!1,isDisabled:n=>!n.can().splitCell()},ToggleHeaderColumn:{label:"Toggle Header Column",action:n=>n.chain().focus().toggleHeaderColumn().run(),isActive:n=>!1,isDisabled:n=>!n.can().toggleHeaderColumn()},ToggleHeaderRow:{label:"Toggle Header Row",action:n=>n.chain().focus().toggleHeaderRow().run(),isActive:n=>!1,isDisabled:n=>!n.can().toggleHeaderRow()},ToggleHeaderCell:{label:"Toggle Header Cell",action:n=>n.chain().focus().toggleHeaderCell().run(),isActive:n=>!1,isDisabled:n=>!n.can().toggleHeaderCell()},Separator:{type:"separator"}};function Zp(n){return n instanceof Array?n.map(Zp):typeof n=="object"?n:wG[n]}const xG={name:"TextEditorFixedMenu",props:["buttons"],components:{Menu:UA},inject:["editor"],computed:{fixedMenuButtons(){if(!this.buttons)return!1;let n;return Array.isArray(this.buttons)?n=this.buttons:n=[["Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Paragraph","Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","FontColor","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"],n.map(Zp)}}};function SG(n,e,t,r,i,s){const o=mt("Menu");return s.fixedMenuButtons?(q(),dt(o,{key:0,buttons:s.fixedMenuButtons},null,8,["buttons"])):He("",!0)}const _G=je(xG,[["render",SG]]),CG={name:"TextEditorBubbleMenu",props:["buttons","options"],components:{BubbleMenu:LB,Menu:UA},inject:["editor"],computed:{bubbleMenuButtons(){if(!this.buttons)return!1;let n;return Array.isArray(this.buttons)?n=this.buttons:n=["Paragraph","Heading 2","Heading 3","Separator","Bold","Italic","Link","Separator","Bullet List","Numbered List","Separator","Image","Video","Blockquote","Code",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"]],n.map(Zp)}}};function kG(n,e,t,r,i,s){const o=mt("Menu"),a=mt("BubbleMenu");return s.bubbleMenuButtons?(q(),dt(a,nn({key:0,class:"bubble-menu rounded-md shadow-sm","tippy-options":{duration:100},editor:s.editor},t.options),{default:Ue(()=>[ye(o,{class:"rounded-md border border-gray-100 shadow-lg",buttons:s.bubbleMenuButtons},null,8,["buttons"])]),_:1},16,["editor"])):He("",!0)}const EG=je(CG,[["render",kG]]),TG={name:"TextEditorFloatingMenu",props:["buttons"],components:{FloatingMenu:HB},inject:["editor"],computed:{floatingMenuButtons(){if(!this.buttons)return!1;let n;return Array.isArray(this.buttons)?n=this.buttons:n=["Paragraph","Heading 2","Heading 3","Bullet List","Numbered List","Blockquote","Code","Horizontal Rule"],n.map(Zp)}}},AG=["onClick","title"],MG={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function RG(n,e,t,r,i,s){const o=mt("FloatingMenu");return s.floatingMenuButtons?(q(),dt(o,{key:0,"tippy-options":{duration:100},editor:s.editor,class:"flex"},{default:Ue(()=>[(q(!0),Q(lt,null,Si(s.floatingMenuButtons,a=>(q(),Q("button",{key:a.label,class:De(["flex rounded p-1 text-gray-800 transition-colors",a.isActive(s.editor)?"bg-gray-100":"hover:bg-gray-100"]),onClick:()=>a.action(s.editor),title:a.label},[a.icon?(q(),dt(bf(a.icon),{key:0,class:"h-4 w-4"})):(q(),Q("span",MG,Ge(a.text),1))],10,AG))),128))]),_:1},8,["editor"])):He("",!0)}const IG=je(TG,[["render",RG]]);var WA={exports:{}};(function(n){(function(){function e(h){var w={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:`Remove only spaces, ' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids`,type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `` and `` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(h===!1)return JSON.parse(JSON.stringify(w));var y={};for(var E in w)w.hasOwnProperty(E)&&(y[E]=w[E].defaultValue);return y}function t(){var h=e(!0),w={};for(var y in h)h.hasOwnProperty(y)&&(w[y]=!0);return w}var r={},i={},s={},o=e(!0),a="vanilla",l={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:e(!0),allOn:t()};r.helper={},r.extensions={},r.setOption=function(h,w){return o[h]=w,this},r.getOption=function(h){return o[h]},r.getOptions=function(){return o},r.resetOptions=function(){o=e(!0)},r.setFlavor=function(h){if(!l.hasOwnProperty(h))throw Error(h+" flavor was not found");r.resetOptions();var w=l[h];a=h;for(var y in w)w.hasOwnProperty(y)&&(o[y]=w[y])},r.getFlavor=function(){return a},r.getFlavorOptions=function(h){if(l.hasOwnProperty(h))return l[h]},r.getDefaultOptions=function(h){return e(h)},r.subParser=function(h,w){if(r.helper.isString(h))if(typeof w!="undefined")i[h]=w;else{if(i.hasOwnProperty(h))return i[h];throw Error("SubParser named "+h+" not registered!")}},r.extension=function(h,w){if(!r.helper.isString(h))throw Error("Extension 'name' must be a string");if(h=r.helper.stdExtName(h),r.helper.isUndefined(w)){if(!s.hasOwnProperty(h))throw Error("Extension named "+h+" is not registered!");return s[h]}else{typeof w=="function"&&(w=w()),r.helper.isArray(w)||(w=[w]);var y=c(w,h);if(y.valid)s[h]=w;else throw Error(y.error)}},r.getAllExtensions=function(){return s},r.removeExtension=function(h){delete s[h]},r.resetExtensions=function(){s={}};function c(h,w){var y=w?"Error in "+w+" extension->":"Error in unnamed extension",E={valid:!0,error:""};r.helper.isArray(h)||(h=[h]);for(var g=0;g<h.length;++g){var I=y+" sub-extension "+g+": ",R=h[g];if(typeof R!="object")return E.valid=!1,E.error=I+"must be an object, but "+typeof R+" given",E;if(!r.helper.isString(R.type))return E.valid=!1,E.error=I+'property "type" must be a string, but '+typeof R.type+" given",E;var S=R.type=R.type.toLowerCase();if(S==="language"&&(S=R.type="lang"),S==="html"&&(S=R.type="output"),S!=="lang"&&S!=="output"&&S!=="listener")return E.valid=!1,E.error=I+"type "+S+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',E;if(S==="listener"){if(r.helper.isUndefined(R.listeners))return E.valid=!1,E.error=I+'. Extensions of type "listener" must have a property called "listeners"',E}else if(r.helper.isUndefined(R.filter)&&r.helper.isUndefined(R.regex))return E.valid=!1,E.error=I+S+' extensions must define either a "regex" property or a "filter" method',E;if(R.listeners){if(typeof R.listeners!="object")return E.valid=!1,E.error=I+'"listeners" property must be an object but '+typeof R.listeners+" given",E;for(var k in R.listeners)if(R.listeners.hasOwnProperty(k)&&typeof R.listeners[k]!="function")return E.valid=!1,E.error=I+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+k+" must be a function but "+typeof R.listeners[k]+" given",E}if(R.filter){if(typeof R.filter!="function")return E.valid=!1,E.error=I+'"filter" must be a function, but '+typeof R.filter+" given",E}else if(R.regex){if(r.helper.isString(R.regex)&&(R.regex=new RegExp(R.regex,"g")),!(R.regex instanceof RegExp))return E.valid=!1,E.error=I+'"regex" property must either be a string or a RegExp object, but '+typeof R.regex+" given",E;if(r.helper.isUndefined(R.replace))return E.valid=!1,E.error=I+'"regex" extensions must implement a replace string or function',E}}return E}r.validateExtension=function(h){var w=c(h,null);return w.valid?!0:(console.warn(w.error),!1)},r.hasOwnProperty("helper")||(r.helper={}),r.helper.isString=function(h){return typeof h=="string"||h instanceof String},r.helper.isFunction=function(h){var w={};return h&&w.toString.call(h)==="[object Function]"},r.helper.isArray=function(h){return Array.isArray(h)},r.helper.isUndefined=function(h){return typeof h=="undefined"},r.helper.forEach=function(h,w){if(r.helper.isUndefined(h))throw new Error("obj param is required");if(r.helper.isUndefined(w))throw new Error("callback param is required");if(!r.helper.isFunction(w))throw new Error("callback param must be a function/closure");if(typeof h.forEach=="function")h.forEach(w);else if(r.helper.isArray(h))for(var y=0;y<h.length;y++)w(h[y],y,h);else if(typeof h=="object")for(var E in h)h.hasOwnProperty(E)&&w(h[E],E,h);else throw new Error("obj does not seem to be an array or an iterable object")},r.helper.stdExtName=function(h){return h.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()};function u(h,w){var y=w.charCodeAt(0);return"E"+y+"E"}r.helper.escapeCharactersCallback=u,r.helper.escapeCharacters=function(h,w,y){var E="(["+w.replace(/([\[\]\\])/g,"\\$1")+"])";y&&(E="\\\\"+E);var g=new RegExp(E,"g");return h=h.replace(g,u),h},r.helper.unescapeHTMLEntities=function(h){return h.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var d=function(h,w,y,E){var g=E||"",I=g.indexOf("g")>-1,R=new RegExp(w+"|"+y,"g"+g.replace(/g/g,"")),S=new RegExp(w,g.replace(/g/g,"")),k=[],T,C,D,A,O;do for(T=0;D=R.exec(h);)if(S.test(D[0]))T++||(C=R.lastIndex,A=C-D[0].length);else if(T&&!--T){O=D.index+D[0].length;var P={left:{start:A,end:C},match:{start:C,end:D.index},right:{start:D.index,end:O},wholeMatch:{start:A,end:O}};if(k.push(P),!I)return k}while(T&&(R.lastIndex=C));return k};r.helper.matchRecursiveRegExp=function(h,w,y,E){for(var g=d(h,w,y,E),I=[],R=0;R<g.length;++R)I.push([h.slice(g[R].wholeMatch.start,g[R].wholeMatch.end),h.slice(g[R].match.start,g[R].match.end),h.slice(g[R].left.start,g[R].left.end),h.slice(g[R].right.start,g[R].right.end)]);return I},r.helper.replaceRecursiveRegExp=function(h,w,y,E,g){if(!r.helper.isFunction(w)){var I=w;w=function(){return I}}var R=d(h,y,E,g),S=h,k=R.length;if(k>0){var T=[];R[0].wholeMatch.start!==0&&T.push(h.slice(0,R[0].wholeMatch.start));for(var C=0;C<k;++C)T.push(w(h.slice(R[C].wholeMatch.start,R[C].wholeMatch.end),h.slice(R[C].match.start,R[C].match.end),h.slice(R[C].left.start,R[C].left.end),h.slice(R[C].right.start,R[C].right.end))),C<k-1&&T.push(h.slice(R[C].wholeMatch.end,R[C+1].wholeMatch.start));R[k-1].wholeMatch.end<h.length&&T.push(h.slice(R[k-1].wholeMatch.end)),S=T.join("")}return S},r.helper.regexIndexOf=function(h,w,y){if(!r.helper.isString(h))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(!(w instanceof RegExp))throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var E=h.substring(y||0).search(w);return E>=0?E+(y||0):E},r.helper.splitAtIndex=function(h,w){if(!r.helper.isString(h))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[h.substring(0,w),h.substring(w)]},r.helper.encodeEmailAddress=function(h){var w=[function(y){return"&#"+y.charCodeAt(0)+";"},function(y){return"&#x"+y.charCodeAt(0).toString(16)+";"},function(y){return y}];return h=h.replace(/./g,function(y){if(y==="@")y=w[Math.floor(Math.random()*2)](y);else{var E=Math.random();y=E>.9?w[2](y):E>.45?w[1](y):w[0](y)}return y}),h},r.helper.padEnd=function(w,y,E){return y=y>>0,E=String(E||" "),w.length>y?String(w):(y=y-w.length,y>E.length&&(E+=E.repeat(y/E.length)),String(w)+E.slice(0,y))},typeof console=="undefined"&&(console={warn:function(h){alert(h)},log:function(h){alert(h)},error:function(h){throw h}}),r.helper.regexes={asteriskDashAndColon:/([*_:~])/g},r.helper.emojis={"+1":"","-1":"",100:"",1234:"","1st_place_medal":"","2nd_place_medal":"","3rd_place_medal":"","8ball":"",a:"",ab:"",abc:"",abcd:"",accept:"",aerial_tramway:"",airplane:"",alarm_clock:"",alembic:"",alien:"",ambulance:"",amphora:"",anchor:"",angel:"",anger:"",angry:"",anguished:"",ant:"",apple:"",aquarius:"",aries:"",arrow_backward:"",arrow_double_down:"",arrow_double_up:"",arrow_down:"",arrow_down_small:"",arrow_forward:"",arrow_heading_down:"",arrow_heading_up:"",arrow_left:"",arrow_lower_left:"",arrow_lower_right:"",arrow_right:"",arrow_right_hook:"",arrow_up:"",arrow_up_down:"",arrow_up_small:"",arrow_upper_left:"",arrow_upper_right:"",arrows_clockwise:"",arrows_counterclockwise:"",art:"",articulated_lorry:"",artificial_satellite:"",astonished:"",athletic_shoe:"",atm:"",atom_symbol:"",avocado:"",b:"",baby:"",baby_bottle:"",baby_chick:"",baby_symbol:"",back:"",bacon:"",badminton:"",baggage_claim:"",baguette_bread:"",balance_scale:"",balloon:"",ballot_box:"",ballot_box_with_check:"",bamboo:"",banana:"",bangbang:"",bank:"",bar_chart:"",barber:"",baseball:"",basketball:"",basketball_man:"",basketball_woman:"&zwj;",bat:"",bath:"",bathtub:"",battery:"",beach_umbrella:"",bear:"",bed:"",bee:"",beer:"",beers:"",beetle:"",beginner:"",bell:"",bellhop_bell:"",bento:"",biking_man:"",bike:"",biking_woman:"&zwj;",bikini:"",biohazard:"",bird:"",birthday:"",black_circle:"",black_flag:"",black_heart:"",black_joker:"",black_large_square:"",black_medium_small_square:"",black_medium_square:"",black_nib:"",black_small_square:"",black_square_button:"",blonde_man:"",blonde_woman:"&zwj;",blossom:"",blowfish:"",blue_book:"",blue_car:"",blue_heart:"",blush:"",boar:"",boat:"",bomb:"",book:"",bookmark:"",bookmark_tabs:"",books:"",boom:"",boot:"",bouquet:"",bowing_man:"",bow_and_arrow:"",bowing_woman:"&zwj;",bowling:"",boxing_glove:"",boy:"",bread:"",bride_with_veil:"",bridge_at_night:"",briefcase:"",broken_heart:"",bug:"",building_construction:"",bulb:"",bullettrain_front:"",bullettrain_side:"",burrito:"",bus:"",business_suit_levitating:"",busstop:"",bust_in_silhouette:"",busts_in_silhouette:"",butterfly:"",cactus:"",cake:"",calendar:"",call_me_hand:"",calling:"",camel:"",camera:"",camera_flash:"",camping:"",cancer:"",candle:"",candy:"",canoe:"",capital_abcd:"",capricorn:"",car:"",card_file_box:"",card_index:"",card_index_dividers:"",carousel_horse:"",carrot:"",cat:"",cat2:"",cd:"",chains:"",champagne:"",chart:"",chart_with_downwards_trend:"",chart_with_upwards_trend:"",checkered_flag:"",cheese:"",cherries:"",cherry_blossom:"",chestnut:"",chicken:"",children_crossing:"",chipmunk:"",chocolate_bar:"",christmas_tree:"",church:"",cinema:"",circus_tent:"",city_sunrise:"",city_sunset:"",cityscape:"",cl:"",clamp:"",clap:"",clapper:"",classical_building:"",clinking_glasses:"",clipboard:"",clock1:"",clock10:"",clock1030:"",clock11:"",clock1130:"",clock12:"",clock1230:"",clock130:"",clock2:"",clock230:"",clock3:"",clock330:"",clock4:"",clock430:"",clock5:"",clock530:"",clock6:"",clock630:"",clock7:"",clock730:"",clock8:"",clock830:"",clock9:"",clock930:"",closed_book:"",closed_lock_with_key:"",closed_umbrella:"",cloud:"",cloud_with_lightning:"",cloud_with_lightning_and_rain:"",cloud_with_rain:"",cloud_with_snow:"",clown_face:"",clubs:"",cocktail:"",coffee:"",coffin:"",cold_sweat:"",comet:"",computer:"",computer_mouse:"",confetti_ball:"",confounded:"",confused:"",congratulations:"",construction:"",construction_worker_man:"",construction_worker_woman:"&zwj;",control_knobs:"",convenience_store:"",cookie:"",cool:"",policeman:"",copyright:"",corn:"",couch_and_lamp:"",couple:"",couple_with_heart_woman_man:"",couple_with_heart_man_man:"&zwj;&zwj;",couple_with_heart_woman_woman:"&zwj;&zwj;",couplekiss_man_man:"&zwj;&zwj;&zwj;",couplekiss_man_woman:"",couplekiss_woman_woman:"&zwj;&zwj;&zwj;",cow:"",cow2:"",cowboy_hat_face:"",crab:"",crayon:"",credit_card:"",crescent_moon:"",cricket:"",crocodile:"",croissant:"",crossed_fingers:"",crossed_flags:"",crossed_swords:"",crown:"",cry:"",crying_cat_face:"",crystal_ball:"",cucumber:"",cupid:"",curly_loop:"",currency_exchange:"",curry:"",custard:"",customs:"",cyclone:"",dagger:"",dancer:"",dancing_women:"",dancing_men:"&zwj;",dango:"",dark_sunglasses:"",dart:"",dash:"",date:"",deciduous_tree:"",deer:"",department_store:"",derelict_house:"",desert:"",desert_island:"",desktop_computer:"",male_detective:"",diamond_shape_with_a_dot_inside:"",diamonds:"",disappointed:"",disappointed_relieved:"",dizzy:"",dizzy_face:"",do_not_litter:"",dog:"",dog2:"",dollar:"",dolls:"",dolphin:"",door:"",doughnut:"",dove:"",dragon:"",dragon_face:"",dress:"",dromedary_camel:"",drooling_face:"",droplet:"",drum:"",duck:"",dvd:"","e-mail":"",eagle:"",ear:"",ear_of_rice:"",earth_africa:"",earth_americas:"",earth_asia:"",egg:"",eggplant:"",eight_pointed_black_star:"",eight_spoked_asterisk:"",electric_plug:"",elephant:"",email:"",end:"",envelope_with_arrow:"",euro:"",european_castle:"",european_post_office:"",evergreen_tree:"",exclamation:"",expressionless:"",eye:"",eye_speech_bubble:"&zwj;",eyeglasses:"",eyes:"",face_with_head_bandage:"",face_with_thermometer:"",fist_oncoming:"",factory:"",fallen_leaf:"",family_man_woman_boy:"",family_man_boy:"&zwj;",family_man_boy_boy:"&zwj;&zwj;",family_man_girl:"&zwj;",family_man_girl_boy:"&zwj;&zwj;",family_man_girl_girl:"&zwj;&zwj;",family_man_man_boy:"&zwj;&zwj;",family_man_man_boy_boy:"&zwj;&zwj;&zwj;",family_man_man_girl:"&zwj;&zwj;",family_man_man_girl_boy:"&zwj;&zwj;&zwj;",family_man_man_girl_girl:"&zwj;&zwj;&zwj;",family_man_woman_boy_boy:"&zwj;&zwj;&zwj;",family_man_woman_girl:"&zwj;&zwj;",family_man_woman_girl_boy:"&zwj;&zwj;&zwj;",family_man_woman_girl_girl:"&zwj;&zwj;&zwj;",family_woman_boy:"&zwj;",family_woman_boy_boy:"&zwj;&zwj;",family_woman_girl:"&zwj;",family_woman_girl_boy:"&zwj;&zwj;",family_woman_girl_girl:"&zwj;&zwj;",family_woman_woman_boy:"&zwj;&zwj;",family_woman_woman_boy_boy:"&zwj;&zwj;&zwj;",family_woman_woman_girl:"&zwj;&zwj;",family_woman_woman_girl_boy:"&zwj;&zwj;&zwj;",family_woman_woman_girl_girl:"&zwj;&zwj;&zwj;",fast_forward:"",fax:"",fearful:"",feet:"",female_detective:"&zwj;",ferris_wheel:"",ferry:"",field_hockey:"",file_cabinet:"",file_folder:"",film_projector:"",film_strip:"",fire:"",fire_engine:"",fireworks:"",first_quarter_moon:"",first_quarter_moon_with_face:"",fish:"",fish_cake:"",fishing_pole_and_fish:"",fist_raised:"",fist_left:"",fist_right:"",flags:"",flashlight:"",fleur_de_lis:"",flight_arrival:"",flight_departure:"",floppy_disk:"",flower_playing_cards:"",flushed:"",fog:"",foggy:"",football:"",footprints:"",fork_and_knife:"",fountain:"",fountain_pen:"",four_leaf_clover:"",fox_face:"",framed_picture:"",free:"",fried_egg:"",fried_shrimp:"",fries:"",frog:"",frowning:"",frowning_face:"",frowning_man:"&zwj;",frowning_woman:"",middle_finger:"",fuelpump:"",full_moon:"",full_moon_with_face:"",funeral_urn:"",game_die:"",gear:"",gem:"",gemini:"",ghost:"",gift:"",gift_heart:"",girl:"",globe_with_meridians:"",goal_net:"",goat:"",golf:"",golfing_man:"",golfing_woman:"&zwj;",gorilla:"",grapes:"",green_apple:"",green_book:"",green_heart:"",green_salad:"",grey_exclamation:"",grey_question:"",grimacing:"",grin:"",grinning:"",guardsman:"",guardswoman:"&zwj;",guitar:"",gun:"",haircut_woman:"",haircut_man:"&zwj;",hamburger:"",hammer:"",hammer_and_pick:"",hammer_and_wrench:"",hamster:"",hand:"",handbag:"",handshake:"",hankey:"",hatched_chick:"",hatching_chick:"",headphones:"",hear_no_evil:"",heart:"",heart_decoration:"",heart_eyes:"",heart_eyes_cat:"",heartbeat:"",heartpulse:"",hearts:"",heavy_check_mark:"",heavy_division_sign:"",heavy_dollar_sign:"",heavy_heart_exclamation:"",heavy_minus_sign:"",heavy_multiplication_x:"",heavy_plus_sign:"",helicopter:"",herb:"",hibiscus:"",high_brightness:"",high_heel:"",hocho:"",hole:"",honey_pot:"",horse:"",horse_racing:"",hospital:"",hot_pepper:"",hotdog:"",hotel:"",hotsprings:"",hourglass:"",hourglass_flowing_sand:"",house:"",house_with_garden:"",houses:"",hugs:"",hushed:"",ice_cream:"",ice_hockey:"",ice_skate:"",icecream:"",id:"",ideograph_advantage:"",imp:"",inbox_tray:"",incoming_envelope:"",tipping_hand_woman:"",information_source:"",innocent:"",interrobang:"",iphone:"",izakaya_lantern:"",jack_o_lantern:"",japan:"",japanese_castle:"",japanese_goblin:"",japanese_ogre:"",jeans:"",joy:"",joy_cat:"",joystick:"",kaaba:"",key:"",keyboard:"",keycap_ten:"",kick_scooter:"",kimono:"",kiss:"",kissing:"",kissing_cat:"",kissing_closed_eyes:"",kissing_heart:"",kissing_smiling_eyes:"",kiwi_fruit:"",koala:"",koko:"",label:"",large_blue_circle:"",large_blue_diamond:"",large_orange_diamond:"",last_quarter_moon:"",last_quarter_moon_with_face:"",latin_cross:"",laughing:"",leaves:"",ledger:"",left_luggage:"",left_right_arrow:"",leftwards_arrow_with_hook:"",lemon:"",leo:"",leopard:"",level_slider:"",libra:"",light_rail:"",link:"",lion:"",lips:"",lipstick:"",lizard:"",lock:"",lock_with_ink_pen:"",lollipop:"",loop:"",loud_sound:"",loudspeaker:"",love_hotel:"",love_letter:"",low_brightness:"",lying_face:"",m:"",mag:"",mag_right:"",mahjong:"",mailbox:"",mailbox_closed:"",mailbox_with_mail:"",mailbox_with_no_mail:"",man:"",man_artist:"&zwj;",man_astronaut:"&zwj;",man_cartwheeling:"&zwj;",man_cook:"&zwj;",man_dancing:"",man_facepalming:"&zwj;",man_factory_worker:"&zwj;",man_farmer:"&zwj;",man_firefighter:"&zwj;",man_health_worker:"&zwj;",man_in_tuxedo:"",man_judge:"&zwj;",man_juggling:"&zwj;",man_mechanic:"&zwj;",man_office_worker:"&zwj;",man_pilot:"&zwj;",man_playing_handball:"&zwj;",man_playing_water_polo:"&zwj;",man_scientist:"&zwj;",man_shrugging:"&zwj;",man_singer:"&zwj;",man_student:"&zwj;",man_teacher:"&zwj;",man_technologist:"&zwj;",man_with_gua_pi_mao:"",man_with_turban:"",tangerine:"",mans_shoe:"",mantelpiece_clock:"",maple_leaf:"",martial_arts_uniform:"",mask:"",massage_woman:"",massage_man:"&zwj;",meat_on_bone:"",medal_military:"",medal_sports:"",mega:"",melon:"",memo:"",men_wrestling:"&zwj;",menorah:"",mens:"",metal:"",metro:"",microphone:"",microscope:"",milk_glass:"",milky_way:"",minibus:"",minidisc:"",mobile_phone_off:"",money_mouth_face:"",money_with_wings:"",moneybag:"",monkey:"",monkey_face:"",monorail:"",moon:"",mortar_board:"",mosque:"",motor_boat:"",motor_scooter:"",motorcycle:"",motorway:"",mount_fuji:"",mountain:"",mountain_biking_man:"",mountain_biking_woman:"&zwj;",mountain_cableway:"",mountain_railway:"",mountain_snow:"",mouse:"",mouse2:"",movie_camera:"",moyai:"",mrs_claus:"",muscle:"",mushroom:"",musical_keyboard:"",musical_note:"",musical_score:"",mute:"",nail_care:"",name_badge:"",national_park:"",nauseated_face:"",necktie:"",negative_squared_cross_mark:"",nerd_face:"",neutral_face:"",new:"",new_moon:"",new_moon_with_face:"",newspaper:"",newspaper_roll:"",next_track_button:"",ng:"",no_good_man:"&zwj;",no_good_woman:"",night_with_stars:"",no_bell:"",no_bicycles:"",no_entry:"",no_entry_sign:"",no_mobile_phones:"",no_mouth:"",no_pedestrians:"",no_smoking:"","non-potable_water":"",nose:"",notebook:"",notebook_with_decorative_cover:"",notes:"",nut_and_bolt:"",o:"",o2:"",ocean:"",octopus:"",oden:"",office:"",oil_drum:"",ok:"",ok_hand:"",ok_man:"&zwj;",ok_woman:"",old_key:"",older_man:"",older_woman:"",om:"",on:"",oncoming_automobile:"",oncoming_bus:"",oncoming_police_car:"",oncoming_taxi:"",open_file_folder:"",open_hands:"",open_mouth:"",open_umbrella:"",ophiuchus:"",orange_book:"",orthodox_cross:"",outbox_tray:"",owl:"",ox:"",package:"",page_facing_up:"",page_with_curl:"",pager:"",paintbrush:"",palm_tree:"",pancakes:"",panda_face:"",paperclip:"",paperclips:"",parasol_on_ground:"",parking:"",part_alternation_mark:"",partly_sunny:"",passenger_ship:"",passport_control:"",pause_button:"",peace_symbol:"",peach:"",peanuts:"",pear:"",pen:"",pencil2:"",penguin:"",pensive:"",performing_arts:"",persevere:"",person_fencing:"",pouting_woman:"",phone:"",pick:"",pig:"",pig2:"",pig_nose:"",pill:"",pineapple:"",ping_pong:"",pisces:"",pizza:"",place_of_worship:"",plate_with_cutlery:"",play_or_pause_button:"",point_down:"",point_left:"",point_right:"",point_up:"",point_up_2:"",police_car:"",policewoman:"&zwj;",poodle:"",popcorn:"",post_office:"",postal_horn:"",postbox:"",potable_water:"",potato:"",pouch:"",poultry_leg:"",pound:"",rage:"",pouting_cat:"",pouting_man:"&zwj;",pray:"",prayer_beads:"",pregnant_woman:"",previous_track_button:"",prince:"",princess:"",printer:"",purple_heart:"",purse:"",pushpin:"",put_litter_in_its_place:"",question:"",rabbit:"",rabbit2:"",racehorse:"",racing_car:"",radio:"",radio_button:"",radioactive:"",railway_car:"",railway_track:"",rainbow:"",rainbow_flag:"&zwj;",raised_back_of_hand:"",raised_hand_with_fingers_splayed:"",raised_hands:"",raising_hand_woman:"",raising_hand_man:"&zwj;",ram:"",ramen:"",rat:"",record_button:"",recycle:"",red_circle:"",registered:"",relaxed:"",relieved:"",reminder_ribbon:"",repeat:"",repeat_one:"",rescue_worker_helmet:"",restroom:"",revolving_hearts:"",rewind:"",rhinoceros:"",ribbon:"",rice:"",rice_ball:"",rice_cracker:"",rice_scene:"",right_anger_bubble:"",ring:"",robot:"",rocket:"",rofl:"",roll_eyes:"",roller_coaster:"",rooster:"",rose:"",rosette:"",rotating_light:"",round_pushpin:"",rowing_man:"",rowing_woman:"&zwj;",rugby_football:"",running_man:"",running_shirt_with_sash:"",running_woman:"&zwj;",sa:"",sagittarius:"",sake:"",sandal:"",santa:"",satellite:"",saxophone:"",school:"",school_satchel:"",scissors:"",scorpion:"",scorpius:"",scream:"",scream_cat:"",scroll:"",seat:"",secret:"",see_no_evil:"",seedling:"",selfie:"",shallow_pan_of_food:"",shamrock:"",shark:"",shaved_ice:"",sheep:"",shell:"",shield:"",shinto_shrine:"",ship:"",shirt:"",shopping:"",shopping_cart:"",shower:"",shrimp:"",signal_strength:"",six_pointed_star:"",ski:"",skier:"",skull:"",skull_and_crossbones:"",sleeping:"",sleeping_bed:"",sleepy:"",slightly_frowning_face:"",slightly_smiling_face:"",slot_machine:"",small_airplane:"",small_blue_diamond:"",small_orange_diamond:"",small_red_triangle:"",small_red_triangle_down:"",smile:"",smile_cat:"",smiley:"",smiley_cat:"",smiling_imp:"",smirk:"",smirk_cat:"",smoking:"",snail:"",snake:"",sneezing_face:"",snowboarder:"",snowflake:"",snowman:"",snowman_with_snow:"",sob:"",soccer:"",soon:"",sos:"",sound:"",space_invader:"",spades:"",spaghetti:"",sparkle:"",sparkler:"",sparkles:"",sparkling_heart:"",speak_no_evil:"",speaker:"",speaking_head:"",speech_balloon:"",speedboat:"",spider:"",spider_web:"",spiral_calendar:"",spiral_notepad:"",spoon:"",squid:"",stadium:"",star:"",star2:"",star_and_crescent:"",star_of_david:"",stars:"",station:"",statue_of_liberty:"",steam_locomotive:"",stew:"",stop_button:"",stop_sign:"",stopwatch:"",straight_ruler:"",strawberry:"",stuck_out_tongue:"",stuck_out_tongue_closed_eyes:"",stuck_out_tongue_winking_eye:"",studio_microphone:"",stuffed_flatbread:"",sun_behind_large_cloud:"",sun_behind_rain_cloud:"",sun_behind_small_cloud:"",sun_with_face:"",sunflower:"",sunglasses:"",sunny:"",sunrise:"",sunrise_over_mountains:"",surfing_man:"",surfing_woman:"&zwj;",sushi:"",suspension_railway:"",sweat:"",sweat_drops:"",sweat_smile:"",sweet_potato:"",swimming_man:"",swimming_woman:"&zwj;",symbols:"",synagogue:"",syringe:"",taco:"",tada:"",tanabata_tree:"",taurus:"",taxi:"",tea:"",telephone_receiver:"",telescope:"",tennis:"",tent:"",thermometer:"",thinking:"",thought_balloon:"",ticket:"",tickets:"",tiger:"",tiger2:"",timer_clock:"",tipping_hand_man:"&zwj;",tired_face:"",tm:"",toilet:"",tokyo_tower:"",tomato:"",tongue:"",top:"",tophat:"",tornado:"",trackball:"",tractor:"",traffic_light:"",train:"",train2:"",tram:"",triangular_flag_on_post:"",triangular_ruler:"",trident:"",triumph:"",trolleybus:"",trophy:"",tropical_drink:"",tropical_fish:"",truck:"",trumpet:"",tulip:"",tumbler_glass:"",turkey:"",turtle:"",tv:"",twisted_rightwards_arrows:"",two_hearts:"",two_men_holding_hands:"",two_women_holding_hands:"",u5272:"",u5408:"",u55b6:"",u6307:"",u6708:"",u6709:"",u6e80:"",u7121:"",u7533:"",u7981:"",u7a7a:"",umbrella:"",unamused:"",underage:"",unicorn:"",unlock:"",up:"",upside_down_face:"",v:"",vertical_traffic_light:"",vhs:"",vibration_mode:"",video_camera:"",video_game:"",violin:"",virgo:"",volcano:"",volleyball:"",vs:"",vulcan_salute:"",walking_man:"",walking_woman:"&zwj;",waning_crescent_moon:"",waning_gibbous_moon:"",warning:"",wastebasket:"",watch:"",water_buffalo:"",watermelon:"",wave:"",wavy_dash:"",waxing_crescent_moon:"",wc:"",weary:"",wedding:"",weight_lifting_man:"",weight_lifting_woman:"&zwj;",whale:"",whale2:"",wheel_of_dharma:"",wheelchair:"",white_check_mark:"",white_circle:"",white_flag:"",white_flower:"",white_large_square:"",white_medium_small_square:"",white_medium_square:"",white_small_square:"",white_square_button:"",wilted_flower:"",wind_chime:"",wind_face:"",wine_glass:"",wink:"",wolf:"",woman:"",woman_artist:"&zwj;",woman_astronaut:"&zwj;",woman_cartwheeling:"&zwj;",woman_cook:"&zwj;",woman_facepalming:"&zwj;",woman_factory_worker:"&zwj;",woman_farmer:"&zwj;",woman_firefighter:"&zwj;",woman_health_worker:"&zwj;",woman_judge:"&zwj;",woman_juggling:"&zwj;",woman_mechanic:"&zwj;",woman_office_worker:"&zwj;",woman_pilot:"&zwj;",woman_playing_handball:"&zwj;",woman_playing_water_polo:"&zwj;",woman_scientist:"&zwj;",woman_shrugging:"&zwj;",woman_singer:"&zwj;",woman_student:"&zwj;",woman_teacher:"&zwj;",woman_technologist:"&zwj;",woman_with_turban:"&zwj;",womans_clothes:"",womans_hat:"",women_wrestling:"&zwj;",womens:"",world_map:"",worried:"",wrench:"",writing_hand:"",x:"",yellow_heart:"",yen:"",yin_yang:"",yum:"",zap:"",zipper_mouth_face:"",zzz:"",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:`<span style="font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>`},r.Converter=function(h){var w={},y=[],E=[],g={},I=a,R={parsed:{},raw:"",format:""};S();function S(){h=h||{};for(var A in o)o.hasOwnProperty(A)&&(w[A]=o[A]);if(typeof h=="object")for(var O in h)h.hasOwnProperty(O)&&(w[O]=h[O]);else throw Error("Converter expects the passed parameter to be an object, but "+typeof h+" was passed instead.");w.extensions&&r.helper.forEach(w.extensions,k)}function k(A,O){if(O=O||null,r.helper.isString(A))if(A=r.helper.stdExtName(A),O=A,r.extensions[A]){console.warn("DEPRECATION WARNING: "+A+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),T(r.extensions[A],A);return}else if(!r.helper.isUndefined(s[A]))A=s[A];else throw Error('Extension "'+A+'" could not be loaded. It was either not found or is not a valid extension.');typeof A=="function"&&(A=A()),r.helper.isArray(A)||(A=[A]);var P=c(A,O);if(!P.valid)throw Error(P.error);for(var N=0;N<A.length;++N){switch(A[N].type){case"lang":y.push(A[N]);break;case"output":E.push(A[N]);break}if(A[N].hasOwnProperty("listeners"))for(var F in A[N].listeners)A[N].listeners.hasOwnProperty(F)&&C(F,A[N].listeners[F])}}function T(A,O){typeof A=="function"&&(A=A(new r.Converter)),r.helper.isArray(A)||(A=[A]);var P=c(A,O);if(!P.valid)throw Error(P.error);for(var N=0;N<A.length;++N)switch(A[N].type){case"lang":y.push(A[N]);break;case"output":E.push(A[N]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function C(A,O){if(!r.helper.isString(A))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof A+" given");if(typeof O!="function")throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof O+" given");g.hasOwnProperty(A)||(g[A]=[]),g[A].push(O)}function D(A){var O=A.match(/^\s*/)[0].length,P=new RegExp("^\\s{0,"+O+"}","gm");return A.replace(P,"")}this._dispatch=function(O,P,N,F){if(g.hasOwnProperty(O))for(var j=0;j<g[O].length;++j){var J=g[O][j](O,P,this,N,F);J&&typeof J!="undefined"&&(P=J)}return P},this.listen=function(A,O){return C(A,O),this},this.makeHtml=function(A){if(!A)return A;var O={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:y,outputModifiers:E,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return A=A.replace(//g,"T"),A=A.replace(/\$/g,"D"),A=A.replace(/\r\n/g,`
`),A=A.replace(/\r/g,`
`),A=A.replace(/\u00A0/g,"&nbsp;"),w.smartIndentationFix&&(A=D(A)),A=`

`+A+`

`,A=r.subParser("detab")(A,w,O),A=A.replace(/^[ \t]+$/mg,""),r.helper.forEach(y,function(P){A=r.subParser("runExtension")(P,A,w,O)}),A=r.subParser("metadata")(A,w,O),A=r.subParser("hashPreCodeTags")(A,w,O),A=r.subParser("githubCodeBlocks")(A,w,O),A=r.subParser("hashHTMLBlocks")(A,w,O),A=r.subParser("hashCodeTags")(A,w,O),A=r.subParser("stripLinkDefinitions")(A,w,O),A=r.subParser("blockGamut")(A,w,O),A=r.subParser("unhashHTMLSpans")(A,w,O),A=r.subParser("unescapeSpecialChars")(A,w,O),A=A.replace(/D/g,"$$"),A=A.replace(/T/g,""),A=r.subParser("completeHTMLDocument")(A,w,O),r.helper.forEach(E,function(P){A=r.subParser("runExtension")(P,A,w,O)}),R=O.metadata,A},this.makeMarkdown=this.makeMd=function(A,O){if(A=A.replace(/\r\n/g,`
`),A=A.replace(/\r/g,`
`),A=A.replace(/>[ \t]+</,">NBSP;<"),!O)if(window&&window.document)O=window.document;else throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");var P=O.createElement("div");P.innerHTML=A;var N={preList:oe(P)};ie(P);for(var F=P.childNodes,j="",J=0;J<F.length;J++)j+=r.subParser("makeMarkdown.node")(F[J],N);function ie(he){for(var ae=0;ae<he.childNodes.length;++ae){var B=he.childNodes[ae];B.nodeType===3?!/\S/.test(B.nodeValue)&&!/^[ ]+$/.test(B.nodeValue)?(he.removeChild(B),--ae):(B.nodeValue=B.nodeValue.split(`
`).join(" "),B.nodeValue=B.nodeValue.replace(/(\s)+/g,"$1")):B.nodeType===1&&ie(B)}}function oe(he){for(var ae=he.querySelectorAll("pre"),B=[],ee=0;ee<ae.length;++ee)if(ae[ee].childElementCount===1&&ae[ee].firstChild.tagName.toLowerCase()==="code"){var le=ae[ee].firstChild.innerHTML.trim(),me=ae[ee].firstChild.getAttribute("data-language")||"";if(me==="")for(var $e=ae[ee].firstChild.className.split(" "),Ke=0;Ke<$e.length;++Ke){var $=$e[Ke].match(/^language-(.+)$/);if($!==null){me=$[1];break}}le=r.helper.unescapeHTMLEntities(le),B.push(le),ae[ee].outerHTML='<precode language="'+me+'" precodenum="'+ee.toString()+'"></precode>'}else B.push(ae[ee].innerHTML),ae[ee].innerHTML="",ae[ee].setAttribute("prenum",ee.toString());return B}return j},this.setOption=function(A,O){w[A]=O},this.getOption=function(A){return w[A]},this.getOptions=function(){return w},this.addExtension=function(A,O){O=O||null,k(A,O)},this.useExtension=function(A){k(A)},this.setFlavor=function(A){if(!l.hasOwnProperty(A))throw Error(A+" flavor was not found");var O=l[A];I=A;for(var P in O)O.hasOwnProperty(P)&&(w[P]=O[P])},this.getFlavor=function(){return I},this.removeExtension=function(A){r.helper.isArray(A)||(A=[A]);for(var O=0;O<A.length;++O){for(var P=A[O],N=0;N<y.length;++N)y[N]===P&&y.splice(N,1);for(var F=0;F<E.length;++F)E[F]===P&&E.splice(F,1)}},this.getAllExtensions=function(){return{language:y,output:E}},this.getMetadata=function(A){return A?R.raw:R.parsed},this.getMetadataFormat=function(){return R.format},this._setMetadataPair=function(A,O){R.parsed[A]=O},this._setMetadataFormat=function(A){R.format=A},this._setMetadataRaw=function(A){R.raw=A}},r.subParser("anchors",function(h,w,y){h=y.converter._dispatch("anchors.before",h,w,y);var E=function(g,I,R,S,k,T,C){if(r.helper.isUndefined(C)&&(C=""),R=R.toLowerCase(),g.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)S="";else if(!S)if(R||(R=I.toLowerCase().replace(/ ?\n/g," ")),S="#"+R,!r.helper.isUndefined(y.gUrls[R]))S=y.gUrls[R],r.helper.isUndefined(y.gTitles[R])||(C=y.gTitles[R]);else return g;S=S.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback);var D='<a href="'+S+'"';return C!==""&&C!==null&&(C=C.replace(/"/g,"&quot;"),C=C.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback),D+=' title="'+C+'"'),w.openLinksInNewWindow&&!/^#/.test(S)&&(D+=' rel="noopener noreferrer" target="E95Eblank"'),D+=">"+I+"</a>",D};return h=h.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,E),h=h.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,E),h=h.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,E),h=h.replace(/\[([^\[\]]+)]()()()()()/g,E),w.ghMentions&&(h=h.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi,function(g,I,R,S,k){if(R==="\\")return I+S;if(!r.helper.isString(w.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var T=w.ghMentionsLink.replace(/\{u}/g,k),C="";return w.openLinksInNewWindow&&(C=' rel="noopener noreferrer" target="E95Eblank"'),I+'<a href="'+T+'"'+C+">"+S+"</a>"})),h=y.converter._dispatch("anchors.after",h,w,y),h});var f=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,p=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,m=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,v=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,x=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,b=function(h){return function(w,y,E,g,I,R,S){E=E.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback);var k=E,T="",C="",D=y||"",A=S||"";return/^www\./i.test(E)&&(E=E.replace(/^www\./i,"http://www.")),h.excludeTrailingPunctuationFromURLs&&R&&(T=R),h.openLinksInNewWindow&&(C=' rel="noopener noreferrer" target="E95Eblank"'),D+'<a href="'+E+'"'+C+">"+k+"</a>"+T+A}},_=function(h,w){return function(y,E,g){var I="mailto:";return E=E||"",g=r.subParser("unescapeSpecialChars")(g,h,w),h.encodeEmails?(I=r.helper.encodeEmailAddress(I+g),g=r.helper.encodeEmailAddress(g)):I=I+g,E+'<a href="'+I+'">'+g+"</a>"}};r.subParser("autoLinks",function(h,w,y){return h=y.converter._dispatch("autoLinks.before",h,w,y),h=h.replace(m,b(w)),h=h.replace(x,_(w,y)),h=y.converter._dispatch("autoLinks.after",h,w,y),h}),r.subParser("simplifiedAutoLinks",function(h,w,y){return w.simplifiedAutoLink&&(h=y.converter._dispatch("simplifiedAutoLinks.before",h,w,y),w.excludeTrailingPunctuationFromURLs?h=h.replace(p,b(w)):h=h.replace(f,b(w)),h=h.replace(v,_(w,y)),h=y.converter._dispatch("simplifiedAutoLinks.after",h,w,y)),h}),r.subParser("blockGamut",function(h,w,y){return h=y.converter._dispatch("blockGamut.before",h,w,y),h=r.subParser("blockQuotes")(h,w,y),h=r.subParser("headers")(h,w,y),h=r.subParser("horizontalRule")(h,w,y),h=r.subParser("lists")(h,w,y),h=r.subParser("codeBlocks")(h,w,y),h=r.subParser("tables")(h,w,y),h=r.subParser("hashHTMLBlocks")(h,w,y),h=r.subParser("paragraphs")(h,w,y),h=y.converter._dispatch("blockGamut.after",h,w,y),h}),r.subParser("blockQuotes",function(h,w,y){h=y.converter._dispatch("blockQuotes.before",h,w,y),h=h+`

`;var E=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return w.splitAdjacentBlockquotes&&(E=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),h=h.replace(E,function(g){return g=g.replace(/^[ \t]*>[ \t]?/gm,""),g=g.replace(/0/g,""),g=g.replace(/^[ \t]+$/gm,""),g=r.subParser("githubCodeBlocks")(g,w,y),g=r.subParser("blockGamut")(g,w,y),g=g.replace(/(^|\n)/g,"$1  "),g=g.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(I,R){var S=R;return S=S.replace(/^  /mg,"0"),S=S.replace(/0/g,""),S}),r.subParser("hashBlock")(`<blockquote>
`+g+`
</blockquote>`,w,y)}),h=y.converter._dispatch("blockQuotes.after",h,w,y),h}),r.subParser("codeBlocks",function(h,w,y){h=y.converter._dispatch("codeBlocks.before",h,w,y),h+="0";var E=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=0))/g;return h=h.replace(E,function(g,I,R){var S=I,k=R,T=`
`;return S=r.subParser("outdent")(S,w,y),S=r.subParser("encodeCode")(S,w,y),S=r.subParser("detab")(S,w,y),S=S.replace(/^\n+/g,""),S=S.replace(/\n+$/g,""),w.omitExtraWLInCodeBlocks&&(T=""),S="<pre><code>"+S+T+"</code></pre>",r.subParser("hashBlock")(S,w,y)+k}),h=h.replace(/0/,""),h=y.converter._dispatch("codeBlocks.after",h,w,y),h}),r.subParser("codeSpans",function(h,w,y){return h=y.converter._dispatch("codeSpans.before",h,w,y),typeof h=="undefined"&&(h=""),h=h.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(E,g,I,R){var S=R;return S=S.replace(/^([ \t]*)/g,""),S=S.replace(/[ \t]*$/g,""),S=r.subParser("encodeCode")(S,w,y),S=g+"<code>"+S+"</code>",S=r.subParser("hashHTMLSpans")(S,w,y),S}),h=y.converter._dispatch("codeSpans.after",h,w,y),h}),r.subParser("completeHTMLDocument",function(h,w,y){if(!w.completeHTMLDocument)return h;h=y.converter._dispatch("completeHTMLDocument.before",h,w,y);var E="html",g=`<!DOCTYPE HTML>
`,I="",R=`<meta charset="utf-8">
`,S="",k="";typeof y.metadata.parsed.doctype!="undefined"&&(g="<!DOCTYPE "+y.metadata.parsed.doctype+`>
`,E=y.metadata.parsed.doctype.toString().toLowerCase(),(E==="html"||E==="html5")&&(R='<meta charset="utf-8">'));for(var T in y.metadata.parsed)if(y.metadata.parsed.hasOwnProperty(T))switch(T.toLowerCase()){case"doctype":break;case"title":I="<title>"+y.metadata.parsed.title+`</title>
`;break;case"charset":E==="html"||E==="html5"?R='<meta charset="'+y.metadata.parsed.charset+`">
`:R='<meta name="charset" content="'+y.metadata.parsed.charset+`">
`;break;case"language":case"lang":S=' lang="'+y.metadata.parsed[T]+'"',k+='<meta name="'+T+'" content="'+y.metadata.parsed[T]+`">
`;break;default:k+='<meta name="'+T+'" content="'+y.metadata.parsed[T]+`">
`}return h=g+"<html"+S+`>
<head>
`+I+R+k+`</head>
<body>
`+h.trim()+`
</body>
</html>`,h=y.converter._dispatch("completeHTMLDocument.after",h,w,y),h}),r.subParser("detab",function(h,w,y){return h=y.converter._dispatch("detab.before",h,w,y),h=h.replace(/\t(?=\t)/g,"    "),h=h.replace(/\t/g,"AB"),h=h.replace(/B(.+?)A/g,function(E,g){for(var I=g,R=4-I.length%4,S=0;S<R;S++)I+=" ";return I}),h=h.replace(/A/g,"    "),h=h.replace(/B/g,""),h=y.converter._dispatch("detab.after",h,w,y),h}),r.subParser("ellipsis",function(h,w,y){return w.ellipsis&&(h=y.converter._dispatch("ellipsis.before",h,w,y),h=h.replace(/\.\.\./g,""),h=y.converter._dispatch("ellipsis.after",h,w,y)),h}),r.subParser("emoji",function(h,w,y){if(!w.emoji)return h;h=y.converter._dispatch("emoji.before",h,w,y);var E=/:([\S]+?):/g;return h=h.replace(E,function(g,I){return r.helper.emojis.hasOwnProperty(I)?r.helper.emojis[I]:g}),h=y.converter._dispatch("emoji.after",h,w,y),h}),r.subParser("encodeAmpsAndAngles",function(h,w,y){return h=y.converter._dispatch("encodeAmpsAndAngles.before",h,w,y),h=h.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),h=h.replace(/<(?![a-z\/?$!])/gi,"&lt;"),h=h.replace(/</g,"&lt;"),h=h.replace(/>/g,"&gt;"),h=y.converter._dispatch("encodeAmpsAndAngles.after",h,w,y),h}),r.subParser("encodeBackslashEscapes",function(h,w,y){return h=y.converter._dispatch("encodeBackslashEscapes.before",h,w,y),h=h.replace(/\\(\\)/g,r.helper.escapeCharactersCallback),h=h.replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,r.helper.escapeCharactersCallback),h=y.converter._dispatch("encodeBackslashEscapes.after",h,w,y),h}),r.subParser("encodeCode",function(h,w,y){return h=y.converter._dispatch("encodeCode.before",h,w,y),h=h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,r.helper.escapeCharactersCallback),h=y.converter._dispatch("encodeCode.after",h,w,y),h}),r.subParser("escapeSpecialCharsWithinTagAttributes",function(h,w,y){h=y.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",h,w,y);var E=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,g=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return h=h.replace(E,function(I){return I.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,r.helper.escapeCharactersCallback)}),h=h.replace(g,function(I){return I.replace(/([\\`*_~=|])/g,r.helper.escapeCharactersCallback)}),h=y.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",h,w,y),h}),r.subParser("githubCodeBlocks",function(h,w,y){return w.ghCodeBlocks?(h=y.converter._dispatch("githubCodeBlocks.before",h,w,y),h+="0",h=h.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(E,g,I,R){var S=w.omitExtraWLInCodeBlocks?"":`
`;return R=r.subParser("encodeCode")(R,w,y),R=r.subParser("detab")(R,w,y),R=R.replace(/^\n+/g,""),R=R.replace(/\n+$/g,""),R="<pre><code"+(I?' class="'+I+" language-"+I+'"':"")+">"+R+S+"</code></pre>",R=r.subParser("hashBlock")(R,w,y),`

G`+(y.ghCodeBlocks.push({text:E,codeblock:R})-1)+`G

`}),h=h.replace(/0/,""),y.converter._dispatch("githubCodeBlocks.after",h,w,y)):h}),r.subParser("hashBlock",function(h,w,y){return h=y.converter._dispatch("hashBlock.before",h,w,y),h=h.replace(/(^\n+|\n+$)/g,""),h=`

K`+(y.gHtmlBlocks.push(h)-1)+`K

`,h=y.converter._dispatch("hashBlock.after",h,w,y),h}),r.subParser("hashCodeTags",function(h,w,y){h=y.converter._dispatch("hashCodeTags.before",h,w,y);var E=function(g,I,R,S){var k=R+r.subParser("encodeCode")(I,w,y)+S;return"C"+(y.gHtmlSpans.push(k)-1)+"C"};return h=r.helper.replaceRecursiveRegExp(h,E,"<code\\b[^>]*>","</code>","gim"),h=y.converter._dispatch("hashCodeTags.after",h,w,y),h}),r.subParser("hashElement",function(h,w,y){return function(E,g){var I=g;return I=I.replace(/\n\n/g,`
`),I=I.replace(/^\n/,""),I=I.replace(/\n+$/g,""),I=`

K`+(y.gHtmlBlocks.push(I)-1)+`K

`,I}}),r.subParser("hashHTMLBlocks",function(h,w,y){h=y.converter._dispatch("hashHTMLBlocks.before",h,w,y);var E=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],g=function(A,O,P,N){var F=A;return P.search(/\bmarkdown\b/)!==-1&&(F=P+y.converter.makeHtml(O)+N),`

K`+(y.gHtmlBlocks.push(F)-1)+`K

`};w.backslashEscapesHTMLTags&&(h=h.replace(/\\<(\/?[^>]+?)>/g,function(A,O){return"&lt;"+O+"&gt;"}));for(var I=0;I<E.length;++I)for(var R,S=new RegExp("^ {0,3}(<"+E[I]+"\\b[^>]*>)","im"),k="<"+E[I]+"\\b[^>]*>",T="</"+E[I]+">";(R=r.helper.regexIndexOf(h,S))!==-1;){var C=r.helper.splitAtIndex(h,R),D=r.helper.replaceRecursiveRegExp(C[1],g,k,T,"im");if(D===C[1])break;h=C[0].concat(D)}return h=h.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,r.subParser("hashElement")(h,w,y)),h=r.helper.replaceRecursiveRegExp(h,function(A){return`

K`+(y.gHtmlBlocks.push(A)-1)+`K

`},"^ {0,3}<!--","-->","gm"),h=h.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,r.subParser("hashElement")(h,w,y)),h=y.converter._dispatch("hashHTMLBlocks.after",h,w,y),h}),r.subParser("hashHTMLSpans",function(h,w,y){h=y.converter._dispatch("hashHTMLSpans.before",h,w,y);function E(g){return"C"+(y.gHtmlSpans.push(g)-1)+"C"}return h=h.replace(/<[^>]+?\/>/gi,function(g){return E(g)}),h=h.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(g){return E(g)}),h=h.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(g){return E(g)}),h=h.replace(/<[^>]+?>/gi,function(g){return E(g)}),h=y.converter._dispatch("hashHTMLSpans.after",h,w,y),h}),r.subParser("unhashHTMLSpans",function(h,w,y){h=y.converter._dispatch("unhashHTMLSpans.before",h,w,y);for(var E=0;E<y.gHtmlSpans.length;++E){for(var g=y.gHtmlSpans[E],I=0;/C(\d+)C/.test(g);){var R=RegExp.$1;if(g=g.replace("C"+R+"C",y.gHtmlSpans[R]),I===10){console.error("maximum nesting of 10 spans reached!!!");break}++I}h=h.replace("C"+E+"C",g)}return h=y.converter._dispatch("unhashHTMLSpans.after",h,w,y),h}),r.subParser("hashPreCodeTags",function(h,w,y){h=y.converter._dispatch("hashPreCodeTags.before",h,w,y);var E=function(g,I,R,S){var k=R+r.subParser("encodeCode")(I,w,y)+S;return`

G`+(y.ghCodeBlocks.push({text:g,codeblock:k})-1)+`G

`};return h=r.helper.replaceRecursiveRegExp(h,E,"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),h=y.converter._dispatch("hashPreCodeTags.after",h,w,y),h}),r.subParser("headers",function(h,w,y){h=y.converter._dispatch("headers.before",h,w,y);var E=isNaN(parseInt(w.headerLevelStart))?1:parseInt(w.headerLevelStart),g=w.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,I=w.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;h=h.replace(g,function(k,T){var C=r.subParser("spanGamut")(T,w,y),D=w.noHeaderId?"":' id="'+S(T)+'"',A=E,O="<h"+A+D+">"+C+"</h"+A+">";return r.subParser("hashBlock")(O,w,y)}),h=h.replace(I,function(k,T){var C=r.subParser("spanGamut")(T,w,y),D=w.noHeaderId?"":' id="'+S(T)+'"',A=E+1,O="<h"+A+D+">"+C+"</h"+A+">";return r.subParser("hashBlock")(O,w,y)});var R=w.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;h=h.replace(R,function(k,T,C){var D=C;w.customizedHeaderId&&(D=C.replace(/\s?\{([^{]+?)}\s*$/,""));var A=r.subParser("spanGamut")(D,w,y),O=w.noHeaderId?"":' id="'+S(C)+'"',P=E-1+T.length,N="<h"+P+O+">"+A+"</h"+P+">";return r.subParser("hashBlock")(N,w,y)});function S(k){var T,C;if(w.customizedHeaderId){var D=k.match(/\{([^{]+?)}\s*$/);D&&D[1]&&(k=D[1])}return T=k,r.helper.isString(w.prefixHeaderId)?C=w.prefixHeaderId:w.prefixHeaderId===!0?C="section-":C="",w.rawPrefixHeaderId||(T=C+T),w.ghCompatibleHeaderId?T=T.replace(/ /g,"-").replace(/&amp;/g,"").replace(/T/g,"").replace(/D/g,"").replace(/[&+$,\/:;=?@"#{}|^~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():w.rawHeaderId?T=T.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/T/g,"").replace(/D/g,"$").replace(/["']/g,"-").toLowerCase():T=T.replace(/[^\w]/g,"").toLowerCase(),w.rawPrefixHeaderId&&(T=C+T),y.hashLinkCounts[T]?T=T+"-"+y.hashLinkCounts[T]++:y.hashLinkCounts[T]=1,T}return h=y.converter._dispatch("headers.after",h,w,y),h}),r.subParser("horizontalRule",function(h,w,y){h=y.converter._dispatch("horizontalRule.before",h,w,y);var E=r.subParser("hashBlock")("<hr />",w,y);return h=h.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,E),h=h.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,E),h=h.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,E),h=y.converter._dispatch("horizontalRule.after",h,w,y),h}),r.subParser("images",function(h,w,y){h=y.converter._dispatch("images.before",h,w,y);var E=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,g=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,I=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,R=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,S=/!\[([^\[\]]+)]()()()()()/g;function k(C,D,A,O,P,N,F,j){return O=O.replace(/\s/g,""),T(C,D,A,O,P,N,F,j)}function T(C,D,A,O,P,N,F,j){var J=y.gUrls,ie=y.gTitles,oe=y.gDimensions;if(A=A.toLowerCase(),j||(j=""),C.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)O="";else if(O===""||O===null)if((A===""||A===null)&&(A=D.toLowerCase().replace(/ ?\n/g," ")),O="#"+A,!r.helper.isUndefined(J[A]))O=J[A],r.helper.isUndefined(ie[A])||(j=ie[A]),r.helper.isUndefined(oe[A])||(P=oe[A].width,N=oe[A].height);else return C;D=D.replace(/"/g,"&quot;").replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback),O=O.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback);var he='<img src="'+O+'" alt="'+D+'"';return j&&r.helper.isString(j)&&(j=j.replace(/"/g,"&quot;").replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback),he+=' title="'+j+'"'),P&&N&&(P=P==="*"?"auto":P,N=N==="*"?"auto":N,he+=' width="'+P+'"',he+=' height="'+N+'"'),he+=" />",he}return h=h.replace(R,T),h=h.replace(I,k),h=h.replace(g,T),h=h.replace(E,T),h=h.replace(S,T),h=y.converter._dispatch("images.after",h,w,y),h}),r.subParser("italicsAndBold",function(h,w,y){h=y.converter._dispatch("italicsAndBold.before",h,w,y);function E(g,I,R){return I+g+R}return w.literalMidWordUnderscores?(h=h.replace(/\b___(\S[\s\S]*?)___\b/g,function(g,I){return E(I,"<strong><em>","</em></strong>")}),h=h.replace(/\b__(\S[\s\S]*?)__\b/g,function(g,I){return E(I,"<strong>","</strong>")}),h=h.replace(/\b_(\S[\s\S]*?)_\b/g,function(g,I){return E(I,"<em>","</em>")})):(h=h.replace(/___(\S[\s\S]*?)___/g,function(g,I){return/\S$/.test(I)?E(I,"<strong><em>","</em></strong>"):g}),h=h.replace(/__(\S[\s\S]*?)__/g,function(g,I){return/\S$/.test(I)?E(I,"<strong>","</strong>"):g}),h=h.replace(/_([^\s_][\s\S]*?)_/g,function(g,I){return/\S$/.test(I)?E(I,"<em>","</em>"):g})),w.literalMidWordAsterisks?(h=h.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(g,I,R){return E(R,I+"<strong><em>","</em></strong>")}),h=h.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(g,I,R){return E(R,I+"<strong>","</strong>")}),h=h.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(g,I,R){return E(R,I+"<em>","</em>")})):(h=h.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(g,I){return/\S$/.test(I)?E(I,"<strong><em>","</em></strong>"):g}),h=h.replace(/\*\*(\S[\s\S]*?)\*\*/g,function(g,I){return/\S$/.test(I)?E(I,"<strong>","</strong>"):g}),h=h.replace(/\*([^\s*][\s\S]*?)\*/g,function(g,I){return/\S$/.test(I)?E(I,"<em>","</em>"):g})),h=y.converter._dispatch("italicsAndBold.after",h,w,y),h}),r.subParser("lists",function(h,w,y){function E(R,S){y.gListLevel++,R=R.replace(/\n{2,}$/,`
`),R+="0";var k=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,T=/\n[ \t]*\n(?!0)/.test(R);return w.disableForced4SpacesIndentedSublists&&(k=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0|\2([*+-]|\d+[.])[ \t]+))/gm),R=R.replace(k,function(C,D,A,O,P,N,F){F=F&&F.trim()!=="";var j=r.subParser("outdent")(P,w,y),J="";return N&&w.tasklists&&(J=' class="task-list-item" style="list-style-type: none;"',j=j.replace(/^[ \t]*\[(x|X| )?]/m,function(){var ie='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return F&&(ie+=" checked"),ie+=">",ie})),j=j.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(ie){return"A"+ie}),D||j.search(/\n{2,}/)>-1?(j=r.subParser("githubCodeBlocks")(j,w,y),j=r.subParser("blockGamut")(j,w,y)):(j=r.subParser("lists")(j,w,y),j=j.replace(/\n$/,""),j=r.subParser("hashHTMLBlocks")(j,w,y),j=j.replace(/\n\n+/g,`

`),T?j=r.subParser("paragraphs")(j,w,y):j=r.subParser("spanGamut")(j,w,y)),j=j.replace("A",""),j="<li"+J+">"+j+`</li>
`,j}),R=R.replace(/0/g,""),y.gListLevel--,S&&(R=R.replace(/\s+$/,"")),R}function g(R,S){if(S==="ol"){var k=R.match(/^ *(\d+)\./);if(k&&k[1]!=="1")return' start="'+k[1]+'"'}return""}function I(R,S,k){var T=w.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,C=w.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,D=S==="ul"?T:C,A="";if(R.search(D)!==-1)(function P(N){var F=N.search(D),j=g(R,S);F!==-1?(A+=`

<`+S+j+`>
`+E(N.slice(0,F),!!k)+"</"+S+`>
`,S=S==="ul"?"ol":"ul",D=S==="ul"?T:C,P(N.slice(F))):A+=`

<`+S+j+`>
`+E(N,!!k)+"</"+S+`>
`})(R);else{var O=g(R,S);A=`

<`+S+O+`>
`+E(R,!!k)+"</"+S+`>
`}return A}return h=y.converter._dispatch("lists.before",h,w,y),h+="0",y.gListLevel?h=h.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(R,S,k){var T=k.search(/[*+-]/g)>-1?"ul":"ol";return I(S,T,!0)}):h=h.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(R,S,k,T){var C=T.search(/[*+-]/g)>-1?"ul":"ol";return I(k,C,!1)}),h=h.replace(/0/,""),h=y.converter._dispatch("lists.after",h,w,y),h}),r.subParser("metadata",function(h,w,y){if(!w.metadata)return h;h=y.converter._dispatch("metadata.before",h,w,y);function E(g){y.metadata.raw=g,g=g.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),g=g.replace(/\n {4}/g," "),g.replace(/^([\S ]+): +([\s\S]+?)$/gm,function(I,R,S){return y.metadata.parsed[R]=S,""})}return h=h.replace(/^\s*+(\S*?)\n([\s\S]+?)\n+\n/,function(g,I,R){return E(R),"M"}),h=h.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(g,I,R){return I&&(y.metadata.format=I),E(R),"M"}),h=h.replace(/M/g,""),h=y.converter._dispatch("metadata.after",h,w,y),h}),r.subParser("outdent",function(h,w,y){return h=y.converter._dispatch("outdent.before",h,w,y),h=h.replace(/^(\t|[ ]{1,4})/gm,"0"),h=h.replace(/0/g,""),h=y.converter._dispatch("outdent.after",h,w,y),h}),r.subParser("paragraphs",function(h,w,y){h=y.converter._dispatch("paragraphs.before",h,w,y),h=h.replace(/^\n+/g,""),h=h.replace(/\n+$/g,"");for(var E=h.split(/\n{2,}/g),g=[],I=E.length,R=0;R<I;R++){var S=E[R];S.search(/(K|G)(\d+)\1/g)>=0?g.push(S):S.search(/\S/)>=0&&(S=r.subParser("spanGamut")(S,w,y),S=S.replace(/^([ \t]*)/g,"<p>"),S+="</p>",g.push(S))}for(I=g.length,R=0;R<I;R++){for(var k="",T=g[R],C=!1;/(K|G)(\d+)\1/.test(T);){var D=RegExp.$1,A=RegExp.$2;D==="K"?k=y.gHtmlBlocks[A]:C?k=r.subParser("encodeCode")(y.ghCodeBlocks[A].text,w,y):k=y.ghCodeBlocks[A].codeblock,k=k.replace(/\$/g,"$$$$"),T=T.replace(/(\n\n)?(K|G)\d+\2(\n\n)?/,k),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(T)&&(C=!0)}g[R]=T}return h=g.join(`
`),h=h.replace(/^\n+/g,""),h=h.replace(/\n+$/g,""),y.converter._dispatch("paragraphs.after",h,w,y)}),r.subParser("runExtension",function(h,w,y,E){if(h.filter)w=h.filter(w,E.converter,y);else if(h.regex){var g=h.regex;g instanceof RegExp||(g=new RegExp(g,"g")),w=w.replace(g,h.replace)}return w}),r.subParser("spanGamut",function(h,w,y){return h=y.converter._dispatch("spanGamut.before",h,w,y),h=r.subParser("codeSpans")(h,w,y),h=r.subParser("escapeSpecialCharsWithinTagAttributes")(h,w,y),h=r.subParser("encodeBackslashEscapes")(h,w,y),h=r.subParser("images")(h,w,y),h=r.subParser("anchors")(h,w,y),h=r.subParser("autoLinks")(h,w,y),h=r.subParser("simplifiedAutoLinks")(h,w,y),h=r.subParser("emoji")(h,w,y),h=r.subParser("underline")(h,w,y),h=r.subParser("italicsAndBold")(h,w,y),h=r.subParser("strikethrough")(h,w,y),h=r.subParser("ellipsis")(h,w,y),h=r.subParser("hashHTMLSpans")(h,w,y),h=r.subParser("encodeAmpsAndAngles")(h,w,y),w.simpleLineBreaks?/\n\nK/.test(h)||(h=h.replace(/\n+/g,`<br />
`)):h=h.replace(/  +\n/g,`<br />
`),h=y.converter._dispatch("spanGamut.after",h,w,y),h}),r.subParser("strikethrough",function(h,w,y){function E(g){return w.simplifiedAutoLink&&(g=r.subParser("simplifiedAutoLinks")(g,w,y)),"<del>"+g+"</del>"}return w.strikethrough&&(h=y.converter._dispatch("strikethrough.before",h,w,y),h=h.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(g,I){return E(I)}),h=y.converter._dispatch("strikethrough.after",h,w,y)),h}),r.subParser("stripLinkDefinitions",function(h,w,y){var E=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=0))/gm,g=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=0)|(?=\n\[))/gm;h+="0";var I=function(R,S,k,T,C,D,A){return S=S.toLowerCase(),h.toLowerCase().split(S).length-1<2?R:(k.match(/^data:.+?\/.+?;base64,/)?y.gUrls[S]=k.replace(/\s/g,""):y.gUrls[S]=r.subParser("encodeAmpsAndAngles")(k,w,y),D?D+A:(A&&(y.gTitles[S]=A.replace(/"|'/g,"&quot;")),w.parseImgDimensions&&T&&C&&(y.gDimensions[S]={width:T,height:C}),""))};return h=h.replace(g,I),h=h.replace(E,I),h=h.replace(/0/,""),h}),r.subParser("tables",function(h,w,y){if(!w.tables)return h;var E=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|0)/gm,g=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|0)/gm;function I(C){return/^:[ \t]*--*$/.test(C)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(C)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(C)?' style="text-align:center;"':""}function R(C,D){var A="";return C=C.trim(),(w.tablesHeaderId||w.tableHeaderId)&&(A=' id="'+C.replace(/ /g,"_").toLowerCase()+'"'),C=r.subParser("spanGamut")(C,w,y),"<th"+A+D+">"+C+`</th>
`}function S(C,D){var A=r.subParser("spanGamut")(C,w,y);return"<td"+D+">"+A+`</td>
`}function k(C,D){for(var A=`<table>
<thead>
<tr>
`,O=C.length,P=0;P<O;++P)A+=C[P];for(A+=`</tr>
</thead>
<tbody>
`,P=0;P<D.length;++P){A+=`<tr>
`;for(var N=0;N<O;++N)A+=D[P][N];A+=`</tr>
`}return A+=`</tbody>
</table>
`,A}function T(C){var D,A=C.split(`
`);for(D=0;D<A.length;++D)/^ {0,3}\|/.test(A[D])&&(A[D]=A[D].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(A[D])&&(A[D]=A[D].replace(/\|[ \t]*$/,"")),A[D]=r.subParser("codeSpans")(A[D],w,y);var O=A[0].split("|").map(function(he){return he.trim()}),P=A[1].split("|").map(function(he){return he.trim()}),N=[],F=[],j=[],J=[];for(A.shift(),A.shift(),D=0;D<A.length;++D)A[D].trim()!==""&&N.push(A[D].split("|").map(function(he){return he.trim()}));if(O.length<P.length)return C;for(D=0;D<P.length;++D)j.push(I(P[D]));for(D=0;D<O.length;++D)r.helper.isUndefined(j[D])&&(j[D]=""),F.push(R(O[D],j[D]));for(D=0;D<N.length;++D){for(var ie=[],oe=0;oe<F.length;++oe)r.helper.isUndefined(N[D][oe]),ie.push(S(N[D][oe],j[oe]));J.push(ie)}return k(F,J)}return h=y.converter._dispatch("tables.before",h,w,y),h=h.replace(/\\(\|)/g,r.helper.escapeCharactersCallback),h=h.replace(E,T),h=h.replace(g,T),h=y.converter._dispatch("tables.after",h,w,y),h}),r.subParser("underline",function(h,w,y){return w.underline&&(h=y.converter._dispatch("underline.before",h,w,y),w.literalMidWordUnderscores?(h=h.replace(/\b___(\S[\s\S]*?)___\b/g,function(E,g){return"<u>"+g+"</u>"}),h=h.replace(/\b__(\S[\s\S]*?)__\b/g,function(E,g){return"<u>"+g+"</u>"})):(h=h.replace(/___(\S[\s\S]*?)___/g,function(E,g){return/\S$/.test(g)?"<u>"+g+"</u>":E}),h=h.replace(/__(\S[\s\S]*?)__/g,function(E,g){return/\S$/.test(g)?"<u>"+g+"</u>":E})),h=h.replace(/(_)/g,r.helper.escapeCharactersCallback),h=y.converter._dispatch("underline.after",h,w,y)),h}),r.subParser("unescapeSpecialChars",function(h,w,y){return h=y.converter._dispatch("unescapeSpecialChars.before",h,w,y),h=h.replace(/E(\d+)E/g,function(E,g){var I=parseInt(g);return String.fromCharCode(I)}),h=y.converter._dispatch("unescapeSpecialChars.after",h,w,y),h}),r.subParser("makeMarkdown.blockquote",function(h,w){var y="";if(h.hasChildNodes())for(var E=h.childNodes,g=E.length,I=0;I<g;++I){var R=r.subParser("makeMarkdown.node")(E[I],w);R!==""&&(y+=R)}return y=y.trim(),y="> "+y.split(`
`).join(`
> `),y}),r.subParser("makeMarkdown.codeBlock",function(h,w){var y=h.getAttribute("language"),E=h.getAttribute("precodenum");return"```"+y+`
`+w.preList[E]+"\n```"}),r.subParser("makeMarkdown.codeSpan",function(h){return"`"+h.innerHTML+"`"}),r.subParser("makeMarkdown.emphasis",function(h,w){var y="";if(h.hasChildNodes()){y+="*";for(var E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);y+="*"}return y}),r.subParser("makeMarkdown.header",function(h,w,y){var E=new Array(y+1).join("#"),g="";if(h.hasChildNodes()){g=E+" ";for(var I=h.childNodes,R=I.length,S=0;S<R;++S)g+=r.subParser("makeMarkdown.node")(I[S],w)}return g}),r.subParser("makeMarkdown.hr",function(){return"---"}),r.subParser("makeMarkdown.image",function(h){var w="";return h.hasAttribute("src")&&(w+="!["+h.getAttribute("alt")+"](",w+="<"+h.getAttribute("src")+">",h.hasAttribute("width")&&h.hasAttribute("height")&&(w+=" ="+h.getAttribute("width")+"x"+h.getAttribute("height")),h.hasAttribute("title")&&(w+=' "'+h.getAttribute("title")+'"'),w+=")"),w}),r.subParser("makeMarkdown.links",function(h,w){var y="";if(h.hasChildNodes()&&h.hasAttribute("href")){var E=h.childNodes,g=E.length;y="[";for(var I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);y+="](",y+="<"+h.getAttribute("href")+">",h.hasAttribute("title")&&(y+=' "'+h.getAttribute("title")+'"'),y+=")"}return y}),r.subParser("makeMarkdown.list",function(h,w,y){var E="";if(!h.hasChildNodes())return"";for(var g=h.childNodes,I=g.length,R=h.getAttribute("start")||1,S=0;S<I;++S)if(!(typeof g[S].tagName=="undefined"||g[S].tagName.toLowerCase()!=="li")){var k="";y==="ol"?k=R.toString()+". ":k="- ",E+=k+r.subParser("makeMarkdown.listItem")(g[S],w),++R}return E+=`
<!-- -->
`,E.trim()}),r.subParser("makeMarkdown.listItem",function(h,w){for(var y="",E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);return/\n$/.test(y)?y=y.split(`
`).join(`
    `).replace(/^ {4}$/gm,"").replace(/\n\n+/g,`

`):y+=`
`,y}),r.subParser("makeMarkdown.node",function(h,w,y){y=y||!1;var E="";if(h.nodeType===3)return r.subParser("makeMarkdown.txt")(h,w);if(h.nodeType===8)return"<!--"+h.data+`-->

`;if(h.nodeType!==1)return"";var g=h.tagName.toLowerCase();switch(g){case"h1":y||(E=r.subParser("makeMarkdown.header")(h,w,1)+`

`);break;case"h2":y||(E=r.subParser("makeMarkdown.header")(h,w,2)+`

`);break;case"h3":y||(E=r.subParser("makeMarkdown.header")(h,w,3)+`

`);break;case"h4":y||(E=r.subParser("makeMarkdown.header")(h,w,4)+`

`);break;case"h5":y||(E=r.subParser("makeMarkdown.header")(h,w,5)+`

`);break;case"h6":y||(E=r.subParser("makeMarkdown.header")(h,w,6)+`

`);break;case"p":y||(E=r.subParser("makeMarkdown.paragraph")(h,w)+`

`);break;case"blockquote":y||(E=r.subParser("makeMarkdown.blockquote")(h,w)+`

`);break;case"hr":y||(E=r.subParser("makeMarkdown.hr")(h,w)+`

`);break;case"ol":y||(E=r.subParser("makeMarkdown.list")(h,w,"ol")+`

`);break;case"ul":y||(E=r.subParser("makeMarkdown.list")(h,w,"ul")+`

`);break;case"precode":y||(E=r.subParser("makeMarkdown.codeBlock")(h,w)+`

`);break;case"pre":y||(E=r.subParser("makeMarkdown.pre")(h,w)+`

`);break;case"table":y||(E=r.subParser("makeMarkdown.table")(h,w)+`

`);break;case"code":E=r.subParser("makeMarkdown.codeSpan")(h,w);break;case"em":case"i":E=r.subParser("makeMarkdown.emphasis")(h,w);break;case"strong":case"b":E=r.subParser("makeMarkdown.strong")(h,w);break;case"del":E=r.subParser("makeMarkdown.strikethrough")(h,w);break;case"a":E=r.subParser("makeMarkdown.links")(h,w);break;case"img":E=r.subParser("makeMarkdown.image")(h,w);break;default:E=h.outerHTML+`

`}return E}),r.subParser("makeMarkdown.paragraph",function(h,w){var y="";if(h.hasChildNodes())for(var E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);return y=y.trim(),y}),r.subParser("makeMarkdown.pre",function(h,w){var y=h.getAttribute("prenum");return"<pre>"+w.preList[y]+"</pre>"}),r.subParser("makeMarkdown.strikethrough",function(h,w){var y="";if(h.hasChildNodes()){y+="~~";for(var E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);y+="~~"}return y}),r.subParser("makeMarkdown.strong",function(h,w){var y="";if(h.hasChildNodes()){y+="**";for(var E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w);y+="**"}return y}),r.subParser("makeMarkdown.table",function(h,w){var y="",E=[[],[]],g=h.querySelectorAll("thead>tr>th"),I=h.querySelectorAll("tbody>tr"),R,S;for(R=0;R<g.length;++R){var k=r.subParser("makeMarkdown.tableCell")(g[R],w),T="---";if(g[R].hasAttribute("style")){var C=g[R].getAttribute("style").toLowerCase().replace(/\s/g,"");switch(C){case"text-align:left;":T=":---";break;case"text-align:right;":T="---:";break;case"text-align:center;":T=":---:";break}}E[0][R]=k.trim(),E[1][R]=T}for(R=0;R<I.length;++R){var D=E.push([])-1,A=I[R].getElementsByTagName("td");for(S=0;S<g.length;++S){var O=" ";typeof A[S]!="undefined"&&(O=r.subParser("makeMarkdown.tableCell")(A[S],w)),E[D].push(O)}}var P=3;for(R=0;R<E.length;++R)for(S=0;S<E[R].length;++S){var N=E[R][S].length;N>P&&(P=N)}for(R=0;R<E.length;++R){for(S=0;S<E[R].length;++S)R===1?E[R][S].slice(-1)===":"?E[R][S]=r.helper.padEnd(E[R][S].slice(-1),P-1,"-")+":":E[R][S]=r.helper.padEnd(E[R][S],P,"-"):E[R][S]=r.helper.padEnd(E[R][S],P);y+="| "+E[R].join(" | ")+` |
`}return y.trim()}),r.subParser("makeMarkdown.tableCell",function(h,w){var y="";if(!h.hasChildNodes())return"";for(var E=h.childNodes,g=E.length,I=0;I<g;++I)y+=r.subParser("makeMarkdown.node")(E[I],w,!0);return y.trim()}),r.subParser("makeMarkdown.txt",function(h){var w=h.nodeValue;return w=w.replace(/ +/g," "),w=w.replace(/NBSP;/g," "),w=r.helper.unescapeHTMLEntities(w),w=w.replace(/([*_~|`])/g,"\\$1"),w=w.replace(/^(\s*)>/g,"\\$1>"),w=w.replace(/^#/gm,"\\#"),w=w.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),w=w.replace(/^( {0,3}\d+)\./gm,"$1\\."),w=w.replace(/^( {0,3})([+-])/gm,"$1\\$2"),w=w.replace(/]([\s]*)\(/g,"\\]$1\\("),w=w.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:"),w});var M=this;n.exports?n.exports=r:M.showdown=r}).call(be)})(WA);var OG=WA.exports;const PG=ck(OG);function DG(n){return new PG.Converter().makeHtml(n)}function $G(n){return n.split(`
`).filter(r=>r.startsWith("![")||r.startsWith("#")||r.startsWith("> ")||r.startsWith("*")||r.startsWith("- ")||r.startsWith("1. ")||r.startsWith("```")||r.startsWith("`")||r.startsWith("[")||r.startsWith("---")).length>0}const NG={name:"TextEditor",inheritAttrs:!1,components:{EditorContent:FB,TextEditorFixedMenu:_G,TextEditorBubbleMenu:EG,TextEditorFloatingMenu:IG},props:{content:{type:String,default:null},placeholder:{type:[String,Function],default:""},editorClass:{type:[String,Array,Object],default:""},editable:{type:Boolean,default:!0},bubbleMenu:{type:[Boolean,Array],default:!1},bubbleMenuOptions:{type:Object,default:()=>({})},fixedMenu:{type:[Boolean,Array],default:!1},floatingMenu:{type:[Boolean,Array],default:!1},extensions:{type:Array,default:()=>[]},starterkitOptions:{type:Object,default:()=>({})},mentions:{type:Array,default:()=>[]}},emits:["change","focus","blur"],expose:["editor"],provide(){return{editor:O_(()=>this.editor)}},data(){return{editor:null}},watch:{content(n){this.editor.getHTML()!==n&&this.editor.commands.setContent(n)},editable(n){this.editor.setEditable(n)},editorProps:{deep:!0,handler(n){this.editor&&this.editor.setOptions({editorProps:n})}}},mounted(){this.editor=new jB({content:this.content||null,editorProps:this.editorProps,editable:this.editable,extensions:[kV.configure(Y({},this.starterkitOptions)),Iq.configure({resizable:!0}),Dq,Pq,Oq,RU,TV.configure({types:["heading","paragraph"]}),IU,$U,DU.configure({multicolor:!0}),Nq,jq,aU.configure({openOnClick:!1}),EV.configure({showOnlyWhenEditable:!1,placeholder:typeof this.placeholder=="function"?this.placeholder:()=>this.placeholder}),WU(this.mentions),...this.extensions||[]],onUpdate:({editor:n})=>{this.$emit("change",n.getHTML())},onFocus:({editor:n,event:e})=>{this.$emit("focus",e)},onBlur:({editor:n,event:e})=>{this.$emit("blur",e)}})},beforeUnmount(){this.editor.destroy(),this.editor=null},computed:{editorProps(){return{attributes:{class:De(["prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100",this.editorClass])},clipboardTextParser:(n,e)=>{if(!$G(n)||!confirm("Do you want to convert markdown content to HTML before pasting?"))return;let t=document.createElement("div");return t.innerHTML=DG(n),(this.editor.view.someProp("clipboardParser")||this.editor.view.someProp("domParser")||KT.fromSchema(this.editor.schema)).parseSlice(t,{preserveWhitespace:!0,context:e})}}}}};function LG(n,e,t,r,i,s){const o=mt("TextEditorBubbleMenu"),a=mt("TextEditorFixedMenu"),l=mt("TextEditorFloatingMenu"),c=mt("editor-content");return i.editor?(q(),Q("div",{key:0,class:De(["relative w-full",n.$attrs.class])},[ye(o,{buttons:t.bubbleMenu,options:t.bubbleMenuOptions},null,8,["buttons","options"]),ye(a,{class:"w-full overflow-x-auto rounded-t-lg border border-gray-200",buttons:t.fixedMenu},null,8,["buttons"]),ye(l,{buttons:t.floatingMenu},null,8,["buttons"]),Ye(n.$slots,"top"),Ye(n.$slots,"editor",{editor:i.editor},()=>[ye(c,{editor:i.editor},null,8,["editor"])]),Ye(n.$slots,"bottom")],2)):He("",!0)}const jG=je(NG,[["render",LG]]);de([]);function Cs(r,i){return Zt(this,arguments,function*(n,e,t={}){e||(e={});let s=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname},t.headers||{});window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(s["X-Frappe-CSRF-Token"]=window.csrf_token);let o=n.startsWith("/")?n:`/api/method/${n}`;const a=yield fetch(o,{method:"POST",headers:s,body:JSON.stringify(e)});if(a.ok){const l=yield a.json();if(l.docs||n==="login")return l;if(l.exc)try{console.groupCollapsed(n),console.log(`method: ${n}`),console.log("params:",e);let c=JSON.parse(l.exc);for(let u of c)console.log(u);console.groupEnd()}catch(c){console.warn("Error printing debug messages",c)}return l.message}else{let l=yield a.text(),c,u;try{c=JSON.parse(l)}catch(p){}let d=[[n,c.exc_type,c._error_message].filter(Boolean).join(" ")];if(c.exc){u=c.exc;try{u=JSON.parse(u)[0],console.log(u)}catch(p){}}let f=new Error(d.join(`
`));throw f.exc_type=c.exc_type,f.exc=u,f.status=a.status,f.messages=c._server_messages?JSON.parse(c._server_messages):[],f.messages=f.messages.concat(c.message),f.messages=f.messages.map(p=>{try{return JSON.parse(p).message}catch(m){return p}}),f.messages=f.messages.filter(Boolean),f.messages.length||(f.messages=c._error_message?[c._error_message]:["Internal Server Error"]),t.onError&&t.onError({response:a,status:a.status,error:f}),f}})}let FG=document.querySelector('link[rel="icon"]');FG.href;zr({});zr({});const Mi=Object.create(null);Mi.open="0";Mi.close="1";Mi.ping="2";Mi.pong="3";Mi.message="4";Mi.upgrade="5";Mi.noop="6";const eh=Object.create(null);Object.keys(Mi).forEach(n=>{eh[Mi[n]]=n});const HG={type:"error",data:"parser error"},BG=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",zG=typeof ArrayBuffer=="function",VG=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,JA=({type:n,data:e},t,r)=>BG&&e instanceof Blob?t?r(e):kS(e,r):zG&&(e instanceof ArrayBuffer||VG(e))?t?r(e):kS(new Blob([e]),r):r(Mi[n]+(e||"")),kS=(n,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)},ES="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vc=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(let n=0;n<ES.length;n++)Vc[ES.charCodeAt(n)]=n;const qG=n=>{let e=n.length*.75,t=n.length,r,i=0,s,o,a,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(r=0;r<t;r+=4)s=Vc[n.charCodeAt(r)],o=Vc[n.charCodeAt(r+1)],a=Vc[n.charCodeAt(r+2)],l=Vc[n.charCodeAt(r+3)],u[i++]=s<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|l&63;return c},UG=typeof ArrayBuffer=="function",KA=(n,e)=>{if(typeof n!="string")return{type:"message",data:GA(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:WG(n.substring(1),e)}:eh[t]?n.length>1?{type:eh[t],data:n.substring(1)}:{type:eh[t]}:HG},WG=(n,e)=>{if(UG){const t=qG(n);return GA(t,e)}else return{base64:!0,data:n}},GA=(n,e)=>{switch(e){case"blob":return n instanceof ArrayBuffer?new Blob([n]):n;case"arraybuffer":default:return n}},YA="",JG=(n,e)=>{const t=n.length,r=new Array(t);let i=0;n.forEach((s,o)=>{JA(s,!1,a=>{r[o]=a,++i===t&&e(r.join(YA))})})},KG=(n,e)=>{const t=n.split(YA),r=[];for(let i=0;i<t.length;i++){const s=KA(t[i],e);if(r.push(s),s.type==="error")break}return r},XA=4;function Vt(n){if(n)return GG(n)}function GG(n){for(var e in Vt.prototype)n[e]=Vt.prototype[e];return n}Vt.prototype.on=Vt.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};Vt.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};Vt.prototype.off=Vt.prototype.removeListener=Vt.prototype.removeAllListeners=Vt.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};Vt.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};Vt.prototype.emitReserved=Vt.prototype.emit;Vt.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};Vt.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Cr=typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")();function ZA(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}const YG=Cr.setTimeout,XG=Cr.clearTimeout;function Qp(n,e){e.useNativeTimers?(n.setTimeoutFn=YG.bind(Cr),n.clearTimeoutFn=XG.bind(Cr)):(n.setTimeoutFn=Cr.setTimeout.bind(Cr),n.clearTimeoutFn=Cr.clearTimeout.bind(Cr))}const ZG=1.33;function QG(n){return typeof n=="string"?eY(n):Math.ceil((n.byteLength||n.size)*ZG)}function eY(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}let tY=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},QA=class extends Vt{constructor(e){super(),this.writable=!1,Qp(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new tY(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=KA(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}};const eM="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),H1=64,nY={};let TS=0,ff=0,AS;function MS(n){let e="";do e=eM[n%H1]+e,n=Math.floor(n/H1);while(n>0);return e}function tM(){const n=MS(+new Date);return n!==AS?(TS=0,AS=n):n+"."+MS(TS++)}for(;ff<H1;ff++)nY[eM[ff]]=ff;function nM(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function rY(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let s=t[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}let rM=!1;try{rM=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(n){}const iY=rM;function iM(n){const e=n.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!e||iY))return new XMLHttpRequest}catch(t){}if(!e)try{return new Cr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}function sY(){}const oY=function(){return new iM({xdomain:!1}).responseType!=null}();class aY extends QA{constructor(e){if(super(e),this.polling=!1,typeof location!="undefined"){const r=location.protocol==="https:";let i=location.port;i||(i=r?"443":"80"),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==r}const t=e&&e.forceBase64;this.supportsBinary=oY&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};KG(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,JG(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=tM()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);const i=nM(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new ll(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}let ll=class th extends Vt{constructor(e,t){super(),Qp(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){const e=ZA(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new iM(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.opts.extraHeaders[r])}}catch(r){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{t.setRequestHeader("Accept","*/*")}catch(r){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},t.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document!="undefined"&&(this.index=th.requestsCount++,th.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=sY,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete th.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};ll.requestsCount=0;ll.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",RS);else if(typeof addEventListener=="function"){const n="onpagehide"in Cr?"pagehide":"unload";addEventListener(n,RS,!1)}}function RS(){for(let n in ll.requests)ll.requests.hasOwnProperty(n)&&ll.requests[n].abort()}const sM=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),hf=Cr.WebSocket||Cr.MozWebSocket,IS=!0,lY="arraybuffer",OS=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class cY extends QA{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=OS?{}:ZA(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=IS&&!OS?t?new hf(e,t):new hf(e):new hf(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||lY,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;JA(r,this.supportsBinary,s=>{const o={};try{IS&&this.ws.send(s)}catch(a){}i&&sM(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=tM()),this.supportsBinary||(e.b64=1);const i=nM(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}check(){return!!hf}}const uY={websocket:cY,polling:aY},dY=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fY=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function B1(n){const e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=dY.exec(n||""),s={},o=14;for(;o--;)s[fY[o]]=i[o]||"";return t!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=hY(s,s.path),s.queryKey=pY(s,s.query),s}function hY(n,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function pY(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(t[i]=s)}),t}let oM=class Ua extends Vt{constructor(e,t={}){super(),this.writeBuffer=[],e&&typeof e=="object"&&(t=e,e=null),e?(e=B1(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=B1(t.host).host),Qp(this,t),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=rY(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=XA,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new uY[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Ua.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),r=!1;Ua.priorWebsocketSuccess=!1;const i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ua.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function s(){r||(r=!0,u(),t.close(),t=null)}const o=d=>{const f=new Error("probe error: "+d);f.transport=t.name,s(),this.emitReserved("upgradeError",f)};function a(){o("transport closed")}function l(){o("socket closed")}function c(d){t&&d.name!==t.name&&s()}const u=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",c)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",c),t.open()}onOpen(){if(this.readyState="open",Ua.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(t+=QG(i)),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){Ua.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const i=e.length;for(;r<i;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}};oM.protocol=XA;function mY(n,e="",t){let r=n;t=t||typeof location!="undefined"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t!="undefined"?n=t.protocol+"//"+n:n="https://"+n),r=B1(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(t&&t.port===r.port?"":":"+r.port),r}const gY=typeof ArrayBuffer=="function",yY=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,aM=Object.prototype.toString,vY=typeof Blob=="function"||typeof Blob!="undefined"&&aM.call(Blob)==="[object BlobConstructor]",bY=typeof File=="function"||typeof File!="undefined"&&aM.call(File)==="[object FileConstructor]";function Bv(n){return gY&&(n instanceof ArrayBuffer||yY(n))||vY&&n instanceof Blob||bY&&n instanceof File}function nh(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(nh(n[t]))return!0;return!1}if(Bv(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return nh(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&nh(n[t]))return!0;return!1}function wY(n){const e=[],t=n.data,r=n;return r.data=z1(t,e),r.attachments=e.length,{packet:r,buffers:e}}function z1(n,e){if(!n)return n;if(Bv(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=z1(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=z1(n[r],e));return t}return n}function xY(n,e){return n.data=V1(n.data,e),delete n.attachments,n}function V1(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=V1(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=V1(n[t],e));return n}const SY=5;var Qe;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(Qe||(Qe={}));class _Y{constructor(e){this.replacer=e}encode(e){return(e.type===Qe.EVENT||e.type===Qe.ACK)&&nh(e)?this.encodeAsBinary({type:e.type===Qe.EVENT?Qe.BINARY_EVENT:Qe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Qe.BINARY_EVENT||e.type===Qe.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=wY(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}class zv extends Vt{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===Qe.BINARY_EVENT;r||t.type===Qe.BINARY_ACK?(t.type=r?Qe.EVENT:Qe.ACK,this.reconstructor=new CY(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Bv(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(Qe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Qe.BINARY_EVENT||r.type===Qe.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(s,t)}else r.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(zv.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case Qe.CONNECT:return typeof t=="object";case Qe.DISCONNECT:return t===void 0;case Qe.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case Qe.EVENT:case Qe.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Qe.ACK:case Qe.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class CY{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=xY(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const kY=Object.freeze(Object.defineProperty({__proto__:null,Decoder:zv,Encoder:_Y,get PacketType(){return Qe},protocol:SY},Symbol.toStringTag,{value:"Module"}));function Ur(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const EY=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class lM extends Vt{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ur(e,"open",this.onopen.bind(this)),Ur(e,"packet",this.onpacket.bind(this)),Ur(e,"error",this.onerror.bind(this)),Ur(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(EY.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const r={type:Qe.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const o=this.ids++,a=t.pop();this._registerAckCallback(o,a),r.id=o}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...o)=>{this.io.clearTimeoutFn(s),t.apply(this,[null,...o])}}emitWithAck(e,...t){const r=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((i,s)=>{t.push((o,a)=>r?o?s(o):i(a):i(o)),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Qe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Qe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Qe.EVENT:case Qe.BINARY_EVENT:this.onevent(e);break;case Qe.ACK:case Qe.BINARY_ACK:this.onack(e);break;case Qe.DISCONNECT:this.ondisconnect();break;case Qe.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...i){r||(r=!0,t.packet({type:Qe.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Qe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function Ul(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Ul.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Ul.prototype.reset=function(){this.attempts=0};Ul.prototype.setMin=function(n){this.ms=n};Ul.prototype.setMax=function(n){this.max=n};Ul.prototype.setJitter=function(n){this.jitter=n};class q1 extends Vt{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Qp(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Ul({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||kY;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new oM(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Ur(t,"open",function(){r.onopen(),e&&e()}),s=Ur(t,"error",o=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",o),e?e(o):r.maybeReconnectOnOpen()});if(this._timeout!==!1){const o=this._timeout;o===0&&i();const a=this.setTimeoutFn(()=>{i(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ur(e,"ping",this.onping.bind(this)),Ur(e,"data",this.ondata.bind(this)),Ur(e,"error",this.onerror.bind(this)),Ur(e,"close",this.onclose.bind(this)),Ur(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){sM(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new lM(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const tc={};function Hg(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=mY(n,e.path||"/socket.io"),r=t.source,i=t.id,s=t.path,o=tc[i]&&s in tc[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new q1(r,e):(tc[i]||(tc[i]=new q1(r,e)),l=tc[i]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(Hg,{Manager:q1,Socket:lM,io:Hg,connect:Hg});const TY={class:"flex items-center gap-3"},AY={class:"text-2xl font-semibold leading-6 text-gray-900"},MY={class:"flex flex-col gap-4"},RY=K("div",{class:"mb-1.5 text-sm text-gray-600"},"Title",-1),IY=K("div",{class:"mb-1.5 text-sm text-gray-600"},"Content",-1),OY={__name:"NoteModal",props:Ab({note:{type:Object,default:{}},doctype:{type:String,default:"CRM Lead"},doc:{type:String,default:""}},{modelValue:{},modelModifiers:{},reloadNotes:{},reloadNotesModifiers:{}}),emits:Ab(["after"],["update:modelValue","update:reloadNotes"]),setup(n,{emit:e}){const t=n,r=zb(n,"modelValue"),i=zb(n,"reloadNotes"),s=e,o=CC(),a=de(null),l=de(!1);let c=de({});function u(){return Zt(this,null,function*(){var f,p;if(!(t.note.title===c.value.title&&t.note.content===c.value.content)){if(c.value.name){let m=yield Cs("frappe.client.set_value",{doctype:"FCRM Note",name:c.value.name,fieldname:c.value});m.name&&((f=i.value)==null||f.reload(),s("after",m))}else{let m=yield Cs("frappe.client.insert",{doc:{doctype:"FCRM Note",title:c.value.title,content:c.value.content,reference_doctype:t.doctype,reference_docname:t.doc||""}});m.name&&((p=i.value)==null||p.reload(),s("after",m,!0))}r.value=!1}})}function d(){var m;if(!((m=t.note)!=null&&m.reference_docname))return;let f=t.note.reference_doctype=="CRM Deal"?"Deal":"Lead",p={leadId:t.note.reference_docname};f=="Deal"&&(p={dealId:t.note.reference_docname}),o.push({name:f,params:p})}return At(()=>r.value,f=>{f&&(l.value=!1,Dn(()=>{a.value.el.focus(),c.value=Y({},t.note),c.value.title&&(l.value=!0)}))}),(f,p)=>{const m=mt("Button"),v=mt("TextInput"),x=mt("Dialog");return q(),dt(x,{modelValue:r.value,"onUpdate:modelValue":p[3]||(p[3]=b=>r.value=b),options:{size:"xl",actions:[{label:l.value?"Update":"Create",variant:"solid",onClick:()=>u()}]}},{"body-title":Ue(()=>{var b;return[K("div",TY,[K("h3",AY,Ge(l.value?"Edit Note":"Create Note"),1),(b=we(c))!=null&&b.reference_docname?(q(),dt(m,{key:0,variant:"outline",size:"sm",label:we(c).reference_doctype=="CRM Deal"?"Open Deal":"Open Lead",onClick:p[0]||(p[0]=_=>d())},{suffix:Ue(()=>[ye(MP,{class:"h-4 w-4"})]),_:1},8,["label"])):He("",!0)])]}),"body-content":Ue(()=>[K("div",MY,[K("div",null,[RY,ye(v,{ref_key:"title",ref:a,variant:"outline",modelValue:we(c).title,"onUpdate:modelValue":p[1]||(p[1]=b=>we(c).title=b),placeholder:"Add title"},null,8,["modelValue"])]),K("div",null,[IY,ye(we(jG),{variant:"outline",ref:"content","editor-class":"!prose-sm overflow-auto min-h-[180px] max-h-80 py-1.5 px-2 rounded border border-gray-300 bg-white hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 text-gray-800 transition-colors",bubbleMenu:!0,content:we(c).content,onChange:p[2]||(p[2]=b=>we(c).content=b),placeholder:"Type a Content"},null,8,["content"])])])]),_:1},8,["modelValue","options"])}}};var PY={},pf={},Vv={exports:{}},cl=typeof Reflect=="object"?Reflect:null,PS=cl&&typeof cl.apply=="function"?cl.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},rh;cl&&typeof cl.ownKeys=="function"?rh=cl.ownKeys:Object.getOwnPropertySymbols?rh=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:rh=function(e){return Object.getOwnPropertyNames(e)};function DY(n){console&&console.warn&&console.warn(n)}var cM=Number.isNaN||function(e){return e!==e};function yt(){yt.init.call(this)}Vv.exports=yt;Vv.exports.once=jY;yt.EventEmitter=yt;yt.prototype._events=void 0;yt.prototype._eventsCount=0;yt.prototype._maxListeners=void 0;var DS=10;function em(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(yt,"defaultMaxListeners",{enumerable:!0,get:function(){return DS},set:function(n){if(typeof n!="number"||n<0||cM(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");DS=n}});yt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};yt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cM(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function uM(n){return n._maxListeners===void 0?yt.defaultMaxListeners:n._maxListeners}yt.prototype.getMaxListeners=function(){return uM(this)};yt.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")PS(l,this,t);else for(var c=l.length,u=mM(l,c),r=0;r<c;++r)PS(u[r],this,t);return!0};function dM(n,e,t,r){var i,s,o;if(em(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]),o===void 0)o=s[e]=t,++n._eventsCount;else if(typeof o=="function"?o=s[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),i=uM(n),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,DY(a)}return n}yt.prototype.addListener=function(e,t){return dM(this,e,t,!1)};yt.prototype.on=yt.prototype.addListener;yt.prototype.prependListener=function(e,t){return dM(this,e,t,!0)};function $Y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fM(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=$Y.bind(r);return i.listener=t,r.wrapFn=i,i}yt.prototype.once=function(e,t){return em(t),this.on(e,fM(this,e,t)),this};yt.prototype.prependOnceListener=function(e,t){return em(t),this.prependListener(e,fM(this,e,t)),this};yt.prototype.removeListener=function(e,t){var r,i,s,o,a;if(em(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():NY(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};yt.prototype.off=yt.prototype.removeListener;yt.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function hM(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?LY(i):mM(i,i.length)}yt.prototype.listeners=function(e){return hM(this,e,!0)};yt.prototype.rawListeners=function(e){return hM(this,e,!1)};yt.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):pM.call(n,e)};yt.prototype.listenerCount=pM;function pM(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}yt.prototype.eventNames=function(){return this._eventsCount>0?rh(this._events):[]};function mM(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function NY(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function LY(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function jY(n,e){return new Promise(function(t,r){function i(o){n.removeListener(e,s),r(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}gM(n,e,s,{once:!0}),e!=="error"&&FY(n,i,{once:!0})})}function FY(n,e,t){typeof n.on=="function"&&gM(n,"error",e,t)}function gM(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(s){r.once&&n.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var oi=Vv.exports,tm={},HY=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(tm,"__esModule",{value:!0});var BY=oi,zY=function(n){HY(e,n);function e(t){var r=n.call(this)||this;return Object.defineProperties(r,{_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get:function(){var i=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){var s=Math.random(),o=Math.floor(s*this._jitter*i);i=Math.floor(s*10)&1?i+o:i-o}return Math.min(i,this._max)|0}},_factor:{value:t.factor||2},_jitter:{value:t.jitter>0&&t.jitter<=1?t.jitter:0},_max:{value:t.max||1e4},_min:{value:t.min||100},_timeoutID:{value:null,writable:!0}}),r}return e.prototype.backoff=function(){var t=this,r=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this.emit("backoff",this._attempts,r),this._timeoutID=setTimeout(function(){t.emit("ready",t._attempts,r),t._attempts++},r)},e.prototype.reset=function(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)},e}(BY.EventEmitter);tm.default=zY;var mf={},yM={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(be,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(v,x){var b=v[x];if(typeof b.bind=="function")return b.bind(v);try{return Function.prototype.bind.call(b,v)}catch(_){return function(){return Function.prototype.apply.apply(b,[v,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(v){return v==="debug"&&(v="log"),typeof console===t?!1:v==="trace"&&r?o:console[v]!==void 0?s(console,v):console.log!==void 0?s(console,"log"):e}function l(v,x){for(var b=0;b<i.length;b++){var _=i[b];this[_]=b<v?e:this.methodFactory(_,v,x)}this.log=this.debug}function c(v,x,b){return function(){typeof console!==t&&(l.call(this,x,b),this[v].apply(this,arguments))}}function u(v,x,b){return a(v)||c.apply(this,arguments)}function d(v,x,b){var _=this,M,h="loglevel";v&&(h+=":"+v);function w(g){var I=(i[g]||"silent").toUpperCase();if(typeof window!==t){try{window.localStorage[h]=I;return}catch(R){}try{window.document.cookie=encodeURIComponent(h)+"="+I+";"}catch(R){}}}function y(){var g;if(typeof window!==t){try{g=window.localStorage[h]}catch(S){}if(typeof g===t)try{var I=window.document.cookie,R=I.indexOf(encodeURIComponent(h)+"=");R!==-1&&(g=/^([^;]+)/.exec(I.slice(R))[1])}catch(S){}return _.levels[g]===void 0&&(g=void 0),g}}_.name=v,_.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},_.methodFactory=b||u,_.getLevel=function(){return M},_.setLevel=function(g,I){if(typeof g=="string"&&_.levels[g.toUpperCase()]!==void 0&&(g=_.levels[g.toUpperCase()]),typeof g=="number"&&g>=0&&g<=_.levels.SILENT){if(M=g,I!==!1&&w(g),l.call(_,g,v),typeof console===t&&g<_.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+g},_.setDefaultLevel=function(g){y()||_.setLevel(g,!1)},_.enableAll=function(g){_.setLevel(_.levels.TRACE,g)},_.disableAll=function(g){_.setLevel(_.levels.SILENT,g)};var E=y();E==null&&(E=x==null?"WARN":x),_.setLevel(E,!1)}var f=new d,p={};f.getLogger=function(x){if(typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var b=p[x];return b||(b=p[x]=new d(x,f.getLevel(),f.methodFactory)),b};var m=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=m),f},f.getLoggers=function(){return p},f})})(yM);var vM=yM.exports,gf={},pn={},bM={},qv={},VY=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(qv,"__esModule",{value:!0});var qY=function(n){VY(e,n);function e(t,r){var i=n.call(this)||this;Object.setPrototypeOf(i,e.prototype);var s=typeof t=="string"?t:i.explanation,o=typeof t=="object"?t:r;return i.message=i.name+" ("+i.code+"): "+s,i.originalError=o,i}return e}(Error);qv.default=qY;(function(n){var e=be&&be.__extends||function(){var f=function(p,m){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,x){v.__proto__=x}||function(v,x){for(var b in x)Object.prototype.hasOwnProperty.call(x,b)&&(v[b]=x[b])},f(p,m)};return function(p,m){f(p,m);function v(){this.constructor=p}p.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.errorsByCode=n.MediaErrors=n.SignalingErrors=n.UserMediaErrors=n.MalformedRequestErrors=n.GeneralErrors=n.SIPServerErrors=n.ClientErrors=n.SignatureValidationErrors=n.AuthorizationErrors=n.TwilioError=void 0;var t=qv;n.TwilioError=t.default;var r;(function(f){var p=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=[],h.code=20101,h.description="Invalid access token",h.explanation="Twilio was unable to validate your Access Token",h.name="AccessTokenInvalid",h.solutions=[],Object.setPrototypeOf(h,f.AccessTokenInvalid.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.AccessTokenInvalid=p;var m=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=[],h.code=20104,h.description="Access token expired or expiration date invalid",h.explanation="The Access Token provided to the Twilio API has expired, the expiration time specified in the token was invalid, or the expiration time specified was too far in the future",h.name="AccessTokenExpired",h.solutions=[],Object.setPrototypeOf(h,f.AccessTokenExpired.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.AccessTokenExpired=m;var v=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=[],h.code=20151,h.description="Authentication Failed",h.explanation="The Authentication with the provided JWT failed",h.name="AuthenticationFailed",h.solutions=[],Object.setPrototypeOf(h,f.AuthenticationFailed.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.AuthenticationFailed=v})(r=n.AuthorizationErrors||(n.AuthorizationErrors={}));var i;(function(f){var p=function(m){e(v,m);function v(x,b){var _=m.call(this,x,b)||this;_.causes=["The access token has an invalid Account SID, API Key, or API Key Secret."],_.code=31202,_.description="Signature validation failed.",_.explanation="The provided access token failed signature validation.",_.name="AccessTokenSignatureValidationFailed",_.solutions=["Ensure the Account SID, API Key, and API Key Secret are valid when generating your access token."],Object.setPrototypeOf(_,f.AccessTokenSignatureValidationFailed.prototype);var M=typeof x=="string"?x:_.explanation,h=typeof x=="object"?x:b;return _.message=_.name+" ("+_.code+"): "+M,_.originalError=h,_}return v}(t.default);f.AccessTokenSignatureValidationFailed=p})(i=n.SignatureValidationErrors||(n.SignatureValidationErrors={}));var s;(function(f){var p=function(b){e(_,b);function _(M,h){var w=b.call(this,M,h)||this;w.causes=[],w.code=31400,w.description="Bad Request (HTTP/SIP)",w.explanation="The request could not be understood due to malformed syntax.",w.name="BadRequest",w.solutions=[],Object.setPrototypeOf(w,f.BadRequest.prototype);var y=typeof M=="string"?M:w.explanation,E=typeof M=="object"?M:h;return w.message=w.name+" ("+w.code+"): "+y,w.originalError=E,w}return _}(t.default);f.BadRequest=p;var m=function(b){e(_,b);function _(M,h){var w=b.call(this,M,h)||this;w.causes=["The outbound call was made to an invalid phone number.","The TwiML application sid is missing a Voice URL."],w.code=31404,w.description="Not Found (HTTP/SIP)",w.explanation="The server has not found anything matching the request.",w.name="NotFound",w.solutions=["Ensure the phone number dialed is valid.","Ensure the TwiML application is configured correctly with a Voice URL link."],Object.setPrototypeOf(w,f.NotFound.prototype);var y=typeof M=="string"?M:w.explanation,E=typeof M=="object"?M:h;return w.message=w.name+" ("+w.code+"): "+y,w.originalError=E,w}return _}(t.default);f.NotFound=m;var v=function(b){e(_,b);function _(M,h){var w=b.call(this,M,h)||this;w.causes=[],w.code=31480,w.description="Temporarily Unavailable (SIP)",w.explanation="The callee is currently unavailable.",w.name="TemporarilyUnavailable",w.solutions=[],Object.setPrototypeOf(w,f.TemporarilyUnavailable.prototype);var y=typeof M=="string"?M:w.explanation,E=typeof M=="object"?M:h;return w.message=w.name+" ("+w.code+"): "+y,w.originalError=E,w}return _}(t.default);f.TemporarilyUnavailable=v;var x=function(b){e(_,b);function _(M,h){var w=b.call(this,M,h)||this;w.causes=[],w.code=31486,w.description="Busy Here (SIP)",w.explanation="The callee is busy.",w.name="BusyHere",w.solutions=[],Object.setPrototypeOf(w,f.BusyHere.prototype);var y=typeof M=="string"?M:w.explanation,E=typeof M=="object"?M:h;return w.message=w.name+" ("+w.code+"): "+y,w.originalError=E,w}return _}(t.default);f.BusyHere=x})(s=n.ClientErrors||(n.ClientErrors={}));var o;(function(f){var p=function(m){e(v,m);function v(x,b){var _=m.call(this,x,b)||this;_.causes=[],_.code=31603,_.description="Decline (SIP)",_.explanation="The callee does not wish to participate in the call.",_.name="Decline",_.solutions=[],Object.setPrototypeOf(_,f.Decline.prototype);var M=typeof x=="string"?x:_.explanation,h=typeof x=="object"?x:b;return _.message=_.name+" ("+_.code+"): "+M,_.originalError=h,_}return v}(t.default);f.Decline=p})(o=n.SIPServerErrors||(n.SIPServerErrors={}));var a;(function(f){var p=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31e3,g.description="Unknown Error",g.explanation="An unknown error has occurred. See error details for more information.",g.name="UnknownError",g.solutions=[],Object.setPrototypeOf(g,f.UnknownError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.UnknownError=p;var m=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31001,g.description="Application Not Found",g.explanation="",g.name="ApplicationNotFoundError",g.solutions=[],Object.setPrototypeOf(g,f.ApplicationNotFoundError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.ApplicationNotFoundError=m;var v=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31002,g.description="Connection Declined",g.explanation="",g.name="ConnectionDeclinedError",g.solutions=[],Object.setPrototypeOf(g,f.ConnectionDeclinedError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.ConnectionDeclinedError=v;var x=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31003,g.description="Connection Timeout",g.explanation="The server could not produce a response within a suitable amount of time.",g.name="ConnectionTimeoutError",g.solutions=[],Object.setPrototypeOf(g,f.ConnectionTimeoutError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.ConnectionTimeoutError=x;var b=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31005,g.description="Connection error",g.explanation="A connection error occurred during the call",g.name="ConnectionError",g.solutions=[],Object.setPrototypeOf(g,f.ConnectionError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.ConnectionError=b;var _=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=["The incoming call was cancelled because it was not answered in time or it was accepted/rejected by another application instance registered with the same identity."],g.code=31008,g.description="Call cancelled",g.explanation="Unable to answer because the call has ended",g.name="CallCancelledError",g.solutions=[],Object.setPrototypeOf(g,f.CallCancelledError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.CallCancelledError=_;var M=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31009,g.description="Transport error",g.explanation="No transport available to send or receive messages",g.name="TransportError",g.solutions=[],Object.setPrototypeOf(g,f.TransportError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.TransportError=M})(a=n.GeneralErrors||(n.GeneralErrors={}));var l;(function(f){var p=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=["Invalid content or MessageType passed to sendMessage method."],g.code=31100,g.description="The request had malformed syntax.",g.explanation="The request could not be understood due to malformed syntax.",g.name="MalformedRequestError",g.solutions=["Ensure content and MessageType passed to sendMessage method are valid."],Object.setPrototypeOf(g,f.MalformedRequestError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.MalformedRequestError=p;var m=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31101,g.description="Missing parameter array in request",g.explanation="",g.name="MissingParameterArrayError",g.solutions=[],Object.setPrototypeOf(g,f.MissingParameterArrayError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.MissingParameterArrayError=m;var v=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31102,g.description="Authorization token missing in request.",g.explanation="",g.name="AuthorizationTokenMissingError",g.solutions=[],Object.setPrototypeOf(g,f.AuthorizationTokenMissingError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.AuthorizationTokenMissingError=v;var x=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31103,g.description="Maximum parameter length has been exceeded.",g.explanation="Length of parameters cannot exceed MAX_PARAM_LENGTH.",g.name="MaxParameterLengthExceededError",g.solutions=[],Object.setPrototypeOf(g,f.MaxParameterLengthExceededError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.MaxParameterLengthExceededError=x;var b=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31104,g.description="Invalid bridge token",g.explanation="",g.name="InvalidBridgeTokenError",g.solutions=[],Object.setPrototypeOf(g,f.InvalidBridgeTokenError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.InvalidBridgeTokenError=b;var _=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=["Client name contains invalid characters."],g.code=31105,g.description="Invalid client name",g.explanation="Client name should not contain control, space, delims, or unwise characters.",g.name="InvalidClientNameError",g.solutions=["Make sure that client name does not contain any of the invalid characters."],Object.setPrototypeOf(g,f.InvalidClientNameError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.InvalidClientNameError=_;var M=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31107,g.description="The reconnect parameter is invalid",g.explanation="",g.name="ReconnectParameterInvalidError",g.solutions=[],Object.setPrototypeOf(g,f.ReconnectParameterInvalidError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.ReconnectParameterInvalidError=M})(l=n.MalformedRequestErrors||(n.MalformedRequestErrors={})),function(f){var p=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31201,g.description="Authorization error",g.explanation="The request requires user authentication. The server understood the request, but is refusing to fulfill it.",g.name="AuthorizationError",g.solutions=[],Object.setPrototypeOf(g,f.AuthorizationError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.AuthorizationError=p;var m=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31203,g.description="No valid account",g.explanation="",g.name="NoValidAccountError",g.solutions=[],Object.setPrototypeOf(g,f.NoValidAccountError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.NoValidAccountError=m;var v=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31204,g.description="Invalid JWT token",g.explanation="",g.name="InvalidJWTTokenError",g.solutions=[],Object.setPrototypeOf(g,f.InvalidJWTTokenError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.InvalidJWTTokenError=v;var x=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31205,g.description="JWT token expired",g.explanation="",g.name="JWTTokenExpiredError",g.solutions=[],Object.setPrototypeOf(g,f.JWTTokenExpiredError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.JWTTokenExpiredError=x;var b=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=["Rate limit exceeded."],g.code=31206,g.description="Rate exceeded authorized limit.",g.explanation="The request performed exceeds the authorized limit.",g.name="RateExceededError",g.solutions=["Ensure message send rate does not exceed authorized limits."],Object.setPrototypeOf(g,f.RateExceededError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.RateExceededError=b;var _=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=[],g.code=31207,g.description="JWT token expiration too long",g.explanation="",g.name="JWTTokenExpirationTooLongError",g.solutions=[],Object.setPrototypeOf(g,f.JWTTokenExpirationTooLongError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.JWTTokenExpirationTooLongError=_;var M=function(h){e(w,h);function w(y,E){var g=h.call(this,y,E)||this;g.causes=["The payload size of Call Message Event exceeds the authorized limit."],g.code=31209,g.description="Call Message Event Payload size exceeded authorized limit.",g.explanation="The request performed to send a Call Message Event exceeds the payload size authorized limit",g.name="PayloadSizeExceededError",g.solutions=["Reduce payload size of Call Message Event to be within the authorized limit and try again."],Object.setPrototypeOf(g,f.PayloadSizeExceededError.prototype);var I=typeof y=="string"?y:g.explanation,R=typeof y=="object"?y:E;return g.message=g.name+" ("+g.code+"): "+I,g.originalError=R,g}return w}(t.default);f.PayloadSizeExceededError=M}(r=n.AuthorizationErrors||(n.AuthorizationErrors={}));var c;(function(f){var p=function(v){e(x,v);function x(b,_){var M=v.call(this,b,_)||this;M.causes=["The user denied the getUserMedia request.","The browser denied the getUserMedia request."],M.code=31401,M.description="UserMedia Permission Denied Error",M.explanation="The browser or end-user denied permissions to user media. Therefore we were unable to acquire input audio.",M.name="PermissionDeniedError",M.solutions=["The user should accept the request next time prompted. If the browser saved the deny, the user should change that permission in their browser.","The user should to verify that the browser has permission to access the microphone at this address."],Object.setPrototypeOf(M,f.PermissionDeniedError.prototype);var h=typeof b=="string"?b:M.explanation,w=typeof b=="object"?b:_;return M.message=M.name+" ("+M.code+"): "+h,M.originalError=w,M}return x}(t.default);f.PermissionDeniedError=p;var m=function(v){e(x,v);function x(b,_){var M=v.call(this,b,_)||this;M.causes=["NotFoundError - The deviceID specified was not found.","The getUserMedia constraints were overconstrained and no devices matched."],M.code=31402,M.description="UserMedia Acquisition Failed Error",M.explanation="The browser and end-user allowed permissions, however getting the media failed. Usually this is due to bad constraints, but can sometimes fail due to browser, OS or hardware issues.",M.name="AcquisitionFailedError",M.solutions=["Ensure the deviceID being specified exists.","Try acquiring media with fewer constraints."],Object.setPrototypeOf(M,f.AcquisitionFailedError.prototype);var h=typeof b=="string"?b:M.explanation,w=typeof b=="object"?b:_;return M.message=M.name+" ("+M.code+"): "+h,M.originalError=w,M}return x}(t.default);f.AcquisitionFailedError=m})(c=n.UserMediaErrors||(n.UserMediaErrors={}));var u;(function(f){var p=function(v){e(x,v);function x(b,_){var M=v.call(this,b,_)||this;M.causes=[],M.code=53e3,M.description="Signaling connection error",M.explanation="Raised whenever a signaling connection error occurs that is not covered by a more specific error code.",M.name="ConnectionError",M.solutions=[],Object.setPrototypeOf(M,f.ConnectionError.prototype);var h=typeof b=="string"?b:M.explanation,w=typeof b=="object"?b:_;return M.message=M.name+" ("+M.code+"): "+h,M.originalError=w,M}return x}(t.default);f.ConnectionError=p;var m=function(v){e(x,v);function x(b,_){var M=v.call(this,b,_)||this;M.causes=["The device running your application lost its Internet connection."],M.code=53001,M.description="Signaling connection disconnected",M.explanation="Raised whenever the signaling connection is unexpectedly disconnected.",M.name="ConnectionDisconnected",M.solutions=["Ensure the device running your application has access to a stable Internet connection."],Object.setPrototypeOf(M,f.ConnectionDisconnected.prototype);var h=typeof b=="string"?b:M.explanation,w=typeof b=="object"?b:_;return M.message=M.name+" ("+M.code+"): "+h,M.originalError=w,M}return x}(t.default);f.ConnectionDisconnected=m})(u=n.SignalingErrors||(n.SignalingErrors={}));var d;(function(f){var p=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=["The Client may not be using a supported WebRTC implementation.","The Client may not have the necessary resources to create or apply a new media description."],h.code=53400,h.description="Client is unable to create or apply a local media description",h.explanation="Raised whenever a Client is unable to create or apply a local media description.",h.name="ClientLocalDescFailed",h.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(h,f.ClientLocalDescFailed.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.ClientLocalDescFailed=p;var m=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=["The Client may not be using a supported WebRTC implementation.","The Client may be connecting peer-to-peer with another Participant that is not using a supported WebRTC implementation.","The Client may not have the necessary resources to apply a new media description."],h.code=53402,h.description="Client is unable to apply a remote media description",h.explanation="Raised whenever the Client receives a remote media description but is unable to apply it.",h.name="ClientRemoteDescFailed",h.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(h,f.ClientRemoteDescFailed.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.ClientRemoteDescFailed=m;var v=function(x){e(b,x);function b(_,M){var h=x.call(this,_,M)||this;h.causes=["The Client was unable to establish a media connection.","A media connection which was active failed liveliness checks."],h.code=53405,h.description="Media connection failed",h.explanation="Raised by the Client or Server whenever a media connection fails.",h.name="ConnectionError",h.solutions=["If the problem persists, try connecting to another region.","Check your Client's network connectivity.","If you've provided custom ICE Servers then ensure that the URLs and credentials are valid."],Object.setPrototypeOf(h,f.ConnectionError.prototype);var w=typeof _=="string"?_:h.explanation,y=typeof _=="object"?_:M;return h.message=h.name+" ("+h.code+"): "+w,h.originalError=y,h}return b}(t.default);f.ConnectionError=v})(d=n.MediaErrors||(n.MediaErrors={})),n.errorsByCode=new Map([[20101,r.AccessTokenInvalid],[20104,r.AccessTokenExpired],[20151,r.AuthenticationFailed],[31202,i.AccessTokenSignatureValidationFailed],[31400,s.BadRequest],[31404,s.NotFound],[31480,s.TemporarilyUnavailable],[31486,s.BusyHere],[31603,o.Decline],[31e3,a.UnknownError],[31001,a.ApplicationNotFoundError],[31002,a.ConnectionDeclinedError],[31003,a.ConnectionTimeoutError],[31005,a.ConnectionError],[31008,a.CallCancelledError],[31009,a.TransportError],[31100,l.MalformedRequestError],[31101,l.MissingParameterArrayError],[31102,l.AuthorizationTokenMissingError],[31103,l.MaxParameterLengthExceededError],[31104,l.InvalidBridgeTokenError],[31105,l.InvalidClientNameError],[31107,l.ReconnectParameterInvalidError],[31201,r.AuthorizationError],[31203,r.NoValidAccountError],[31204,r.InvalidJWTTokenError],[31205,r.JWTTokenExpiredError],[31206,r.RateExceededError],[31207,r.JWTTokenExpirationTooLongError],[31209,r.PayloadSizeExceededError],[31401,c.PermissionDeniedError],[31402,c.AcquisitionFailedError],[53e3,u.ConnectionError],[53001,u.ConnectionDisconnected],[53400,d.ClientLocalDescFailed],[53402,d.ClientRemoteDescFailed],[53405,d.ConnectionError]]),Object.freeze(n.errorsByCode)})(bM);(function(n){var e=be&&be.__extends||function(){var u=function(d,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&(p[v]=m[v])},u(d,f)};return function(d,f){u(d,f);function p(){this.constructor=d}d.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.UserMediaErrors=n.TwilioError=n.SIPServerErrors=n.SignatureValidationErrors=n.SignalingErrors=n.MediaErrors=n.MalformedRequestErrors=n.GeneralErrors=n.ClientErrors=n.AuthorizationErrors=n.hasErrorByCode=n.getErrorByCode=n.NotSupportedError=n.InvalidStateError=n.InvalidArgumentError=n.getPreciseSignalingErrorByCode=void 0;var t=bM;Object.defineProperty(n,"AuthorizationErrors",{enumerable:!0,get:function(){return t.AuthorizationErrors}}),Object.defineProperty(n,"ClientErrors",{enumerable:!0,get:function(){return t.ClientErrors}}),Object.defineProperty(n,"GeneralErrors",{enumerable:!0,get:function(){return t.GeneralErrors}}),Object.defineProperty(n,"MalformedRequestErrors",{enumerable:!0,get:function(){return t.MalformedRequestErrors}}),Object.defineProperty(n,"MediaErrors",{enumerable:!0,get:function(){return t.MediaErrors}}),Object.defineProperty(n,"SignalingErrors",{enumerable:!0,get:function(){return t.SignalingErrors}}),Object.defineProperty(n,"SignatureValidationErrors",{enumerable:!0,get:function(){return t.SignatureValidationErrors}}),Object.defineProperty(n,"SIPServerErrors",{enumerable:!0,get:function(){return t.SIPServerErrors}}),Object.defineProperty(n,"TwilioError",{enumerable:!0,get:function(){return t.TwilioError}}),Object.defineProperty(n,"UserMediaErrors",{enumerable:!0,get:function(){return t.UserMediaErrors}});var r=new Set([31001,31002,31003,31101,31102,31103,31104,31105,31107,31201,31202,31203,31204,31205,31207,31404,31480,31486,31603]);function i(u,d){if(typeof d=="number"&&c(d)){var f=u?!0:!r.has(d);if(f)return l(d)}}n.getPreciseSignalingErrorByCode=i;var s=function(u){e(d,u);function d(f){var p=u.call(this,f)||this;return p.name="InvalidArgumentError",p}return d}(Error);n.InvalidArgumentError=s;var o=function(u){e(d,u);function d(f){var p=u.call(this,f)||this;return p.name="InvalidStateError",p}return d}(Error);n.InvalidStateError=o;var a=function(u){e(d,u);function d(f){var p=u.call(this,f)||this;return p.name="NotSupportedError",p}return d}(Error);n.NotSupportedError=a;function l(u){var d=t.errorsByCode.get(u);if(!d)throw new s("Error code "+u+" not found");return d}n.getErrorByCode=l;function c(u){return t.errorsByCode.has(u)}n.hasErrorByCode=c})(pn);var Cn={},fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.SOUNDS_BASE_URL=fn.RELEASE_VERSION=fn.PACKAGE_NAME=fn.ECHO_TEST_DURATION=fn.COWBELL_AUDIO_URL=void 0;var UY="@twilio/voice-sdk";fn.PACKAGE_NAME=UY;var wM="2.10.2";fn.RELEASE_VERSION=wM;var xM="https://sdk.twilio.com/js/client/sounds/releases/1.0.0";fn.SOUNDS_BASE_URL=xM;var WY=xM+"/cowbell.mp3?cache="+wM;fn.COWBELL_AUDIO_URL=WY;var JY=2e4;fn.ECHO_TEST_DURATION=JY;var yf=be&&be.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.Logger=void 0;var $S=vM,KY=fn,SM=function(){function n(e,t){this._log=n.getLogLevelInstance(t),this._prefix="[TwilioVoice]["+e+"]"}return n.getLogLevelInstance=function(e){if(!n.loglevelInstance)try{n.loglevelInstance=(e&&e.LogLevelModule?e.LogLevelModule:$S).getLogger(KY.PACKAGE_NAME)}catch(t){console.warn("Cannot create custom logger"),n.loglevelInstance=console}return n.loglevelInstance},n.prototype.debug=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this._log).debug.apply(e,yf([this._prefix],t))},n.prototype.error=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this._log).error.apply(e,yf([this._prefix],t))},n.prototype.info=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this._log).info.apply(e,yf([this._prefix],t))},n.prototype.setDefaultLevel=function(e){this._log.setDefaultLevel?this._log.setDefaultLevel(e):console.warn("Logger cannot setDefaultLevel")},n.prototype.warn=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this._log).warn.apply(e,yf([this._prefix],t))},n.levels=$S.levels,n}();Cn.Logger=SM.getLogLevelInstance();Cn.default=SM;var Uv={};Object.defineProperty(Uv,"__esModule",{value:!0});var GY=fn,nc=pn,YY=Cn,XY=GY.SOUNDS_BASE_URL+"/outgoing.mp3",ZY=function(){function n(e,t,r,i){this._name=e,this._availableDevices=t,this._beforeChange=r,this._isSupported=i,this._activeDevices=new Set,this._log=new YY.default("OutputDeviceCollection")}return n.prototype.delete=function(e){this._log.debug(".delete",e);var t=!!this._activeDevices.delete(e),r=this._availableDevices.get("default")||Array.from(this._availableDevices.values())[0];!this._activeDevices.size&&r&&this._activeDevices.add(r);var i=Array.from(this._activeDevices.values()).map(function(s){return s.deviceId});return this._beforeChange(this._name,i),!!t},n.prototype.get=function(){return this._activeDevices},n.prototype.set=function(e){var t=this;if(this._log.debug(".set",e),!this._isSupported)return Promise.reject(new nc.NotSupportedError("This browser does not support audio output selection"));var r=Array.isArray(e)?e:[e];if(!r.length)return Promise.reject(new nc.InvalidArgumentError("Must specify at least one device to set"));var i=[],s=r.map(function(o){var a=t._availableDevices.get(o);return a||i.push(o),a});return i.length?Promise.reject(new nc.InvalidArgumentError("Devices not found: "+i.join(", "))):new Promise(function(o){o(t._beforeChange(t._name,r))}).then(function(){t._activeDevices.clear(),s.forEach(t._activeDevices.add,t._activeDevices)})},n.prototype.test=function(e){return e===void 0&&(e=XY),this._isSupported?this._activeDevices.size?Promise.all(Array.from(this._activeDevices).map(function(t){var r;return new Promise(function(i){r=new Audio(e),r.oncanplay=i}).then(function(){return r.setSinkId(t.deviceId).then(function(){return r.play()})})})):Promise.reject(new nc.InvalidStateError("No active output devices to test")):Promise.reject(new nc.NotSupportedError("This browser does not support audio output selection"))},n}();Uv.default=ZY;var Wv={};Object.defineProperty(Wv,"__esModule",{value:!0});var QY=function(){function n(e){Object.defineProperties(this,{deviceId:{get:function(){return e.deviceId}},groupId:{get:function(){return e.groupId}},kind:{get:function(){return e.kind}},label:{get:function(){return e.label}}})}return n}();Wv.default=QY;var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.promisifyEvents=nt.flatMap=nt.queryToJson=nt.isUnifiedPlanDefault=nt.isSafari=nt.isLegacyEdge=nt.isFirefox=nt.isChrome=nt.isElectron=nt.difference=nt.average=nt.Exception=void 0;function ap(n){if(!(this instanceof ap))return new ap(n);this.message=n}ap.prototype.toString=function(){return"Twilio.Exception: "+this.message};function eX(n){return n&&n.length?n.reduce(function(e,t){return e+t})/n.length:0}nt.average=eX;function tX(n,e,t){t=t||function(i){return i};var r=new Set(e.map(t));return n.filter(function(i){return!r.has(t(i))})}nt.difference=tX;function _M(n){return!!n.userAgent.match("Electron")}nt.isElectron=_M;function CM(n,e){var t=!!e.userAgent.match("CriOS"),r=!!e.userAgent.match("HeadlessChrome"),i=typeof n.chrome!="undefined"&&e.vendor==="Google Inc."&&e.userAgent.indexOf("OPR")===-1&&e.userAgent.indexOf("Edge")===-1;return t||_M(e)||i||r}nt.isChrome=CM;function kM(n){return n=n||(typeof window=="undefined"?be.navigator:window.navigator),!!n&&typeof n.userAgent=="string"&&/firefox|fxios/i.test(n.userAgent)}nt.isFirefox=kM;function nX(n){return n=n||(typeof window=="undefined"?be.navigator:window.navigator),!!n&&typeof n.userAgent=="string"&&/edge\/\d+/i.test(n.userAgent)}nt.isLegacyEdge=nX;function EM(n){return!!n.vendor&&n.vendor.indexOf("Apple")!==-1&&n.userAgent&&n.userAgent.indexOf("CriOS")===-1&&n.userAgent.indexOf("FxiOS")===-1}nt.isSafari=EM;function rX(n,e,t,r){if(typeof n=="undefined"||typeof e=="undefined"||typeof t=="undefined"||typeof r=="undefined"||typeof t.prototype=="undefined"||typeof r.prototype=="undefined")return!1;if(CM(n,e)&&t.prototype.addTransceiver){var i=new t,s=!0;try{i.addTransceiver("audio")}catch(o){s=!1}return i.close(),s}else{if(kM(e))return!0;if(EM(e))return"currentDirection"in r.prototype}return!1}nt.isUnifiedPlanDefault=rX;function iX(n){return n?n.split("&").reduce(function(e,t){var r=t.split("="),i=r[0],s=decodeURIComponent((r[1]||"").replace(/\+/g,"%20"));return i&&(e[i]=s),e},{}):""}nt.queryToJson=iX;function sX(n,e){var t=n instanceof Map||n instanceof Set?Array.from(n.values()):n;return e=e||function(r){return r},t.reduce(function(r,i){var s=e(i);return r.concat(s)},[])}nt.flatMap=sX;function oX(n,e,t){return new Promise(function(r,i){function s(){n.removeListener(t,o),r()}function o(){n.removeListener(e,s),i()}n.once(e,s),n.once(t,o)})}nt.promisifyEvents=oX;var aX=ap;nt.Exception=aX;var NS;function lX(){if(NS)return gf;NS=1;var n=be&&be.__extends||function(){var u=function(d,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&(p[v]=m[v])},u(d,f)};return function(d,f){u(d,f);function p(){this.constructor=d}d.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(gf,"__esModule",{value:!0});var e=oi,t=om(),r=pn,i=Cn,s=Uv,o=Wv,a=nt,l={audioinput:"Audio Input",audiooutput:"Audio Output"},c=function(u){n(d,u);function d(f,p,m){var v,x=u.call(this)||this;x.availableInputDevices=new Map,x.availableOutputDevices=new Map,x._audioConstraints=null,x._defaultInputDeviceStream=null,x._enabledSounds=(v={},v[t.default.SoundName.Disconnect]=!0,v[t.default.SoundName.Incoming]=!0,v[t.default.SoundName.Outgoing]=!0,v),x._inputDevice=null,x._isPollingInputVolume=!1,x._log=new i.default("AudioHelper"),x._processedStream=null,x._selectedInputDeviceStream=null,x._unknownDeviceIndexes={audioinput:{},audiooutput:{}},x._updateAvailableDevices=function(){return!x._mediaDevices||!x._enumerateDevices?Promise.reject("Enumeration not supported"):x._enumerateDevices().then(function(h){x._updateDevices(h.filter(function(y){return y.kind==="audiooutput"}),x.availableOutputDevices,x._removeLostOutput),x._updateDevices(h.filter(function(y){return y.kind==="audioinput"}),x.availableInputDevices,x._removeLostInput);var w=x.availableOutputDevices.get("default")||Array.from(x.availableOutputDevices.values())[0];[x.speakerDevices,x.ringtoneDevices].forEach(function(y){!y.get().size&&x.availableOutputDevices.size&&x.isOutputSelectionSupported&&y.set(w.deviceId).catch(function(E){x._log.warn("Unable to set audio output devices. "+E)})})})},x._removeLostInput=function(h){if(!x.inputDevice||x.inputDevice.deviceId!==h.deviceId)return!1;x._destroyProcessedStream(),x._replaceStream(null),x._inputDevice=null,x._maybeStopPollingVolume();var w=x.availableInputDevices.get("default")||Array.from(x.availableInputDevices.values())[0];return w&&x.setInputDevice(w.deviceId),!0},x._removeLostOutput=function(h){var w=x.speakerDevices.delete(h),y=x.ringtoneDevices.delete(h);return w||y},m=Object.assign({AudioContext:typeof AudioContext!="undefined"&&AudioContext,setSinkId:typeof HTMLAudioElement!="undefined"&&HTMLAudioElement.prototype.setSinkId},m),x._updateUserOptions(m),x._audioProcessorEventObserver=m.audioProcessorEventObserver,x._mediaDevices=m.mediaDevices||navigator.mediaDevices,x._onActiveInputChanged=p,x._enumerateDevices=typeof m.enumerateDevices=="function"?m.enumerateDevices:x._mediaDevices&&x._mediaDevices.enumerateDevices.bind(x._mediaDevices);var b=!!(m.AudioContext||m.audioContext),_=!!x._enumerateDevices;m.enabledSounds&&(x._enabledSounds=m.enabledSounds);var M=typeof m.setSinkId=="function";return x.isOutputSelectionSupported=_&&M,x.isVolumeSupported=b,x.isVolumeSupported&&(x._audioContext=m.audioContext||m.AudioContext&&new m.AudioContext,x._audioContext&&(x._inputVolumeAnalyser=x._audioContext.createAnalyser(),x._inputVolumeAnalyser.fftSize=32,x._inputVolumeAnalyser.smoothingTimeConstant=.3)),x.ringtoneDevices=new s.default("ringtone",x.availableOutputDevices,f,x.isOutputSelectionSupported),x.speakerDevices=new s.default("speaker",x.availableOutputDevices,f,x.isOutputSelectionSupported),x.addListener("newListener",function(h){h==="inputVolume"&&x._maybeStartPollingVolume()}),x.addListener("removeListener",function(h){h==="inputVolume"&&x._maybeStopPollingVolume()}),x.once("newListener",function(){x.isOutputSelectionSupported||x._log.warn("Warning: This browser does not support audio output selection."),x.isVolumeSupported||x._log.warn("Warning: This browser does not support Twilio's volume indicator feature.")}),_&&x._initializeEnumeration(),x}return Object.defineProperty(d.prototype,"audioConstraints",{get:function(){return this._audioConstraints},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"inputDevice",{get:function(){return this._inputDevice},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"inputStream",{get:function(){return this._processedStream||this._selectedInputDeviceStream},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"processedStream",{get:function(){return this._processedStream},enumerable:!1,configurable:!0}),d.prototype._destroy=function(){this._stopDefaultInputDeviceStream(),this._stopSelectedInputDeviceStream(),this._destroyProcessedStream(),this._maybeStopPollingVolume(),this.removeAllListeners(),this._unbind()},d.prototype._maybeStartPollingVolume=function(){var f=this;if(!(!this.isVolumeSupported||!this.inputStream)&&(this._updateVolumeSource(),!(this._isPollingInputVolume||!this._inputVolumeAnalyser))){var p=this._inputVolumeAnalyser.frequencyBinCount,m=new Uint8Array(p);this._isPollingInputVolume=!0;var v=function(){if(f._isPollingInputVolume){if(f._inputVolumeAnalyser){f._inputVolumeAnalyser.getByteFrequencyData(m);var x=a.average(m);f.emit("inputVolume",x/255)}requestAnimationFrame(v)}};requestAnimationFrame(v)}},d.prototype._maybeStopPollingVolume=function(){this.isVolumeSupported&&(!this._isPollingInputVolume||this.inputStream&&this.listenerCount("inputVolume")||(this._inputVolumeSource&&(this._inputVolumeSource.disconnect(),delete this._inputVolumeSource),this._isPollingInputVolume=!1))},d.prototype._openDefaultDeviceWithConstraints=function(f){var p=this;return this._log.info("Opening default device with constraints",f),this._getUserMedia(f).then(function(m){return p._log.info("Opened default device. Updating available devices."),p._updateAvailableDevices().catch(function(v){p._log.warn("Unable to updateAvailableDevices after gUM call",v)}),p._defaultInputDeviceStream=m,p._maybeCreateProcessedStream(m)})},d.prototype._stopDefaultInputDeviceStream=function(){this._defaultInputDeviceStream&&(this._log.info("stopping default device stream"),this._defaultInputDeviceStream.getTracks().forEach(function(f){return f.stop()}),this._defaultInputDeviceStream=null,this._destroyProcessedStream())},d.prototype._unbind=function(){if(!this._mediaDevices||!this._enumerateDevices)throw new r.NotSupportedError("Enumeration is not supported");this._mediaDevices.removeEventListener&&this._mediaDevices.removeEventListener("devicechange",this._updateAvailableDevices)},d.prototype._updateUserOptions=function(f){typeof f.enumerateDevices=="function"&&(this._enumerateDevices=f.enumerateDevices),typeof f.getUserMedia=="function"&&(this._getUserMedia=f.getUserMedia)},d.prototype.addProcessor=function(f){if(this._log.debug(".addProcessor"),this._processor)throw new r.NotSupportedError("Adding multiple AudioProcessors is not supported at this time.");if(typeof f!="object"||f===null)throw new r.InvalidArgumentError("Missing AudioProcessor argument.");if(typeof f.createProcessedStream!="function")throw new r.InvalidArgumentError("Missing createProcessedStream() method.");if(typeof f.destroyProcessedStream!="function")throw new r.InvalidArgumentError("Missing destroyProcessedStream() method.");return this._processor=f,this._audioProcessorEventObserver.emit("add"),this._restartStreams()},d.prototype.disconnect=function(f){return this._log.debug(".disconnect",f),this._maybeEnableSound(t.default.SoundName.Disconnect,f)},d.prototype.incoming=function(f){return this._log.debug(".incoming",f),this._maybeEnableSound(t.default.SoundName.Incoming,f)},d.prototype.outgoing=function(f){return this._log.debug(".outgoing",f),this._maybeEnableSound(t.default.SoundName.Outgoing,f)},d.prototype.removeProcessor=function(f){if(this._log.debug(".removeProcessor"),typeof f!="object"||f===null)throw new r.InvalidArgumentError("Missing AudioProcessor argument.");if(this._processor!==f)throw new r.InvalidArgumentError("Cannot remove an AudioProcessor that has not been previously added.");return this._destroyProcessedStream(),this._processor=null,this._audioProcessorEventObserver.emit("remove"),this._restartStreams()},d.prototype.setAudioConstraints=function(f){return this._log.debug(".setAudioConstraints",f),this._audioConstraints=Object.assign({},f),delete this._audioConstraints.deviceId,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()},d.prototype.setInputDevice=function(f){return this._log.debug(".setInputDevice",f),this._setInputDevice(f,!1)},d.prototype.unsetAudioConstraints=function(){return this._log.debug(".unsetAudioConstraints"),this._audioConstraints=null,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()},d.prototype.unsetInputDevice=function(){var f=this;return this._log.debug(".unsetInputDevice",this.inputDevice),this.inputDevice?(this._destroyProcessedStream(),this._onActiveInputChanged(null).then(function(){f._replaceStream(null),f._inputDevice=null,f._maybeStopPollingVolume()})):Promise.resolve()},d.prototype._destroyProcessedStream=function(){if(this._processor&&this._processedStream){this._log.info("destroying processed stream");var f=this._processedStream;this._processedStream.getTracks().forEach(function(p){return p.stop()}),this._processedStream=null,this._processor.destroyProcessedStream(f),this._audioProcessorEventObserver.emit("destroy")}},d.prototype._getUnknownDeviceIndex=function(f){var p=f.deviceId,m=f.kind,v=this._unknownDeviceIndexes[m][p];return v||(v=Object.keys(this._unknownDeviceIndexes[m]).length+1,this._unknownDeviceIndexes[m][p]=v),v},d.prototype._initializeEnumeration=function(){var f=this;if(!this._mediaDevices||!this._enumerateDevices)throw new r.NotSupportedError("Enumeration is not supported");this._mediaDevices.addEventListener&&this._mediaDevices.addEventListener("devicechange",this._updateAvailableDevices),this._updateAvailableDevices().then(function(){f.isOutputSelectionSupported&&Promise.all([f.speakerDevices.set("default"),f.ringtoneDevices.set("default")]).catch(function(p){f._log.warn("Warning: Unable to set audio output devices. "+p)})})},d.prototype._maybeCreateProcessedStream=function(f){var p=this;return this._processor?(this._log.info("Creating processed stream"),this._processor.createProcessedStream(f).then(function(m){return p._processedStream=m,p._audioProcessorEventObserver.emit("create"),p._processedStream})):Promise.resolve(f)},d.prototype._maybeEnableSound=function(f,p){return typeof p!="undefined"&&(this._enabledSounds[f]=p),this._enabledSounds[f]},d.prototype._replaceStream=function(f){this._log.info("Replacing with new stream."),this._selectedInputDeviceStream&&(this._log.info("Old stream detected. Stopping tracks."),this._stopSelectedInputDeviceStream()),this._selectedInputDeviceStream=f},d.prototype._restartStreams=function(){if(this.inputDevice&&this._selectedInputDeviceStream)return this._log.info("Restarting selected input device"),this._setInputDevice(this.inputDevice.deviceId,!0);if(this._defaultInputDeviceStream){var f=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return this._log.info("Restarting default input device, now becoming selected."),this._setInputDevice(f.deviceId,!0)}return Promise.resolve()},d.prototype._setInputDevice=function(f,p){var m=this;if(typeof f!="string")return Promise.reject(new r.InvalidArgumentError("Must specify the device to set"));var v=this.availableInputDevices.get(f);if(!v)return Promise.reject(new r.InvalidArgumentError("Device not found: "+f));if(this._log.info("Setting input device. ID: "+f),this._inputDevice&&this._inputDevice.deviceId===f&&this._selectedInputDeviceStream){if(!p)return Promise.resolve();this._log.info("Same track detected on setInputDevice, stopping old tracks."),this._stopSelectedInputDeviceStream()}this._stopDefaultInputDeviceStream();var x={audio:Object.assign({deviceId:{exact:f}},this.audioConstraints)};return this._log.info("setInputDevice: getting new tracks."),this._getUserMedia(x).then(function(b){return m._destroyProcessedStream(),m._maybeCreateProcessedStream(b).then(function(_){return m._log.info("setInputDevice: invoking _onActiveInputChanged."),m._onActiveInputChanged(_).then(function(){m._replaceStream(b),m._inputDevice=v,m._maybeStartPollingVolume()})})})},d.prototype._stopSelectedInputDeviceStream=function(){this._selectedInputDeviceStream&&(this._log.info("Stopping selected device stream"),this._selectedInputDeviceStream.getTracks().forEach(function(f){return f.stop()}))},d.prototype._updateDevices=function(f,p,m){var v=this,x=f.map(function(w){return w.deviceId}),b=Array.from(p.values()).map(function(w){return w.deviceId}),_=[],M=a.difference(b,x);M.forEach(function(w){var y=p.get(w);y&&(p.delete(w),m(y)&&_.push(y))});var h=!1;f.forEach(function(w){var y=p.get(w.deviceId),E=v._wrapMediaDeviceInfo(w);(!y||y.label!==E.label)&&(p.set(w.deviceId,E),h=!0)}),(h||M.length)&&(this.inputDevice!==null&&this.inputDevice.deviceId==="default"&&(this._log.warn("Calling getUserMedia after device change to ensure that the           tracks of the active device (default) have not gone stale."),this._setInputDevice(this.inputDevice.deviceId,!0)),this._log.debug("#deviceChange",_),this.emit("deviceChange",_))},d.prototype._updateVolumeSource=function(){if(!(!this.inputStream||!this._audioContext||!this._inputVolumeAnalyser)){this._inputVolumeSource&&this._inputVolumeSource.disconnect();try{this._inputVolumeSource=this._audioContext.createMediaStreamSource(this.inputStream),this._inputVolumeSource.connect(this._inputVolumeAnalyser)}catch(f){this._log.warn("Unable to update volume source",f),delete this._inputVolumeSource}}},d.prototype._wrapMediaDeviceInfo=function(f){var p={deviceId:f.deviceId,groupId:f.groupId,kind:f.kind,label:f.label};if(!p.label)if(p.deviceId==="default")p.label="Default";else{var m=this._getUnknownDeviceIndex(f);p.label="Unknown "+l[p.kind]+" Device "+m}return new o.default(p)},d}(e.EventEmitter);return c||(c={}),gf.default=c,gf}var nm={},cX=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(nm,"__esModule",{value:!0});nm.AudioProcessorEventObserver=void 0;var uX=oi,dX=Cn,fX=function(n){cX(e,n);function e(){var t=n.call(this)||this;return t._log=new dX.default("AudioProcessorEventObserver"),t._log.info("Creating AudioProcessorEventObserver instance"),t.on("enabled",function(){return t._reEmitEvent("enabled")}),t.on("add",function(){return t._reEmitEvent("add")}),t.on("remove",function(){return t._reEmitEvent("remove")}),t.on("create",function(){return t._reEmitEvent("create-processed-stream")}),t.on("destroy",function(){return t._reEmitEvent("destroy-processed-stream")}),t}return e.prototype.destroy=function(){this.removeAllListeners()},e.prototype._reEmitEvent=function(t){this._log.info("AudioProcessor:"+t),this.emit("event",{name:t,group:"audio-processor"})},e}(uX.EventEmitter);nm.AudioProcessorEventObserver=fX;var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0});var hX=pn,pX={dtmf0:[1360,960],dtmf1:[1230,720],dtmf2:[1360,720],dtmf3:[1480,720],dtmf4:[1230,790],dtmf5:[1360,790],dtmf6:[1480,790],dtmf7:[1230,870],dtmf8:[1360,870],dtmf9:[1480,870],dtmfh:[1480,960],dtmfs:[1230,960]},mX=function(){function n(e){var t=this;this._context=e,this._gainNodes=[],this._gainNodes=[this._context.createGain(),this._context.createGain()],this._gainNodes.forEach(function(r){r.connect(t._context.destination),r.gain.value=.1,t._gainNodes.push(r)})}return n.prototype.cleanup=function(){this._gainNodes.forEach(function(e){e.disconnect()})},n.prototype.play=function(e){var t=this,r=pX[e];if(!r)throw new hX.InvalidArgumentError("Invalid DTMF sound name");var i=[this._context.createOscillator(),this._context.createOscillator()];i.forEach(function(s,o){s.type="sine",s.frequency.value=r[o],s.connect(t._gainNodes[o]),s.start(),s.stop(t._context.currentTime+.1),s.addEventListener("ended",function(){return s.disconnect()})})},n}();Jv.default=mX;var Kv={},Gv={};Object.defineProperty(Gv,"__esModule",{value:!0});function gX(n,e,t){var r=JSON.stringify(e.body||{}),i=new Headers;e.headers=e.headers||[],Object.entries(e.headers).forEach(function(s){var o=s[0],a=s[1];return i.append(o,a)}),fetch(e.url,{body:r,headers:i,method:n}).then(function(s){return s.text()},t).then(function(s){return t(null,s)},t)}var Yv=gX;Yv.get=function(e,t){return new this("GET",e,t)};Yv.post=function(e,t){return new this("POST",e,t)};Gv.default=Yv;var yX=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Kv,"__esModule",{value:!0});var vX=oi,bX=Cn,wX=Gv,Vr=function(n){yX(e,n);function e(t,r,i){var s=n.call(this)||this;if(!(s instanceof e))return new e(t,r,i);i=Object.assign({defaultPayload:function(){return{}}},i);var o=i.defaultPayload;typeof o!="function"&&(o=function(){return Object.assign({},i.defaultPayload)});var a=!0,l=Object.assign({app_name:void 0,app_version:void 0},i.metadata);return Object.defineProperties(s,{_defaultPayload:{value:o},_host:{value:i.host,writable:!0},_isEnabled:{get:function(){return a},set:function(c){a=c}},_log:{value:new bX.default("EventPublisher")},_request:{value:i.request||wX.default,writable:!0},_token:{value:r,writable:!0},isEnabled:{enumerable:!0,get:function(){return a}},metadata:{enumerable:!0,get:function(){return l}},productName:{enumerable:!0,value:t},token:{enumerable:!0,get:function(){return this._token}}}),s}return e}(vX.EventEmitter);Vr.prototype._post=function(e,t,r,i,s,o,a){var l=this;if(!this.isEnabled&&!a||!this._host)return this._log.debug("Publishing cancelled",JSON.stringify({isEnabled:this.isEnabled,force:a,host:this._host})),Promise.resolve();if(!o||(!o.parameters||!o.parameters.CallSid)&&!o.outboundConnectionId)return o?this._log.debug("Publishing cancelled. Missing connection info",JSON.stringify({outboundConnectionId:o.outboundConnectionId,parameters:o.parameters})):this._log.debug("Publishing cancelled. Missing connection object"),Promise.resolve();var c={group:r,level:t.toUpperCase(),name:i,payload:s&&s.forEach?s.slice(0):Object.assign(this._defaultPayload(o),s),payload_type:"application/json",private:!1,publisher:this.productName,timestamp:new Date().toISOString()};this.metadata&&(c.publisher_metadata=this.metadata),e==="EndpointEvents"&&this._log.debug("Publishing insights",JSON.stringify({endpointName:e,event:c,force:a,host:this._host}));var u={body:c,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token},url:"https://"+this._host+"/v4/"+e};return new Promise(function(d,f){l._request.post(u,function(p){p?(l.emit("error",p),f(p)):d()})}).catch(function(d){l._log.error("Unable to post "+r+" "+i+" event to Insights. Received error: "+d)})};Vr.prototype.post=function(e,t,r,i,s,o){return this._post("EndpointEvents",e,t,r,i,s,o)};Vr.prototype.debug=function(e,t,r,i){return this.post("debug",e,t,r,i)};Vr.prototype.info=function(e,t,r,i){return this.post("info",e,t,r,i)};Vr.prototype.warn=function(e,t,r,i){return this.post("warning",e,t,r,i)};Vr.prototype.error=function(e,t,r,i){return this.post("error",e,t,r,i)};Vr.prototype.postMetrics=function(e,t,r,i,s){var o=this;return new Promise(function(a){var l=r.map(xX).map(function(c){return Object.assign(c,i)});a(o._post("EndpointMetrics","info",e,t,l,s))})};Vr.prototype.setHost=function(e){this._host=e};Vr.prototype.setToken=function(e){this._token=e};Vr.prototype.enable=function(){this._isEnabled=!0};Vr.prototype.disable=function(){this._isEnabled=!1};function xX(n){return{audio_codec:n.codecName,audio_level_in:n.audioInputLevel,audio_level_out:n.audioOutputLevel,bytes_received:n.bytesReceived,bytes_sent:n.bytesSent,call_volume_input:n.inputVolume,call_volume_output:n.outputVolume,jitter:n.jitter,mos:n.mos&&Math.round(n.mos*100)/100,packets_lost:n.packetsLost,packets_lost_fraction:n.packetsLostFraction&&Math.round(n.packetsLostFraction*100)/100,packets_received:n.packetsReceived,rtt:n.rtt,timestamp:new Date(n.timestamp).toISOString(),total_bytes_received:n.totals.bytesReceived,total_bytes_sent:n.totals.bytesSent,total_packets_lost:n.totals.packetsLost,total_packets_received:n.totals.packetsReceived,total_packets_sent:n.totals.packetsSent}}Kv.default=Vr;var Bg={},la={},Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});var LS=32767,jS=typeof window!="undefined"?window.RTCStatsReport:void 0;function Qr(n){if(!(this instanceof Qr))return new Qr(n);var e=this;Object.defineProperties(this,{_map:{value:n},size:{enumerable:!0,get:function(){return e._map.size}}}),this[Symbol.iterator]=n[Symbol.iterator]}jS&&(Qr.prototype=Object.create(jS.prototype),Qr.prototype.constructor=Qr);["entries","forEach","get","has","keys","values"].forEach(function(n){Qr.prototype[n]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._map)[n].apply(e,t)}});Qr.fromArray=function(e){return new Qr(e.reduce(function(t,r){return t.set(r.id,r),t},new Map))};Qr.fromRTCStatsResponse=function(e){var t,r=new Map,i=e.result().reduce(function(o,a){var l=a.id;switch(a.type){case"googCertificate":o.set(l,TX(a));break;case"datachannel":o.set(l,AX(a));break;case"googCandidatePair":AM(a,"googActiveConnection")&&(t=l),o.set(l,EX(a));break;case"localcandidate":o.set(l,HS(a,!1));break;case"remotecandidate":o.set(l,HS(a,!0));break;case"ssrc":Go(a,"packetsReceived")?o.set("rtp-"+l,CX(a)):o.set("rtp-"+l,kX(a)),o.set("track-"+l,_X(a)),o.set("codec-"+l,SX(a));break;case"googComponent":var c=FS(a);r.set(c.selectedCandidatePairId,l),o.set(l,FS(a));break}return o},new Map);if(t){var s=r.get(t);s&&(i.get(s).dtlsState="connected")}return new Qr(i)};function FS(n){return{bytesReceived:void 0,bytesSent:void 0,dtlsState:void 0,id:n.id,localCertificateId:n.stat("localCertificateId"),remoteCertificateId:n.stat("remoteCertificateId"),rtcpTransportStatsId:void 0,selectedCandidatePairId:n.stat("selectedCandidatePairId"),timestamp:Date.parse(n.timestamp),type:"transport"}}function SX(n){return{channels:void 0,clockRate:void 0,id:n.id,implementation:void 0,mimeType:n.stat("mediaType")+"/"+n.stat("googCodecName"),payloadType:void 0,sdpFmtpLine:void 0,timestamp:Date.parse(n.timestamp),type:"codec"}}function _X(n){return{audioLevel:Go(n,"audioOutputLevel")?ut(n,"audioOutputLevel")/LS:(ut(n,"audioInputLevel")||0)/LS,detached:void 0,echoReturnLoss:W1(n,"googEchoCancellationReturnLoss"),echoReturnLossEnhancement:W1(n,"googEchoCancellationReturnLossEnhancement"),ended:void 0,frameHeight:Go(n,"googFrameHeightReceived")?ut(n,"googFrameHeightReceived"):ut(n,"googFrameHeightSent"),frameWidth:Go(n,"googFrameWidthReceived")?ut(n,"googFrameWidthReceived"):ut(n,"googFrameWidthSent"),framesCorrupted:void 0,framesDecoded:ut(n,"framesDecoded"),framesDropped:void 0,framesPerSecond:void 0,framesReceived:void 0,framesSent:ut(n,"framesEncoded"),fullFramesLost:void 0,id:n.id,kind:n.stat("mediaType"),partialFramesLost:void 0,remoteSource:void 0,ssrcIds:void 0,timestamp:Date.parse(n.timestamp),trackIdentifier:n.stat("googTrackId"),type:"track"}}function TM(n,e){return{associateStatsId:void 0,codecId:"codec-"+n.id,firCount:e?ut(n,"googFirsSent"):void 0,id:n.id,isRemote:void 0,mediaType:n.stat("mediaType"),nackCount:e?ut(n,"googNacksSent"):ut(n,"googNacksReceived"),pliCount:e?ut(n,"googPlisSent"):ut(n,"googPlisReceived"),qpSum:ut(n,"qpSum"),sliCount:void 0,ssrc:n.stat("ssrc"),timestamp:Date.parse(n.timestamp),trackId:"track-"+n.id,transportId:n.stat("transportId")}}function CX(n){var e=TM(n,!0);return Object.assign(e,{burstDiscardCount:void 0,burstDiscardRate:void 0,burstLossCount:void 0,burstLossRate:void 0,burstPacketsDiscarded:void 0,burstPacketsLost:void 0,bytesReceived:ut(n,"bytesReceived"),fractionLost:void 0,framesDecoded:ut(n,"framesDecoded"),gapDiscardRate:void 0,gapLossRate:void 0,jitter:U1(n.stat("googJitterReceived")),packetsDiscarded:void 0,packetsLost:ut(n,"packetsLost"),packetsReceived:ut(n,"packetsReceived"),packetsRepaired:void 0,roundTripTime:U1(n.stat("googRtt")),type:"inbound-rtp"}),e}function kX(n){var e=TM(n,!1);return Object.assign(e,{bytesSent:ut(n,"bytesSent"),framesEncoded:ut(n,"framesEncoded"),packetsSent:ut(n,"packetsSent"),remoteTimestamp:void 0,targetBitrate:void 0,type:"outbound-rtp"}),e}function HS(n,e){return{candidateType:MX(n.stat("candidateType")),deleted:void 0,id:n.id,ip:n.stat("ipAddress"),isRemote:e,port:ut(n,"portNumber"),priority:W1(n,"priority"),protocol:n.stat("transport"),relayProtocol:void 0,timestamp:Date.parse(n.timestamp),transportId:void 0,type:e?"remote-candidate":"local-candidate",url:void 0}}function EX(n){return{availableIncomingBitrate:void 0,availableOutgoingBitrate:void 0,bytesReceived:ut(n,"bytesReceived"),bytesSent:ut(n,"bytesSent"),consentRequestsSent:ut(n,"consentRequestsSent"),currentRoundTripTime:U1(n.stat("googRtt")),id:n.id,lastPacketReceivedTimestamp:void 0,lastPacketSentTimestamp:void 0,localCandidateId:n.stat("localCandidateId"),nominated:void 0,priority:void 0,readable:void 0,remoteCandidateId:n.stat("remoteCandidateId"),requestsReceived:ut(n,"requestsReceived"),requestsSent:ut(n,"requestsSent"),responsesReceived:ut(n,"responsesReceived"),responsesSent:ut(n,"responsesSent"),retransmissionsReceived:void 0,retransmissionsSent:void 0,state:void 0,timestamp:Date.parse(n.timestamp),totalRoundTripTime:void 0,transportId:n.stat("googChannelId"),type:"candidate-pair",writable:AM(n,"googWritable")}}function TX(n){return{base64Certificate:n.stat("googDerBase64"),fingerprint:n.stat("googFingerprint"),fingerprintAlgorithm:n.stat("googFingerprintAlgorithm"),id:n.id,issuerCertificateId:n.stat("googIssuerId"),timestamp:Date.parse(n.timestamp),type:"certificate"}}function AX(n){return{bytesReceived:void 0,bytesSent:void 0,datachannelid:n.stat("datachannelid"),id:n.id,label:n.stat("label"),messagesReceived:void 0,messagesSent:void 0,protocol:n.stat("protocol"),state:n.stat("state"),timestamp:Date.parse(n.timestamp),transportId:n.stat("transportId"),type:"data-channel"}}function U1(n){return isNaN(n)||n===""?void 0:parseInt(n,10)/1e3}function MX(n){switch(n){case"peerreflexive":return"prflx";case"serverreflexive":return"srflx";case"host":case"relay":default:return n}}function ut(n,e){var t=n.stat(e);return Go(n,e)?parseInt(t,10):void 0}function W1(n,e){var t=n.stat(e);return Go(n,e)?parseFloat(t):void 0}function AM(n,e){var t=n.stat(e);return Go(n,e)?t==="true"||t===!0:void 0}function Go(n,e){var t=n.stat(e);return typeof t!="undefined"&&t!==""}Xv.default=Qr;var RX=be&&be.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r};Object.defineProperty(la,"__esModule",{value:!0});la.getRTCIceCandidateStatsReport=la.getRTCStats=void 0;var BS=pn,IX=Xv,OX="PeerConnection is null",PX="WebRTC statistics are unsupported";function _a(n,e){return typeof n.get=="function"?n.get(e):n.find(function(t){return t.id===e})}function MM(n){if(!n)return Promise.reject(new BS.InvalidArgumentError(OX));if(typeof n.getStats!="function")return Promise.reject(new BS.NotSupportedError(PX));var e;try{e=n.getStats()}catch(t){e=new Promise(function(r){return n.getStats(r)}).then(IX.default.fromRTCStatsResponse)}return e}function DX(n,e){return e=Object.assign({createRTCSample:LX},e),MM(n).then(e.createRTCSample)}la.getRTCStats=DX;function $X(n){return MM(n).then(function(e){var t=Array.from(e.values()).reduce(function(c,u){switch(["candidatePairs","localCandidates","remoteCandidates"].forEach(function(d){c[d]||(c[d]=[])}),u.type){case"candidate-pair":c.candidatePairs.push(u);break;case"local-candidate":c.localCandidates.push(u);break;case"remote-candidate":c.remoteCandidates.push(u);break;case"transport":u.selectedCandidatePairId&&(c.transport=u);break}return c},{}),r=t.candidatePairs,i=t.localCandidates,s=t.remoteCandidates,o=t.transport,a=r.find(function(c){return c.selected||o&&c.id===o.selectedCandidatePairId}),l;return a&&(l={localCandidate:i.find(function(c){return c.id===a.localCandidateId}),remoteCandidate:s.find(function(c){return c.id===a.remoteCandidateId})}),{iceCandidateStats:RX(i,s),selectedIceCandidatePairStats:l}})}la.getRTCIceCandidateStatsReport=$X;function NX(){}function LX(n){var e=null,t=new NX,r;Array.from(n.values()).forEach(function(l){if(!l.isRemote){var c=l.type.replace("-","");if(r=r||l.timestamp,l.remoteId){var u=_a(n,l.remoteId);u&&u.roundTripTime&&(t.rtt=u.roundTripTime*1e3)}switch(c){case"inboundrtp":t.timestamp=t.timestamp||l.timestamp,t.jitter=l.jitter*1e3,t.packetsLost=l.packetsLost,t.packetsReceived=l.packetsReceived,t.bytesReceived=l.bytesReceived;break;case"outboundrtp":if(t.timestamp=l.timestamp,t.packetsSent=l.packetsSent,t.bytesSent=l.bytesSent,l.codecId){var d=_a(n,l.codecId);t.codecName=d?d.mimeType&&d.mimeType.match(/(.*\/)?(.*)/)[2]:l.codecId}break;case"transport":e=l.id;break}}}),t.timestamp||(t.timestamp=r);var i=_a(n,e);if(!i)return t;var s=_a(n,i.selectedCandidatePairId);if(!s)return t;var o=_a(n,s.localCandidateId),a=_a(n,s.remoteCandidateId);return t.rtt||(t.rtt=s&&s.currentRoundTripTime*1e3),Object.assign(t,{localAddress:o&&(o.address||o.ip),remoteAddress:a&&(a.address||a.ip)}),t}var zS;function RM(){return zS||(zS=1,function(n){var e=be&&be.__extends||function(){var p=function(m,v){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,b){x.__proto__=b}||function(x,b){for(var _ in b)Object.prototype.hasOwnProperty.call(b,_)&&(x[_]=b[_])},p(m,v)};return function(m,v){p(m,v);function x(){this.constructor=m}m.prototype=v===null?Object.create(v):(x.prototype=v.prototype,new x)}}(),t=be&&be.__assign||function(){return t=Object.assign||function(p){for(var m,v=1,x=arguments.length;v<x;v++){m=arguments[v];for(var b in m)Object.prototype.hasOwnProperty.call(m,b)&&(p[b]=m[b])}return p},t.apply(this,arguments)},r=be&&be.__awaiter||function(p,m,v,x){function b(_){return _ instanceof v?_:new v(function(M){M(_)})}return new(v||(v=Promise))(function(_,M){function h(E){try{y(x.next(E))}catch(g){M(g)}}function w(E){try{y(x.throw(E))}catch(g){M(g)}}function y(E){E.done?_(E.value):b(E.value).then(h,w)}y((x=x.apply(p,m||[])).next())})},i=be&&be.__generator||function(p,m){var v={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},x,b,_,M;return M={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function h(y){return function(E){return w([y,E])}}function w(y){if(x)throw new TypeError("Generator is already executing.");for(;v;)try{if(x=1,b&&(_=y[0]&2?b.return:y[0]?b.throw||((_=b.return)&&_.call(b),0):b.next)&&!(_=_.call(b,y[1])).done)return _;switch(b=0,_&&(y=[y[0]&2,_.value]),y[0]){case 0:case 1:_=y;break;case 4:return v.label++,{value:y[1],done:!1};case 5:v.label++,b=y[1],y=[0];continue;case 7:y=v.ops.pop(),v.trys.pop();continue;default:if(_=v.trys,!(_=_.length>0&&_[_.length-1])&&(y[0]===6||y[0]===2)){v=0;continue}if(y[0]===3&&(!_||y[1]>_[0]&&y[1]<_[3])){v.label=y[1];break}if(y[0]===6&&v.label<_[1]){v.label=_[1],_=y;break}if(_&&v.label<_[2]){v.label=_[2],v.ops.push(y);break}_[2]&&v.ops.pop(),v.trys.pop();continue}y=m.call(p,v)}catch(E){y=[6,E],b=0}finally{x=_=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.PreflightTest=void 0;var s=oi,o=ub(),a=om(),l=pn,c=Cn,u=la,d=fn,f=function(p){e(m,p);function m(v,x){var b=p.call(this)||this;b._hasInsightsErrored=!1,b._log=new c.default("PreflightTest"),b._networkTiming={},b._options={codecPreferences:[o.default.Codec.PCMU,o.default.Codec.Opus],edge:"roaming",fakeMicInput:!1,logLevel:"error",signalingTimeoutMs:1e4},b._status=m.Status.Connecting,Object.assign(b._options,x),b._samples=[],b._warnings=[],b._startTime=Date.now(),b._initDevice(v,t(t({},b._options),{fileInputStream:b._options.fakeMicInput?b._getStreamFromFile():void 0}));var _=["codecPreferences","edge","fakeMicInput","logLevel","signalingTimeoutMs"],M=["audioContext","deviceFactory","fileInputStream","getRTCIceCandidateStatsReport","iceServers","rtcConfiguration"];if(typeof x=="object"){var h=t({},x);Object.keys(h).forEach(function(w){!_.includes(w)&&!M.includes(w)&&delete h[w],M.includes(w)&&(h[w]=!0)}),b._log.debug(".constructor",JSON.stringify(h))}return b}return m.prototype.stop=function(){var v=this;this._log.debug(".stop");var x=new l.GeneralErrors.CallCancelledError;this._device?(this._device.once(a.default.EventName.Unregistered,function(){return v._onFailed(x)}),this._device.destroy()):this._onFailed(x)},m.prototype._emitWarning=function(v,x,b){var _={name:v,description:x};b&&(_.rtcWarning=b),this._warnings.push(_),this._log.debug("#"+m.Events.Warning,JSON.stringify(_)),this.emit(m.Events.Warning,_)},m.prototype._getCallQuality=function(v){return v>4.2?m.CallQuality.Excellent:v>=4.1&&v<=4.2?m.CallQuality.Great:v>=3.7&&v<=4?m.CallQuality.Good:v>=3.1&&v<=3.6?m.CallQuality.Fair:m.CallQuality.Degraded},m.prototype._getReport=function(){var v=this._getRTCStats(),x={start:this._startTime};this._endTime&&(x.end=this._endTime,x.duration=this._endTime-this._startTime);var b={callSid:this._callSid,edge:this._edge,iceCandidateStats:this._rtcIceCandidateStatsReport.iceCandidateStats,networkTiming:this._networkTiming,samples:this._samples,selectedEdge:this._options.edge,stats:v,testTiming:x,totals:this._getRTCSampleTotals(),warnings:this._warnings},_=this._rtcIceCandidateStatsReport.selectedIceCandidatePairStats;return _&&(b.selectedIceCandidatePairStats=_,b.isTurnRequired=_.localCandidate.candidateType==="relay"||_.remoteCandidate.candidateType==="relay"),v&&(b.callQuality=this._getCallQuality(v.mos.average)),b},m.prototype._getRTCSampleTotals=function(){if(this._latestSample)return t({},this._latestSample.totals)},m.prototype._getRTCStats=function(){var v=this._samples.findIndex(function(b){return typeof b.mos=="number"&&b.mos>0}),x=v>=0?this._samples.slice(v):[];if(!(!x||!x.length))return["jitter","mos","rtt"].reduce(function(b,_){var M,h=x.map(function(w){return w[_]});return t(t({},b),(M={},M[_]={average:Number((h.reduce(function(w,y){return w+y})/h.length).toPrecision(5)),max:Math.max.apply(Math,h),min:Math.min.apply(Math,h)},M))},{})},m.prototype._getStreamFromFile=function(){var v=this._options.audioContext;if(!v)throw new l.NotSupportedError("Cannot fake input audio stream: AudioContext is not supported by this browser.");var x=new Audio(d.COWBELL_AUDIO_URL);x.addEventListener("canplaythrough",function(){return x.play()}),typeof x.setAttribute=="function"&&x.setAttribute("crossorigin","anonymous");var b=v.createMediaElementSource(x),_=v.createMediaStreamDestination();return b.connect(_),_.stream},m.prototype._initDevice=function(v,x){var b=this;try{this._device=new(x.deviceFactory||a.default)(v,{codecPreferences:x.codecPreferences,edge:x.edge,fileInputStream:x.fileInputStream,logLevel:x.logLevel,preflight:!0}),this._device.once(a.default.EventName.Registered,function(){b._onDeviceRegistered()}),this._device.once(a.default.EventName.Error,function(_){b._onDeviceError(_)}),this._device.register()}catch(_){setTimeout(function(){b._onFailed(_)});return}this._signalingTimeoutTimer=setTimeout(function(){b._onDeviceError(new l.SignalingErrors.ConnectionError("WebSocket Connection Timeout"))},x.signalingTimeoutMs)},m.prototype._onDeviceError=function(v){this._device.destroy(),this._onFailed(v)},m.prototype._onDeviceRegistered=function(){return r(this,void 0,void 0,function(){var v,x,b,_=this;return i(this,function(M){switch(M.label){case 0:return clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),v=this,[4,this._device.connect({rtcConfiguration:this._options.rtcConfiguration})];case 1:return v._call=M.sent(),this._networkTiming.signaling={start:Date.now()},this._setupCallHandlers(this._call),this._edge=this._device.edge||void 0,this._options.fakeMicInput&&(this._echoTimer=setTimeout(function(){return _._device.disconnectAll()},d.ECHO_TEST_DURATION),x=this._device.audio,x&&(x.disconnect(!1),x.outgoing(!1))),this._call.once("disconnect",function(){_._device.once(a.default.EventName.Unregistered,function(){return _._onUnregistered()}),_._device.destroy()}),b=this._call._publisher,b.on("error",function(){_._hasInsightsErrored||_._emitWarning("insights-connection-error","Received an error when attempting to connect to Insights gateway"),_._hasInsightsErrored=!0}),[2]}})})},m.prototype._onFailed=function(v){clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=m.Status.Failed,this._log.debug("#"+m.Events.Failed,v),this.emit(m.Events.Failed,v)},m.prototype._onUnregistered=function(){var v=this;setTimeout(function(){v._status!==m.Status.Failed&&(clearTimeout(v._echoTimer),clearTimeout(v._signalingTimeoutTimer),v._releaseHandlers(),v._endTime=Date.now(),v._status=m.Status.Completed,v._report=v._getReport(),v._log.debug("#"+m.Events.Completed,JSON.stringify(v._report)),v.emit(m.Events.Completed,v._report))},10)},m.prototype._releaseHandlers=function(){[this._device,this._call].forEach(function(v){v&&v.eventNames().forEach(function(x){return v.removeAllListeners(x)})})},m.prototype._setupCallHandlers=function(v){var x=this;this._options.fakeMicInput&&v.once("volume",function(){v._mediaHandler.outputs.forEach(function(b){return b.audio.muted=!0})}),v.on("warning",function(b,_){x._emitWarning(b,"Received an RTCWarning. See .rtcWarning for the RTCWarning",_)}),v.once("accept",function(){x._callSid=v._mediaHandler.callSid,x._status=m.Status.Connected,x._log.debug("#"+m.Events.Connected),x.emit(m.Events.Connected)}),v.on("sample",function(b){return r(x,void 0,void 0,function(){var _;return i(this,function(M){switch(M.label){case 0:return this._latestSample?[3,2]:(_=this,[4,(this._options.getRTCIceCandidateStatsReport||u.getRTCIceCandidateStatsReport)(v._mediaHandler.version.pc)]);case 1:_._rtcIceCandidateStatsReport=M.sent(),M.label=2;case 2:return this._latestSample=b,this._samples.push(b),this._log.debug("#"+m.Events.Sample,JSON.stringify(b)),this.emit(m.Events.Sample,b),[2]}})})}),[{reportLabel:"peerConnection",type:"pcconnection"},{reportLabel:"ice",type:"iceconnection"},{reportLabel:"dtls",type:"dtlstransport"},{reportLabel:"signaling",type:"signaling"}].forEach(function(b){var _=b.type,M=b.reportLabel,h="on"+_+"statechange",w=v._mediaHandler[h];v._mediaHandler[h]=function(y){var E=x._networkTiming[M]=x._networkTiming[M]||{start:0};y==="connecting"||y==="checking"?E.start=Date.now():(y==="connected"||y==="stable")&&!E.duration&&(E.end=Date.now(),E.duration=E.end-E.start),w(y)}})},Object.defineProperty(m.prototype,"callSid",{get:function(){return this._callSid},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"endTime",{get:function(){return this._endTime},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"latestSample",{get:function(){return this._latestSample},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"report",{get:function(){return this._report},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"startTime",{get:function(){return this._startTime},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),m}(s.EventEmitter);n.PreflightTest=f,function(p){(function(m){m.Excellent="excellent",m.Great="great",m.Good="good",m.Fair="fair",m.Degraded="degraded"})(p.CallQuality||(p.CallQuality={})),function(m){m.Completed="completed",m.Connected="connected",m.Failed="failed",m.Sample="sample",m.Warning="warning"}(p.Events||(p.Events={})),function(m){m.Connecting="connecting",m.Connected="connected",m.Completed="completed",m.Failed="failed"}(p.Status||(p.Status={}))}(f=n.PreflightTest||(n.PreflightTest={})),n.PreflightTest=f}(Bg)),Bg}var Zv={},IM={};(function(n){var e=be&&be.__extends||function(){var b=function(_,M){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,w){h.__proto__=w}||function(h,w){for(var y in w)Object.prototype.hasOwnProperty.call(w,y)&&(h[y]=w[y])},b(_,M)};return function(_,M){b(_,M);function h(){this.constructor=_}_.prototype=M===null?Object.create(M):(h.prototype=M.prototype,new h)}}(),t=be&&be.__assign||function(){return t=Object.assign||function(b){for(var _,M=1,h=arguments.length;M<h;M++){_=arguments[M];for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&(b[w]=_[w])}return b},t.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.WSTransportState=void 0;var r=oi,i=tm,s=pn,o=Cn,a=globalThis.WebSocket,l=1e4,c=5e3,u=15e3,d=15e3,f=1/0,p=1e3,m=2e4,v;(function(b){b.Connecting="connecting",b.Closed="closed",b.Open="open"})(v=n.WSTransportState||(n.WSTransportState={}));var x=function(b){e(_,b);function _(M,h){h===void 0&&(h={});var w=b.call(this)||this;return w.state=v.Closed,w._backoffStartTime={preferred:null,primary:null},w._connectedUri=null,w._log=new o.default("WSTransport"),w._shouldFallback=!1,w._uriIndex=0,w._moveUriIndex=function(){w._uriIndex++,w._uriIndex>=w._uris.length&&(w._uriIndex=0)},w._onSocketClose=function(y){if(w._log.error("Received websocket close event code: "+y.code+". Reason: "+y.reason),y.code===1006||y.code===1015){w.emit("error",{code:31005,message:y.reason||"Websocket connection to Twilio's signaling servers were unexpectedly ended. If this is happening consistently, there may be an issue resolving the hostname provided. If a region or an edge is being specified in Device setup, ensure it is valid.",twilioError:new s.SignalingErrors.ConnectionError});var E=w.state===v.Open||w._previousState===v.Open;(w._shouldFallback||!E)&&w._moveUriIndex(),w._shouldFallback=!0}w._closeSocket()},w._onSocketError=function(y){w._log.error("WebSocket received error: "+y.message),w.emit("error",{code:31e3,message:y.message||"WSTransport socket error",twilioError:new s.SignalingErrors.ConnectionDisconnected})},w._onSocketMessage=function(y){if(w._setHeartbeatTimeout(),w._socket&&y.data===`
`){w._socket.send(`
`);return}w.emit("message",y)},w._onSocketOpen=function(){w._log.info("WebSocket opened successfully."),w._timeOpened=Date.now(),w._shouldFallback=!1,w._setState(v.Open),clearTimeout(w._connectTimeout),w._resetBackoffs(),w._setHeartbeatTimeout(),w.emit("open")},w._options=t(t({},_.defaultConstructorOptions),h),w._uris=M,w._backoff=w._setupBackoffs(),w}return _.prototype.close=function(){this._log.info("WSTransport.close() called..."),this._close()},_.prototype.open=function(){if(this._log.info("WSTransport.open() called..."),this._socket&&(this._socket.readyState===a.CONNECTING||this._socket.readyState===a.OPEN)){this._log.info("WebSocket already open.");return}this._preferredUri?this._connect(this._preferredUri):this._connect(this._uris[this._uriIndex])},_.prototype.send=function(M){if(!this._socket||this._socket.readyState!==a.OPEN)return!1;try{this._socket.send(M)}catch(h){return this._log.error("Error while sending message:",h.message),this._closeSocket(),!1}return!0},_.prototype.updatePreferredURI=function(M){this._preferredUri=M},_.prototype.updateURIs=function(M){typeof M=="string"&&(M=[M]),this._uris=M,this._uriIndex=0},_.prototype._close=function(){this._setState(v.Closed),this._closeSocket()},_.prototype._closeSocket=function(){if(clearTimeout(this._connectTimeout),clearTimeout(this._heartbeatTimeout),this._log.info("Closing and cleaning up WebSocket..."),!this._socket){this._log.info("No WebSocket to clean up.");return}this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("error",this._onSocketError),this._socket.removeEventListener("message",this._onSocketMessage),this._socket.removeEventListener("open",this._onSocketOpen),(this._socket.readyState===a.CONNECTING||this._socket.readyState===a.OPEN)&&this._socket.close(),this._timeOpened&&Date.now()-this._timeOpened>l&&this._resetBackoffs(),this.state!==v.Closed&&this._performBackoff(),delete this._socket,this.emit("close")},_.prototype._connect=function(M,h){var w=this;this._log.info(typeof h=="number"?"Attempting to reconnect (retry #"+h+")...":"Attempting to connect..."),this._closeSocket(),this._setState(v.Connecting),this._connectedUri=M;try{this._socket=new this._options.WebSocket(this._connectedUri)}catch(y){this._log.error("Could not connect to endpoint:",y.message),this._close(),this.emit("error",{code:31e3,message:y.message||"Could not connect to "+this._connectedUri,twilioError:new s.SignalingErrors.ConnectionDisconnected});return}this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("error",this._onSocketError),this._socket.addEventListener("message",this._onSocketMessage),this._socket.addEventListener("open",this._onSocketOpen),delete this._timeOpened,this._connectTimeout=setTimeout(function(){w._log.info("WebSocket connection attempt timed out."),w._moveUriIndex(),w._closeSocket()},this._options.connectTimeoutMs)},_.prototype._performBackoff=function(){this._preferredUri?(this._log.info("Preferred URI set; backing off."),this._backoff.preferred.backoff()):(this._log.info("Preferred URI not set; backing off."),this._backoff.primary.backoff())},_.prototype._resetBackoffs=function(){this._backoff.preferred.reset(),this._backoff.primary.reset(),this._backoffStartTime.preferred=null,this._backoffStartTime.primary=null},_.prototype._setHeartbeatTimeout=function(){var M=this;clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=setTimeout(function(){M._log.info("No messages received in "+u/1e3+" seconds. Reconnecting..."),M._shouldFallback=!0,M._closeSocket()},u)},_.prototype._setState=function(M){this._previousState=this.state,this.state=M},_.prototype._setupBackoffs=function(){var M=this,h={factor:2,jitter:.4,max:this._options.maxPreferredDelayMs,min:100};this._log.info("Initializing preferred transport backoff using config: ",h);var w=new i.default(h);w.on("backoff",function(g,I){if(M.state===v.Closed){M._log.info("Preferred backoff initiated but transport state is closed; not attempting a connection.");return}M._log.info("Will attempt to reconnect Websocket to preferred URI in "+I+"ms"),g===0&&(M._backoffStartTime.preferred=Date.now(),M._log.info("Preferred backoff start; "+M._backoffStartTime.preferred))}),w.on("ready",function(g,I){if(M.state===v.Closed){M._log.info("Preferred backoff ready but transport state is closed; not attempting a connection.");return}if(M._backoffStartTime.preferred===null){M._log.info("Preferred backoff start time invalid; not attempting a connection.");return}if(Date.now()-M._backoffStartTime.preferred>M._options.maxPreferredDurationMs){M._log.info("Max preferred backoff attempt time exceeded; falling back to primary backoff."),M._preferredUri=null,M._backoff.primary.backoff();return}if(typeof M._preferredUri!="string"){M._log.info("Preferred URI cleared; falling back to primary backoff."),M._preferredUri=null,M._backoff.primary.backoff();return}M._connect(M._preferredUri,g+1)});var y={factor:2,jitter:.4,max:this._options.maxPrimaryDelayMs,min:this._uris&&this._uris.length>1?Math.floor(Math.random()*4001)+1e3:100};this._log.info("Initializing primary transport backoff using config: ",y);var E=new i.default(y);return E.on("backoff",function(g,I){if(M.state===v.Closed){M._log.info("Primary backoff initiated but transport state is closed; not attempting a connection.");return}M._log.info("Will attempt to reconnect WebSocket in "+I+"ms"),g===0&&(M._backoffStartTime.primary=Date.now(),M._log.info("Primary backoff start; "+M._backoffStartTime.primary))}),E.on("ready",function(g,I){if(M.state===v.Closed){M._log.info("Primary backoff ready but transport state is closed; not attempting a connection.");return}if(M._backoffStartTime.primary===null){M._log.info("Primary backoff start time invalid; not attempting a connection.");return}if(Date.now()-M._backoffStartTime.primary>M._options.maxPrimaryDurationMs){M._log.info("Max primary backoff attempt time exceeded; not attempting a connection.");return}M._connect(M._uris[M._uriIndex],g+1)}),{preferred:w,primary:E}},Object.defineProperty(_.prototype,"uri",{get:function(){return this._connectedUri},enumerable:!1,configurable:!0}),_.defaultConstructorOptions={WebSocket:a,connectTimeoutMs:c,maxPreferredDelayMs:p,maxPreferredDurationMs:d,maxPrimaryDelayMs:m,maxPrimaryDurationMs:f},_}(r.EventEmitter);n.default=x})(IM);var jX=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Zv,"__esModule",{value:!0});var FX=oi,HX=fn,Qv=pn,BX=Cn,zX=IM,VX="1.6",qX=30,Rt=function(n){jX(e,n);function e(t,r,i){var s=n.call(this)||this;if(!(s instanceof e))return new e(t,r,i);var o={TransportFactory:zX.default};i=i||{};for(var a in o)a in i||(i[a]=o[a]);s.options=i,s.token=t||"",s.status="disconnected",s.gateway=null,s.region=null,s._messageQueue=[],s._preferredUri=null,s._uris=r,s._handleTransportClose=s._handleTransportClose.bind(s),s._handleTransportError=s._handleTransportError.bind(s),s._handleTransportMessage=s._handleTransportMessage.bind(s),s._handleTransportOpen=s._handleTransportOpen.bind(s),s._log=new BX.default("PStream"),s.on("error",function(){s._log.warn("Unexpected error handled in pstream")});var l=s;return s.addListener("ready",function(){l.status="ready"}),s.addListener("offline",function(){l.status="offline"}),s.addListener("close",function(){l._log.info('Received "close" from server. Destroying PStream...'),l._destroy()}),s.transport=new s.options.TransportFactory(s._uris,{backoffMaxMs:s.options.backoffMaxMs,maxPreferredDurationMs:s.options.maxPreferredDurationMs}),Object.defineProperties(s,{uri:{enumerable:!0,get:function(){return this.transport.uri}}}),s.transport.on("close",s._handleTransportClose),s.transport.on("error",s._handleTransportError),s.transport.on("message",s._handleTransportMessage),s.transport.on("open",s._handleTransportOpen),s.transport.open(),s}return e}(FX.EventEmitter);Rt.prototype._handleTransportClose=function(){this.emit("transportClose"),this.status!=="disconnected"&&(this.status!=="offline"&&this.emit("offline",this),this.status="disconnected")};Rt.prototype._handleTransportError=function(n){if(!n){this.emit("error",{error:{code:31e3,message:"Websocket closed without a provided reason",twilioError:new Qv.SignalingErrors.ConnectionDisconnected}});return}this.emit("error",typeof n.code!="undefined"?{error:n}:n)};Rt.prototype._handleTransportMessage=function(n){if(!(!n||!n.data||typeof n.data!="string")){var e=JSON.parse(n.data),t=e.type,r=e.payload,i=r===void 0?{}:r;this.gateway=i.gateway||this.gateway,this.region=i.region||this.region,t==="error"&&i.error&&(i.error.twilioError=new Qv.SignalingErrors.ConnectionError),this.emit(t,i)}};Rt.prototype._handleTransportOpen=function(){var n=this;this.status="connected",this.setToken(this.token),this.emit("transportOpen");var e=this._messageQueue.splice(0,this._messageQueue.length);e.forEach(function(t){return n._publish.apply(n,t)})};Rt.toString=function(){return"[Twilio.PStream class]"};Rt.prototype.toString=function(){return"[Twilio.PStream instance]"};Rt.prototype.setToken=function(n){this._log.info("Setting token and publishing listen"),this.token=n;var e=0,t=this.options.maxPreferredDurationMs;this._log.info("maxPreferredDurationMs:"+t),typeof t=="number"&&t>=0&&(e=Math.min(Math.ceil(t/1e3),qX)),this._log.info("reconnectTimeout:"+e);var r={browserinfo:UX(),reconnectTimeout:e,token:n};this._publish("listen",r)};Rt.prototype.sendMessage=function(n,e,t,r,i){t===void 0&&(t="application/json");var s={callsid:n,content:e,contenttype:t,messagetype:r,voiceeventsid:i};this._publish("message",s,!0)};Rt.prototype.register=function(n){var e={media:n};this._publish("register",e,!0)};Rt.prototype.invite=function(n,e,t,r){var i={callsid:e,preflight:!!t,sdp:n,twilio:r?{params:r}:{}};this._publish("invite",i,!0)};Rt.prototype.reconnect=function(n,e,t,r){var i={callsid:e,preflight:!1,reconnect:t,sdp:n,twilio:r?{params:r}:{}};this._publish("invite",i,!0)};Rt.prototype.answer=function(n,e){this._publish("answer",{sdp:n,callsid:e},!0)};Rt.prototype.dtmf=function(n,e){this._publish("dtmf",{callsid:n,dtmf:e},!0)};Rt.prototype.hangup=function(n,e){var t=e?{callsid:n,message:e}:{callsid:n};this._publish("hangup",t,!0)};Rt.prototype.reject=function(n){this._publish("reject",{callsid:n},!0)};Rt.prototype.reinvite=function(n,e){this._publish("reinvite",{sdp:n,callsid:e},!1)};Rt.prototype._destroy=function(){this.transport.removeListener("close",this._handleTransportClose),this.transport.removeListener("error",this._handleTransportError),this.transport.removeListener("message",this._handleTransportMessage),this.transport.removeListener("open",this._handleTransportOpen),this.transport.close(),this.emit("offline",this)};Rt.prototype.destroy=function(){return this._log.info("PStream.destroy() called..."),this._destroy(),this};Rt.prototype.updatePreferredURI=function(n){this._preferredUri=n,this.transport.updatePreferredURI(n)};Rt.prototype.updateURIs=function(n){this._uris=n,this.transport.updateURIs(this._uris)};Rt.prototype.publish=function(n,e){return this._publish(n,e,!0)};Rt.prototype._publish=function(n,e,t){var r=JSON.stringify({payload:e,type:n,version:VX}),i=!!this.transport.send(r);i||(this.emit("error",{error:{code:31009,message:"No transport available to send or receive messages",twilioError:new Qv.GeneralErrors.TransportError}}),t&&this._messageQueue.push([n,e,!0]))};function UX(){var n=typeof navigator!="undefined"?navigator:{},e={browser:{platform:n.platform||"unknown",userAgent:n.userAgent||"unknown"},p:"browser",plugin:"rtc",v:HX.RELEASE_VERSION};return e}Zv.default=Rt;var OM={};(function(n){var e;Object.defineProperty(n,"__esModule",{value:!0}),n.getRegionShortcode=n.getChunderURIs=n.createSignalingEndpointURL=n.createEventGatewayURI=n.defaultEdge=n.regionToEdge=n.regionShortcodes=n.Region=n.Edge=void 0;var t=pn,r;(function(d){d.Sydney="sydney",d.SaoPaulo="sao-paulo",d.Dublin="dublin",d.Frankfurt="frankfurt",d.Tokyo="tokyo",d.Singapore="singapore",d.Ashburn="ashburn",d.Umatilla="umatilla",d.Roaming="roaming",d.AshburnIx="ashburn-ix",d.SanJoseIx="san-jose-ix",d.LondonIx="london-ix",d.FrankfurtIx="frankfurt-ix",d.SingaporeIx="singapore-ix",d.SydneyIx="sydney-ix",d.TokyoIx="tokyo-ix"})(r=n.Edge||(n.Edge={}));var i;(function(d){d.Au1="au1",d.Au1Ix="au1-ix",d.Br1="br1",d.De1="de1",d.De1Ix="de1-ix",d.Gll="gll",d.Ie1="ie1",d.Ie1Ix="ie1-ix",d.Ie1Tnx="ie1-tnx",d.Jp1="jp1",d.Jp1Ix="jp1-ix",d.Sg1="sg1",d.Sg1Ix="sg1-ix",d.Sg1Tnx="sg1-tnx",d.Us1="us1",d.Us1Ix="us1-ix",d.Us1Tnx="us1-tnx",d.Us2="us2",d.Us2Ix="us2-ix",d.Us2Tnx="us2-tnx"})(i=n.Region||(n.Region={})),n.regionShortcodes={ASIAPAC_SINGAPORE:i.Sg1,ASIAPAC_SYDNEY:i.Au1,ASIAPAC_TOKYO:i.Jp1,EU_FRANKFURT:i.De1,EU_IRELAND:i.Ie1,SOUTH_AMERICA_SAO_PAULO:i.Br1,US_EAST_VIRGINIA:i.Us1,US_WEST_OREGON:i.Us2},n.regionToEdge=(e={},e[i.Au1]=r.Sydney,e[i.Br1]=r.SaoPaulo,e[i.Ie1]=r.Dublin,e[i.De1]=r.Frankfurt,e[i.Jp1]=r.Tokyo,e[i.Sg1]=r.Singapore,e[i.Us1]=r.Ashburn,e[i.Us2]=r.Umatilla,e[i.Gll]=r.Roaming,e[i.Us1Ix]=r.AshburnIx,e[i.Us2Ix]=r.SanJoseIx,e[i.Ie1Ix]=r.LondonIx,e[i.De1Ix]=r.FrankfurtIx,e[i.Sg1Ix]=r.SingaporeIx,e[i.Au1Ix]=r.SydneyIx,e[i.Jp1Ix]=r.TokyoIx,e[i.Us1Tnx]=r.AshburnIx,e[i.Us2Tnx]=r.AshburnIx,e[i.Ie1Tnx]=r.LondonIx,e[i.Sg1Tnx]=r.SingaporeIx,e),n.defaultEdge=r.Roaming;var s="eventgw.twilio.com";function o(d){return"voice-js."+d+".twilio.com"}function a(d){return d?"eventgw."+d+".twilio.com":s}n.createEventGatewayURI=a;function l(d){return"wss://"+d+"/signal"}n.createSignalingEndpointURL=l;function c(d){if(d&&typeof d!="string"&&!Array.isArray(d))throw new t.InvalidArgumentError("If `edge` is provided, it must be of type `string` or an array of strings.");var f;if(d){var p=Array.isArray(d)?d:[d];f=p.map(function(m){return o(m)})}else f=[o(n.defaultEdge)];return f}n.getChunderURIs=c;function u(d){return n.regionShortcodes[d]||null}n.getRegionShortcode=u})(OM);var Wi={},eb={},rm={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.setMaxAverageBitrate=Ir.setIceAggressiveNomination=Ir.setCodecPreferences=Ir.getPreferredCodecInfo=void 0;var ih=nt,VS={0:"PCMU",8:"PCMA"},WX=111,JX=51e4,KX=6e3;function GX(n){var e=/a=rtpmap:(\d+) (\S+)/m.exec(n)||[null,"",""],t=e[1],r=e[2],i=new RegExp("a=fmtp:"+t+" (\\S+)","m"),s=i.exec(n)||[null,""],o=s[1];return{codecName:r,codecParams:o}}Ir.getPreferredCodecInfo=GX;function YX(n){return ih.isChrome(window,window.navigator)?n.split(`
`).filter(function(e){return e.indexOf("a=ice-lite")===-1}).join(`
`):n}Ir.setIceAggressiveNomination=YX;function XX(n,e){if(typeof e!="number"||e<KX||e>JX)return n;var t=/a=rtpmap:(\d+) opus/m.exec(n),r=t&&t.length?t[1]:WX,i=new RegExp("a=fmtp:"+r),s=n.split(`
`).map(function(o){return i.test(o)?o+(";maxaveragebitrate="+e):o});return s.join(`
`)}Ir.setMaxAverageBitrate=XX;function ZX(n,e){var t=QX(n),r=n.split(`\r
m=`)[0];return[r].concat(t.map(function(i){if(!/^m=(audio|video)/.test(i))return i;var s=i.match(/^m=(audio|video)/)[1],o=eZ(i),a=tZ(o,e),l=nZ(a,i),c=o.get("pcma")||[],u=o.get("pcmu")||[],d=s==="audio"?new Set(c.concat(u)):new Set;return d.has(a[0])?l.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):l})).join(`\r
`)}Ir.setCodecPreferences=ZX;function QX(n,e,t){return n.replace(/\r\n\r\n$/,`\r
`).split(`\r
m=`).slice(1).map(function(r){return"m="+r}).filter(function(r){var i=new RegExp("m="+(e||".*"),"gm"),s=new RegExp("a="+(t||".*"),"gm");return i.test(r)&&s.test(r)})}function eZ(n){return Array.from(rZ(n)).reduce(function(e,t){var r=t[0],i=t[1],s=e.get(i)||[];return e.set(i,s.concat(r))},new Map)}function tZ(n,e){e=e.map(function(s){return s.toLowerCase()});var t=ih.flatMap(e,function(s){return n.get(s)||[]}),r=ih.difference(Array.from(n.keys()),e),i=ih.flatMap(r,function(s){return n.get(s)});return t.concat(i)}function nZ(n,e){var t=e.split(`\r
`),r=t[0],i=t.slice(1);return r=r.replace(/([0-9]+\s?)+$/,n.join(" ")),[r].concat(i).join(`\r
`)}function rZ(n){return iZ(n).reduce(function(e,t){var r=new RegExp("a=rtpmap:"+t+" ([^/]+)"),i=n.match(r),s=i?i[1].toLowerCase():VS[t]?VS[t].toLowerCase():"";return e.set(t,s)},new Map)}function iZ(n){var e=n.split(`\r
`)[0],t=e.match(/([0-9]+)/g);return t?t.slice(1).map(function(r){return parseInt(r,10)}):[]}var PM={exports:{}};(function(n){var e={};e.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(function(r){return r.trim()})},e.splitSections=function(t){var r=t.split(`
m=`);return r.map(function(i,s){return(s>0?"m="+i:i).trim()+`\r
`})},e.getDescription=function(t){var r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){var r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(function(i){return i.indexOf(r)===0})},e.parseCandidate=function(t){var r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");for(var i={foundation:r[0],component:parseInt(r[1],10),protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]},s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]=r[s+1];break}return i},e.writeCandidate=function(t){var r=[];r.push(t.foundation),r.push(t.component),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);var i=t.type;return r.push("typ"),r.push(i),i!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substr(14).split(" ")},e.parseRtpMap=function(t){var r=t.substr(9).split(" "),i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){var r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);var i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){var r=t.substr(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1]}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+`\r
`},e.parseFmtp=function(t){for(var r={},i,s=t.substr(t.indexOf(" ")+1).split(";"),o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){var r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var s=[];Object.keys(t.parameters).forEach(function(o){t.parameters[o]?s.push(o+"="+t.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){var r=t.substr(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){var r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(function(s){r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){var r=t.indexOf(" "),i={ssrc:parseInt(t.substr(7,r-7),10)},s=t.indexOf(":",r);return s>-1?(i.attribute=t.substr(r+1,s-r-1),i.value=t.substr(s+1)):i.attribute=t.substr(r+1),i},e.parseSsrcGroup=function(t){var r=t.substr(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(function(i){return parseInt(i,10)})}},e.getMid=function(t){var r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substr(6)},e.parseFingerprint=function(t){var r=t.substr(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1]}},e.getDtlsParameters=function(t,r){var i=e.matchPrefix(t+r,"a=fingerprint:");return{role:"auto",fingerprints:i.map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){var i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(function(s){i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(t){var r=t.substr(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;var r=t.substr(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){var i=e.matchPrefix(t+r,"a=crypto:");return i.map(e.parseCryptoLine)},e.getIceParameters=function(t,r){var i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substr(12),password:s.substr(10)}:null},e.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`},e.parseRtpParameters=function(t){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=e.splitLines(t),s=i[0].split(" "),o=3;o<s.length;o++){var a=s[o],l=e.matchPrefix(t,"a=rtpmap:"+a+" ")[0];if(l){var c=e.parseRtpMap(l),u=e.matchPrefix(t,"a=fmtp:"+a+" ");switch(c.parameters=u.length?e.parseFmtp(u[0]):{},c.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+a+" ").map(e.parseRtcpFb),r.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(c.name.toUpperCase());break}}}return e.matchPrefix(t,"a=extmap:").forEach(function(d){r.headerExtensions.push(e.parseExtmap(d))}),r},e.writeRtpDescription=function(t,r){var i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=r.codecs.map(function(o){return o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType}).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(function(o){i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});var s=0;return r.codecs.forEach(function(o){o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),i+=`a=rtcp-mux\r
`,r.headerExtensions&&r.headerExtensions.forEach(function(o){i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(t){var r=[],i=e.parseRtpParameters(t),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(t,"a=ssrc:").map(function(f){return e.parseSsrcMedia(f)}).filter(function(f){return f.attribute==="cname"}),l=a.length>0&&a[0].ssrc,c,u=e.matchPrefix(t,"a=ssrc-group:FID").map(function(f){var p=f.substr(17).split(" ");return p.map(function(m){return parseInt(m,10)})});u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(function(f){if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){var p={ssrc:l,codecPayloadType:parseInt(f.parameters.apt,10)};l&&c&&(p.rtx={ssrc:c}),r.push(p),s&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:l,mechanism:o?"red+ulpfec":"red"},r.push(p))}}),r.length===0&&l&&r.push({ssrc:l});var d=e.matchPrefix(t,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substr(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substr(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(function(f){f.maxBitrate=d})),r},e.parseRtcpParameters=function(t){var r={},i=e.matchPrefix(t,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return a.attribute==="cname"})[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);var s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;var o=e.matchPrefix(t,"a=rtcp-mux");return r.mux=o.length>0,r},e.parseMsid=function(t){var r,i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substr(7).split(" "),{stream:r[0],track:r[1]};var s=e.matchPrefix(t,"a=ssrc:").map(function(o){return e.parseSsrcMedia(o)}).filter(function(o){return o.attribute==="msid"});if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){var r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:"),s;i.length>0&&(s=parseInt(i[0].substr(19),10)),isNaN(s)&&(s=65536);var o=e.matchPrefix(t,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:s};var a=e.matchPrefix(t,"a=sctpmap:");if(a.length>0){var l=e.matchPrefix(t,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){var i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,21)},e.writeSessionBoilerplate=function(t,r,i){var s,o=r!==void 0?r:2;t?s=t:s=e.generateSessionId();var a=i||"thisisadapterortc";return`v=0\r
o=`+a+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.writeMediaSection=function(t,r,i,s){var o=e.writeRtpDescription(t.kind,r);if(o+=e.writeIceParameters(t.iceGatherer.getLocalParameters()),o+=e.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),i==="offer"?"actpass":"active"),o+="a=mid:"+t.mid+`\r
`,t.direction?o+="a="+t.direction+`\r
`:t.rtpSender&&t.rtpReceiver?o+=`a=sendrecv\r
`:t.rtpSender?o+=`a=sendonly\r
`:t.rtpReceiver?o+=`a=recvonly\r
`:o+=`a=inactive\r
`,t.rtpSender){var a="msid:"+s.id+" "+t.rtpSender.track.id+`\r
`;o+="a="+a,o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+a,t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return o+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+`\r
`,t.rtpSender&&t.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+`\r
`),o},e.getDirection=function(t,r){for(var i=e.splitLines(t),s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substr(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){var r=e.splitLines(t),i=r[0].split(" ");return i[0].substr(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){var r=e.splitLines(t),i=r[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){var r=e.matchPrefix(t,"o=")[0],i=r.substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;for(var r=e.splitLines(t),i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})(PM);var sZ=PM.exports,Oe=sZ;function qS(n,e,t,r,i){var s=Oe.writeRtpDescription(n.kind,e);if(s+=Oe.writeIceParameters(n.iceGatherer.getLocalParameters()),s+=Oe.writeDtlsParameters(n.dtlsTransport.getLocalParameters(),t==="offer"?"actpass":i||"active"),s+="a=mid:"+n.mid+`\r
`,n.rtpSender&&n.rtpReceiver?s+=`a=sendrecv\r
`:n.rtpSender?s+=`a=sendonly\r
`:n.rtpReceiver?s+=`a=recvonly\r
`:s+=`a=inactive\r
`,n.rtpSender){var o=n.rtpSender._initialTrackId||n.rtpSender.track.id;n.rtpSender._initialTrackId=o;var a="msid:"+(r?r.id:"-")+" "+o+`\r
`;s+="a="+a,s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" "+a,n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" "+a,s+="a=ssrc-group:FID "+n.sendEncodingParameters[0].ssrc+" "+n.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return s+="a=ssrc:"+n.sendEncodingParameters[0].ssrc+" cname:"+Oe.localCName+`\r
`,n.rtpSender&&n.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+n.sendEncodingParameters[0].rtx.ssrc+" cname:"+Oe.localCName+`\r
`),s}function oZ(n,e){var t=!1;return n=JSON.parse(JSON.stringify(n)),n.filter(function(r){if(r&&(r.urls||r.url)){var i=r.urls||r.url;r.url&&!r.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s=typeof i=="string";return s&&(i=[i]),i=i.filter(function(o){var a=o.indexOf("turn:")===0&&o.indexOf("transport=udp")!==-1&&o.indexOf("turn:[")===-1&&!t;return a?(t=!0,!0):o.indexOf("stun:")===0&&e>=14393&&o.indexOf("?transport=udp")===-1}),delete r.url,r.urls=s?i[0]:i,!!i.length}})}function zg(n,e){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(s,o){s=parseInt(s,10);for(var a=0;a<o.length;a++)if(o[a].payloadType===s||o[a].preferredPayloadType===s)return o[a]},i=function(s,o,a,l){var c=r(s.parameters.apt,a),u=r(o.parameters.apt,l);return c&&u&&c.name.toLowerCase()===u.name.toLowerCase()};return n.codecs.forEach(function(s){for(var o=0;o<e.codecs.length;o++){var a=e.codecs[o];if(s.name.toLowerCase()===a.name.toLowerCase()&&s.clockRate===a.clockRate){if(s.name.toLowerCase()==="rtx"&&s.parameters&&a.parameters.apt&&!i(s,a,n.codecs,e.codecs))continue;a=JSON.parse(JSON.stringify(a)),a.numChannels=Math.min(s.numChannels,a.numChannels),t.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(l){for(var c=0;c<s.rtcpFeedback.length;c++)if(s.rtcpFeedback[c].type===l.type&&s.rtcpFeedback[c].parameter===l.parameter)return!0;return!1});break}}}),n.headerExtensions.forEach(function(s){for(var o=0;o<e.headerExtensions.length;o++){var a=e.headerExtensions[o];if(s.uri===a.uri){t.headerExtensions.push(a);break}}}),t}function US(n,e,t){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[e][n].indexOf(t)!==-1}function Vg(n,e){var t=n.getRemoteCandidates().find(function(r){return e.foundation===r.foundation&&e.ip===r.ip&&e.port===r.port&&e.priority===r.priority&&e.protocol===r.protocol&&e.type===r.type});return t||n.addRemoteCandidate(e),!t}function zn(n,e){var t=new Error(e);return t.name=n,t}var aZ=function(n,e){function t(a,l){l.addTrack(a),l.dispatchEvent(new n.MediaStreamTrackEvent("addtrack",{track:a}))}function r(a,l){l.removeTrack(a),l.dispatchEvent(new n.MediaStreamTrackEvent("removetrack",{track:a}))}function i(a,l,c,u){var d=new Event("track");d.track=l,d.receiver=c,d.transceiver={receiver:c},d.streams=u,n.setTimeout(function(){a._dispatchEvent("track",d)})}var s=function(a){var l=this,c=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(d){l[d]=c[d].bind(c)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",a=JSON.parse(JSON.stringify(a||{})),this.usingBundle=a.bundlePolicy==="max-bundle",a.rtcpMuxPolicy==="negotiate")throw zn("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require"),a.iceTransportPolicy){case"all":case"relay":break;default:a.iceTransportPolicy="all";break}switch(a.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:a.bundlePolicy="balanced";break}if(a.iceServers=oZ(a.iceServers||[],e),this._iceGatherers=[],a.iceCandidatePoolSize)for(var u=a.iceCandidatePoolSize;u>0;u--)this._iceGatherers.push(new n.RTCIceGatherer({iceServers:a.iceServers,gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=0;this._config=a,this.transceivers=[],this._sdpSessionId=Oe.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};s.prototype.onicecandidate=null,s.prototype.onaddstream=null,s.prototype.ontrack=null,s.prototype.onremovestream=null,s.prototype.onsignalingstatechange=null,s.prototype.oniceconnectionstatechange=null,s.prototype.onicegatheringstatechange=null,s.prototype.onnegotiationneeded=null,s.prototype.ondatachannel=null,s.prototype._dispatchEvent=function(a,l){this._isClosed||(this.dispatchEvent(l),typeof this["on"+a]=="function"&&this["on"+a](l))},s.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)},s.prototype.getConfiguration=function(){return this._config},s.prototype.getLocalStreams=function(){return this.localStreams},s.prototype.getRemoteStreams=function(){return this.remoteStreams},s.prototype._createTransceiver=function(a){var l=this.transceivers.length>0,c={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&l)c.iceTransport=this.transceivers[0].iceTransport,c.dtlsTransport=this.transceivers[0].dtlsTransport;else{var u=this._createIceAndDtlsTransports();c.iceTransport=u.iceTransport,c.dtlsTransport=u.dtlsTransport}return this.transceivers.push(c),c},s.prototype.addTrack=function(a,l){if(this._isClosed)throw zn("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var c=this.transceivers.find(function(f){return f.track===a});if(c)throw zn("InvalidAccessError","Track already exists.");for(var u,d=0;d<this.transceivers.length;d++)!this.transceivers[d].track&&this.transceivers[d].kind===a.kind&&(u=this.transceivers[d]);return u||(u=this._createTransceiver(a.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(l)===-1&&this.localStreams.push(l),u.track=a,u.stream=l,u.rtpSender=new n.RTCRtpSender(a,u.dtlsTransport),u.rtpSender},s.prototype.addStream=function(a){var l=this;if(e>=15025)a.getTracks().forEach(function(u){l.addTrack(u,a)});else{var c=a.clone();a.getTracks().forEach(function(u,d){var f=c.getTracks()[d];u.addEventListener("enabled",function(p){f.enabled=p.enabled})}),c.getTracks().forEach(function(u){l.addTrack(u,c)})}},s.prototype.removeTrack=function(a){if(this._isClosed)throw zn("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof n.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var l=this.transceivers.find(function(d){return d.rtpSender===a});if(!l)throw zn("InvalidAccessError","Sender was not created by this connection.");var c=l.stream;l.rtpSender.stop(),l.rtpSender=null,l.track=null,l.stream=null;var u=this.transceivers.map(function(d){return d.stream});u.indexOf(c)===-1&&this.localStreams.indexOf(c)>-1&&this.localStreams.splice(this.localStreams.indexOf(c),1),this._maybeFireNegotiationNeeded()},s.prototype.removeStream=function(a){var l=this;a.getTracks().forEach(function(c){var u=l.getSenders().find(function(d){return d.track===c});u&&l.removeTrack(u)})},s.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})},s.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})},s.prototype._createIceGatherer=function(a,l){var c=this;if(l&&a>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var u=new n.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(u,"state",{value:"new",writable:!0}),this.transceivers[a].bufferedCandidateEvents=[],this.transceivers[a].bufferCandidates=function(d){var f=!d.candidate||Object.keys(d.candidate).length===0;u.state=f?"completed":"gathering",c.transceivers[a].bufferedCandidateEvents!==null&&c.transceivers[a].bufferedCandidateEvents.push(d)},u.addEventListener("localcandidate",this.transceivers[a].bufferCandidates),u},s.prototype._gather=function(a,l){var c=this,u=this.transceivers[l].iceGatherer;if(!u.onlocalcandidate){var d=this.transceivers[l].bufferedCandidateEvents;this.transceivers[l].bufferedCandidateEvents=null,u.removeEventListener("localcandidate",this.transceivers[l].bufferCandidates),u.onlocalcandidate=function(f){if(!(c.usingBundle&&l>0)){var p=new Event("icecandidate");p.candidate={sdpMid:a,sdpMLineIndex:l};var m=f.candidate,v=!m||Object.keys(m).length===0;if(v)(u.state==="new"||u.state==="gathering")&&(u.state="completed");else{u.state==="new"&&(u.state="gathering"),m.component=1;var x=Oe.writeCandidate(m);p.candidate=Object.assign(p.candidate,Oe.parseCandidate(x)),p.candidate.candidate=x}var b=Oe.getMediaSections(c.localDescription.sdp);v?b[p.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:b[p.candidate.sdpMLineIndex]+="a="+p.candidate.candidate+`\r
`,c.localDescription.sdp=Oe.getDescription(c.localDescription.sdp)+b.join("");var _=c.transceivers.every(function(M){return M.iceGatherer&&M.iceGatherer.state==="completed"});c.iceGatheringState!=="gathering"&&(c.iceGatheringState="gathering",c._emitGatheringStateChange()),v||c._dispatchEvent("icecandidate",p),_&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}},n.setTimeout(function(){d.forEach(function(f){u.onlocalcandidate(f)})},0)}},s.prototype._createIceAndDtlsTransports=function(){var a=this,l=new n.RTCIceTransport(null);l.onicestatechange=function(){a._updateConnectionState()};var c=new n.RTCDtlsTransport(l);return c.ondtlsstatechange=function(){a._updateConnectionState()},c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0}),a._updateConnectionState()},{iceTransport:l,dtlsTransport:c}},s.prototype._disposeIceAndDtlsTransports=function(a){var l=this.transceivers[a].iceGatherer;l&&(delete l.onlocalcandidate,delete this.transceivers[a].iceGatherer);var c=this.transceivers[a].iceTransport;c&&(delete c.onicestatechange,delete this.transceivers[a].iceTransport);var u=this.transceivers[a].dtlsTransport;u&&(delete u.ondtlsstatechange,delete u.onerror,delete this.transceivers[a].dtlsTransport)},s.prototype._transceive=function(a,l,c){var u=zg(a.localCapabilities,a.remoteCapabilities);l&&a.rtpSender&&(u.encodings=a.sendEncodingParameters,u.rtcp={cname:Oe.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(u.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(u)),c&&a.rtpReceiver&&u.codecs.length>0&&(a.kind==="video"&&a.recvEncodingParameters&&e<15019&&a.recvEncodingParameters.forEach(function(d){delete d.rtx}),a.recvEncodingParameters.length?u.encodings=a.recvEncodingParameters:u.encodings=[{}],u.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(u.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(u.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(u))},s.prototype.setLocalDescription=function(a){var l=this;if(["offer","answer"].indexOf(a.type)===-1)return Promise.reject(zn("TypeError",'Unsupported type "'+a.type+'"'));if(!US("setLocalDescription",a.type,l.signalingState)||l._isClosed)return Promise.reject(zn("InvalidStateError","Can not set local "+a.type+" in state "+l.signalingState));var c,u;if(a.type==="offer")c=Oe.splitSections(a.sdp),u=c.shift(),c.forEach(function(f,p){var m=Oe.parseRtpParameters(f);l.transceivers[p].localCapabilities=m}),l.transceivers.forEach(function(f,p){l._gather(f.mid,p)});else if(a.type==="answer"){c=Oe.splitSections(l.remoteDescription.sdp),u=c.shift();var d=Oe.matchPrefix(u,"a=ice-lite").length>0;c.forEach(function(f,p){var m=l.transceivers[p],v=m.iceGatherer,x=m.iceTransport,b=m.dtlsTransport,_=m.localCapabilities,M=m.remoteCapabilities,h=Oe.isRejected(f)&&Oe.matchPrefix(f,"a=bundle-only").length===0;if(!h&&!m.isDatachannel){var w=Oe.getIceParameters(f,u),y=Oe.getDtlsParameters(f,u);d&&(y.role="server"),(!l.usingBundle||p===0)&&(l._gather(m.mid,p),x.state==="new"&&x.start(v,w,d?"controlling":"controlled"),b.state==="new"&&b.start(y));var E=zg(_,M);l._transceive(m,E.codecs.length>0,!1)}})}return l.localDescription={type:a.type,sdp:a.sdp},a.type==="offer"?l._updateSignalingState("have-local-offer"):l._updateSignalingState("stable"),Promise.resolve()},s.prototype.setRemoteDescription=function(a){var l=this;if(["offer","answer"].indexOf(a.type)===-1)return Promise.reject(zn("TypeError",'Unsupported type "'+a.type+'"'));if(!US("setRemoteDescription",a.type,l.signalingState)||l._isClosed)return Promise.reject(zn("InvalidStateError","Can not set remote "+a.type+" in state "+l.signalingState));var c={};l.remoteStreams.forEach(function(x){c[x.id]=x});var u=[],d=Oe.splitSections(a.sdp),f=d.shift(),p=Oe.matchPrefix(f,"a=ice-lite").length>0,m=Oe.matchPrefix(f,"a=group:BUNDLE ").length>0;l.usingBundle=m;var v=Oe.matchPrefix(f,"a=ice-options:")[0];return v?l.canTrickleIceCandidates=v.substr(14).split(" ").indexOf("trickle")>=0:l.canTrickleIceCandidates=!1,d.forEach(function(x,b){var _=Oe.splitLines(x),M=Oe.getKind(x),h=Oe.isRejected(x)&&Oe.matchPrefix(x,"a=bundle-only").length===0,w=_[0].substr(2).split(" ")[2],y=Oe.getDirection(x,f),E=Oe.parseMsid(x),g=Oe.getMid(x)||Oe.generateIdentifier();if(M==="application"&&w==="DTLS/SCTP"){l.transceivers[b]={mid:g,isDatachannel:!0};return}var I,R,S,k,T,C,D,A,O,P=Oe.parseRtpParameters(x),N,F;h||(N=Oe.getIceParameters(x,f),F=Oe.getDtlsParameters(x,f),F.role="client"),D=Oe.parseRtpEncodingParameters(x);var j=Oe.parseRtcpParameters(x),J=Oe.matchPrefix(x,"a=end-of-candidates",f).length>0,ie=Oe.matchPrefix(x,"a=candidate:").map(function(ae){return Oe.parseCandidate(ae)}).filter(function(ae){return ae.component===1});if((a.type==="offer"||a.type==="answer")&&!h&&m&&b>0&&l.transceivers[b]&&(l._disposeIceAndDtlsTransports(b),l.transceivers[b].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[b].iceTransport=l.transceivers[0].iceTransport,l.transceivers[b].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[b].rtpSender&&l.transceivers[b].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[b].rtpReceiver&&l.transceivers[b].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),a.type==="offer"&&!h){I=l.transceivers[b]||l._createTransceiver(M),I.mid=g,I.iceGatherer||(I.iceGatherer=l._createIceGatherer(b,m)),ie.length&&I.iceTransport.state==="new"&&(J&&(!m||b===0)?I.iceTransport.setRemoteCandidates(ie):ie.forEach(function(ae){Vg(I.iceTransport,ae)})),A=n.RTCRtpReceiver.getCapabilities(M),e<15019&&(A.codecs=A.codecs.filter(function(ae){return ae.name!=="rtx"})),C=I.sendEncodingParameters||[{ssrc:(2*b+2)*1001}];var oe=!1;if(y==="sendrecv"||y==="sendonly"){if(oe=!I.rtpReceiver,T=I.rtpReceiver||new n.RTCRtpReceiver(I.dtlsTransport,M),oe){var he;O=T.track,E&&E.stream==="-"||(E?(c[E.stream]||(c[E.stream]=new n.MediaStream,Object.defineProperty(c[E.stream],"id",{get:function(){return E.stream}})),Object.defineProperty(O,"id",{get:function(){return E.track}}),he=c[E.stream]):(c.default||(c.default=new n.MediaStream),he=c.default)),he&&(t(O,he),I.associatedRemoteMediaStreams.push(he)),u.push([O,T,he])}}else I.rtpReceiver&&I.rtpReceiver.track&&(I.associatedRemoteMediaStreams.forEach(function(ae){var B=ae.getTracks().find(function(ee){return ee.id===I.rtpReceiver.track.id});B&&r(B,ae)}),I.associatedRemoteMediaStreams=[]);I.localCapabilities=A,I.remoteCapabilities=P,I.rtpReceiver=T,I.rtcpParameters=j,I.sendEncodingParameters=C,I.recvEncodingParameters=D,l._transceive(l.transceivers[b],!1,oe)}else a.type==="answer"&&!h&&(I=l.transceivers[b],R=I.iceGatherer,S=I.iceTransport,k=I.dtlsTransport,T=I.rtpReceiver,C=I.sendEncodingParameters,A=I.localCapabilities,l.transceivers[b].recvEncodingParameters=D,l.transceivers[b].remoteCapabilities=P,l.transceivers[b].rtcpParameters=j,ie.length&&S.state==="new"&&((p||J)&&(!m||b===0)?S.setRemoteCandidates(ie):ie.forEach(function(ae){Vg(I.iceTransport,ae)})),(!m||b===0)&&(S.state==="new"&&S.start(R,N,"controlling"),k.state==="new"&&k.start(F)),l._transceive(I,y==="sendrecv"||y==="recvonly",y==="sendrecv"||y==="sendonly"),T&&(y==="sendrecv"||y==="sendonly")?(O=T.track,E?(c[E.stream]||(c[E.stream]=new n.MediaStream),t(O,c[E.stream]),u.push([O,T,c[E.stream]])):(c.default||(c.default=new n.MediaStream),t(O,c.default),u.push([O,T,c.default]))):delete I.rtpReceiver)}),l._dtlsRole===void 0&&(l._dtlsRole=a.type==="offer"?"active":"passive"),l.remoteDescription={type:a.type,sdp:a.sdp},a.type==="offer"?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(c).forEach(function(x){var b=c[x];if(b.getTracks().length){if(l.remoteStreams.indexOf(b)===-1){l.remoteStreams.push(b);var _=new Event("addstream");_.stream=b,n.setTimeout(function(){l._dispatchEvent("addstream",_)})}u.forEach(function(M){var h=M[0],w=M[1];b.id===M[2].id&&i(l,h,w,[b])})}}),u.forEach(function(x){x[2]||i(l,x[0],x[1],[])}),n.setTimeout(function(){l&&l.transceivers&&l.transceivers.forEach(function(x){x.iceTransport&&x.iceTransport.state==="new"&&x.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),x.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},s.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop(),a.dtlsTransport&&a.dtlsTransport.stop(),a.rtpSender&&a.rtpSender.stop(),a.rtpReceiver&&a.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},s.prototype._updateSignalingState=function(a){this.signalingState=a;var l=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",l)},s.prototype._maybeFireNegotiationNeeded=function(){var a=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,n.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=!1;var l=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",l)}},0))},s.prototype._updateConnectionState=function(){var a,l={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(u){l[u.iceTransport.state]++,l[u.dtlsTransport.state]++}),l.connected+=l.completed,a="new",l.failed>0?a="failed":l.connecting>0||l.checking>0?a="connecting":l.disconnected>0?a="disconnected":l.new>0?a="new":(l.connected>0||l.completed>0)&&(a="connected"),a!==this.iceConnectionState){this.iceConnectionState=a;var c=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",c)}},s.prototype.createOffer=function(){var a=this;if(a._isClosed)return Promise.reject(zn("InvalidStateError","Can not call createOffer after close"));var l=a.transceivers.filter(function(p){return p.kind==="audio"}).length,c=a.transceivers.filter(function(p){return p.kind==="video"}).length,u=arguments[0];if(u){if(u.mandatory||u.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");u.offerToReceiveAudio!==void 0&&(u.offerToReceiveAudio===!0?l=1:u.offerToReceiveAudio===!1?l=0:l=u.offerToReceiveAudio),u.offerToReceiveVideo!==void 0&&(u.offerToReceiveVideo===!0?c=1:u.offerToReceiveVideo===!1?c=0:c=u.offerToReceiveVideo)}for(a.transceivers.forEach(function(p){p.kind==="audio"?(l--,l<0&&(p.wantReceive=!1)):p.kind==="video"&&(c--,c<0&&(p.wantReceive=!1))});l>0||c>0;)l>0&&(a._createTransceiver("audio"),l--),c>0&&(a._createTransceiver("video"),c--);var d=Oe.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.transceivers.forEach(function(p,m){var v=p.track,x=p.kind,b=p.mid||Oe.generateIdentifier();p.mid=b,p.iceGatherer||(p.iceGatherer=a._createIceGatherer(m,a.usingBundle));var _=n.RTCRtpSender.getCapabilities(x);e<15019&&(_.codecs=_.codecs.filter(function(h){return h.name!=="rtx"})),_.codecs.forEach(function(h){h.name==="H264"&&h.parameters["level-asymmetry-allowed"]===void 0&&(h.parameters["level-asymmetry-allowed"]="1"),p.remoteCapabilities&&p.remoteCapabilities.codecs&&p.remoteCapabilities.codecs.forEach(function(w){h.name.toLowerCase()===w.name.toLowerCase()&&h.clockRate===w.clockRate&&(h.preferredPayloadType=w.payloadType)})}),_.headerExtensions.forEach(function(h){var w=p.remoteCapabilities&&p.remoteCapabilities.headerExtensions||[];w.forEach(function(y){h.uri===y.uri&&(h.id=y.id)})});var M=p.sendEncodingParameters||[{ssrc:(2*m+1)*1001}];v&&e>=15019&&x==="video"&&!M[0].rtx&&(M[0].rtx={ssrc:M[0].ssrc+1}),p.wantReceive&&(p.rtpReceiver=new n.RTCRtpReceiver(p.dtlsTransport,x)),p.localCapabilities=_,p.sendEncodingParameters=M}),a._config.bundlePolicy!=="max-compat"&&(d+="a=group:BUNDLE "+a.transceivers.map(function(p){return p.mid}).join(" ")+`\r
`),d+=`a=ice-options:trickle\r
`,a.transceivers.forEach(function(p,m){d+=qS(p,p.localCapabilities,"offer",p.stream,a._dtlsRole),d+=`a=rtcp-rsize\r
`,p.iceGatherer&&a.iceGatheringState!=="new"&&(m===0||!a.usingBundle)&&(p.iceGatherer.getLocalCandidates().forEach(function(v){v.component=1,d+="a="+Oe.writeCandidate(v)+`\r
`}),p.iceGatherer.state==="completed"&&(d+=`a=end-of-candidates\r
`))});var f=new n.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(f)},s.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(zn("InvalidStateError","Can not call createAnswer after close"));var l=Oe.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&(l+="a=group:BUNDLE "+a.transceivers.map(function(d){return d.mid}).join(" ")+`\r
`);var c=Oe.getMediaSections(a.remoteDescription.sdp).length;a.transceivers.forEach(function(d,f){if(!(f+1>c)){if(d.isDatachannel){l+=`m=application 0 DTLS/SCTP 5000\r
c=IN IP4 0.0.0.0\r
a=mid:`+d.mid+`\r
`;return}if(d.stream){var p;d.kind==="audio"?p=d.stream.getAudioTracks()[0]:d.kind==="video"&&(p=d.stream.getVideoTracks()[0]),p&&e>=15019&&d.kind==="video"&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}var m=zg(d.localCapabilities,d.remoteCapabilities),v=m.codecs.filter(function(x){return x.name.toLowerCase()==="rtx"}).length;!v&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,l+=qS(d,m,"answer",d.stream,a._dtlsRole),d.rtcpParameters&&d.rtcpParameters.reducedSize&&(l+=`a=rtcp-rsize\r
`)}});var u=new n.RTCSessionDescription({type:"answer",sdp:l});return Promise.resolve(u)},s.prototype.addIceCandidate=function(a){var l=this,c;return a&&!(a.sdpMLineIndex!==void 0||a.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(u,d){if(l.remoteDescription)if(!a||a.candidate==="")for(var f=0;f<l.transceivers.length&&!(!l.transceivers[f].isDatachannel&&(l.transceivers[f].iceTransport.addRemoteCandidate({}),c=Oe.getMediaSections(l.remoteDescription.sdp),c[f]+=`a=end-of-candidates\r
`,l.remoteDescription.sdp=Oe.getDescription(l.remoteDescription.sdp)+c.join(""),l.usingBundle));f++);else{var p=a.sdpMLineIndex;if(a.sdpMid){for(var m=0;m<l.transceivers.length;m++)if(l.transceivers[m].mid===a.sdpMid){p=m;break}}var v=l.transceivers[p];if(v){if(v.isDatachannel)return u();var x=Object.keys(a.candidate).length>0?Oe.parseCandidate(a.candidate):{};if(x.protocol==="tcp"&&(x.port===0||x.port===9)||x.component&&x.component!==1)return u();if((p===0||p>0&&v.iceTransport!==l.transceivers[0].iceTransport)&&!Vg(v.iceTransport,x))return d(zn("OperationError","Can not add ICE candidate"));var b=a.candidate.trim();b.indexOf("a=")===0&&(b=b.substr(2)),c=Oe.getMediaSections(l.remoteDescription.sdp),c[p]+="a="+(x.type?b:"end-of-candidates")+`\r
`,l.remoteDescription.sdp=c.join("")}else return d(zn("OperationError","Can not add ICE candidate"))}else return d(zn("InvalidStateError","Can not add ICE candidate without a remote description"));u()})},s.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(c){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(u){c[u]&&a.push(c[u].getStats())})});var l=function(c){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[c.type]||c.type};return new Promise(function(c){var u=new Map;Promise.all(a).then(function(d){d.forEach(function(f){Object.keys(f).forEach(function(p){f[p].type=l(f[p]),u.set(p,f[p])})}),c(u)})})};var o=["createOffer","createAnswer"];return o.forEach(function(a){var l=s.prototype[a];s.prototype[a]=function(){var c=arguments;return typeof c[0]=="function"||typeof c[1]=="function"?l.apply(this,[arguments[2]]).then(function(u){typeof c[0]=="function"&&c[0].apply(null,[u])},function(u){typeof c[1]=="function"&&c[1].apply(null,[u])}):l.apply(this,arguments)}}),o=["setLocalDescription","setRemoteDescription","addIceCandidate"],o.forEach(function(a){var l=s.prototype[a];s.prototype[a]=function(){var c=arguments;return typeof c[1]=="function"||typeof c[2]=="function"?l.apply(this,arguments).then(function(){typeof c[1]=="function"&&c[1].apply(null)},function(u){typeof c[2]=="function"&&c[2].apply(null,[u])}):l.apply(this,arguments)}}),["getStats"].forEach(function(a){var l=s.prototype[a];s.prototype[a]=function(){var c=arguments;return typeof c[1]=="function"?l.apply(this,arguments).then(function(){typeof c[1]=="function"&&c[1].apply(null)}):l.apply(this,arguments)}}),s};Object.defineProperty(rm,"__esModule",{value:!0});var lZ=Cn,tb=nt,Nl=Ir,cZ=aZ;function ns(n){if(typeof window=="undefined"){this.log.info("No RTCPeerConnection implementation available. The window object was not found.");return}n&&n.RTCPeerConnection?this.RTCPeerConnection=n.RTCPeerConnection:tb.isLegacyEdge()?this.RTCPeerConnection=new cZ(typeof window!="undefined"?window:be):typeof window.RTCPeerConnection=="function"?this.RTCPeerConnection=window.RTCPeerConnection:typeof window.webkitRTCPeerConnection=="function"?this.RTCPeerConnection=webkitRTCPeerConnection:typeof window.mozRTCPeerConnection=="function"?(this.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate):this.log.info("No RTCPeerConnection implementation available")}ns.prototype.create=function(n){this.log=new lZ.default("RTCPC"),this.pc=new this.RTCPeerConnection(n)};ns.prototype.createModernConstraints=function(n){if(typeof n=="undefined")return null;var e=Object.assign({},n);return typeof webkitRTCPeerConnection!="undefined"&&!tb.isLegacyEdge()?(e.mandatory={},typeof n.audio!="undefined"&&(e.mandatory.OfferToReceiveAudio=n.audio),typeof n.video!="undefined"&&(e.mandatory.OfferToReceiveVideo=n.video)):(typeof n.audio!="undefined"&&(e.offerToReceiveAudio=n.audio),typeof n.video!="undefined"&&(e.offerToReceiveVideo=n.video)),delete e.audio,delete e.video,e};ns.prototype.createOffer=function(n,e,t,r,i){var s=this;return t=this.createModernConstraints(t),$M(this.pc.createOffer,this.pc)(t).then(function(o){if(!s.pc)return Promise.resolve();var a=Nl.setMaxAverageBitrate(o.sdp,n);return im(s.pc.setLocalDescription,s.pc)(new RTCSessionDescription({sdp:Nl.setCodecPreferences(a,e),type:"offer"}))}).then(r,i)};ns.prototype.createAnswer=function(n,e,t,r,i){var s=this;return t=this.createModernConstraints(t),$M(this.pc.createAnswer,this.pc)(t).then(function(o){if(!s.pc)return Promise.resolve();var a=Nl.setMaxAverageBitrate(o.sdp,n);return im(s.pc.setLocalDescription,s.pc)(new RTCSessionDescription({sdp:Nl.setCodecPreferences(a,e),type:"answer"}))}).then(r,i)};ns.prototype.processSDP=function(n,e,t,r,i,s){var o=this;t=Nl.setCodecPreferences(t,e);var a=new RTCSessionDescription({sdp:t,type:"offer"});return im(this.pc.setRemoteDescription,this.pc)(a).then(function(){o.createAnswer(n,e,r,i,s)})};ns.prototype.getSDP=function(){return this.pc.localDescription.sdp};ns.prototype.processAnswer=function(n,e,t,r){return this.pc?(e=Nl.setCodecPreferences(e,n),im(this.pc.setRemoteDescription,this.pc)(new RTCSessionDescription({sdp:e,type:"answer"})).then(t,r)):Promise.resolve()};ns.test=function(){if(typeof navigator=="object"){var n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.getUserMedia;if(tb.isLegacyEdge(navigator))return!1;if(n&&typeof window.RTCPeerConnection=="function")return!0;if(n&&typeof window.webkitRTCPeerConnection=="function")return!0;if(n&&typeof window.mozRTCPeerConnection=="function"){try{var e=new window.mozRTCPeerConnection;if(typeof e.getLocalStreams!="function")return!1}catch(t){return!1}return!0}else if(typeof RTCIceGatherer!="undefined")return!0}return!1};function DM(n,e,t,r){return function(){var i=Array.prototype.slice.call(arguments);return new Promise(function(s){var o=n.apply(e,i);if(!r){s(o);return}if(typeof o=="object"&&typeof o.then=="function")s(o);else throw new Error}).catch(function(){return new Promise(function(s,o){n.apply(e,t?[s,o].concat(i):i.concat([s,o]))})})}}function $M(n,e){return DM(n,e,!0,!0)}function im(n,e){return DM(n,e,!1,!1)}rm.default=ns;Object.defineProperty(eb,"__esModule",{value:!0});var Ri=pn,uZ=Cn,dZ=nt,lp=rm,fZ=Ir,hZ=15e3,pZ="none",mZ="timeout",gZ="new",WS=50;function Ie(n,e,t){if(!n||!e)throw new Ri.InvalidArgumentError("Audiohelper, and pstream are required arguments");if(!(this instanceof Ie))return new Ie(n,e,t);this._log=new uZ.default("PeerConnection");function r(){this._log.warn("Unexpected noop call in peerconnection")}this.onaudio=r,this.onopen=r,this.onerror=r,this.onclose=r,this.ondisconnected=r,this.onfailed=r,this.onconnected=r,this.onreconnected=r,this.onsignalingstatechange=r,this.ondtlstransportstatechange=r,this.onicegatheringfailure=r,this.onicegatheringstatechange=r,this.oniceconnectionstatechange=r,this.onpcconnectionstatechange=r,this.onicecandidate=r,this.onselectedcandidatepairchange=r,this.onvolume=r,this.version=null,this.pstream=e,this.stream=null,this.sinkIds=new Set(["default"]),this.outputs=new Map,this.status="connecting",this.callSid=null,this.isMuted=!1;var i=typeof window!="undefined"&&(window.AudioContext||window.webkitAudioContext);return this._isSinkSupported=!!i&&typeof HTMLAudioElement!="undefined"&&HTMLAudioElement.prototype.setSinkId,this._audioContext=i&&n._audioContext,this._audioHelper=n,this._hasIceCandidates=!1,this._hasIceGatheringFailures=!1,this._iceGatheringTimeoutId=null,this._masterAudio=null,this._masterAudioDeviceId=null,this._mediaStreamSource=null,this._dtmfSender=null,this._dtmfSenderUnsupported=!1,this._callEvents=[],this._nextTimeToPublish=Date.now(),this._onAnswerOrRinging=r,this._onHangup=r,this._remoteStream=null,this._shouldManageStream=!0,this._iceState=gZ,this._isUnifiedPlan=t.isUnifiedPlan,this.options=t=t||{},this.navigator=t.navigator||(typeof navigator!="undefined"?navigator:null),this.util=t.util||dZ,this.codecPreferences=t.codecPreferences,this}Ie.prototype.uri=function(){return this._uri};Ie.prototype.openDefaultDeviceWithConstraints=function(n){return this._audioHelper._openDefaultDeviceWithConstraints(n).then(this._setInputTracksFromStream.bind(this,!1))};Ie.prototype.setInputTracksFromStream=function(n){var e=this;return this._setInputTracksFromStream(!0,n).then(function(){e._shouldManageStream=!1})};Ie.prototype._createAnalyser=function(n,e){e=Object.assign({fftSize:32,smoothingTimeConstant:.3},e);var t=n.createAnalyser();for(var r in e)t[r]=e[r];return t};Ie.prototype._setVolumeHandler=function(n){this.onvolume=n};Ie.prototype._startPollingVolume=function(){if(!(!this._audioContext||!this.stream||!this._remoteStream)){var n=this._audioContext,e=this._inputAnalyser=this._createAnalyser(n),t=e.frequencyBinCount,r=new Uint8Array(t);this._inputAnalyser2=this._createAnalyser(n,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0});var i=this._outputAnalyser=this._createAnalyser(n),s=i.frequencyBinCount,o=new Uint8Array(s);this._outputAnalyser2=this._createAnalyser(n,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0}),this._updateInputStreamSource(this.stream),this._updateOutputStreamSource(this._remoteStream);var a=this;setTimeout(function l(){if(a._audioContext){if(a.status==="closed"){a._inputAnalyser.disconnect(),a._outputAnalyser.disconnect(),a._inputAnalyser2.disconnect(),a._outputAnalyser2.disconnect();return}}else return;a._inputAnalyser.getByteFrequencyData(r);var c=a.util.average(r);a._inputAnalyser2.getByteFrequencyData(r);var u=a.util.average(r);a._outputAnalyser.getByteFrequencyData(o);var d=a.util.average(o);a._outputAnalyser2.getByteFrequencyData(o);var f=a.util.average(o);a.onvolume(c/255,d/255,u,f),setTimeout(l,WS)},WS)}};Ie.prototype._stopStream=function(){this._shouldManageStream&&this._audioHelper._stopDefaultInputDeviceStream()};Ie.prototype._updateInputStreamSource=function(n){this._inputStreamSource&&this._inputStreamSource.disconnect();try{this._inputStreamSource=this._audioContext.createMediaStreamSource(n),this._inputStreamSource.connect(this._inputAnalyser),this._inputStreamSource.connect(this._inputAnalyser2)}catch(e){this._log.warn("Unable to update input MediaStreamSource",e),this._inputStreamSource=null}};Ie.prototype._updateOutputStreamSource=function(n){this._outputStreamSource&&this._outputStreamSource.disconnect();try{this._outputStreamSource=this._audioContext.createMediaStreamSource(n),this._outputStreamSource.connect(this._outputAnalyser),this._outputStreamSource.connect(this._outputAnalyser2)}catch(e){this._log.warn("Unable to update output MediaStreamSource",e),this._outputStreamSource=null}};Ie.prototype._setInputTracksFromStream=function(n,e){return this._isUnifiedPlan?this._setInputTracksForUnifiedPlan(n,e):this._setInputTracksForPlanB(n,e)};Ie.prototype._setInputTracksForPlanB=function(n,e){var t=this;if(!e)return Promise.reject(new Ri.InvalidArgumentError("Can not set input stream to null while in a call"));if(!e.getAudioTracks().length)return Promise.reject(new Ri.InvalidArgumentError("Supplied input stream has no audio tracks"));var r=this.stream;return r?(this._stopStream(),yZ(this.version.pc,r),r.getAudioTracks().forEach(r.removeTrack,r),e.getAudioTracks().forEach(r.addTrack,r),NM(this.version.pc,e),this._updateInputStreamSource(this.stream)):this.stream=n?J1(e):e,this.mute(this.isMuted),this.version?new Promise(function(i,s){t.version.createOffer(t.options.maxAverageBitrate,t.codecPreferences,{audio:!0},function(){t.version.processAnswer(t.codecPreferences,t._answerSdp,function(){i(t.stream)},s)},s)}):Promise.resolve(this.stream)};Ie.prototype._setInputTracksForUnifiedPlan=function(n,e){var t=this;if(!e)return Promise.reject(new Ri.InvalidArgumentError("Can not set input stream to null while in a call"));if(!e.getAudioTracks().length)return Promise.reject(new Ri.InvalidArgumentError("Supplied input stream has no audio tracks"));var r=this.stream,i=function(){return t.mute(t.isMuted),Promise.resolve(t.stream)};if(!r)this.stream=n?J1(e):e;else return this._shouldManageStream&&this._stopStream(),this._sender||(this._sender=this.version.pc.getSenders()[0]),this._sender.replaceTrack(e.getAudioTracks()[0]).then(function(){return t._updateInputStreamSource(e),t.stream=n?J1(e):e,i()});return i()};Ie.prototype._onInputDevicesChanged=function(){if(this.stream){var n=this.stream.getAudioTracks().every(function(e){return e.readyState==="ended"});n&&this._shouldManageStream&&this.openDefaultDeviceWithConstraints({audio:!0})}};Ie.prototype._onIceGatheringFailure=function(n){this._hasIceGatheringFailures=!0,this.onicegatheringfailure(n)};Ie.prototype._onMediaConnectionStateChange=function(n){var e=this._iceState;if(!(e===n||n!=="connected"&&n!=="disconnected"&&n!=="failed")){this._iceState=n;var t;switch(n){case"connected":e==="disconnected"||e==="failed"?(t="ICE liveliness check succeeded. Connection with Twilio restored",this._log.info(t),this.onreconnected(t)):(t="Media connection established.",this._log.info(t),this.onconnected(t)),this._stopIceGatheringTimeout(),this._hasIceGatheringFailures=!1;break;case"disconnected":t="ICE liveliness check failed. May be having trouble connecting to Twilio",this._log.warn(t),this.ondisconnected(t);break;case"failed":t="Connection with Twilio was interrupted.",this._log.warn(t),this.onfailed(t);break}}};Ie.prototype._setSinkIds=function(n){return this._isSinkSupported?(this.sinkIds=new Set(n.forEach?n:[n]),this.version?this._updateAudioOutputs():Promise.resolve()):Promise.reject(new Ri.NotSupportedError("Audio output selection is not supported by this browser"))};Ie.prototype._startIceGatheringTimeout=function(){var e=this;this._stopIceGatheringTimeout(),this._iceGatheringTimeoutId=setTimeout(function(){e._onIceGatheringFailure(mZ)},hZ)};Ie.prototype._stopIceGatheringTimeout=function(){clearInterval(this._iceGatheringTimeoutId)};Ie.prototype._updateAudioOutputs=function(){var e=Array.from(this.sinkIds).filter(function(s){return!this.outputs.has(s)},this),t=Array.from(this.outputs.keys()).filter(function(s){return!this.sinkIds.has(s)},this),r=this,i=e.map(this._createAudioOutput,this);return Promise.all(i).then(function(){return Promise.all(t.map(r._removeAudioOutput,r))})};Ie.prototype._createAudio=function(e){var t=new Audio(e);return this.onaudio(t),t};Ie.prototype._createAudioOutput=function(e){var t=null;this._mediaStreamSource&&(t=this._audioContext.createMediaStreamDestination(),this._mediaStreamSource.connect(t));var r=this._createAudio();nb(r,t&&t.stream?t.stream:this.pcStream);var i=this;return r.setSinkId(e).then(function(){return r.play()}).then(function(){i.outputs.set(e,{audio:r,dest:t})})};Ie.prototype._removeAudioOutputs=function(){return this._masterAudio&&typeof this._masterAudioDeviceId!="undefined"&&(this._disableOutput(this,this._masterAudioDeviceId),this.outputs.delete(this._masterAudioDeviceId),this._masterAudioDeviceId=null,this._masterAudio.paused||this._masterAudio.pause(),typeof this._masterAudio.srcObject!="undefined"?this._masterAudio.srcObject=null:this._masterAudio.src="",this._masterAudio=null),Array.from(this.outputs.keys()).map(this._removeAudioOutput,this)};Ie.prototype._disableOutput=function(e,t){var r=e.outputs.get(t);r&&(r.audio&&(r.audio.pause(),r.audio.src=""),r.dest&&r.dest.disconnect())};Ie.prototype._reassignMasterOutput=function(e,t){var r=e.outputs.get(t);e.outputs.delete(t);var i=this,s=Array.from(e.outputs.keys())[0]||"default";return r.audio.setSinkId(s).then(function(){i._disableOutput(e,s),e.outputs.set(s,r),e._masterAudioDeviceId=s}).catch(function(){e.outputs.set(t,r),i._log.info("Could not reassign master output. Attempted to roll back.")})};Ie.prototype._removeAudioOutput=function(e){return this._masterAudioDeviceId===e?this._reassignMasterOutput(this,e):(this._disableOutput(this,e),this.outputs.delete(e),Promise.resolve())};Ie.prototype._onAddTrack=function(e,t){var r=e._masterAudio=this._createAudio();nb(r,t),r.play();var i=Array.from(e.outputs.keys())[0]||"default";e._masterAudioDeviceId=i,e.outputs.set(i,{audio:r});try{e._mediaStreamSource=e._audioContext.createMediaStreamSource(t)}catch(s){this._log.warn("Unable to create a MediaStreamSource from onAddTrack",s),this._mediaStreamSource=null}e.pcStream=t,e._updateAudioOutputs()};Ie.prototype._fallbackOnAddTrack=function(e,t){var r=document&&document.createElement("audio");r.autoplay=!0,nb(r,t)||e._log.info("Error attaching stream to element."),e.outputs.set("default",{audio:r})};Ie.prototype._setEncodingParameters=function(n){if(!(!n||!this._sender||typeof this._sender.getParameters!="function"||typeof this._sender.setParameters!="function")){var e=this._sender.getParameters();!e.priority&&!(e.encodings&&e.encodings.length)||(e.priority="high",e.encodings&&e.encodings.length&&e.encodings.forEach(function(t){t.priority="high",t.networkPriority="high"}),this._sender.setParameters(e))}};Ie.prototype._setupPeerConnection=function(n){var e=this,t=this,r=new(this.options.rtcpcFactory||lp.default)({RTCPeerConnection:this.options.RTCPeerConnection});r.create(n),NM(r.pc,this.stream);var i="ontrack"in r.pc?"ontrack":"onaddstream";return r.pc[i]=function(s){var o=t._remoteStream=s.stream||s.streams[0];typeof r.pc.getSenders=="function"&&(e._sender=r.pc.getSenders()[0]),t._isSinkSupported?t._onAddTrack(t,o):t._fallbackOnAddTrack(t,o),t._startPollingVolume()},r};Ie.prototype._maybeSetIceAggressiveNomination=function(n){return this.options.forceAggressiveIceNomination?fZ.setIceAggressiveNomination(n):n};Ie.prototype._setupChannel=function(){var n=this,e=this.version.pc;this.version.pc.onopen=function(){n.status="open",n.onopen()},this.version.pc.onstatechange=function(){n.version.pc&&n.version.pc.readyState==="stable"&&(n.status="open",n.onopen())},this.version.pc.onsignalingstatechange=function(){var t=e.signalingState;n._log.info('signalingState is "'+t+'"'),n.version.pc&&n.version.pc.signalingState==="stable"&&(n.status="open",n.onopen()),n.onsignalingstatechange(e.signalingState)},e.onconnectionstatechange=function(t){var r=e.connectionState;if(!r&&t&&t.target){var i=t.target;r=i.connectionState||i.connectionState_,n._log.info("pc.connectionState not detected. Using target PC. State="+r)}r?n._log.info('pc.connectionState is "'+r+'"'):n._log.warn('onconnectionstatechange detected but state is "'+r+'"'),n.onpcconnectionstatechange(r),n._onMediaConnectionStateChange(r)},e.onicecandidate=function(t){var r=t.candidate;r&&(n._hasIceCandidates=!0,n.onicecandidate(r),n._setupRTCIceTransportListener()),n._log.info("ICE Candidate: "+JSON.stringify(r))},e.onicegatheringstatechange=function(){var t=e.iceGatheringState;t==="gathering"?n._startIceGatheringTimeout():t==="complete"&&(n._stopIceGatheringTimeout(),n._hasIceCandidates||n._onIceGatheringFailure(pZ),n._hasIceCandidates&&n._hasIceGatheringFailures&&n._startIceGatheringTimeout()),n._log.info('pc.iceGatheringState is "'+e.iceGatheringState+'"'),n.onicegatheringstatechange(t)},e.oniceconnectionstatechange=function(){n._log.info('pc.iceConnectionState is "'+e.iceConnectionState+'"'),n.oniceconnectionstatechange(e.iceConnectionState),n._onMediaConnectionStateChange(e.iceConnectionState)}};Ie.prototype._initializeMediaStream=function(n){return this.status==="open"?!1:this.pstream.status==="disconnected"?(this.onerror({info:{code:31e3,message:"Cannot establish connection. Client is disconnected",twilioError:new Ri.SignalingErrors.ConnectionDisconnected}}),this.close(),!1):(this.version=this._setupPeerConnection(n),this._setupChannel(),!0)};Ie.prototype._removeReconnectionListeners=function(){this.pstream&&(this.pstream.removeListener("answer",this._onAnswerOrRinging),this.pstream.removeListener("hangup",this._onHangup))};Ie.prototype._setupRTCDtlsTransportListener=function(){var n=this,e=this.getRTCDtlsTransport();if(!(!e||e.onstatechange)){var t=function(){n._log.info('dtlsTransportState is "'+e.state+'"'),n.ondtlstransportstatechange(e.state)};t(),e.onstatechange=t}};Ie.prototype._setupRTCIceTransportListener=function(){var n=this,e=this._getRTCIceTransport();!e||e.onselectedcandidatepairchange||(e.onselectedcandidatepairchange=function(){return n.onselectedcandidatepairchange(e.getSelectedCandidatePair())})};Ie.prototype.iceRestart=function(){var n=this;this._log.info("Attempting to restart ICE..."),this._hasIceCandidates=!1,this.version.createOffer(this.options.maxAverageBitrate,this.codecPreferences,{iceRestart:!0}).then(function(){n._removeReconnectionListeners(),n._onAnswerOrRinging=function(e){if(n._removeReconnectionListeners(),!e.sdp||n.version.pc.signalingState!=="have-local-offer"){var t="Invalid state or param during ICE Restart:"+("hasSdp:"+!!e.sdp+", signalingState:"+n.version.pc.signalingState);n._log.warn(t);return}var r=n._maybeSetIceAggressiveNomination(e.sdp);n._answerSdp=r,n.status!=="closed"&&n.version.processAnswer(n.codecPreferences,r,null,function(i){var s=i&&i.message?i.message:i;n._log.error("Failed to process answer during ICE Restart. Error: "+s)})},n._onHangup=function(){n._log.info("Received hangup during ICE Restart"),n._removeReconnectionListeners()},n.pstream.on("answer",n._onAnswerOrRinging),n.pstream.on("hangup",n._onHangup),n.pstream.reinvite(n.version.getSDP(),n.callSid)}).catch(function(e){var t=e&&e.message?e.message:e;n._log.error("Failed to createOffer during ICE Restart. Error: "+t),n.onfailed(t)})};Ie.prototype.makeOutgoingCall=function(n,e,t,r,i){var s=this;if(!this._initializeMediaStream(r))return;var o=this;this.callSid=t;function a(){o.options&&o._setEncodingParameters(o.options.dscp),i(o.version.pc)}function l(d){var f=d.message||d;o.onerror({info:{code:31e3,message:"Error processing answer: "+f,twilioError:new Ri.MediaErrors.ClientRemoteDescFailed}})}this._onAnswerOrRinging=function(d){if(d.sdp){var f=s._maybeSetIceAggressiveNomination(d.sdp);o._answerSdp=f,o.status!=="closed"&&o.version.processAnswer(s.codecPreferences,f,a,l),o.pstream.removeListener("answer",o._onAnswerOrRinging),o.pstream.removeListener("ringing",o._onAnswerOrRinging)}},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("ringing",this._onAnswerOrRinging);function c(){o.status!=="closed"&&(o.pstream.invite(o.version.getSDP(),o.callSid,o.options.preflight,e),o._setupRTCDtlsTransportListener())}function u(d){var f=d.message||d;o.onerror({info:{code:31e3,message:"Error creating the offer: "+f,twilioError:new Ri.MediaErrors.ClientLocalDescFailed}})}this.version.createOffer(this.options.maxAverageBitrate,this.codecPreferences,{audio:!0},c,u)};Ie.prototype.answerIncomingCall=function(n,e,t,r){if(!this._initializeMediaStream(t))return;e=this._maybeSetIceAggressiveNomination(e),this._answerSdp=e.replace(/^a=setup:actpass$/gm,"a=setup:passive"),this.callSid=n;var i=this;function s(){i.status!=="closed"&&(i.pstream.answer(i.version.getSDP(),n),i.options&&i._setEncodingParameters(i.options.dscp),r(i.version.pc),i._setupRTCDtlsTransportListener())}function o(a){var l=a.message||a;i.onerror({info:{code:31e3,message:"Error creating the answer: "+l,twilioError:new Ri.MediaErrors.ClientRemoteDescFailed}})}this.version.processSDP(this.options.maxAverageBitrate,this.codecPreferences,e,{audio:!0},s,o)};Ie.prototype.close=function(){this.version&&this.version.pc&&(this.version.pc.signalingState!=="closed"&&this.version.pc.close(),this.version.pc=null),this.stream&&(this.mute(!1),this._stopStream()),this.stream=null,this._removeReconnectionListeners(),this._stopIceGatheringTimeout(),Promise.all(this._removeAudioOutputs()).catch(function(){}),this._mediaStreamSource&&this._mediaStreamSource.disconnect(),this._inputAnalyser&&this._inputAnalyser.disconnect(),this._outputAnalyser&&this._outputAnalyser.disconnect(),this._inputAnalyser2&&this._inputAnalyser2.disconnect(),this._outputAnalyser2&&this._outputAnalyser2.disconnect(),this.status="closed",this.onclose()};Ie.prototype.reject=function(n){this.callSid=n};Ie.prototype.ignore=function(n){this.callSid=n};Ie.prototype.mute=function(n){if(this.isMuted=n,!!this.stream)if(this._sender&&this._sender.track)this._sender.track.enabled=!n;else{var e=typeof this.stream.getAudioTracks=="function"?this.stream.getAudioTracks():this.stream.audioTracks;e.forEach(function(t){t.enabled=!n})}};Ie.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender||this._dtmfSenderUnsupported)return this._dtmfSender||null;var e=this,t=this.version.pc;if(!t)return this._log.warn("No RTCPeerConnection available to call createDTMFSender on"),null;if(typeof t.getSenders=="function"&&(typeof RTCDTMFSender=="function"||typeof RTCDtmfSender=="function")){var r=t.getSenders().find(function(s){return s.dtmf});if(r)return this._log.info("Using RTCRtpSender#dtmf"),this._dtmfSender=r.dtmf,this._dtmfSender}if(typeof t.createDTMFSender=="function"&&typeof t.getLocalStreams=="function"){var i=t.getLocalStreams().map(function(s){var o=e._getAudioTracks(s);return o&&o[0]})[0];return i?(this._log.info("Creating RTCDTMFSender"),this._dtmfSender=t.createDTMFSender(i),this._dtmfSender):(this._log.warn("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null)}return this._log.info("RTCPeerConnection does not support RTCDTMFSender"),this._dtmfSenderUnsupported=!0,null};Ie.prototype.getRTCDtlsTransport=function(){var e=this.version&&this.version.pc&&typeof this.version.pc.getSenders=="function"&&this.version.pc.getSenders()[0];return e&&e.transport||null};Ie.prototype._canStopMediaStreamTrack=function(){return typeof MediaStreamTrack.prototype.stop=="function"};Ie.prototype._getAudioTracks=function(n){return typeof n.getAudioTracks=="function"?n.getAudioTracks():n.audioTracks};Ie.prototype._getRTCIceTransport=function(){var e=this.getRTCDtlsTransport();return e&&e.iceTransport||null};Ie.protocol=function(){return lp.default.test()?new lp.default:null}();function NM(n,e){typeof n.addTrack=="function"?e.getAudioTracks().forEach(function(t){n.addTrack(t,e)}):n.addStream(e)}function J1(n){var e=typeof MediaStream!="undefined"?new MediaStream:new webkitMediaStream;return n.getAudioTracks().forEach(e.addTrack,e),e}function yZ(n,e){typeof n.removeTrack=="function"?n.getSenders().forEach(function(t){n.removeTrack(t)}):n.removeStream(e)}function nb(n,e){if(typeof n.srcObject!="undefined")n.srcObject=e;else if(typeof n.mozSrcObject!="undefined")n.mozSrcObject=e;else if(typeof n.src!="undefined"){var t=n.options.window||window;n.src=(t.URL||t.webkitURL).createObjectURL(e)}else return!1;return!0}Ie.enabled=lp.default.test();eb.default=Ie;Object.defineProperty(Wi,"__esModule",{value:!0});Wi.PeerConnection=Wi.getMediaEngine=Wi.enabled=void 0;var vZ=eb;Wi.PeerConnection=vZ.default;var bZ=rm;function wZ(){return bZ.default.test()}Wi.enabled=wZ;function xZ(){return typeof RTCIceGatherer!="undefined"?"ORTC":"WebRTC"}Wi.getMediaEngine=xZ;var rb={};Object.defineProperty(rb,"__esModule",{value:!0});var qg=pn,SZ=nt;function _Z(n,e){return e=e||{},e.util=e.util||SZ,e.navigator=e.navigator||(typeof navigator!="undefined"?navigator:null),new Promise(function(t,r){if(!e.navigator)throw new qg.NotSupportedError("getUserMedia is not supported");switch("function"){case typeof(e.navigator.mediaDevices&&e.navigator.mediaDevices.getUserMedia):return t(e.navigator.mediaDevices.getUserMedia(n));case typeof e.navigator.webkitGetUserMedia:return e.navigator.webkitGetUserMedia(n,t,r);case typeof e.navigator.mozGetUserMedia:return e.navigator.mozGetUserMedia(n,t,r);case typeof e.navigator.getUserMedia:return e.navigator.getUserMedia(n,t,r);default:throw new qg.NotSupportedError("getUserMedia is not supported")}}).catch(function(t){throw e.util.isFirefox()&&t.name==="NotReadableError"?new qg.NotSupportedError(`Firefox does not currently support opening multiple audio input trackssimultaneously, even across different tabs.
Related Bugzilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324`):t})}rb.default=_Z;var ib={},sm={},sb={};Object.defineProperty(sb,"__esModule",{value:!0});var CZ=function(){function n(){var e=this;this._promise=new Promise(function(t,r){e._resolve=t,e._reject=r})}return Object.defineProperty(n.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),n.prototype.reject=function(e){this._reject(e)},n.prototype.resolve=function(e){this._resolve(e)},n}();sb.default=CZ;var kZ=be&&be.__awaiter||function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},EZ=be&&be.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(sm,"__esModule",{value:!0});sm.AsyncQueue=void 0;var TZ=sb,AZ=function(){function n(){this._operations=[]}return n.prototype.enqueue=function(e){var t=!!this._operations.length,r=new TZ.default;return this._operations.push({deferred:r,callback:e}),t||this._processQueue(),r.promise},n.prototype._processQueue=function(){return kZ(this,void 0,void 0,function(){var e,t,r,i,s,o,a;return EZ(this,function(l){switch(l.label){case 0:if(!this._operations.length)return[3,5];e=this._operations[0],t=e.deferred,r=e.callback,i=void 0,s=void 0,o=void 0,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,r()];case 2:return i=l.sent(),o=!0,[3,4];case 3:return a=l.sent(),s=a,[3,4];case 4:return this._operations.shift(),o?t.resolve(i):t.reject(s),[3,0];case 5:return[2]}})})},n}();sm.AsyncQueue=AZ;var ob={},ab={};Object.defineProperty(ab,"__esModule",{value:!0});var MZ=function(){function n(){var e=this;this.promise=new Promise(function(t,r){e._resolve=t,e._reject=r})}return Object.defineProperty(n.prototype,"reject",{get:function(){return this._reject},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolve",{get:function(){return this._resolve},enumerable:!1,configurable:!0}),n}();ab.default=MZ;var lb={},RZ=be&&be.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r};Object.defineProperty(lb,"__esModule",{value:!0});var IZ=oi,OZ=function(){function n(){this._eventEmitter=new IZ.EventEmitter}return n.prototype.addEventListener=function(e,t){return this._eventEmitter.addListener(e,t)},n.prototype.dispatchEvent=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return(t=this._eventEmitter).emit.apply(t,RZ([e],r))},n.prototype.removeEventListener=function(e,t){return this._eventEmitter.removeListener(e,t)},n}();lb.default=OZ;var PZ=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sh=be&&be.__awaiter||function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})},oh=be&&be.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(ob,"__esModule",{value:!0});var DZ=ab,$Z=lb,NZ=function(n){PZ(e,n);function e(t,r,i){r===void 0&&(r={}),i===void 0&&(i={});var s=n.call(this)||this;return s._audioNode=null,s._loop=!1,s._pendingPlayDeferreds=[],s._sinkId="default",s._src="",typeof r!="string"&&(i=r),s._audioContext=t,s._audioElement=new(i.AudioFactory||Audio),s._bufferPromise=s._createPlayDeferred().promise,s._destination=s._audioContext.destination,s._gainNode=s._audioContext.createGain(),s._gainNode.connect(s._destination),s._XMLHttpRequest=i.XMLHttpRequestFactory||XMLHttpRequest,s.addEventListener("canplaythrough",function(){s._resolvePlayDeferreds()}),typeof r=="string"&&(s.src=r),s}return Object.defineProperty(e.prototype,"destination",{get:function(){return this._destination},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){var r=this;function i(){r._audioNode.removeEventListener("ended",i),r.pause()}!t&&this.loop&&!this.paused&&this._audioNode.addEventListener("ended",i),this._loop=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._gainNode.gain.value===0},set:function(t){this._gainNode.gain.value=t?0:1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._audioNode===null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(t){this._load(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"srcObject",{get:function(){return this._audioElement.srcObject},set:function(t){this._audioElement.srcObject=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sinkId",{get:function(){return this._sinkId},enumerable:!1,configurable:!0}),e.prototype.load=function(){this._load(this._src)},e.prototype.pause=function(){this.paused||(this._audioElement.pause(),this._audioNode.stop(),this._audioNode.disconnect(this._gainNode),this._audioNode=null,this._rejectPlayDeferreds(new Error("The play() request was interrupted by a call to pause().")))},e.prototype.play=function(){return sh(this,void 0,void 0,function(){var t,r=this;return oh(this,function(i){switch(i.label){case 0:return this.paused?[3,2]:[4,this._bufferPromise];case 1:if(i.sent(),!this.paused)return[2];throw new Error("The play() request was interrupted by a call to pause().");case 2:return this._audioNode=this._audioContext.createBufferSource(),this._audioNode.loop=this.loop,this._audioNode.addEventListener("ended",function(){r._audioNode&&r._audioNode.loop||r.dispatchEvent("ended")}),[4,this._bufferPromise];case 3:if(t=i.sent(),this.paused)throw new Error("The play() request was interrupted by a call to pause().");return this._audioNode.buffer=t,this._audioNode.connect(this._gainNode),this._audioNode.start(),this._audioElement.srcObject?[2,this._audioElement.play()]:[2]}})})},e.prototype.setSinkId=function(t){return sh(this,void 0,void 0,function(){return oh(this,function(r){switch(r.label){case 0:if(typeof this._audioElement.setSinkId!="function")throw new Error("This browser does not support setSinkId.");return t===this.sinkId?[2]:t==="default"?(this.paused||this._gainNode.disconnect(this._destination),this._audioElement.srcObject=null,this._destination=this._audioContext.destination,this._gainNode.connect(this._destination),this._sinkId=t,[2]):[4,this._audioElement.setSinkId(t)];case 1:return r.sent(),this._audioElement.srcObject?[2]:(this._gainNode.disconnect(this._audioContext.destination),this._destination=this._audioContext.createMediaStreamDestination(),this._audioElement.srcObject=this._destination.stream,this._sinkId=t,this._gainNode.connect(this._destination),[2])}})})},e.prototype._createPlayDeferred=function(){var t=new DZ.default;return this._pendingPlayDeferreds.push(t),t},e.prototype._load=function(t){var r=this;this._src&&this._src!==t&&this.pause(),this._src=t,this._bufferPromise=new Promise(function(i,s){return sh(r,void 0,void 0,function(){var o;return oh(this,function(a){switch(a.label){case 0:return t?[4,LZ(this._audioContext,this._XMLHttpRequest,t)]:[2,this._createPlayDeferred().promise];case 1:return o=a.sent(),this.dispatchEvent("canplaythrough"),i(o),[2]}})})})},e.prototype._rejectPlayDeferreds=function(t){var r=this._pendingPlayDeferreds;r.splice(0,r.length).forEach(function(i){var s=i.reject;return s(t)})},e.prototype._resolvePlayDeferreds=function(t){var r=this._pendingPlayDeferreds;r.splice(0,r.length).forEach(function(i){var s=i.resolve;return s(t)})},e}($Z.default);function LZ(n,e,t){return sh(this,void 0,void 0,function(){var r,i;return oh(this,function(s){switch(s.label){case 0:return r=new e,r.open("GET",t,!0),r.responseType="arraybuffer",[4,new Promise(function(o){r.addEventListener("load",o),r.send()})];case 1:i=s.sent();try{return[2,n.decodeAudioData(i.target.response)]}catch(o){return[2,new Promise(function(a){n.decodeAudioData(i.target.response,a)})]}return[2]}})})}ob.default=NZ;Object.defineProperty(ib,"__esModule",{value:!0});var jZ=sm,JS=ob,LM=pn;function Qi(n,e,t){if(!(this instanceof Qi))return new Qi(n,e,t);if(!n||!e)throw new LM.InvalidArgumentError("name and url are required arguments");t=Object.assign({AudioFactory:typeof Audio!="undefined"?Audio:null,maxDuration:0,shouldLoop:!1},t),t.AudioPlayer=t.audioContext?JS.default.bind(JS.default,t.audioContext):t.AudioFactory,Object.defineProperties(this,{_Audio:{value:t.AudioPlayer},_activeEls:{value:new Map},_isSinkSupported:{value:t.AudioFactory!==null&&typeof t.AudioFactory.prototype.setSinkId=="function"},_maxDuration:{value:t.maxDuration},_maxDurationTimeout:{value:null,writable:!0},_operations:{value:new jZ.AsyncQueue},_playPromise:{value:null,writable:!0},_shouldLoop:{value:t.shouldLoop},_sinkIds:{value:["default"]},isPlaying:{enumerable:!0,get:function(){return!!this._playPromise}},name:{enumerable:!0,value:n},url:{enumerable:!0,value:e}}),this._Audio&&this._play(!0,!1)}function jM(n){n&&(n.pause(),n.src="",n.srcObject=null,n.load())}Qi.prototype._playAudioElement=function(e,t,r){var i=this,s=this._activeEls.get(e);if(!s)throw new LM.InvalidArgumentError('sinkId: "'+e+`" doesn't have an audio element`);return s.muted=!!t,s.loop=!!r,s.play().then(function(){return s}).catch(function(o){throw jM(s),i._activeEls.delete(e),o})};Qi.prototype._play=function(e,t){this.isPlaying&&this._stop(),this._maxDuration>0&&(this._maxDurationTimeout=setTimeout(this._stop.bind(this),this._maxDuration)),t=typeof t=="boolean"?t:this._shouldLoop;var r=this,i=this._playPromise=Promise.all(this._sinkIds.map(function(o){if(!r._Audio)return Promise.resolve();var a=r._activeEls.get(o);return a?r._playAudioElement(o,e,t):(a=new r._Audio(r.url),typeof a.setAttribute=="function"&&a.setAttribute("crossorigin","anonymous"),new Promise(function(l){a.addEventListener("canplaythrough",l)}).then(function(){return(r._isSinkSupported?a.setSinkId(o):Promise.resolve()).then(function(){return r._activeEls.set(o,a),r._playPromise?r._playAudioElement(o,e,t):Promise.resolve()})}))}));return i};Qi.prototype._stop=function(){var e=this;this._activeEls.forEach(function(t,r){e._sinkIds.includes(r)?(t.pause(),t.currentTime=0):(jM(t),e._activeEls.delete(r))}),clearTimeout(this._maxDurationTimeout),this._playPromise=null,this._maxDurationTimeout=null};Qi.prototype.setSinkIds=function(e){this._isSinkSupported&&(e=e.forEach?e:[e],[].splice.apply(this._sinkIds,[0,this._sinkIds.length].concat(e)))};Qi.prototype.stop=function(){var e=this;this._operations.enqueue(function(){return e._stop(),Promise.resolve()})};Qi.prototype.play=function(){var e=this;return this._operations.enqueue(function(){return e._play()})};ib.default=Qi;var _d={},FM={exports:{}},HM={exports:{}};(function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(t,r){return t<<r|t>>>32-r},rotr:function(t,r){return t<<32-r|t>>>r},endian:function(t){if(t.constructor==Number)return e.rotl(t,8)&16711935|e.rotl(t,24)&4278255360;for(var r=0;r<t.length;r++)t[r]=e.endian(t[r]);return t},randomBytes:function(t){for(var r=[];t>0;t--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(t){for(var r=[],i=0,s=0;i<t.length;i++,s+=8)r[s>>>5]|=t[i]<<24-s%32;return r},wordsToBytes:function(t){for(var r=[],i=0;i<t.length*32;i+=8)r.push(t[i>>>5]>>>24-i%32&255);return r},bytesToHex:function(t){for(var r=[],i=0;i<t.length;i++)r.push((t[i]>>>4).toString(16)),r.push((t[i]&15).toString(16));return r.join("")},hexToBytes:function(t){for(var r=[],i=0;i<t.length;i+=2)r.push(parseInt(t.substr(i,2),16));return r},bytesToBase64:function(t){for(var r=[],i=0;i<t.length;i+=3)for(var s=t[i]<<16|t[i+1]<<8|t[i+2],o=0;o<4;o++)i*8+o*6<=t.length*8?r.push(n.charAt(s>>>6*(3-o)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],i=0,s=0;i<t.length;s=++i%4)s!=0&&r.push((n.indexOf(t.charAt(i-1))&Math.pow(2,-2*s+8)-1)<<s*2|n.indexOf(t.charAt(i))>>>6-s*2);return r}};HM.exports=e})();var FZ=HM.exports,K1={utf8:{stringToBytes:function(n){return K1.bin.stringToBytes(unescape(encodeURIComponent(n)))},bytesToString:function(n){return decodeURIComponent(escape(K1.bin.bytesToString(n)))}},bin:{stringToBytes:function(n){for(var e=[],t=0;t<n.length;t++)e.push(n.charCodeAt(t)&255);return e},bytesToString:function(n){for(var e=[],t=0;t<n.length;t++)e.push(String.fromCharCode(n[t]));return e.join("")}}},KS=K1;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var HZ=function(n){return n!=null&&(BM(n)||BZ(n)||!!n._isBuffer)};function BM(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function BZ(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&BM(n.slice(0,0))}(function(){var n=FZ,e=KS.utf8,t=HZ,r=KS.bin,i=function(s,o){s.constructor==String?o&&o.encoding==="binary"?s=r.stringToBytes(s):s=e.stringToBytes(s):t(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var a=n.bytesToWords(s),l=s.length*8,c=1732584193,u=-271733879,d=-1732584194,f=271733878,p=0;p<a.length;p++)a[p]=(a[p]<<8|a[p]>>>24)&16711935|(a[p]<<24|a[p]>>>8)&4278255360;a[l>>>5]|=128<<l%32,a[(l+64>>>9<<4)+14]=l;for(var m=i._ff,v=i._gg,x=i._hh,b=i._ii,p=0;p<a.length;p+=16){var _=c,M=u,h=d,w=f;c=m(c,u,d,f,a[p+0],7,-680876936),f=m(f,c,u,d,a[p+1],12,-389564586),d=m(d,f,c,u,a[p+2],17,606105819),u=m(u,d,f,c,a[p+3],22,-1044525330),c=m(c,u,d,f,a[p+4],7,-176418897),f=m(f,c,u,d,a[p+5],12,1200080426),d=m(d,f,c,u,a[p+6],17,-1473231341),u=m(u,d,f,c,a[p+7],22,-45705983),c=m(c,u,d,f,a[p+8],7,1770035416),f=m(f,c,u,d,a[p+9],12,-1958414417),d=m(d,f,c,u,a[p+10],17,-42063),u=m(u,d,f,c,a[p+11],22,-1990404162),c=m(c,u,d,f,a[p+12],7,1804603682),f=m(f,c,u,d,a[p+13],12,-40341101),d=m(d,f,c,u,a[p+14],17,-1502002290),u=m(u,d,f,c,a[p+15],22,1236535329),c=v(c,u,d,f,a[p+1],5,-165796510),f=v(f,c,u,d,a[p+6],9,-1069501632),d=v(d,f,c,u,a[p+11],14,643717713),u=v(u,d,f,c,a[p+0],20,-373897302),c=v(c,u,d,f,a[p+5],5,-701558691),f=v(f,c,u,d,a[p+10],9,38016083),d=v(d,f,c,u,a[p+15],14,-660478335),u=v(u,d,f,c,a[p+4],20,-405537848),c=v(c,u,d,f,a[p+9],5,568446438),f=v(f,c,u,d,a[p+14],9,-1019803690),d=v(d,f,c,u,a[p+3],14,-187363961),u=v(u,d,f,c,a[p+8],20,1163531501),c=v(c,u,d,f,a[p+13],5,-1444681467),f=v(f,c,u,d,a[p+2],9,-51403784),d=v(d,f,c,u,a[p+7],14,1735328473),u=v(u,d,f,c,a[p+12],20,-1926607734),c=x(c,u,d,f,a[p+5],4,-378558),f=x(f,c,u,d,a[p+8],11,-2022574463),d=x(d,f,c,u,a[p+11],16,1839030562),u=x(u,d,f,c,a[p+14],23,-35309556),c=x(c,u,d,f,a[p+1],4,-1530992060),f=x(f,c,u,d,a[p+4],11,1272893353),d=x(d,f,c,u,a[p+7],16,-155497632),u=x(u,d,f,c,a[p+10],23,-1094730640),c=x(c,u,d,f,a[p+13],4,681279174),f=x(f,c,u,d,a[p+0],11,-358537222),d=x(d,f,c,u,a[p+3],16,-722521979),u=x(u,d,f,c,a[p+6],23,76029189),c=x(c,u,d,f,a[p+9],4,-640364487),f=x(f,c,u,d,a[p+12],11,-421815835),d=x(d,f,c,u,a[p+15],16,530742520),u=x(u,d,f,c,a[p+2],23,-995338651),c=b(c,u,d,f,a[p+0],6,-198630844),f=b(f,c,u,d,a[p+7],10,1126891415),d=b(d,f,c,u,a[p+14],15,-1416354905),u=b(u,d,f,c,a[p+5],21,-57434055),c=b(c,u,d,f,a[p+12],6,1700485571),f=b(f,c,u,d,a[p+3],10,-1894986606),d=b(d,f,c,u,a[p+10],15,-1051523),u=b(u,d,f,c,a[p+1],21,-2054922799),c=b(c,u,d,f,a[p+8],6,1873313359),f=b(f,c,u,d,a[p+15],10,-30611744),d=b(d,f,c,u,a[p+6],15,-1560198380),u=b(u,d,f,c,a[p+13],21,1309151649),c=b(c,u,d,f,a[p+4],6,-145523070),f=b(f,c,u,d,a[p+11],10,-1120210379),d=b(d,f,c,u,a[p+2],15,718787259),u=b(u,d,f,c,a[p+9],21,-343485551),c=c+_>>>0,u=u+M>>>0,d=d+h>>>0,f=f+w>>>0}return n.endian([c,u,d,f])};i._ff=function(s,o,a,l,c,u,d){var f=s+(o&a|~o&l)+(c>>>0)+d;return(f<<u|f>>>32-u)+o},i._gg=function(s,o,a,l,c,u,d){var f=s+(o&l|a&~l)+(c>>>0)+d;return(f<<u|f>>>32-u)+o},i._hh=function(s,o,a,l,c,u,d){var f=s+(o^a^l)+(c>>>0)+d;return(f<<u|f>>>32-u)+o},i._ii=function(s,o,a,l,c,u,d){var f=s+(a^(o|~l))+(c>>>0)+d;return(f<<u|f>>>32-u)+o},i._blocksize=16,i._digestsize=16,FM.exports=function(s,o){if(s==null)throw new Error("Illegal argument "+s);var a=n.wordsToBytes(i(s,o));return o&&o.asBytes?a:o&&o.asString?r.bytesToString(a):n.bytesToHex(a)}})();var zZ=FM.exports;Object.defineProperty(_d,"__esModule",{value:!0});_d.generateVoiceEventSid=void 0;var Ug=zZ,vf=pn,VZ=typeof Ug=="function"?Ug:Ug.default;function qZ(){if(typeof window!="object")throw new vf.NotSupportedError("This platform is not supported.");var n=window.crypto;if(typeof n!="object")throw new vf.NotSupportedError("The `crypto` module is not available on this platform.");if(typeof(n.randomUUID||n.getRandomValues)=="undefined")throw new vf.NotSupportedError("Neither `crypto.randomUUID` or `crypto.getRandomValues` are available on this platform.");var e=window.Uint32Array;if(typeof e=="undefined")throw new vf.NotSupportedError("The `Uint32Array` module is not available on this platform.");var t=typeof n.randomUUID=="function"?function(){return n.randomUUID()}:function(){return n.getRandomValues(new Uint32Array(32)).toString()};return VZ(t())}function UZ(){return"KX"+qZ()}_d.generateVoiceEventSid=UZ;var GS;function om(){if(GS)return mf;GS=1;var n=be&&be.__extends||function(){var S=function(k,T){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,D){C.__proto__=D}||function(C,D){for(var A in D)Object.prototype.hasOwnProperty.call(D,A)&&(C[A]=D[A])},S(k,T)};return function(k,T){S(k,T);function C(){this.constructor=k}k.prototype=T===null?Object.create(T):(C.prototype=T.prototype,new C)}}(),e=be&&be.__assign||function(){return e=Object.assign||function(S){for(var k,T=1,C=arguments.length;T<C;T++){k=arguments[T];for(var D in k)Object.prototype.hasOwnProperty.call(k,D)&&(S[D]=k[D])}return S},e.apply(this,arguments)},t=be&&be.__awaiter||function(S,k,T,C){function D(A){return A instanceof T?A:new T(function(O){O(A)})}return new(T||(T=Promise))(function(A,O){function P(j){try{F(C.next(j))}catch(J){O(J)}}function N(j){try{F(C.throw(j))}catch(J){O(J)}}function F(j){j.done?A(j.value):D(j.value).then(P,N)}F((C=C.apply(S,k||[])).next())})},r=be&&be.__generator||function(S,k){var T={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},C,D,A,O;return O={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function P(F){return function(j){return N([F,j])}}function N(F){if(C)throw new TypeError("Generator is already executing.");for(;T;)try{if(C=1,D&&(A=F[0]&2?D.return:F[0]?D.throw||((A=D.return)&&A.call(D),0):D.next)&&!(A=A.call(D,F[1])).done)return A;switch(D=0,A&&(F=[F[0]&2,A.value]),F[0]){case 0:case 1:A=F;break;case 4:return T.label++,{value:F[1],done:!1};case 5:T.label++,D=F[1],F=[0];continue;case 7:F=T.ops.pop(),T.trys.pop();continue;default:if(A=T.trys,!(A=A.length>0&&A[A.length-1])&&(F[0]===6||F[0]===2)){T=0;continue}if(F[0]===3&&(!A||F[1]>A[0]&&F[1]<A[3])){T.label=F[1];break}if(F[0]===6&&T.label<A[1]){T.label=A[1],A=F;break}if(A&&T.label<A[2]){T.label=A[2],T.ops.push(F);break}A[2]&&T.ops.pop(),T.trys.pop();continue}F=k.call(S,T)}catch(j){F=[6,j],D=0}finally{C=A=0}if(F[0]&5)throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}};Object.defineProperty(mf,"__esModule",{value:!0});var i=oi,s=vM,o=lX(),a=nm,l=ub(),c=fn,u=Jv,d=pn,f=Kv,p=Cn,m=RM(),v=Zv,x=OM,b=Wi,_=rb,M=ib,h=nt,w=_d,y=3e4,E=2e3,g="twilio-js-sdk",I='Parameter "token" must be of type "string".',R=function(S){n(k,S);function k(T,C){var D;C===void 0&&(C={});var A=S.call(this)||this;if(A._activeCall=null,A._audio=null,A._audioProcessorEventObserver=null,A._callInputStream=null,A._calls=[],A._callSinkIds=["default"],A._chunderURIs=[],A._defaultOptions={allowIncomingWhileBusy:!1,closeProtection:!1,codecPreferences:[l.default.Codec.PCMU,l.default.Codec.Opus],dscp:!0,enableImprovedSignalingErrorPrecision:!1,forceAggressiveIceNomination:!1,logLevel:s.levels.ERROR,maxCallSignalingTimeoutMs:0,preflight:!1,sounds:{},tokenRefreshMs:1e4,voiceEventSidGenerator:w.generateVoiceEventSid},A._edge=null,A._home=null,A._identity=null,A._log=new p.default("Device"),A._options={},A._preferredURI=null,A._publisher=null,A._region=null,A._regTimer=null,A._shouldReRegister=!1,A._soundcache=new Map,A._state=k.State.Unregistered,A._stateEventMapping=(D={},D[k.State.Destroyed]=k.EventName.Destroyed,D[k.State.Unregistered]=k.EventName.Unregistered,D[k.State.Registering]=k.EventName.Registering,D[k.State.Registered]=k.EventName.Registered,D),A._stream=null,A._streamConnectedPromise=null,A._tokenWillExpireTimeout=null,A._createDefaultPayload=function(F){var j={aggressive_nomination:A._options.forceAggressiveIceNomination,browser_extension:A._isBrowserExtension,dscp:!!A._options.dscp,ice_restart_enabled:!0,platform:b.getMediaEngine(),sdk_version:c.RELEASE_VERSION};function J(oe,he){he&&(j[oe]=he)}if(F){var ie=F.parameters.CallSid;J("call_sid",/^TJ/.test(ie)?void 0:ie),J("temp_call_sid",F.outboundConnectionId),J("audio_codec",F.codec),j.direction=F.direction}return J("gateway",A._stream&&A._stream.gateway),J("region",A._stream&&A._stream.region),j},A._onSignalingClose=function(){A._stream=null,A._streamConnectedPromise=null},A._onSignalingConnected=function(F){var j,J=x.getRegionShortcode(F.region);if(A._edge=F.edge||x.regionToEdge[J]||F.region,A._region=J||F.region,A._home=F.home,(j=A._publisher)===null||j===void 0||j.setHost(x.createEventGatewayURI(F.home)),F.token&&(A._identity=F.token.identity,typeof F.token.ttl=="number"&&typeof A._options.tokenRefreshMs=="number")){var ie=F.token.ttl*1e3,oe=Math.max(0,ie-A._options.tokenRefreshMs);A._tokenWillExpireTimeout=setTimeout(function(){A._log.debug("#tokenWillExpire"),A.emit("tokenWillExpire",A),A._tokenWillExpireTimeout&&(clearTimeout(A._tokenWillExpireTimeout),A._tokenWillExpireTimeout=null)},oe)}var he=x.getChunderURIs(A._edge);if(he.length>0){var ae=he[0];A._preferredURI=x.createSignalingEndpointURL(ae)}else A._log.warn("Could not parse a preferred URI from the stream#connected event.");A._shouldReRegister&&A.register()},A._onSignalingError=function(F){if(typeof F=="object"){var j=F.error,J=F.callsid;if(typeof j=="object"){var ie=typeof J=="string"&&A._findCall(J)||void 0,oe=j.code,he=j.message,ae=j.twilioError;if(typeof oe=="number")if(oe===31201)ae=new d.AuthorizationErrors.AuthenticationFailed(j);else if(oe===31204)ae=new d.AuthorizationErrors.AccessTokenInvalid(j);else if(oe===31205)A._stopRegistrationTimer(),ae=new d.AuthorizationErrors.AccessTokenExpired(j);else{var B=d.getPreciseSignalingErrorByCode(!!A._options.enableImprovedSignalingErrorPrecision,oe);typeof B!="undefined"&&(ae=new B(j))}ae||(A._log.error("Unknown signaling error: ",j),ae=new d.GeneralErrors.UnknownError(he,j)),A._log.error("Received error: ",ae),A._log.debug("#error",j),A.emit(k.EventName.Error,ae,ie)}}},A._onSignalingInvite=function(F){return t(A,void 0,void 0,function(){var j,J,ie,oe,he,ae=this,B;return r(this,function(ee){switch(ee.label){case 0:return j=!!this._activeCall,j&&!this._options.allowIncomingWhileBusy?(this._log.info("Device busy; ignoring incoming invite"),[2]):!F.callsid||!F.sdp?(this._log.debug("#error",F),this.emit(k.EventName.Error,new d.ClientErrors.BadRequest("Malformed invite from gateway")),[2]):(J=F.parameters||{},J.CallSid=J.CallSid||F.callsid,ie=Object.assign({},h.queryToJson(J.Params)),[4,this._makeCall(ie,{callParameters:J,enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,offerSdp:F.sdp,reconnectToken:F.reconnect,voiceEventSidGenerator:this._options.voiceEventSidGenerator})]);case 1:return oe=ee.sent(),this._calls.push(oe),oe.once("accept",function(){ae._soundcache.get(k.SoundName.Incoming).stop(),ae._publishNetworkChange()}),he=!((B=this._audio)===null||B===void 0)&&B.incoming()&&!j?function(){return ae._soundcache.get(k.SoundName.Incoming).play()}:function(){return Promise.resolve()},this._showIncomingCall(oe,he),[2]}})})},A._onSignalingOffline=function(){A._log.info("Stream is offline"),A._edge=null,A._region=null,A._shouldReRegister=A.state!==k.State.Unregistered,A._setState(k.State.Unregistered)},A._onSignalingReady=function(){A._log.info("Stream is ready"),A._setState(k.State.Registered)},A._publishNetworkChange=function(){A._activeCall&&A._networkInformation&&A._publisher.info("network-information","network-change",{connection_type:A._networkInformation.type,downlink:A._networkInformation.downlink,downlinkMax:A._networkInformation.downlinkMax,effective_type:A._networkInformation.effectiveType,rtt:A._networkInformation.rtt},A._activeCall)},A._updateInputStream=function(F){var j=A._activeCall;return j&&!F?Promise.reject(new d.InvalidStateError("Cannot unset input device while a call is in progress.")):(A._callInputStream=F,j?j._setInputTracksFromStream(F):Promise.resolve())},A._updateSinkIds=function(F,j){var J=F==="ringtone"?A._updateRingtoneSinkIds(j):A._updateSpeakerSinkIds(j);return J.then(function(){A._publisher.info("audio",F+"-devices-set",{audio_device_ids:j},A._activeCall)},function(ie){throw A._publisher.error("audio",F+"-devices-set-failed",{audio_device_ids:j,message:ie.message},A._activeCall),ie})},A._setupLoglevel(C.logLevel),A._logOptions("constructor",C),A.updateToken(T),h.isLegacyEdge())throw new d.NotSupportedError("Microsoft Edge Legacy (https://support.microsoft.com/en-us/help/4533505/what-is-microsoft-edge-legacy) is deprecated and will not be able to connect to Twilio to make or receive calls after September 1st, 2020. Please see this documentation for a list of supported browsers https://www.twilio.com/docs/voice/client/javascript#supported-browsers");if(!k.isSupported&&C.ignoreBrowserSupport)throw window&&window.location&&window.location.protocol==="http:"?new d.NotSupportedError("twilio.js wasn't able to find WebRTC browser support.           This is most likely because this page is served over http rather than https,           which does not support WebRTC in many browsers. Please load this page over https and           try again."):new d.NotSupportedError("twilio.js 1.3+ SDKs require WebRTC browser support.         For more information, see <https://www.twilio.com/docs/api/client/twilio-js>.         If you have any questions about this announcement, please contact         Twilio Support at <help@twilio.com>.");if(window){var O=window,P=O.msBrowser||O.browser||O.chrome;A._isBrowserExtension=!!P&&!!P.runtime&&!!P.runtime.id||!!O.safari&&!!O.safari.extension}if(A._isBrowserExtension&&A._log.info("Running as browser extension."),navigator){var N=navigator;A._networkInformation=N.connection||N.mozConnection||N.webkitConnection}return A._networkInformation&&typeof A._networkInformation.addEventListener=="function"&&A._networkInformation.addEventListener("change",A._publishNetworkChange),k._getOrCreateAudioContext(),k._audioContext&&(k._dialtonePlayer||(k._dialtonePlayer=new u.default(k._audioContext))),typeof k._isUnifiedPlanDefault=="undefined"&&(k._isUnifiedPlanDefault=typeof window!="undefined"&&typeof RTCPeerConnection!="undefined"&&typeof RTCRtpTransceiver!="undefined"?h.isUnifiedPlanDefault(window,window.navigator,RTCPeerConnection,RTCRtpTransceiver):!1),A._boundDestroy=A.destroy.bind(A),A._boundConfirmClose=A._confirmClose.bind(A),typeof window!="undefined"&&window.addEventListener&&(window.addEventListener("unload",A._boundDestroy),window.addEventListener("pagehide",A._boundDestroy)),A.updateOptions(C),A}return Object.defineProperty(k,"audioContext",{get:function(){return k._audioContext},enumerable:!1,configurable:!0}),Object.defineProperty(k,"extension",{get:function(){var T=typeof document!="undefined"?document.createElement("audio"):{canPlayType:!1},C;try{C=T.canPlayType&&!!T.canPlayType("audio/mpeg").replace(/no/,"")}catch(A){C=!1}var D;try{D=T.canPlayType&&!!T.canPlayType("audio/ogg;codecs='vorbis'").replace(/no/,"")}catch(A){D=!1}return D&&!C?"ogg":"mp3"},enumerable:!1,configurable:!0}),Object.defineProperty(k,"isSupported",{get:function(){return b.enabled()},enumerable:!1,configurable:!0}),Object.defineProperty(k,"packageName",{get:function(){return c.PACKAGE_NAME},enumerable:!1,configurable:!0}),k.runPreflight=function(T,C){return new m.PreflightTest(T,e({audioContext:k._getOrCreateAudioContext()},C))},k.toString=function(){return"[Twilio.Device class]"},Object.defineProperty(k,"version",{get:function(){return c.RELEASE_VERSION},enumerable:!1,configurable:!0}),k._getOrCreateAudioContext=function(){return k._audioContext||(typeof AudioContext!="undefined"?k._audioContext=new AudioContext:typeof webkitAudioContext!="undefined"&&(k._audioContext=new webkitAudioContext)),k._audioContext},Object.defineProperty(k.prototype,"audio",{get:function(){return this._audio},enumerable:!1,configurable:!0}),k.prototype.connect=function(T){return T===void 0&&(T={}),t(this,void 0,void 0,function(){var C,D;return r(this,function(A){switch(A.label){case 0:if(this._log.debug(".connect",JSON.stringify(T&&T.params||{}),T),this._throwIfDestroyed(),this._activeCall)throw new d.InvalidStateError("A Call is already active");return D=this,[4,this._makeCall(T.params||{},{enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,rtcConfiguration:T.rtcConfiguration,voiceEventSidGenerator:this._options.voiceEventSidGenerator})];case 1:return C=D._activeCall=A.sent(),this._calls.splice(0).forEach(function(O){return O.ignore()}),this._soundcache.get(k.SoundName.Incoming).stop(),C.accept({rtcConstraints:T.rtcConstraints}),this._publishNetworkChange(),[2,C]}})})},Object.defineProperty(k.prototype,"calls",{get:function(){return this._calls},enumerable:!1,configurable:!0}),k.prototype.destroy=function(){var T;this._log.debug(".destroy"),this._log.debug("Rejecting any incoming calls");var C=this._calls.slice(0);C.forEach(function(D){return D.reject()}),this.disconnectAll(),this._stopRegistrationTimer(),this._destroyStream(),this._destroyPublisher(),this._destroyAudioHelper(),(T=this._audioProcessorEventObserver)===null||T===void 0||T.destroy(),this._networkInformation&&typeof this._networkInformation.removeEventListener=="function"&&this._networkInformation.removeEventListener("change",this._publishNetworkChange),typeof window!="undefined"&&window.removeEventListener&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.removeEventListener("unload",this._boundDestroy),window.removeEventListener("pagehide",this._boundDestroy)),this._setState(k.State.Destroyed),i.EventEmitter.prototype.removeAllListeners.call(this)},k.prototype.disconnectAll=function(){this._log.debug(".disconnectAll");var T=this._calls.splice(0);T.forEach(function(C){return C.disconnect()}),this._activeCall&&this._activeCall.disconnect()},Object.defineProperty(k.prototype,"edge",{get:function(){return this._edge},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"home",{get:function(){return this._home},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"identity",{get:function(){return this._identity},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"isBusy",{get:function(){return!!this._activeCall},enumerable:!1,configurable:!0}),k.prototype.register=function(){return t(this,void 0,void 0,function(){return r(this,function(T){switch(T.label){case 0:if(this._log.debug(".register"),this.state!==k.State.Unregistered)throw new d.InvalidStateError('Attempt to register when device is in state "'+this.state+'". '+('Must be "'+k.State.Unregistered+'".'));return this._shouldReRegister=!1,this._setState(k.State.Registering),[4,this._streamConnectedPromise||this._setupStream()];case 1:return T.sent(),[4,this._sendPresence(!0)];case 2:return T.sent(),[4,h.promisifyEvents(this,k.State.Registered,k.State.Unregistered)];case 3:return T.sent(),[2]}})})},Object.defineProperty(k.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),k.prototype.toString=function(){return"[Twilio.Device instance]"},k.prototype.unregister=function(){return t(this,void 0,void 0,function(){var T,C;return r(this,function(D){switch(D.label){case 0:if(this._log.debug(".unregister"),this.state!==k.State.Registered)throw new d.InvalidStateError('Attempt to unregister when device is in state "'+this.state+'". '+('Must be "'+k.State.Registered+'".'));return this._shouldReRegister=!1,[4,this._streamConnectedPromise];case 1:return T=D.sent(),C=new Promise(function(A){T.on("offline",A)}),[4,this._sendPresence(!1)];case 2:return D.sent(),[4,C];case 3:return D.sent(),[2]}})})},k.prototype.updateOptions=function(T){if(T===void 0&&(T={}),this._logOptions("updateOptions",T),this.state===k.State.Destroyed)throw new d.InvalidStateError('Attempt to "updateOptions" when device is in state "'+this.state+'".');this._options=e(e(e({},this._defaultOptions),this._options),T);var C=new Set(this._chunderURIs),D=typeof this._options.chunderw=="string"?[this._options.chunderw]:Array.isArray(this._options.chunderw)&&this._options.chunderw,A=this._chunderURIs=(D||x.getChunderURIs(this._options.edge)).map(x.createSignalingEndpointURL),O=C.size!==A.length;if(!O)for(var P=0,N=A;P<N.length;P++){var F=N[P];if(!C.has(F)){O=!0;break}}if(this.isBusy&&O)throw new d.InvalidStateError("Cannot change Edge while on an active Call");this._setupLoglevel(this._options.logLevel);for(var j=0,J=Object.keys(k._defaultSounds);j<J.length;j++){var ie=J[j],oe=k._defaultSounds[ie],he=c.SOUNDS_BASE_URL+"/"+oe.filename+"."+k.extension+("?cache="+c.RELEASE_VERSION),ae=this._options.sounds&&this._options.sounds[ie]||he,B=new(this._options.Sound||M.default)(ie,ae,{audioContext:this._options.disableAudioContextSounds?null:k.audioContext,maxDuration:oe.maxDuration,shouldLoop:oe.shouldLoop});this._soundcache.set(ie,B)}this._setupAudioHelper(),this._setupPublisher(),O&&this._streamConnectedPromise&&this._setupStream(),typeof window!="undefined"&&typeof window.addEventListener=="function"&&this._options.closeProtection&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.addEventListener("beforeunload",this._boundConfirmClose))},k.prototype.updateToken=function(T){if(this._log.debug(".updateToken"),this.state===k.State.Destroyed)throw new d.InvalidStateError('Attempt to "updateToken" when device is in state "'+this.state+'".');if(typeof T!="string")throw new d.InvalidArgumentError(I);this._token=T,this._stream&&this._stream.setToken(this._token),this._publisher&&this._publisher.setToken(this._token)},k.prototype._confirmClose=function(T){if(!this._activeCall)return"";var C=this._options.closeProtection||!1,D=typeof C!="string"?"A call is currently in-progress. Leaving or reloading this page will end the call.":C;return(T||window.event).returnValue=D,D},k.prototype._destroyAudioHelper=function(){this._audio&&(this._audio._destroy(),this._audio=null)},k.prototype._destroyPublisher=function(){this._publisher&&(this._publisher=null)},k.prototype._destroyStream=function(){this._stream&&(this._stream.removeListener("close",this._onSignalingClose),this._stream.removeListener("connected",this._onSignalingConnected),this._stream.removeListener("error",this._onSignalingError),this._stream.removeListener("invite",this._onSignalingInvite),this._stream.removeListener("offline",this._onSignalingOffline),this._stream.removeListener("ready",this._onSignalingReady),this._stream.destroy(),this._stream=null),this._onSignalingOffline(),this._streamConnectedPromise=null},k.prototype._findCall=function(T){return this._calls.find(function(C){return C.parameters.CallSid===T||C.outboundConnectionId===T})||null},k.prototype._logOptions=function(T,C){C===void 0&&(C={});var D=["allowIncomingWhileBusy","appName","appVersion","closeProtection","codecPreferences","disableAudioContextSounds","dscp","edge","enableImprovedSignalingErrorPrecision","forceAggressiveIceNomination","logLevel","maxAverageBitrate","maxCallSignalingTimeoutMs","sounds","tokenRefreshMs"],A=["RTCPeerConnection","enumerateDevices","getUserMedia"];if(typeof C=="object"){var O=e({},C);Object.keys(O).forEach(function(P){!D.includes(P)&&!A.includes(P)&&delete O[P],A.includes(P)&&(O[P]=!0)}),this._log.debug("."+T,JSON.stringify(O))}},k.prototype._makeCall=function(T,C){return t(this,void 0,void 0,function(){var D,A,O,P,N=this;return r(this,function(F){switch(F.label){case 0:if(typeof k._isUnifiedPlanDefault=="undefined")throw new d.InvalidStateError("Device has not been initialized.");return P={audioHelper:this._audio,isUnifiedPlanDefault:k._isUnifiedPlanDefault,onIgnore:function(){N._soundcache.get(k.SoundName.Incoming).stop()}},[4,this._streamConnectedPromise||this._setupStream()];case 1:return D=(P.pstream=F.sent(),P.publisher=this._publisher,P.soundcache=this._soundcache,P),C=Object.assign({MediaStream:this._options.MediaStream||b.PeerConnection,RTCPeerConnection:this._options.RTCPeerConnection,beforeAccept:function(j){!N._activeCall||N._activeCall===j||(N._activeCall.disconnect(),N._removeCall(N._activeCall))},codecPreferences:this._options.codecPreferences,customSounds:this._options.sounds,dialtonePlayer:k._dialtonePlayer,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,getInputStream:function(){return N._options.fileInputStream||N._callInputStream},getSinkIds:function(){return N._callSinkIds},maxAverageBitrate:this._options.maxAverageBitrate,preflight:this._options.preflight,rtcConstraints:this._options.rtcConstraints,shouldPlayDisconnect:function(){var j;return(j=N._audio)===null||j===void 0?void 0:j.disconnect()},twimlParams:T,voiceEventSidGenerator:this._options.voiceEventSidGenerator},C),A=function(){if(!N._stream){N._log.warn("UnsetPreferredUri called without a stream");return}N._activeCall===null&&N._calls.length===0&&N._stream.updatePreferredURI(null)},O=new(this._options.Call||l.default)(D,C),this._publisher.info("settings","init",{RTCPeerConnection:!!this._options.RTCPeerConnection,enumerateDevices:!!this._options.enumerateDevices,getUserMedia:!!this._options.getUserMedia},O),O.once("accept",function(){var j,J,ie;N._stream.updatePreferredURI(N._preferredURI),N._removeCall(O),N._activeCall=O,N._audio&&N._audio._maybeStartPollingVolume(),O.direction===l.default.CallDirection.Outgoing&&(!((j=N._audio)===null||j===void 0)&&j.outgoing())&&N._soundcache.get(k.SoundName.Outgoing).play();var oe={edge:N._edge||N._region};N._options.edge&&(oe.selected_edge=Array.isArray(N._options.edge)?N._options.edge:[N._options.edge]),N._publisher.info("settings","edge",oe,O),!((J=N._audio)===null||J===void 0)&&J.processedStream&&((ie=N._audioProcessorEventObserver)===null||ie===void 0||ie.emit("enabled"))}),O.addListener("error",function(j){O.status()==="closed"&&(N._removeCall(O),A()),N._audio&&N._audio._maybeStopPollingVolume(),N._maybeStopIncomingSound()}),O.once("cancel",function(){N._log.info("Canceled: "+O.parameters.CallSid),N._removeCall(O),A(),N._audio&&N._audio._maybeStopPollingVolume(),N._maybeStopIncomingSound()}),O.once("disconnect",function(){N._audio&&N._audio._maybeStopPollingVolume(),N._removeCall(O),A(),N._maybeStopIncomingSound()}),O.once("reject",function(){N._log.info("Rejected: "+O.parameters.CallSid),N._audio&&N._audio._maybeStopPollingVolume(),N._removeCall(O),A(),N._maybeStopIncomingSound()}),O.on("transportClose",function(){O.status()===l.default.State.Pending&&(N._audio&&N._audio._maybeStopPollingVolume(),N._removeCall(O),N._maybeStopIncomingSound())}),[2,O]}})})},k.prototype._maybeStopIncomingSound=function(){this._calls.length||this._soundcache.get(k.SoundName.Incoming).stop()},k.prototype._removeCall=function(T){this._activeCall===T&&(this._activeCall=null);for(var C=this._calls.length-1;C>=0;C--)T===this._calls[C]&&this._calls.splice(C,1)},k.prototype._sendPresence=function(T){return t(this,void 0,void 0,function(){var C;return r(this,function(D){switch(D.label){case 0:return[4,this._streamConnectedPromise];case 1:return C=D.sent(),C?(C.register({audio:T}),T?this._startRegistrationTimer():this._stopRegistrationTimer(),[2]):[2]}})})},k.prototype._setState=function(T){if(T!==this.state){this._state=T;var C=this._stateEventMapping[T];this._log.debug("#"+C),this.emit(C)}},k.prototype._setupAudioHelper=function(){var T=this;this._audioProcessorEventObserver||(this._audioProcessorEventObserver=new a.AudioProcessorEventObserver,this._audioProcessorEventObserver.on("event",function(D){var A=D.name,O=D.group;T._publisher.info(O,A,{},T._activeCall)}));var C={audioContext:k.audioContext,audioProcessorEventObserver:this._audioProcessorEventObserver,enumerateDevices:this._options.enumerateDevices,getUserMedia:this._options.getUserMedia||_.default};if(this._audio){this._log.info("Found existing audio helper; updating options..."),this._audio._updateUserOptions(C);return}this._audio=new(this._options.AudioHelper||o.default)(this._updateSinkIds,this._updateInputStream,C),this._audio.on("deviceChange",function(D){var A=T._activeCall,O=D.map(function(P){return P.deviceId});T._publisher.info("audio","device-change",{lost_active_device_ids:O},A),A&&A._mediaHandler._onInputDevicesChanged()})},k.prototype._setupLoglevel=function(T){var C=typeof T=="number"||typeof T=="string"?T:s.levels.ERROR;this._log.setDefaultLevel(C),this._log.info("Set logger default level to",C)},k.prototype._setupPublisher=function(){var T=this;this._publisher&&(this._log.info("Found existing publisher; destroying..."),this._destroyPublisher());var C={defaultPayload:this._createDefaultPayload,metadata:{app_name:this._options.appName,app_version:this._options.appVersion}};return this._options.eventgw&&(C.host=this._options.eventgw),this._home&&(C.host=x.createEventGatewayURI(this._home)),this._publisher=new(this._options.Publisher||f.default)(g,this.token,C),this._options.publishEvents===!1?this._publisher.disable():this._publisher.on("error",function(D){T._log.warn("Cannot connect to insights.",D)}),this._publisher},k.prototype._setupStream=function(){var T=this;return this._stream&&(this._log.info("Found existing stream; destroying..."),this._destroyStream()),this._log.info("Setting up VSP"),this._stream=new(this._options.PStream||v.default)(this.token,this._chunderURIs,{backoffMaxMs:this._options.backoffMaxMs,maxPreferredDurationMs:this._options.maxCallSignalingTimeoutMs}),this._stream.addListener("close",this._onSignalingClose),this._stream.addListener("connected",this._onSignalingConnected),this._stream.addListener("error",this._onSignalingError),this._stream.addListener("invite",this._onSignalingInvite),this._stream.addListener("offline",this._onSignalingOffline),this._stream.addListener("ready",this._onSignalingReady),this._streamConnectedPromise=h.promisifyEvents(this._stream,"connected","close").then(function(){return T._stream})},k.prototype._showIncomingCall=function(T,C){var D=this,A;return Promise.race([C(),new Promise(function(O,P){A=setTimeout(function(){var N="Playing incoming ringtone took too long; it might not play. Continuing execution...";P(new Error(N))},E)})]).catch(function(O){D._log.warn(O.message)}).then(function(){clearTimeout(A),D._log.debug("#incoming",JSON.stringify({customParameters:T.customParameters,parameters:T.parameters})),D.emit(k.EventName.Incoming,T)})},k.prototype._startRegistrationTimer=function(){var T=this;this._stopRegistrationTimer(),this._regTimer=setTimeout(function(){T._sendPresence(!0)},y)},k.prototype._stopRegistrationTimer=function(){this._regTimer&&clearTimeout(this._regTimer)},k.prototype._throwIfDestroyed=function(){if(this.state===k.State.Destroyed)throw new d.InvalidStateError("Device has been destroyed.")},k.prototype._updateRingtoneSinkIds=function(T){return Promise.resolve(this._soundcache.get(k.SoundName.Incoming).setSinkIds(T))},k.prototype._updateSpeakerSinkIds=function(T){Array.from(this._soundcache.entries()).filter(function(D){return D[0]!==k.SoundName.Incoming}).forEach(function(D){return D[1].setSinkIds(T)}),this._callSinkIds=T;var C=this._activeCall;return C?C._setSinkIds(T):Promise.resolve()},k._defaultSounds={disconnect:{filename:"disconnect",maxDuration:3e3},dtmf0:{filename:"dtmf-0",maxDuration:1e3},dtmf1:{filename:"dtmf-1",maxDuration:1e3},dtmf2:{filename:"dtmf-2",maxDuration:1e3},dtmf3:{filename:"dtmf-3",maxDuration:1e3},dtmf4:{filename:"dtmf-4",maxDuration:1e3},dtmf5:{filename:"dtmf-5",maxDuration:1e3},dtmf6:{filename:"dtmf-6",maxDuration:1e3},dtmf7:{filename:"dtmf-7",maxDuration:1e3},dtmf8:{filename:"dtmf-8",maxDuration:1e3},dtmf9:{filename:"dtmf-9",maxDuration:1e3},dtmfh:{filename:"dtmf-hash",maxDuration:1e3},dtmfs:{filename:"dtmf-star",maxDuration:1e3},incoming:{filename:"incoming",shouldLoop:!0},outgoing:{filename:"outgoing",maxDuration:3e3}},k}(i.EventEmitter);return function(S){(function(k){k.Error="error",k.Incoming="incoming",k.Destroyed="destroyed",k.Unregistered="unregistered",k.Registering="registering",k.Registered="registered",k.TokenWillExpire="tokenWillExpire"})(S.EventName||(S.EventName={})),function(k){k.Destroyed="destroyed",k.Unregistered="unregistered",k.Registering="registering",k.Registered="registered"}(S.State||(S.State={})),function(k){k.Incoming="incoming",k.Outgoing="outgoing",k.Disconnect="disconnect",k.Dtmf0="dtmf0",k.Dtmf1="dtmf1",k.Dtmf2="dtmf2",k.Dtmf3="dtmf3",k.Dtmf4="dtmf4",k.Dtmf5="dtmf5",k.Dtmf6="dtmf6",k.Dtmf7="dtmf7",k.Dtmf8="dtmf8",k.Dtmf9="dtmf9",k.DtmfS="dtmfs",k.DtmfH="dtmfh"}(S.SoundName||(S.SoundName={}))}(R||(R={})),mf.default=R,mf}var am={};Object.defineProperty(am,"__esModule",{value:!0});am.IceCandidate=void 0;var WZ=function(){function n(e,t){t===void 0&&(t=!1),this.deleted=!1;var r,i=e.candidate.split("network-cost ");i[1]&&(r=parseInt(i[1],10)),this.candidateType=e.type,this.ip=e.ip||e.address,this.isRemote=t,this.networkCost=r,this.port=e.port,this.priority=e.priority,this.protocol=e.protocol,this.relatedAddress=e.relatedAddress,this.relatedPort=e.relatedPort,this.tcpType=e.tcpType,this.transportId=e.sdpMid}return n.prototype.toPayload=function(){return{candidate_type:this.candidateType,deleted:this.deleted,ip:this.ip,is_remote:this.isRemote,"network-cost":this.networkCost,port:this.port,priority:this.priority,protocol:this.protocol,related_address:this.relatedAddress,related_port:this.relatedPort,tcp_type:this.tcpType,transport_id:this.transportId}},n}();am.IceCandidate=WZ;var cb={},ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.isNonNegativeNumber=ca.calculate=void 0;var YS=94.768;function zM(n,e,t){if(typeof n!="number"||typeof e!="number"||typeof t!="number"||!vu(n)||!vu(e)||!vu(t))return null;var r=n+e*2+10,i=0;switch(!0){case r<160:i=YS-r/40;break;case r<1e3:i=YS-(r-120)/10;break}switch(!0){case t<=i/2.5:i=Math.max(i-t*2.5,6.52);break;default:i=0;break}var s=1+.035*i+7e-6*i*(i-60)*(100-i);return s}ca.calculate=zM;function vu(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)&&n>=0}ca.isNonNegativeNumber=vu;ca.default={calculate:zM,isNonNegativeNumber:vu};var JZ=be&&be.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ks=be&&be.__assign||function(){return ks=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},ks.apply(this,arguments)},VM=be&&be.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r};Object.defineProperty(cb,"__esModule",{value:!0});var KZ=oi,XS=pn,GZ=ca,YZ=la,Wg=nt,XZ=5,ZZ=0,QZ=3,eQ=1e3,tQ=5*1e3,nQ={audioInputLevel:{minStandardDeviation:327.67,sampleCount:10},audioOutputLevel:{minStandardDeviation:327.67,sampleCount:10},bytesReceived:{clearCount:2,min:1,raiseCount:3,sampleCount:3},bytesSent:{clearCount:2,min:1,raiseCount:3,sampleCount:3},jitter:{max:30},mos:{min:3},packetsLostFraction:[{max:1},{clearValue:1,maxAverage:3,sampleCount:7}],rtt:{max:400}};function rQ(n,e){return e.reduce(function(t,r){return t+=r>n?1:0},0)}function iQ(n,e){return e.reduce(function(t,r){return t+=r<n?1:0},0)}function sQ(n){if(n.length<=0)return null;var e=n.reduce(function(i,s){return i+s},0)/n.length,t=n.map(function(i){return Math.pow(i-e,2)}),r=Math.sqrt(t.reduce(function(i,s){return i+s},0)/t.length);return r}function oQ(n){return n.reduce(function(e,t){return VM(e,t)},[])}var aQ=function(n){JZ(e,n);function e(t){var r=n.call(this)||this;r._activeWarnings=new Map,r._currentStreaks=new Map,r._inputVolumes=[],r._outputVolumes=[],r._sampleBuffer=[],r._supplementalSampleBuffers={audioInputLevel:[],audioOutputLevel:[]},r._warningsEnabled=!0,t=t||{},r._getRTCStats=t.getRTCStats||YZ.getRTCStats,r._mos=t.Mos||GZ.default,r._peerConnection=t.peerConnection,r._thresholds=ks(ks({},nQ),t.thresholds);var i=Object.values(r._thresholds).map(function(s){return s.sampleCount}).filter(function(s){return!!s});return r._maxSampleCount=Math.max.apply(Math,VM([XZ],i)),r._peerConnection&&r.enable(r._peerConnection),r}return e.prototype.addVolumes=function(t,r){this._inputVolumes.push(t),this._outputVolumes.push(r)},e.prototype.disable=function(){return this._sampleInterval&&(clearInterval(this._sampleInterval),delete this._sampleInterval),this},e.prototype.disableWarnings=function(){return this._warningsEnabled&&this._activeWarnings.clear(),this._warningsEnabled=!1,this},e.prototype.enable=function(t){if(t){if(this._peerConnection&&t!==this._peerConnection)throw new XS.InvalidArgumentError("Attempted to replace an existing PeerConnection in StatsMonitor.enable");this._peerConnection=t}if(!this._peerConnection)throw new XS.InvalidArgumentError("Can not enable StatsMonitor without a PeerConnection");return this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),eQ),this},e.prototype.enableWarnings=function(){return this._warningsEnabled=!0,this},e.prototype.hasActiveWarning=function(t,r){var i=t+":"+r;return!!this._activeWarnings.get(i)},e.prototype._addSample=function(t){var r=this._sampleBuffer;r.push(t),r.length>this._maxSampleCount&&r.splice(0,r.length-this._maxSampleCount)},e.prototype._clearWarning=function(t,r,i){var s=t+":"+r,o=this._activeWarnings.get(s);!o||Date.now()-o.timeRaised<tQ||(this._activeWarnings.delete(s),this.emit("warning-cleared",ks(ks({},i),{name:t,threshold:{name:r,value:this._thresholds[t][r]}})))},e.prototype._createSample=function(t,r){var i=r&&r.totals.bytesSent||0,s=r&&r.totals.bytesReceived||0,o=r&&r.totals.packetsSent||0,a=r&&r.totals.packetsReceived||0,l=r&&r.totals.packetsLost||0,c=t.bytesSent-i,u=t.bytesReceived-s,d=t.packetsSent-o,f=t.packetsReceived-a,p=t.packetsLost-l,m=f+p,v=m>0?p/m*100:0,x=t.packetsReceived+t.packetsLost,b=x>0?t.packetsLost/x*100:100,_=typeof t.rtt=="number"||!r?t.rtt:r.rtt,M=this._inputVolumes.splice(0);this._supplementalSampleBuffers.audioInputLevel.push(M);var h=this._outputVolumes.splice(0);return this._supplementalSampleBuffers.audioOutputLevel.push(h),{audioInputLevel:Math.round(Wg.average(M)),audioOutputLevel:Math.round(Wg.average(h)),bytesReceived:u,bytesSent:c,codecName:t.codecName,jitter:t.jitter,mos:this._mos.calculate(_,t.jitter,r&&v),packetsLost:p,packetsLostFraction:v,packetsReceived:f,packetsSent:d,rtt:_,timestamp:t.timestamp,totals:{bytesReceived:t.bytesReceived,bytesSent:t.bytesSent,packetsLost:t.packetsLost,packetsLostFraction:b,packetsReceived:t.packetsReceived,packetsSent:t.packetsSent}}},e.prototype._fetchSample=function(){var t=this;this._getSample().then(function(r){t._addSample(r),t._raiseWarnings(),t.emit("sample",r)}).catch(function(r){t.disable(),t.emit("error",r)})},e.prototype._getSample=function(){var t=this;return this._getRTCStats(this._peerConnection).then(function(r){var i=null;return t._sampleBuffer.length&&(i=t._sampleBuffer[t._sampleBuffer.length-1]),t._createSample(r,i)})},e.prototype._raiseWarning=function(t,r,i){var s=t+":"+r;if(!this._activeWarnings.has(s)){this._activeWarnings.set(s,{timeRaised:Date.now()});var o=this._thresholds[t],a;if(Array.isArray(o)){var l=o.find(function(c){return r in c});l&&(a=l[r])}else a=this._thresholds[t][r];this.emit("warning",ks(ks({},i),{name:t,threshold:{name:r,value:a}}))}},e.prototype._raiseWarnings=function(){var t=this;this._warningsEnabled&&Object.keys(this._thresholds).forEach(function(r){return t._raiseWarningsForStat(r)})},e.prototype._raiseWarningsForStat=function(t){var r=this,i=Array.isArray(this._thresholds[t])?this._thresholds[t]:[this._thresholds[t]];i.forEach(function(s){var o=r._sampleBuffer,a=s.clearCount||ZZ,l=s.raiseCount||QZ,c=s.sampleCount||r._maxSampleCount,u=o.slice(-c),d=u.map(function(w){return w[t]}),f=d.some(function(w){return typeof w=="undefined"||w===null});if(!f){var p;if(typeof s.max=="number"&&(p=rQ(s.max,d),p>=l?r._raiseWarning(t,"max",{values:d,samples:u}):p<=a&&r._clearWarning(t,"max",{values:d,samples:u})),typeof s.min=="number"&&(p=iQ(s.min,d),p>=l?r._raiseWarning(t,"min",{values:d,samples:u}):p<=a&&r._clearWarning(t,"min",{values:d,samples:u})),typeof s.maxDuration=="number"&&o.length>1){u=o.slice(-2);var m=u[0][t],v=u[1][t],x=r._currentStreaks.get(t)||0,b=m===v?x+1:0;r._currentStreaks.set(t,b),b>=s.maxDuration?r._raiseWarning(t,"maxDuration",{value:b}):b===0&&r._clearWarning(t,"maxDuration",{value:x})}if(typeof s.minStandardDeviation=="number"){var _=r._supplementalSampleBuffers[t];if(!_||_.length<s.sampleCount)return;_.length>s.sampleCount&&_.splice(0,_.length-s.sampleCount);var M=oQ(_.slice(-c)),h=sQ(M);if(typeof h!="number")return;h<s.minStandardDeviation?r._raiseWarning(t,"minStandardDeviation",{value:h}):r._clearWarning(t,"minStandardDeviation",{value:h})}[["maxAverage",function(w,y){return w>y}],["minAverage",function(w,y){return w<y}]].forEach(function(w){var y=w[0],E=w[1];if(typeof s[y]=="number"&&d.length>=c){var g=Wg.average(d);E(g,s[y])?r._raiseWarning(t,y,{values:d,samples:u}):E(g,s.clearValue||s[y])||r._clearWarning(t,y,{values:d,samples:u})}})}})},e}(KZ.EventEmitter);cb.default=aQ;var ZS;function ub(){if(ZS)return pf;ZS=1;var n=be&&be.__extends||function(){var R=function(S,k){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,C){T.__proto__=C}||function(T,C){for(var D in C)Object.prototype.hasOwnProperty.call(C,D)&&(T[D]=C[D])},R(S,k)};return function(S,k){R(S,k);function T(){this.constructor=S}S.prototype=k===null?Object.create(k):(T.prototype=k.prototype,new T)}}(),e=be&&be.__assign||function(){return e=Object.assign||function(R){for(var S,k=1,T=arguments.length;k<T;k++){S=arguments[k];for(var C in S)Object.prototype.hasOwnProperty.call(S,C)&&(R[C]=S[C])}return R},e.apply(this,arguments)};Object.defineProperty(pf,"__esModule",{value:!0});var t=oi,r=tm,i=om(),s=pn,o=Cn,a=Wi,l=am,c=Ir,u=cb,d=nt,f=_d,p=fn,m={factor:1.1,jitter:.5,max:3e4,min:1},v=70,x=500,b=160,_=10,M=5e3,h={disconnect:!0,info:{code:31003,message:"Connection with Twilio was interrupted.",twilioError:new s.MediaErrors.ConnectionError}},w={packetsLostFraction:{max:"packet-loss",maxAverage:"packets-lost-fraction"}},y={audioInputLevel:"audio-input-level",audioOutputLevel:"audio-output-level",bytesReceived:"bytes-received",bytesSent:"bytes-sent",jitter:"jitter",mos:"mos",rtt:"rtt"},E={max:"high-",maxAverage:"high-",maxDuration:"constant-",min:"low-",minStandardDeviation:"constant-"},g=function(R){n(S,R);function S(k,T){var C=R.call(this)||this;C.parameters={},C._inputVolumeStreak=0,C._isAnswered=!1,C._isCancelled=!1,C._isRejected=!1,C._latestInputVolume=0,C._latestOutputVolume=0,C._log=new o.default("Call"),C._mediaStatus=S.State.Pending,C._messages=new Map,C._metricsSamples=[],C._options={MediaHandler:a.PeerConnection,enableImprovedSignalingErrorPrecision:!1,offerSdp:null,shouldPlayDisconnect:function(){return!0},voiceEventSidGenerator:f.generateVoiceEventSid},C._outputVolumeStreak=0,C._shouldSendHangup=!0,C._signalingStatus=S.State.Pending,C._soundcache=new Map,C._status=S.State.Pending,C._wasConnected=!1,C.toString=function(){return"[Twilio.Call instance]"},C._emitWarning=function(P,N,F,j,J,ie){var oe=J?"-cleared":"-raised",he=P+"warning"+oe;if(!(N==="constant-audio-input-level"&&C.isMuted())){var ae=J?"info":"warning";N==="constant-audio-output-level"&&(ae="info");var B={threshold:F};if(j&&(j instanceof Array?B.values=j.map(function(le){return typeof le=="number"?Math.round(le*100)/100:j}):B.value=j),C._publisher.post(ae,he,N,{data:B},C),N!=="constant-audio-output-level"){var ee=J?"warning-cleared":"warning";C._log.debug("#"+ee,N),C.emit(ee,N,ie&&!J?ie:null)}}},C._onAck=function(P){var N=P.acktype,F=P.callsid,j=P.voiceeventsid;if(C.parameters.CallSid!==F){C._log.warn("Received ack from a different callsid: "+F);return}N==="message"&&C._onMessageSent(j)},C._onAnswer=function(P){typeof P.reconnect=="string"&&(C._signalingReconnectToken=P.reconnect),!(C._isAnswered&&C._status!==S.State.Reconnecting)&&(C._setCallSid(P),C._isAnswered=!0,C._maybeTransitionToOpen())},C._onCancel=function(P){var N=P.callsid;C.parameters.CallSid===N&&(C._isCancelled=!0,C._publisher.info("connection","cancel",null,C),C._cleanupEventListeners(),C._mediaHandler.close(),C._status=S.State.Closed,C._log.debug("#cancel"),C.emit("cancel"),C._pstream.removeListener("cancel",C._onCancel))},C._onConnected=function(){C._log.info("Received connected from pstream"),C._signalingReconnectToken&&C._mediaHandler.version&&C._pstream.reconnect(C._mediaHandler.version.getSDP(),C.parameters.CallSid,C._signalingReconnectToken)},C._onHangup=function(P){if(C.status()!==S.State.Closed){if(P.callsid&&(C.parameters.CallSid||C.outboundConnectionId)){if(P.callsid!==C.parameters.CallSid&&P.callsid!==C.outboundConnectionId)return}else if(P.callsid)return;if(C._log.info("Received HANGUP from gateway"),P.error){var N=P.error.code,F=s.getPreciseSignalingErrorByCode(C._options.enableImprovedSignalingErrorPrecision,N),j=typeof F!="undefined"?new F(P.error.message):new s.GeneralErrors.ConnectionError("Error sent from gateway in HANGUP");C._log.error("Received an error from the gateway:",j),C._log.debug("#error",j),C.emit("error",j)}C._shouldSendHangup=!1,C._publisher.info("connection","disconnected-by-remote",null,C),C._disconnect(null,!0),C._cleanupEventListeners()}},C._onMediaFailure=function(P){var N=S.MediaFailure,F=N.ConnectionDisconnected,j=N.ConnectionFailed,J=N.IceGatheringFailed,ie=N.LowBytes,oe=P===j||P===J;if(!d.isChrome(window,window.navigator)&&P===j)return C._mediaHandler.onerror(h);if(C._mediaStatus===S.State.Reconnecting){if(oe){if(Date.now()-C._mediaReconnectStartTime>m.max)return C._log.warn("Exceeded max ICE retries"),C._mediaHandler.onerror(h);try{C._mediaReconnectBackoff.backoff()}catch(le){if(!(le.message&&le.message==="Backoff in progress."))throw le}}return}var he=C._mediaHandler.version.pc,ae=he&&he.iceConnectionState==="disconnected",B=C._monitor.hasActiveWarning("bytesSent","min")||C._monitor.hasActiveWarning("bytesReceived","min");if(P===ie&&ae||P===F&&B||oe){var ee=new s.MediaErrors.ConnectionError("Media connection failed.");C._log.warn("ICE Connection disconnected."),C._publisher.warn("connection","error",ee,C),C._publisher.info("connection","reconnecting",null,C),C._mediaReconnectStartTime=Date.now(),C._status=S.State.Reconnecting,C._mediaStatus=S.State.Reconnecting,C._mediaReconnectBackoff.reset(),C._mediaReconnectBackoff.backoff(),C._log.debug("#reconnecting"),C.emit("reconnecting",ee)}},C._onMediaReconnected=function(){C._mediaStatus===S.State.Reconnecting&&(C._log.info("ICE Connection reestablished."),C._mediaStatus=S.State.Open,C._signalingStatus===S.State.Open&&(C._publisher.info("connection","reconnected",null,C),C._log.debug("#reconnected"),C.emit("reconnected"),C._status=S.State.Open))},C._onMessageReceived=function(P){var N=P.callsid,F=P.content,j=P.contenttype,J=P.messagetype,ie=P.voiceeventsid;if(C.parameters.CallSid!==N){C._log.warn("Received a message from a different callsid: "+N);return}var oe={content:F,contentType:j,messageType:J,voiceEventSid:ie};C._log.debug("#messageReceived",JSON.stringify(oe)),C.emit("messageReceived",oe)},C._onMessageSent=function(P){if(!C._messages.has(P)){C._log.warn("Received a messageSent with a voiceEventSid that doesn't exists: "+P);return}var N=C._messages.get(P);C._messages.delete(P),C._log.debug("#messageSent",JSON.stringify(N)),C.emit("messageSent",N)},C._onRinging=function(P){if(C._setCallSid(P),!(C._status!==S.State.Connecting&&C._status!==S.State.Ringing)){var N=!!P.sdp;C._status=S.State.Ringing,C._publisher.info("connection","outgoing-ringing",{hasEarlyMedia:N},C),C._log.debug("#ringing"),C.emit("ringing",N)}},C._onRTCSample=function(P){var N=e(e({},P),{inputVolume:C._latestInputVolume,outputVolume:C._latestOutputVolume});C._codec=N.codecName,C._metricsSamples.push(N),C._metricsSamples.length>=_&&C._publishMetrics(),C.emit("sample",P)},C._onSignalingError=function(P){var N=P.callsid,F=P.voiceeventsid;if(C.parameters.CallSid!==N){C._log.warn("Received an error from a different callsid: "+N);return}F&&C._messages.has(F)&&(C._messages.delete(F),C._log.warn("Received an error while sending a message.",P))},C._onSignalingReconnected=function(){C._signalingStatus===S.State.Reconnecting&&(C._log.info("Signaling Connection reestablished."),C._signalingStatus=S.State.Open,C._mediaStatus===S.State.Open&&(C._publisher.info("connection","reconnected",null,C),C._log.debug("#reconnected"),C.emit("reconnected"),C._status=S.State.Open))},C._onTransportClose=function(){C._log.error("Received transportClose from pstream"),C._log.debug("#transportClose"),C.emit("transportClose"),C._signalingReconnectToken?(C._status=S.State.Reconnecting,C._signalingStatus=S.State.Reconnecting,C._log.debug("#reconnecting"),C.emit("reconnecting",new s.SignalingErrors.ConnectionDisconnected)):(C._status=S.State.Closed,C._signalingStatus=S.State.Closed)},C._reemitWarning=function(P,N){var F=/^audio/.test(P.name)?"audio-level-":"network-quality-",j=E[P.threshold.name],J;P.name in w?J=w[P.name][P.threshold.name]:P.name in y&&(J=y[P.name]);var ie=j+J;C._emitWarning(F,ie,P.threshold.value,P.values||P.value,N,P)},C._reemitWarningCleared=function(P){C._reemitWarning(P,!0)},C._isUnifiedPlanDefault=k.isUnifiedPlanDefault,C._soundcache=k.soundcache,typeof k.onIgnore=="function"&&(C._onIgnore=k.onIgnore);var D=T&&T.twimlParams||{};C.customParameters=new Map(Object.entries(D).map(function(P){var N=P[0],F=P[1];return[N,String(F)]})),Object.assign(C._options,T),C._options.callParameters&&(C.parameters=C._options.callParameters),C._options.reconnectToken&&(C._signalingReconnectToken=C._options.reconnectToken),C._voiceEventSidGenerator=C._options.voiceEventSidGenerator||f.generateVoiceEventSid,C._direction=C.parameters.CallSid?S.CallDirection.Incoming:S.CallDirection.Outgoing,C._direction===S.CallDirection.Incoming&&C.parameters?C.callerInfo=C.parameters.StirStatus?{isVerified:C.parameters.StirStatus==="TN-Validation-Passed-A"}:null:C.callerInfo=null,C._mediaReconnectBackoff=new r.default(m),C._mediaReconnectBackoff.on("ready",function(){return C._mediaHandler.iceRestart()}),C.outboundConnectionId=I();var A=C._publisher=k.publisher;C._direction===S.CallDirection.Incoming?A.info("connection","incoming",null,C):A.info("connection","outgoing",{preflight:C._options.preflight},C);var O=C._monitor=new(C._options.StatsMonitor||u.default);return O.on("sample",C._onRTCSample),O.disableWarnings(),setTimeout(function(){return O.enableWarnings()},M),O.on("warning",function(P,N){(P.name==="bytesSent"||P.name==="bytesReceived")&&C._onMediaFailure(S.MediaFailure.LowBytes),C._reemitWarning(P,N)}),O.on("warning-cleared",function(P){C._reemitWarningCleared(P)}),C._mediaHandler=new C._options.MediaHandler(k.audioHelper,k.pstream,{RTCPeerConnection:C._options.RTCPeerConnection,codecPreferences:C._options.codecPreferences,dscp:C._options.dscp,forceAggressiveIceNomination:C._options.forceAggressiveIceNomination,isUnifiedPlan:C._isUnifiedPlanDefault,maxAverageBitrate:C._options.maxAverageBitrate,preflight:C._options.preflight}),C.on("volume",function(P,N){C._inputVolumeStreak=C._checkVolume(P,C._inputVolumeStreak,C._latestInputVolume,"input"),C._outputVolumeStreak=C._checkVolume(N,C._outputVolumeStreak,C._latestOutputVolume,"output"),C._latestInputVolume=P,C._latestOutputVolume=N}),C._mediaHandler.onaudio=function(P){C._log.debug("#audio"),C.emit("audio",P)},C._mediaHandler.onvolume=function(P,N,F,j){O.addVolumes(F/255*32767,j/255*32767),C.emit("volume",P,N)},C._mediaHandler.ondtlstransportstatechange=function(P){var N=P==="failed"?"error":"debug";C._publisher.post(N,"dtls-transport-state",P,null,C)},C._mediaHandler.onpcconnectionstatechange=function(P){var N="debug",F=C._mediaHandler.getRTCDtlsTransport();P==="failed"&&(N=F&&F.state==="failed"?"error":"warning"),C._publisher.post(N,"pc-connection-state",P,null,C)},C._mediaHandler.onicecandidate=function(P){var N=new l.IceCandidate(P).toPayload();C._publisher.debug("ice-candidate","ice-candidate",N,C)},C._mediaHandler.onselectedcandidatepairchange=function(P){var N=new l.IceCandidate(P.local).toPayload(),F=new l.IceCandidate(P.remote,!0).toPayload();C._publisher.debug("ice-candidate","selected-ice-candidate-pair",{local_candidate:N,remote_candidate:F},C)},C._mediaHandler.oniceconnectionstatechange=function(P){var N=P==="failed"?"error":"debug";C._publisher.post(N,"ice-connection-state",P,null,C)},C._mediaHandler.onicegatheringfailure=function(P){C._publisher.warn("ice-gathering-state",P,null,C),C._onMediaFailure(S.MediaFailure.IceGatheringFailed)},C._mediaHandler.onicegatheringstatechange=function(P){C._publisher.debug("ice-gathering-state",P,null,C)},C._mediaHandler.onsignalingstatechange=function(P){C._publisher.debug("signaling-state",P,null,C)},C._mediaHandler.ondisconnected=function(P){C._log.warn(P),C._publisher.warn("network-quality-warning-raised","ice-connectivity-lost",{message:P},C),C._log.debug("#warning","ice-connectivity-lost"),C.emit("warning","ice-connectivity-lost"),C._onMediaFailure(S.MediaFailure.ConnectionDisconnected)},C._mediaHandler.onfailed=function(P){C._onMediaFailure(S.MediaFailure.ConnectionFailed)},C._mediaHandler.onconnected=function(){C._status===S.State.Reconnecting&&C._onMediaReconnected()},C._mediaHandler.onreconnected=function(P){C._log.info(P),C._publisher.info("network-quality-warning-cleared","ice-connectivity-lost",{message:P},C),C._log.debug("#warning-cleared","ice-connectivity-lost"),C.emit("warning-cleared","ice-connectivity-lost"),C._onMediaReconnected()},C._mediaHandler.onerror=function(P){P.disconnect===!0&&C._disconnect(P.info&&P.info.message);var N=P.info.twilioError||new s.GeneralErrors.UnknownError(P.info.message);C._log.error("Received an error from MediaStream:",P),C._log.debug("#error",N),C.emit("error",N)},C._mediaHandler.onopen=function(){C._status===S.State.Open||C._status===S.State.Reconnecting||(C._status===S.State.Ringing||C._status===S.State.Connecting?(C.mute(C._mediaHandler.isMuted),C._mediaStatus=S.State.Open,C._maybeTransitionToOpen()):C._mediaHandler.close())},C._mediaHandler.onclose=function(){C._status=S.State.Closed,C._options.shouldPlayDisconnect&&C._options.shouldPlayDisconnect()&&!C._isCancelled&&!C._isRejected&&C._soundcache.get(i.default.SoundName.Disconnect).play(),O.disable(),C._publishMetrics(),!C._isCancelled&&!C._isRejected&&(C._log.debug("#disconnect"),C.emit("disconnect",C))},C._pstream=k.pstream,C._pstream.on("ack",C._onAck),C._pstream.on("cancel",C._onCancel),C._pstream.on("error",C._onSignalingError),C._pstream.on("ringing",C._onRinging),C._pstream.on("transportClose",C._onTransportClose),C._pstream.on("connected",C._onConnected),C._pstream.on("message",C._onMessageReceived),C.on("error",function(P){C._publisher.error("connection","error",{code:P.code,message:P.message},C),C._pstream&&C._pstream.status==="disconnected"&&C._cleanupEventListeners()}),C.on("disconnect",function(){C._cleanupEventListeners()}),C}return Object.defineProperty(S.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"codec",{get:function(){return this._codec},enumerable:!1,configurable:!0}),S.prototype._setInputTracksFromStream=function(k){return this._mediaHandler.setInputTracksFromStream(k)},S.prototype._setSinkIds=function(k){return this._mediaHandler._setSinkIds(k)},S.prototype.accept=function(k){var T=this;if(this._status===S.State.Pending){this._log.debug(".accept",k),k=k||{};var C=k.rtcConfiguration||this._options.rtcConfiguration,D=k.rtcConstraints||this._options.rtcConstraints||{},A={audio:typeof D.audio!="undefined"?D.audio:!0};this._status=S.State.Connecting;var O=function(){if(T._status!==S.State.Connecting){T._cleanupEventListeners(),T._mediaHandler.close();return}var F=function(ie,oe){var he=T._direction===S.CallDirection.Incoming?"accepted-by-local":"accepted-by-remote";T._publisher.info("connection",he,null,T),typeof oe=="string"&&(T._signalingReconnectToken=oe);var ae=c.getPreferredCodecInfo(T._mediaHandler.version.getSDP()),B=ae.codecName,ee=ae.codecParams;T._publisher.info("settings","codec",{codec_params:ee,selected_codec:B},T),T._monitor.enable(ie)},j=typeof T._options.getSinkIds=="function"&&T._options.getSinkIds();if(Array.isArray(j)&&T._mediaHandler._setSinkIds(j).catch(function(){}),T._pstream.addListener("hangup",T._onHangup),T._direction===S.CallDirection.Incoming)T._isAnswered=!0,T._pstream.on("answer",T._onAnswer),T._mediaHandler.answerIncomingCall(T.parameters.CallSid,T._options.offerSdp,C,F);else{var J=Array.from(T.customParameters.entries()).map(function(ie){return encodeURIComponent(ie[0])+"="+encodeURIComponent(ie[1])}).join("&");T._pstream.on("answer",T._onAnswer),T._mediaHandler.makeOutgoingCall(T._pstream.token,J,T.outboundConnectionId,C,F)}};this._options.beforeAccept&&this._options.beforeAccept(this);var P=typeof this._options.getInputStream=="function"&&this._options.getInputStream(),N=P?this._mediaHandler.setInputTracksFromStream(P):this._mediaHandler.openDefaultDeviceWithConstraints(A);N.then(function(){T._publisher.info("get-user-media","succeeded",{data:{audioConstraints:A}},T),O()},function(F){var j;F.code===31208||["PermissionDeniedError","NotAllowedError"].indexOf(F.name)!==-1?(j=new s.UserMediaErrors.PermissionDeniedError,T._publisher.error("get-user-media","denied",{data:{audioConstraints:A,error:F}},T)):(j=new s.UserMediaErrors.AcquisitionFailedError,T._publisher.error("get-user-media","failed",{data:{audioConstraints:A,error:F}},T)),T._disconnect(),T._log.debug("#error",F),T.emit("error",j)})}},S.prototype.disconnect=function(){this._log.debug(".disconnect"),this._disconnect()},S.prototype.getLocalStream=function(){return this._mediaHandler&&this._mediaHandler.stream},S.prototype.getRemoteStream=function(){return this._mediaHandler&&this._mediaHandler._remoteStream},S.prototype.ignore=function(){this._status===S.State.Pending&&(this._log.debug(".ignore"),this._status=S.State.Closed,this._mediaHandler.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local",null,this),this._onIgnore&&this._onIgnore())},S.prototype.isMuted=function(){return this._mediaHandler.isMuted},S.prototype.mute=function(k){k===void 0&&(k=!0),this._log.debug(".mute",k);var T=this._mediaHandler.isMuted;this._mediaHandler.mute(k);var C=this._mediaHandler.isMuted;T!==C&&(this._publisher.info("connection",C?"muted":"unmuted",null,this),this._log.debug("#mute",C),this.emit("mute",C,this))},S.prototype.postFeedback=function(k,T){if(typeof k=="undefined"||k===null)return this._postFeedbackDeclined();if(!Object.values(S.FeedbackScore).includes(k))throw new s.InvalidArgumentError("Feedback score must be one of: "+Object.values(S.FeedbackScore));if(typeof T!="undefined"&&T!==null&&!Object.values(S.FeedbackIssue).includes(T))throw new s.InvalidArgumentError("Feedback issue must be one of: "+Object.values(S.FeedbackIssue));return this._publisher.info("feedback","received",{issue_name:T,quality_score:k},this,!0)},S.prototype.reject=function(){this._status===S.State.Pending&&(this._log.debug(".reject"),this._isRejected=!0,this._pstream.reject(this.parameters.CallSid),this._mediaHandler.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=S.State.Closed,this._log.debug("#reject"),this.emit("reject"))},S.prototype.sendDigits=function(k){var T=this;if(this._log.debug(".sendDigits",k),k.match(/[^0-9*#w]/))throw new s.InvalidArgumentError("Illegal character passed into sendDigits");var C=this._options.customSounds||{},D=[];k.split("").forEach(function(F){var j=F!=="w"?"dtmf"+F:"";j==="dtmf*"&&(j="dtmfs"),j==="dtmf#"&&(j="dtmfh"),D.push(j)});var A=function(){var F=D.shift();F&&(T._options.dialtonePlayer&&!C[F]?T._options.dialtonePlayer.play(F):T._soundcache.get(F).play()),D.length&&setTimeout(function(){return A()},200)};A();var O=this._mediaHandler.getOrCreateDTMFSender();function P(F){if(F.length){var j=F.shift();j&&j.length&&O.insertDTMF(j,b,v),setTimeout(P.bind(null,F),x)}}if(O){if(!("canInsertDTMF"in O)||O.canInsertDTMF){this._log.info("Sending digits using RTCDTMFSender"),P(k.split("w"));return}this._log.info("RTCDTMFSender cannot insert DTMF")}if(this._log.info("Sending digits over PStream"),this._pstream!==null&&this._pstream.status!=="disconnected")this._pstream.dtmf(this.parameters.CallSid,k);else{var N=new s.GeneralErrors.ConnectionError("Could not send DTMF: Signaling channel is disconnected");this._log.debug("#error",N),this.emit("error",N)}},S.prototype.sendMessage=function(k){this._log.debug(".sendMessage",JSON.stringify(k));var T=k.content,C=k.contentType,D=k.messageType;if(typeof T=="undefined"||T===null)throw new s.InvalidArgumentError("`content` is empty");if(typeof D!="string")throw new s.InvalidArgumentError("`messageType` must be an enumeration value of `Call.MessageType` or a string.");if(D.length===0)throw new s.InvalidArgumentError("`messageType` must be a non-empty string.");if(this._pstream===null)throw new s.InvalidStateError("Could not send CallMessage; Signaling channel is disconnected");var A=this.parameters.CallSid;if(typeof this.parameters.CallSid=="undefined")throw new s.InvalidStateError("Could not send CallMessage; Call has no CallSid");var O=this._voiceEventSidGenerator();return this._messages.set(O,{content:T,contentType:C,messageType:D,voiceEventSid:O}),this._pstream.sendMessage(A,T,C,D,O),O},S.prototype.status=function(){return this._status},S.prototype._checkVolume=function(k,T,C,D){var A=T>=10,O=0;return C===k&&(O=T),O>=10?this._emitWarning("audio-level-","constant-audio-"+D+"-level",10,O,!1):A&&this._emitWarning("audio-level-","constant-audio-"+D+"-level",10,O,!0),O},S.prototype._cleanupEventListeners=function(){var k=this,T=function(){k._pstream&&(k._pstream.removeListener("ack",k._onAck),k._pstream.removeListener("answer",k._onAnswer),k._pstream.removeListener("cancel",k._onCancel),k._pstream.removeListener("error",k._onSignalingError),k._pstream.removeListener("hangup",k._onHangup),k._pstream.removeListener("ringing",k._onRinging),k._pstream.removeListener("transportClose",k._onTransportClose),k._pstream.removeListener("connected",k._onConnected),k._pstream.removeListener("message",k._onMessageReceived))};T(),setTimeout(T,0)},S.prototype._createMetricPayload=function(){var k={call_sid:this.parameters.CallSid,dscp:!!this._options.dscp,sdk_version:p.RELEASE_VERSION};return this._options.gateway&&(k.gateway=this._options.gateway),k.direction=this._direction,k},S.prototype._disconnect=function(k,T){if(k=typeof k=="string"?k:null,!(this._status!==S.State.Open&&this._status!==S.State.Connecting&&this._status!==S.State.Reconnecting&&this._status!==S.State.Ringing)){if(this._log.info("Disconnecting..."),this._pstream!==null&&this._pstream.status!=="disconnected"&&this._shouldSendHangup){var C=this.parameters.CallSid||this.outboundConnectionId;C&&this._pstream.hangup(C,k)}this._cleanupEventListeners(),this._mediaHandler.close(),T||this._publisher.info("connection","disconnected-by-local",null,this)}},S.prototype._maybeTransitionToOpen=function(){this._wasConnected,this._isAnswered&&(this._onSignalingReconnected(),this._signalingStatus=S.State.Open,this._mediaHandler&&this._mediaHandler.status==="open"&&(this._status=S.State.Open,this._wasConnected||(this._wasConnected=!0,this._log.debug("#accept"),this.emit("accept",this))))},S.prototype._postFeedbackDeclined=function(){return this._publisher.info("feedback","received-none",null,this,!0)},S.prototype._publishMetrics=function(){var k=this;this._metricsSamples.length!==0&&this._publisher.postMetrics("quality-metrics-samples","metrics-sample",this._metricsSamples.splice(0),this._createMetricPayload(),this).catch(function(T){k._log.warn("Unable to post metrics to Insights. Received error:",T)})},S.prototype._setCallSid=function(k){var T=k.callsid;T&&(this.parameters.CallSid=T,this._mediaHandler.callSid=T)},S.toString=function(){return"[Twilio.Call class]"},S}(t.EventEmitter);(function(R){(function(S){S.Closed="closed",S.Connecting="connecting",S.Open="open",S.Pending="pending",S.Reconnecting="reconnecting",S.Ringing="ringing"})(R.State||(R.State={})),function(S){S.AudioLatency="audio-latency",S.ChoppyAudio="choppy-audio",S.DroppedCall="dropped-call",S.Echo="echo",S.NoisyCall="noisy-call",S.OneWayAudio="one-way-audio"}(R.FeedbackIssue||(R.FeedbackIssue={})),function(S){S[S.One=1]="One",S[S.Two=2]="Two",S[S.Three=3]="Three",S[S.Four=4]="Four",S[S.Five=5]="Five"}(R.FeedbackScore||(R.FeedbackScore={})),function(S){S.Incoming="INCOMING",S.Outgoing="OUTGOING"}(R.CallDirection||(R.CallDirection={})),function(S){S.Opus="opus",S.PCMU="pcmu"}(R.Codec||(R.Codec={})),function(S){S.None="none",S.Timeout="timeout"}(R.IceGatheringFailureReason||(R.IceGatheringFailureReason={})),function(S){S.ConnectionDisconnected="ConnectionDisconnected",S.ConnectionFailed="ConnectionFailed",S.IceGatheringFailed="IceGatheringFailed",S.LowBytes="LowBytes"}(R.MediaFailure||(R.MediaFailure={})),function(S){S.UserDefinedMessage="user-defined-message"}(R.MessageType||(R.MessageType={}))})(g||(g={}));function I(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(R){var S=Math.random()*16|0,k=R==="x"?S:S&3|8;return k.toString(16)})}return pf.default=g,pf}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.TwilioError=n.Logger=n.PreflightTest=n.Device=n.Call=void 0;var e=ub();n.Call=e.default;var t=om();n.Device=t.default;var r=pn;n.TwilioError=r;var i=Cn;Object.defineProperty(n,"Logger",{enumerable:!0,get:function(){return i.Logger}});var s=RM();Object.defineProperty(n,"PreflightTest",{enumerable:!0,get:function(){return s.PreflightTest}})})(PY);const lQ="0.21.1";class ga extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class G1 extends ga{constructor(e){super(e||"Unsupported content type.")}}class Y1 extends ga{constructor(e){super(e||"Request pending.")}}class cQ extends ga{constructor(e){super(e||"Unspecified session description handler error.")}}class Jg extends ga{constructor(){super("The session has terminated.")}}class rc extends ga{constructor(e){super(e||"An error occurred during state transition.")}}class uQ{constructor(e){this.incomingAckRequest=e}get request(){return this.incomingAckRequest.message}}class dQ{constructor(e){this.incomingByeRequest=e}get request(){return this.incomingByeRequest.message}accept(e){return this.incomingByeRequest.accept(e),Promise.resolve()}reject(e){return this.incomingByeRequest.reject(e),Promise.resolve()}}class fQ{constructor(e){this.incomingCancelRequest=e}get request(){return this.incomingCancelRequest}}class Yu{constructor(){this.listeners=new Array}addListener(e,t){const r=i=>{this.removeListener(r),e(i)};(t==null?void 0:t.once)===!0?this.listeners.push(r):this.listeners.push(e)}emit(e){this.listeners.slice().forEach(t=>t(e))}removeAllListeners(){this.listeners=[]}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}on(e){return this.addListener(e)}off(e){return this.removeListener(e)}once(e){return this.addListener(e,{once:!0})}}class hQ{constructor(e){this.incomingInfoRequest=e}get request(){return this.incomingInfoRequest.message}accept(e){return this.incomingInfoRequest.accept(e),Promise.resolve()}reject(e){return this.incomingInfoRequest.reject(e),Promise.resolve()}}class qM{constructor(e){this.parameters={};for(const t in e)e.hasOwnProperty(t)&&this.setParam(t,e[t])}setParam(e,t){e&&(this.parameters[e.toLowerCase()]=typeof t=="undefined"||t===null?null:t.toString())}getParam(e){if(e)return this.parameters[e.toLowerCase()]}hasParam(e){return!!(e&&this.parameters[e.toLowerCase()]!==void 0)}deleteParam(e){if(e=e.toLowerCase(),this.hasParam(e)){const t=this.parameters[e];return delete this.parameters[e],t}}clearParams(){this.parameters={}}}class Wn extends qM{constructor(e,t,r){super(r),this.uri=e,this._displayName=t}get friendlyName(){return this.displayName||this.uri.aor}get displayName(){return this._displayName}set displayName(e){this._displayName=e}clone(){return new Wn(this.uri.clone(),this._displayName,JSON.parse(JSON.stringify(this.parameters)))}toString(){let e=this.displayName||this.displayName==="0"?'"'+this.displayName+'" ':"";e+="<"+this.uri.toString()+">";for(const t in this.parameters)this.parameters.hasOwnProperty(t)&&(e+=";"+t,this.parameters[t]!==null&&(e+="="+this.parameters[t]));return e}}class wi extends qM{constructor(e="sip",t,r,i,s,o){if(super(s||{}),this.headers={},!r)throw new TypeError('missing or invalid "host" parameter');for(const a in o)o.hasOwnProperty(a)&&this.setHeader(a,o[a]);this.raw={scheme:e,user:t,host:r,port:i},this.normal={scheme:e.toLowerCase(),user:t,host:r.toLowerCase(),port:i}}get scheme(){return this.normal.scheme}set scheme(e){this.raw.scheme=e,this.normal.scheme=e.toLowerCase()}get user(){return this.normal.user}set user(e){this.normal.user=this.raw.user=e}get host(){return this.normal.host}set host(e){this.raw.host=e,this.normal.host=e.toLowerCase()}get aor(){return this.normal.user+"@"+this.normal.host}get port(){return this.normal.port}set port(e){this.normal.port=this.raw.port=e}setHeader(e,t){this.headers[this.headerize(e)]=t instanceof Array?t:[t]}getHeader(e){if(e)return this.headers[this.headerize(e)]}hasHeader(e){return!!e&&!!this.headers.hasOwnProperty(this.headerize(e))}deleteHeader(e){if(e=this.headerize(e),this.headers.hasOwnProperty(e)){const t=this.headers[e];return delete this.headers[e],t}}clearHeaders(){this.headers={}}clone(){return new wi(this._raw.scheme,this._raw.user||"",this._raw.host,this._raw.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))}toRaw(){return this._toString(this._raw)}toString(){return this._toString(this._normal)}get _normal(){return this.normal}get _raw(){return this.raw}_toString(e){let t=e.scheme+":";e.scheme.toLowerCase().match("^sips?$")||(t+="//"),e.user&&(t+=this.escapeUser(e.user)+"@"),t+=e.host,(e.port||e.port===0)&&(t+=":"+e.port);for(const i in this.parameters)this.parameters.hasOwnProperty(i)&&(t+=";"+i,this.parameters[i]!==null&&(t+="="+this.parameters[i]));const r=[];for(const i in this.headers)if(this.headers.hasOwnProperty(i))for(const s in this.headers[i])this.headers[i].hasOwnProperty(s)&&r.push(i+"="+this.headers[i][s]);return r.length>0&&(t+="?"+r.join("&")),t}escapeUser(e){let t;try{t=decodeURIComponent(e)}catch(r){throw r}return encodeURIComponent(t).replace(/%3A/ig,":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")}headerize(e){const t={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"},r=e.toLowerCase().replace(/_/g,"-").split("-"),i=r.length;let s="";for(let o=0;o<i;o++)o!==0&&(s+="-"),s+=r[o].charAt(0).toUpperCase()+r[o].substring(1);return t[s]&&(s=t[s]),s}}function QS(n,e){if(n.scheme!==e.scheme||n.user!==e.user||n.host!==e.host||n.port!==e.port)return!1;function t(s,o){const a=Object.keys(s.parameters),l=Object.keys(o.parameters);return!(!a.filter(u=>l.includes(u)).every(u=>s.parameters[u]===o.parameters[u])||!["user","ttl","method","transport"].every(u=>s.hasParam(u)&&o.hasParam(u)||!s.hasParam(u)&&!o.hasParam(u))||!["maddr"].every(u=>s.hasParam(u)&&o.hasParam(u)||!s.hasParam(u)&&!o.hasParam(u)))}if(!t(n,e))return!1;const r=Object.keys(n.headers),i=Object.keys(e.headers);if(r.length!==0||i.length!==0){if(r.length!==i.length)return!1;const s=r.filter(o=>i.includes(o));if(s.length!==i.length||!s.every(o=>n.headers[o].length&&e.headers[o].length&&n.headers[o][0]===e.headers[o][0]))return!1}return!0}function Kg(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}let e_=class ah extends Error{constructor(e,t,r,i){super(),this.message=e,this.expected=t,this.found=r,this.location=i,this.name="SyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,ah.prototype):this.__proto__=ah.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ah)}static buildMessage(e,t){function r(c){return c.charCodeAt(0).toString(16).toUpperCase()}function i(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,u=>"\\x0"+r(u)).replace(/[\x10-\x1F\x7F-\x9F]/g,u=>"\\x"+r(u))}function s(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,u=>"\\x0"+r(u)).replace(/[\x10-\x1F\x7F-\x9F]/g,u=>"\\x"+r(u))}function o(c){switch(c.type){case"literal":return'"'+i(c.text)+'"';case"class":const u=c.parts.map(d=>Array.isArray(d)?s(d[0])+"-"+s(d[1]):s(d));return"["+(c.inverted?"^":"")+u+"]";case"any":return"any character";case"end":return"end of input";case"other":return c.description}}function a(c){const u=c.map(o);let d,f;if(u.sort(),u.length>0){for(d=1,f=1;d<u.length;d++)u[d-1]!==u[d]&&(u[f]=u[d],f++);u.length=f}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+i(c)+'"':"end of input"}return"Expected "+a(e)+" but "+l(t)+" found."}format(e){let t="Error: "+this.message;if(this.location){let r=null,i;for(i=0;i<e.length;i++)if(e[i].source===this.location.source){r=e[i].text.split(/\r\n|\n|\r/g);break}let s=this.location.start,o=this.location.source+":"+s.line+":"+s.column;if(r){let a=this.location.end,l=Kg("",s.line.toString().length," "),c=r[s.line-1],u=s.line===a.line?a.column:c.length+1;t+=`
 --> `+o+`
`+l+` |
`+s.line+" | "+c+`
`+l+" | "+Kg("",s.column-1," ")+Kg("",u-s.column,"^")}else t+=`
 at `+o}return t}};function pQ(n,e){e=e!==void 0?e:{};const t={},r=e.grammarSource,i={Contact:119,Name_Addr_Header:156,Record_Route:176,Request_Response:81,SIP_URI:45,Subscription_State:186,Supported:191,Require:182,Via:194,absoluteURI:84,Call_ID:118,Content_Disposition:130,Content_Length:135,Content_Type:136,CSeq:146,displayName:122,Event:149,From:151,host:52,Max_Forwards:154,Min_SE:213,Proxy_Authenticate:157,quoted_string:40,Refer_To:178,Replaces:179,Session_Expires:210,stun_URI:217,To:192,turn_URI:223,uuid:226,WWW_Authenticate:209,challenge:158,sipfrag:230,Referred_By:231};let s=119;const o=[`\r
`,b(`\r
`,!1),/^[0-9]/,_([["0","9"]],!1,!1),/^[a-zA-Z]/,_([["a","z"],["A","Z"]],!1,!1),/^[0-9a-fA-F]/,_([["0","9"],["a","f"],["A","F"]],!1,!1),/^[\0-\xFF]/,_([["\0",""]],!1,!1),/^["]/,_(['"'],!1,!1)," ",b(" ",!1),"	",b("	",!1),/^[a-zA-Z0-9]/,_([["a","z"],["A","Z"],["0","9"]],!1,!1),";",b(";",!1),"/",b("/",!1),"?",b("?",!1),":",b(":",!1),"@",b("@",!1),"&",b("&",!1),"=",b("=",!1),"+",b("+",!1),"$",b("$",!1),",",b(",",!1),"-",b("-",!1),"_",b("_",!1),".",b(".",!1),"!",b("!",!1),"~",b("~",!1),"*",b("*",!1),"'",b("'",!1),"(",b("(",!1),")",b(")",!1),"%",b("%",!1),function(){return" "},function(){return":"},/^[!-~]/,_([["!","~"]],!1,!1),/^[\x80-\uFFFF]/,_([["",""]],!1,!1),/^[\x80-\xBF]/,_([["",""]],!1,!1),/^[a-f]/,_([["a","f"]],!1,!1),"`",b("`",!1),"<",b("<",!1),">",b(">",!1),"\\",b("\\",!1),"[",b("[",!1),"]",b("]",!1),"{",b("{",!1),"}",b("}",!1),function(){return"*"},function(){return"/"},function(){return"="},function(){return"("},function(){return")"},function(){return">"},function(){return"<"},function(){return","},function(){return";"},function(){return":"},function(){return'"'},/^[!-']/,_([["!","'"]],!1,!1),/^[*-[]/,_([["*","["]],!1,!1),/^[\]-~]/,_([["]","~"]],!1,!1),function(S){return S},/^[#-[]/,_([["#","["]],!1,!1),/^[\0-\t]/,_([["\0","	"]],!1,!1),/^[\v-\f]/,_([["\v","\f"]],!1,!1),/^[\x0E-\x7F]/,_([["",""]],!1,!1),function(){e=e||{data:{}},e.data.uri=new wi(e.data.scheme,e.data.user,e.data.host,e.data.port),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port},function(){e=e||{data:{}},e.data.uri=new wi(e.data.scheme,e.data.user,e.data.host,e.data.port,e.data.uri_params,e.data.uri_headers),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port,delete e.data.uri_params,e.startRule==="SIP_URI"&&(e.data=e.data.uri)},"sips",b("sips",!0),"sip",b("sip",!0),function(S){e=e||{data:{}},e.data.scheme=S},function(){e=e||{data:{}},e.data.user=decodeURIComponent(v().slice(0,-1))},function(){e=e||{data:{}},e.data.password=v()},function(){return e=e||{data:{}},e.data.host=v(),e.data.host},function(){return e=e||{data:{}},e.data.host_type="domain",v()},/^[a-zA-Z0-9_\-]/,_([["a","z"],["A","Z"],["0","9"],"_","-"],!1,!1),/^[a-zA-Z0-9\-]/,_([["a","z"],["A","Z"],["0","9"],"-"],!1,!1),function(){return e=e||{data:{}},e.data.host_type="IPv6",v()},"::",b("::",!1),function(){return e=e||{data:{}},e.data.host_type="IPv6",v()},function(){return e=e||{data:{}},e.data.host_type="IPv4",v()},"25",b("25",!1),/^[0-5]/,_([["0","5"]],!1,!1),"2",b("2",!1),/^[0-4]/,_([["0","4"]],!1,!1),"1",b("1",!1),/^[1-9]/,_([["1","9"]],!1,!1),function(S){return e=e||{data:{}},S=parseInt(S.join("")),e.data.port=S,S},"transport=",b("transport=",!0),"udp",b("udp",!0),"tcp",b("tcp",!0),"sctp",b("sctp",!0),"tls",b("tls",!0),function(S){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.transport=S.toLowerCase()},"user=",b("user=",!0),"phone",b("phone",!0),"ip",b("ip",!0),function(S){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.user=S.toLowerCase()},"method=",b("method=",!0),function(S){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.method=S},"ttl=",b("ttl=",!0),function(S){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.ttl=S},"maddr=",b("maddr=",!0),function(S){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.maddr=S},"lr",b("lr",!0),function(){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),e.data.uri_params.lr=void 0},function(S,k){e=e||{data:{}},e.data.uri_params||(e.data.uri_params={}),k===null?k=void 0:k=k[1],e.data.uri_params[S.toLowerCase()]=k},function(S,k){S=S.join("").toLowerCase(),k=k.join(""),e=e||{data:{}},e.data.uri_headers||(e.data.uri_headers={}),e.data.uri_headers[S]?e.data.uri_headers[S].push(k):e.data.uri_headers[S]=[k]},function(){e=e||{data:{}},e.startRule==="Refer_To"&&(e.data.uri=new wi(e.data.scheme,e.data.user,e.data.host,e.data.port,e.data.uri_params,e.data.uri_headers),delete e.data.scheme,delete e.data.user,delete e.data.host,delete e.data.host_type,delete e.data.port,delete e.data.uri_params)},"//",b("//",!1),function(){e=e||{data:{}},e.data.scheme=v()},b("SIP",!0),function(){e=e||{data:{}},e.data.sip_version=v()},"INVITE",b("INVITE",!1),"ACK",b("ACK",!1),"VXACH",b("VXACH",!1),"OPTIONS",b("OPTIONS",!1),"BYE",b("BYE",!1),"CANCEL",b("CANCEL",!1),"REGISTER",b("REGISTER",!1),"SUBSCRIBE",b("SUBSCRIBE",!1),"NOTIFY",b("NOTIFY",!1),"REFER",b("REFER",!1),"PUBLISH",b("PUBLISH",!1),function(){return e=e||{data:{}},e.data.method=v(),e.data.method},function(S){e=e||{data:{}},e.data.status_code=parseInt(S.join(""))},function(){e=e||{data:{}},e.data.reason_phrase=v()},function(){e=e||{data:{}},e.data=v()},function(){var S,k;for(e=e||{data:{}},k=e.data.multi_header.length,S=0;S<k;S++)if(e.data.multi_header[S].parsed===null){e.data=null;break}e.data!==null?e.data=e.data.multi_header:e.data=-1},function(){var S;e=e||{data:{}},e.data.multi_header||(e.data.multi_header=[]);try{S=new Wn(e.data.uri,e.data.displayName,e.data.params),delete e.data.uri,delete e.data.displayName,delete e.data.params}catch(k){S=null}e.data.multi_header.push({position:l,offset:x().start.offset,parsed:S})},function(S){S=v().trim(),S[0]==='"'&&(S=S.substring(1,S.length-1)),e=e||{data:{}},e.data.displayName=S},"q",b("q",!0),function(S){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.q=S},"expires",b("expires",!0),function(S){e=e||{data:{}},e.data.params||(e.data.params={}),e.data.params.expires=S},function(S){return parseInt(S.join(""))},"0",b("0",!1),function(){return parseFloat(v())},function(S,k){e=e||{data:{}},e.data.params||(e.data.params={}),k===null?k=void 0:k=k[1],e.data.params[S.toLowerCase()]=k},"render",b("render",!0),"session",b("session",!0),"icon",b("icon",!0),"alert",b("alert",!0),function(){e=e||{data:{}},e.startRule==="Content_Disposition"&&(e.data.type=v().toLowerCase())},"handling",b("handling",!0),"optional",b("optional",!0),"required",b("required",!0),function(S){e=e||{data:{}},e.data=parseInt(S.join(""))},function(){e=e||{data:{}},e.data=v()},"text",b("text",!0),"image",b("image",!0),"audio",b("audio",!0),"video",b("video",!0),"application",b("application",!0),"message",b("message",!0),"multipart",b("multipart",!0),"x-",b("x-",!0),function(S){e=e||{data:{}},e.data.value=parseInt(S.join(""))},function(S){e=e||{data:{}},e.data=S},function(S){e=e||{data:{}},e.data.event=S.toLowerCase()},function(){e=e||{data:{}};var S=e.data.tag;e.data=new Wn(e.data.uri,e.data.displayName,e.data.params),S&&e.data.setParam("tag",S)},"tag",b("tag",!0),function(S){e=e||{data:{}},e.data.tag=S},function(S){e=e||{data:{}},e.data=parseInt(S.join(""))},function(S){e=e||{data:{}},e.data=S},function(){e=e||{data:{}},e.data=new Wn(e.data.uri,e.data.displayName,e.data.params)},"digest",b("Digest",!0),"realm",b("realm",!0),function(S){e=e||{data:{}},e.data.realm=S},"domain",b("domain",!0),"nonce",b("nonce",!0),function(S){e=e||{data:{}},e.data.nonce=S},"opaque",b("opaque",!0),function(S){e=e||{data:{}},e.data.opaque=S},"stale",b("stale",!0),"true",b("true",!0),function(){e=e||{data:{}},e.data.stale=!0},"false",b("false",!0),function(){e=e||{data:{}},e.data.stale=!1},"algorithm",b("algorithm",!0),"md5",b("MD5",!0),"md5-sess",b("MD5-sess",!0),function(S){e=e||{data:{}},e.data.algorithm=S.toUpperCase()},"qop",b("qop",!0),"auth-int",b("auth-int",!0),"auth",b("auth",!0),function(S){e=e||{data:{}},e.data.qop||(e.data.qop=[]),e.data.qop.push(S.toLowerCase())},function(S){e=e||{data:{}},e.data.value=parseInt(S.join(""))},function(){var S,k;for(e=e||{data:{}},k=e.data.multi_header.length,S=0;S<k;S++)if(e.data.multi_header[S].parsed===null){e.data=null;break}e.data!==null?e.data=e.data.multi_header:e.data=-1},function(){var S;e=e||{data:{}},e.data.multi_header||(e.data.multi_header=[]);try{S=new Wn(e.data.uri,e.data.displayName,e.data.params),delete e.data.uri,delete e.data.displayName,delete e.data.params}catch(k){S=null}e.data.multi_header.push({position:l,offset:x().start.offset,parsed:S})},function(){e=e||{data:{}},e.data=new Wn(e.data.uri,e.data.displayName,e.data.params)},function(){e=e||{data:{}},e.data.replaces_from_tag&&e.data.replaces_to_tag||(e.data=-1)},function(){e=e||{data:{}},e.data={call_id:e.data}},"from-tag",b("from-tag",!0),function(S){e=e||{data:{}},e.data.replaces_from_tag=S},"to-tag",b("to-tag",!0),function(S){e=e||{data:{}},e.data.replaces_to_tag=S},"early-only",b("early-only",!0),function(){e=e||{data:{}},e.data.early_only=!0},function(S,k){return k},function(S,k){return R(S,k)},function(S){e=e||{data:{}},e.startRule==="Require"&&(e.data=S||[])},function(S){e=e||{data:{}},e.data.value=parseInt(S.join(""))},"active",b("active",!0),"pending",b("pending",!0),"terminated",b("terminated",!0),function(){e=e||{data:{}},e.data.state=v()},"reason",b("reason",!0),function(S){e=e||{data:{}},typeof S!="undefined"&&(e.data.reason=S)},function(S){e=e||{data:{}},typeof S!="undefined"&&(e.data.expires=S)},"retry_after",b("retry_after",!0),function(S){e=e||{data:{}},typeof S!="undefined"&&(e.data.retry_after=S)},"deactivated",b("deactivated",!0),"probation",b("probation",!0),"rejected",b("rejected",!0),"timeout",b("timeout",!0),"giveup",b("giveup",!0),"noresource",b("noresource",!0),"invariant",b("invariant",!0),function(S){e=e||{data:{}},e.startRule==="Supported"&&(e.data=S||[])},function(){e=e||{data:{}};var S=e.data.tag;e.data=new Wn(e.data.uri,e.data.displayName,e.data.params),S&&e.data.setParam("tag",S)},"ttl",b("ttl",!0),function(S){e=e||{data:{}},e.data.ttl=S},"maddr",b("maddr",!0),function(S){e=e||{data:{}},e.data.maddr=S},"received",b("received",!0),function(S){e=e||{data:{}},e.data.received=S},"branch",b("branch",!0),function(S){e=e||{data:{}},e.data.branch=S},"rport",b("rport",!0),function(S){e=e||{data:{}},typeof S!="undefined"&&(e.data.rport=S.join(""))},function(S){e=e||{data:{}},e.data.protocol=S},b("UDP",!0),b("TCP",!0),b("TLS",!0),b("SCTP",!0),function(S){e=e||{data:{}},e.data.transport=S},function(){e=e||{data:{}},e.data.host=v()},function(S){e=e||{data:{}},e.data.port=parseInt(S.join(""))},function(S){return parseInt(S.join(""))},function(S){e=e||{data:{}},e.startRule==="Session_Expires"&&(e.data.deltaSeconds=S)},"refresher",b("refresher",!1),"uas",b("uas",!1),"uac",b("uac",!1),function(S){e=e||{data:{}},e.startRule==="Session_Expires"&&(e.data.refresher=S)},function(S){e=e||{data:{}},e.startRule==="Min_SE"&&(e.data=S)},"stuns",b("stuns",!0),"stun",b("stun",!0),function(S){e=e||{data:{}},e.data.scheme=S},function(S){e=e||{data:{}},e.data.host=S},"?transport=",b("?transport=",!1),"turns",b("turns",!0),"turn",b("turn",!0),function(S){e=e||{data:{}},e.data.transport=S},function(){e=e||{data:{}},e.data=v()},"Referred-By",b("Referred-By",!1),"b",b("b",!1),"cid",b("cid",!1)],a=[g('2 ""6 7!'),g('4"""5!7#'),g('4$""5!7%'),g(`4&""5!7'`),g(";'.# &;("),g('4(""5!7)'),g('4*""5!7+'),g('2,""6,7-'),g('2.""6.7/'),g('40""5!71'),g('22""6273. &24""6475.} &26""6677.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),g(";).# &;,"),g('2F""6F7G.} &2H""6H7I.q &2J""6J7K.e &2L""6L7M.Y &2N""6N7O.M &2P""6P7Q.A &2R""6R7S.5 &2T""6T7U.) &2V""6V7W'),g(`%%2X""6X7Y/5#;#/,$;#/#$+#)(#'#("'#&'#/"!&,)`),g(`%%$;$0#*;$&/,#; /#$+")("'#&'#." &"/=#$;$/&#0#*;$&&&#/'$8":Z" )("'#&'#`),g(';.." &"'),g(`%$;'.# &;(0)*;'.# &;(&/?#28""6879/0$;//'$8#:[# )(#'#("'#&'#`),g(`%%$;2/&#0#*;2&&&#/g#$%$;.0#*;.&/,#;2/#$+")("'#&'#0=*%$;.0#*;.&/,#;2/#$+")("'#&'#&/#$+")("'#&'#/"!&,)`),g('4\\""5!7].# &;3'),g('4^""5!7_'),g('4`""5!7a'),g(';!.) &4b""5!7c'),g('%$;). &2F""6F7G. &2J""6J7K.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O/#0*;). &2F""6F7G. &2J""6J7K.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O&&&#/"!&,)'),g('%$;). &2F""6F7G.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O/#0*;). &2F""6F7G.} &2L""6L7M.q &2X""6X7Y.e &2P""6P7Q.Y &2H""6H7I.M &2@""6@7A.A &2d""6d7e.5 &2R""6R7S.) &2N""6N7O&&&#/"!&,)'),g(`2T""6T7U. &2V""6V7W. &2f""6f7g. &2h""6h7i. &2:""6:7;. &2D""6D7E. &22""6273. &28""6879. &2j""6j7k. &;&.} &24""6475.q &2l""6l7m.e &2n""6n7o.Y &26""6677.M &2>""6>7?.A &2p""6p7q.5 &2r""6r7s.) &;'.# &;(`),g('%$;). &2F""6F7G. &2J""6J7K. &2L""6L7M. &2X""6X7Y. &2P""6P7Q. &2H""6H7I. &2@""6@7A. &2d""6d7e. &2R""6R7S. &2N""6N7O. &2T""6T7U. &2V""6V7W. &2f""6f7g. &2h""6h7i. &28""6879.w &2j""6j7k.k &;&.e &24""6475.Y &2l""6l7m.M &2n""6n7o.A &26""6677.5 &2p""6p7q.) &2r""6r7s/#0*;). &2F""6F7G. &2J""6J7K. &2L""6L7M. &2X""6X7Y. &2P""6P7Q. &2H""6H7I. &2@""6@7A. &2d""6d7e. &2R""6R7S. &2N""6N7O. &2T""6T7U. &2V""6V7W. &2f""6f7g. &2h""6h7i. &28""6879.w &2j""6j7k.k &;&.e &24""6475.Y &2l""6l7m.M &2n""6n7o.A &26""6677.5 &2p""6p7q.) &2r""6r7s&&&#/"!&,)'),g(`%;//?#2P""6P7Q/0$;//'$8#:t# )(#'#("'#&'#`),g(`%;//?#24""6475/0$;//'$8#:u# )(#'#("'#&'#`),g(`%;//?#2>""6>7?/0$;//'$8#:v# )(#'#("'#&'#`),g(`%;//?#2T""6T7U/0$;//'$8#:w# )(#'#("'#&'#`),g(`%;//?#2V""6V7W/0$;//'$8#:x# )(#'#("'#&'#`),g(`%2h""6h7i/0#;//'$8":y" )("'#&'#`),g(`%;//6#2f""6f7g/'$8":z" )("'#&'#`),g(`%;//?#2D""6D7E/0$;//'$8#:{# )(#'#("'#&'#`),g(`%;//?#22""6273/0$;//'$8#:|# )(#'#("'#&'#`),g(`%;//?#28""6879/0$;//'$8#:}# )(#'#("'#&'#`),g(`%;//0#;&/'$8":~" )("'#&'#`),g(`%;&/0#;//'$8":~" )("'#&'#`),g(`%;=/T#$;G.) &;K.# &;F0/*;G.) &;K.# &;F&/,$;>/#$+#)(#'#("'#&'#`),g('4""5!7.A &4""5!7.5 &4""5!7.) &;3.# &;.'),g(`%%;//Q#;&/H$$;J.# &;K0)*;J.# &;K&/,$;&/#$+$)($'#(#'#("'#&'#/"!&,)`),g(`%;//]#;&/T$%$;J.# &;K0)*;J.# &;K&/"!&,)/1$;&/($8$:$!!)($'#(#'#("'#&'#`),g(';..G &2L""6L7M.; &4""5!7./ &4""5!7.# &;3'),g(`%2j""6j7k/J#4""5!7.5 &4""5!7.) &4""5!7/#$+")("'#&'#`),g(`%;N/M#28""6879/>$;O." &"/0$;S/'$8$:$ )($'#(#'#("'#&'#`),g(`%;N/d#28""6879/U$;O." &"/G$;S/>$;_/5$;l." &"/'$8&:& )(&'#(%'#($'#(#'#("'#&'#`),g(`%3""5$7.) &3""5#7/' 8!:!! )`),g(`%;P/]#%28""6879/,#;R/#$+")("'#&'#." &"/6$2:""6:7;/'$8#:# )(#'#("'#&'#`),g("$;+.) &;-.# &;Q/2#0/*;+.) &;-.# &;Q&&&#"),g('2<""6<7=.q &2>""6>7?.e &2@""6@7A.Y &2B""6B7C.M &2D""6D7E.A &22""6273.5 &26""6677.) &24""6475'),g('%$;+._ &;-.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E0e*;+._ &;-.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E&/& 8!:! )'),g(`%;T/J#%28""6879/,#;^/#$+")("'#&'#." &"/#$+")("'#&'#`),g("%;U.) &;\\.# &;X/& 8!:! )"),g(`%$%;V/2#2J""6J7K/#$+")("'#&'#0<*%;V/2#2J""6J7K/#$+")("'#&'#&/D#;W/;$2J""6J7K." &"/'$8#:# )(#'#("'#&'#`),g('$4""5!7/,#0)*4""5!7&&&#'),g(`%4$""5!7%/?#$4""5!70)*4""5!7&/#$+")("'#&'#`),g(`%2l""6l7m/?#;Y/6$2n""6n7o/'$8#:# )(#'#("'#&'#`),g(`%%;Z/#28""6879/$;Z/$28""6879/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+-)(-'#(,'#(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%2""67/#;Z/$28""6879/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+,)(,'#(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%2""67/#;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+*)(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%2""67/t#;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%2""67/\\#;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+&)(&'#(%'#($'#(#'#("'#&'#. &%2""67/D#;Z/;$28""6879/,$;[/#$+$)($'#(#'#("'#&'#. &%2""67/,#;[/#$+")("'#&'#. &%2""67/,#;Z/#$+")("'#&'#. &%;Z/#2""67/$;Z/$28""6879/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$++)(+'#(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$2""67/t$;Z/k$28""6879/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+*)(*'#()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/k$2""67/\\$;Z/S$28""6879/D$;Z/;$28""6879/,$;[/#$+))()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/z$%28""6879/,#;Z/#$+")("'#&'#." &"/S$2""67/D$;Z/;$28""6879/,$;[/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/b$%28""6879/,#;Z/#$+")("'#&'#." &"/;$2""67/,$;[/#$+')(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/b$%28""6879/,#;Z/#$+")("'#&'#." &"/;$2""67/,$;Z/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#. &%;Z/#%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/$%28""6879/,#;Z/#$+")("'#&'#." &"/Y$%28""6879/,#;Z/#$+")("'#&'#." &"/2$2""67/#$+()(('#(''#(&'#(%'#($'#(#'#("'#&'#/& 8!:! )`),g(`%;#/M#;#." &"/?$;#." &"/1$;#." &"/#$+$)($'#(#'#("'#&'#`),g(`%;Z/;#28""6879/,$;Z/#$+#)(#'#("'#&'#.# &;\\`),g(`%;]/o#2J""6J7K/\`$;]/W$2J""6J7K/H$;]/?$2J""6J7K/0$;]/'$8':' )(''#(&'#(%'#($'#(#'#("'#&'#`),g(`%2""67/2#4""5!7/#$+")("'#&'#. &%2""67/;#4""5!7/,$;!/#$+#)(#'#("'#&'#.j &%2""67/5#;!/,$;!/#$+#)(#'#("'#&'#.B &%4""5!7/,#;!/#$+")("'#&'#.# &;!`),g(`%%;!." &"/[#;!." &"/M$;!." &"/?$;!." &"/1$;!." &"/#$+%)(%'#($'#(#'#("'#&'#/' 8!:!! )`),g(`$%22""6273/,#;\`/#$+")("'#&'#0<*%22""6273/,#;\`/#$+")("'#&'#&`),g(";a.A &;b.; &;c.5 &;d./ &;e.) &;f.# &;g"),g(`%3""5*7/a#3""5#7.G &3""5#7.; &3""5$7./ &3""5#7.# &;6/($8":"! )("'#&'#`),g(`%3""5%7/I#3""5%7./ &3""5"7.# &;6/($8":"! )("'#&'#`),g(`%3""5'7/1#;/($8":"! )("'#&'#`),g(`%3""5$7/1#;/($8":"! )("'#&'#`),g(`%3""5&7/1#;T/($8":"! )("'#&'#`),g(`%3""5"7/N#%2>""6>7?/,#;6/#$+")("'#&'#." &"/'$8":" )("'#&'#`),g(`%;h/P#%2>""6>7?/,#;i/#$+")("'#&'#." &"/)$8":""! )("'#&'#`),g('%$;j/&#0#*;j&&&#/"!&,)'),g('%$;j/&#0#*;j&&&#/"!&,)'),g(";k.) &;+.# &;-"),g('2l""6l7m.e &2n""6n7o.Y &24""6475.M &28""6879.A &2<""6<7=.5 &2@""6@7A.) &2B""6B7C'),g(`%26""6677/n#;m/e$$%2<""6<7=/,#;m/#$+")("'#&'#0<*%2<""6<7=/,#;m/#$+")("'#&'#&/#$+#)(#'#("'#&'#`),g(`%;n/A#2>""6>7?/2$;o/)$8#:#"" )(#'#("'#&'#`),g("$;p.) &;+.# &;-/2#0/*;p.) &;+.# &;-&&&#"),g("$;p.) &;+.# &;-0/*;p.) &;+.# &;-&"),g('2l""6l7m.e &2n""6n7o.Y &24""6475.M &26""6677.A &28""6879.5 &2@""6@7A.) &2B""6B7C'),g(";.# &;r"),g(`%;/G#;'/>$;s/5$;'/,$;/#$+%)(%'#($'#(#'#("'#&'#`),g(";M.# &;t"),g(`%;/E#28""6879/6$;u.# &;x/'$8#:# )(#'#("'#&'#`),g(`%;v.# &;w/J#%26""6677/,#;/#$+")("'#&'#." &"/#$+")("'#&'#`),g(`%2""67/:#;/1$;w." &"/#$+#)(#'#("'#&'#`),g(`%24""6475/,#;{/#$+")("'#&'#`),g(`%;z/3#$;y0#*;y&/#$+")("'#&'#`),g(";*.) &;+.# &;-"),g(';+. &;-. &22""6273.} &26""6677.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),g(`%;|/e#$%24""6475/,#;|/#$+")("'#&'#0<*%24""6475/,#;|/#$+")("'#&'#&/#$+")("'#&'#`),g(`%$;~0#*;~&/e#$%22""6273/,#;}/#$+")("'#&'#0<*%22""6273/,#;}/#$+")("'#&'#&/#$+")("'#&'#`),g("$;~0#*;~&"),g(';+.w &;-.q &28""6879.e &2:""6:7;.Y &2<""6<7=.M &2>""6>7?.A &2@""6@7A.5 &2B""6B7C.) &2D""6D7E'),g(`%%;"/#$;".G &;!.A &2@""6@7A.5 &2F""6F7G.) &2J""6J7K0M*;".G &;!.A &2@""6@7A.5 &2F""6F7G.) &2J""6J7K&/#$+")("'#&'#/& 8!:! )`),g(";.# &;"),g(`%%;O/2#2:""6:7;/#$+")("'#&'#." &"/,#;S/#$+")("'#&'#." &"`),g('$;+. &;-.} &2B""6B7C.q &2D""6D7E.e &22""6273.Y &28""6879.M &2:""6:7;.A &2<""6<7=.5 &2>""6>7?.) &2@""6@7A/#0*;+. &;-.} &2B""6B7C.q &2D""6D7E.e &22""6273.Y &28""6879.M &2:""6:7;.A &2<""6<7=.5 &2>""6>7?.) &2@""6@7A&&&#'),g("$;y0#*;y&"),g(`%3""5#7/q#24""6475/b$$;!/&#0#*;!&&&#/L$2J""6J7K/=$$;!/&#0#*;!&&&#/'$8%:% )(%'#($'#(#'#("'#&'#`),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g('2""67'),g("%;.Y &;.S &;.M &;.G &;.A &;.; &;.5 &;./ &;.) &;.# &;6/& 8!:! )"),g(`%;/G#;'/>$;/5$;'/,$;/#$+%)(%'#($'#(#'#("'#&'#`),g("%;/' 8!:!! )"),g(`%;!/5#;!/,$;!/#$+#)(#'#("'#&'#`),g("%$;*.A &;+.; &;-.5 &;3./ &;4.) &;'.# &;(0G*;*.A &;+.; &;-.5 &;3./ &;4.) &;'.# &;(&/& 8!:! )"),g(`%;/Y#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g(`%;9/N#%2:""6:7;/,#;9/#$+")("'#&'#." &"/'$8":" )("'#&'#`),g(`%;:.c &%;/Y#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+")("'#&'#/& 8!:! )`),g(`%;L.# &;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(`%;." &"/>#;@/5$;M/,$;?/#$+$)($'#(#'#("'#&'#`),g(`%%;6/Y#$%;./,#;6/#$+")("'#&'#06*%;./,#;6/#$+")("'#&'#&/#$+")("'#&'#.# &;H/' 8!:!! )`),g(";.) &;.# &;"),g(`%3""5!7/:#;</1$;/($8#:#! )(#'#("'#&'#`),g(`%3""5'7/:#;</1$;/($8#:#! )(#'#("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g(`%2""67/o#%2J""6J7K/M#;!." &"/?$;!." &"/1$;!." &"/#$+$)($'#(#'#("'#&'#." &"/'$8":" )("'#&'#`),g(`%;6/J#%;</,#;/#$+")("'#&'#." &"/)$8":""! )("'#&'#`),g(";6.) &;T.# &;H"),g(`%;/Y#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g(`%3""5&7.G &3""5'7.; &3""5$7./ &3""5%7.# &;6/& 8!:! )`),g(";.# &;"),g(`%3""5(7/M#;</D$3""5(7./ &3""5(7.# &;6/#$+#)(#'#("'#&'#`),g(`%;6/Y#$%;A/,#;6/#$+")("'#&'#06*%;A/,#;6/#$+")("'#&'#&/#$+")("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g("%;/& 8!:! )"),g(`%;/k#;;/b$;/Y$$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),g(";.# &;"),g('3""5$7.S &3""5%7.G &3""5%7.; &3""5%7./ &3""5+7.# &;'),g(`3""5'7./ &3""5)7.# &;`),g(";6.# &;"),g(`%3""5"7/,#;6/#$+")("'#&'#`),g(";.# &;6"),g(`%;6/5#;</,$;/#$+#)(#'#("'#&'#`),g(";6.# &;H"),g(`%;/5#;./,$;/#$+#)(#'#("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g("%;/' 8!:!! )"),g(`%;/^#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/($8":"!!)("'#&'#`),g(`%%;7/e#$%2J""6J7K/,#;7/#$+")("'#&'#0<*%2J""6J7K/,#;7/#$+")("'#&'#&/#$+")("'#&'#/"!&,)`),g(`%;L.# &;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(";.# &;"),g(`%3""5#7/:#;</1$;6/($8#:#! )(#'#("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g("%;/' 8!:!! )"),g(`%$;0#*;&/x#;@/o$;M/f$;?/]$$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8%:% )(%'#($'#(#'#("'#&'#`),g(";"),g(`%3""5&7/k#;./b$;/Y$$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#.# &;`),g(`%;6/k#;./b$;/Y$$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),g(`%;6/;#;</2$;6.# &;H/#$+#)(#'#("'#&'#`),g(";.G &;.A &;.; &;.5 &;./ &;.) &;.# &;"),g(`%3""5%7/5#;</,$;/#$+#)(#'#("'#&'#`),g("%;I/' 8!:!! )"),g(`%3""5&7/#;</$;D/$;/|$$%$;'/&#0#*;'&&&#/,#;/#$+")("'#&'#0C*%$;'/&#0#*;'&&&#/,#;/#$+")("'#&'#&/,$;E/#$+&)(&'#(%'#($'#(#'#("'#&'#`),g(";t.# &;w"),g(`%3""5%7/5#;</,$;/#$+#)(#'#("'#&'#`),g("%;I/' 8!:!! )"),g(`%3""5&7/:#;</1$;I/($8#:#! )(#'#("'#&'#`),g(`%3""5%7/]#;</T$%3""5$7/& 8!:! ).4 &%3""5%7/& 8!:! )/#$+#)(#'#("'#&'#`),g(`%3""5)7/R#;</I$3""5#7./ &3""5(7.# &;6/($8#:#! )(#'#("'#&'#`),g(`%3""5#7/#;</$;D/$%;/e#$%2D""6D7E/,#;/#$+")("'#&'#0<*%2D""6D7E/,#;/#$+")("'#&'#&/#$+")("'#&'#/,$;E/#$+%)(%'#($'#(#'#("'#&'#`),g(`%3""5(7./ &3""5$7.# &;6/' 8!:!! )`),g(`%;6/Y#$%;A/,#;6/#$+")("'#&'#06*%;A/,#;6/#$+")("'#&'#&/#$+")("'#&'#`),g(`%;/G#;./>$;/5$;./,$;/#$+%)(%'#($'#(#'#("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g(`%;/]#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(`%;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(`%;L.O &;.I &%;@." &"/:#;t/1$;?." &"/#$+#)(#'#("'#&'#/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(`%;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g("%;/& 8!:! )"),g(`%3""5(7/:#;</1$;6/($8#:#! )(#'#("'#&'#.g &%3""5&7/:#;</1$;6/($8#:#! )(#'#("'#&'#.: &%3""5*7/& 8!:! ).# &;`),g(`%%;6/k#$%;A/2#;6/)$8":""$ )("'#&'#0<*%;A/2#;6/)$8":""$ )("'#&'#&/)$8":""! )("'#&'#." &"/' 8!:!! )`),g(`%;/Y#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g(`%;/Y#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g("%$;!/&#0#*;!&&&#/' 8!:!! )"),g(`%;/Y#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g(`%3""5&7.; &3""5'7./ &3""5*7.# &;6/& 8!:! )`),g(`%3""5&7/:#;</1$;/($8#:#! )(#'#("'#&'#.} &%3""5'7/:#;</1$;/($8#:#! )(#'#("'#&'#.P &%3""5+7/:#;</1$;/($8#:#! )(#'#("'#&'#.# &;`),g(`3""5+7.k &3""5)7._ &3""5(7.S &3""5'7.G &3""5&7.; &3""5*7./ &3""5)7.# &;6`),g(';1." &"'),g(`%%;6/k#$%;A/2#;6/)$8":""$ )("'#&'#0<*%;A/2#;6/)$8":""$ )("'#&'#&/)$8":""! )("'#&'#." &"/' 8!:!! )`),g(`%;L.# &;/]#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/'$8":" )("'#&'#`),g(";.# &;"),g(`%;/Y#$%;A/,#;/#$+")("'#&'#06*%;A/,#;/#$+")("'#&'#&/#$+")("'#&'#`),g(`%;/k#;./b$;/Y$$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),g(";.; &;.5 &;./ &;.) &;.# &;"),g(`%3""5#7/:#;</1$;/($8#:#! )(#'#("'#&'#`),g(`%3""5%7/:#;</1$;T/($8#:#! )(#'#("'#&'#`),g(`%3""5(7/F#;</=$;\\.) &;Y.# &;X/($8#:#! )(#'#("'#&'#`),g(`%3""5&7/:#;</1$;6/($8#:#! )(#'#("'#&'#`),g(`%3""5%7/A#;</8$$;!0#*;!&/($8#:#! )(#'#("'#&'#`),g(`%;/G#;;/>$;6/5$;;/,$;/#$+%)(%'#($'#(#'#("'#&'#`),g(`%3""5#7.# &;6/' 8!:!! )`),g(`%3""5#7.G &3""5#7.; &3""5#7./ &3""5$7.# &;6/' 8!:!! )`),g(`%;/D#%;C/,#;/#$+")("'#&'#." &"/#$+")("'#&'#`),g("%;U.) &;\\.# &;X/& 8!:! )"),g(`%%;!." &"/[#;!." &"/M$;!." &"/?$;!." &"/1$;!." &"/#$+%)(%'#($'#(#'#("'#&'#/' 8!:!! )`),g(`%%;!/?#;!." &"/1$;!." &"/#$+#)(#'#("'#&'#/' 8!:!! )`),g(";"),g(`%;/^#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/($8":"!!)("'#&'#`),g(";.# &;"),g(`%2""67/L#;</C$2""67.) &2""67/($8#:#! )(#'#("'#&'#`),g(`%;/^#$%;B/,#;/#$+")("'#&'#06*%;B/,#;/#$+")("'#&'#&/($8":"!!)("'#&'#`),g(`%;6/5#;0/,$;/#$+#)(#'#("'#&'#`),g("$;2.) &;4.# &;.0/*;2.) &;4.# &;.&"),g("$;%0#*;%&"),g(`%;/;#28""6879/,$;/#$+#)(#'#("'#&'#`),g(`%3""5%7.) &3""5$7/' 8!:!! )`),g(`%;/J#%28""6879/,#;^/#$+")("'#&'#." &"/#$+")("'#&'#`),g("%;\\.) &;X.# &;/' 8!:!! )"),g(';".S &;!.M &2F""6F7G.A &2J""6J7K.5 &2H""6H7I.) &2N""6N7O'),g('2L""6L7M. &2B""6B7C. &2<""6<7=.} &2R""6R7S.q &2T""6T7U.e &2V""6V7W.Y &2P""6P7Q.M &2@""6@7A.A &2D""6D7E.5 &22""6273.) &2>""6>7?'),g(`%;/b#28""6879/S$;/J$%2""67/,#;/#$+")("'#&'#." &"/#$+$)($'#(#'#("'#&'#`),g(`%3""5%7.) &3""5$7/' 8!:!! )`),g(`%3""5#7.6 &3""5#7.* &$;+0#*;+&/' 8!:!! )`),g(`%;/#2F""6F7G/x$;/o$2F""6F7G/\`$;/W$2F""6F7G/H$;/?$2F""6F7G/0$;/'$8):) )()'#(('#(''#(&'#(%'#($'#(#'#("'#&'#`),g(`%;#/>#;#/5$;#/,$;#/#$+$)($'#(#'#("'#&'#`),g(`%;/,#;/#$+")("'#&'#`),g(`%;/5#;/,$;/#$+#)(#'#("'#&'#`),g(`%;q/T#$;m0#*;m&/D$%; /,#;/#$+")("'#&'#." &"/#$+#)(#'#("'#&'#`),g(`%2""67.) &2""67/w#;0/n$;/e$$%;B/2#;.# &;/#$+")("'#&'#0<*%;B/2#;.# &;/#$+")("'#&'#&/#$+$)($'#(#'#("'#&'#`),g(";.# &;L"),g(`%2""67/5#;</,$;/#$+#)(#'#("'#&'#`),g(`%;D/S#;,/J$2:""6:7;/;$;,.# &;T/,$;E/#$+%)(%'#($'#(#'#("'#&'#`)];let l=0,c=0;const u=[{line:1,column:1}];let d=0,f=[],p=0,m;if(e.startRule!==void 0){if(!(e.startRule in i))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');s=i[e.startRule]}function v(){return n.substring(c,l)}function x(){return w(c,l)}function b(S,k){return{type:"literal",text:S,ignoreCase:k}}function _(S,k,T){return{type:"class",parts:S,inverted:k,ignoreCase:T}}function M(){return{type:"end"}}function h(S){let k=u[S],T;if(k)return k;for(T=S-1;!u[T];)T--;for(k=u[T],k={line:k.line,column:k.column};T<S;)n.charCodeAt(T)===10?(k.line++,k.column=1):k.column++,T++;return u[S]=k,k}function w(S,k){const T=h(S),C=h(k);return{source:r,start:{offset:S,line:T.line,column:T.column},end:{offset:k,line:C.line,column:C.column}}}function y(S){l<d||(l>d&&(d=l,f=[]),f.push(S))}function E(S,k,T){return new e_(e_.buildMessage(S,k),S,k,T)}function g(S){return S.split("").map(k=>k.charCodeAt(0)-32)}function I(S){const k=a[S];let T=0;const C=[];let D=k.length;const A=[],O=[];let P;for(;;){for(;T<D;)switch(k[T]){case 0:O.push(o[k[T+1]]),T+=2;break;case 1:O.push(void 0),T++;break;case 2:O.push(null),T++;break;case 3:O.push(t),T++;break;case 4:O.push([]),T++;break;case 5:O.push(l),T++;break;case 6:O.pop(),T++;break;case 7:l=O.pop(),T++;break;case 8:O.length-=k[T+1],T+=2;break;case 9:O.splice(-2,1),T++;break;case 10:O[O.length-2].push(O.pop()),T++;break;case 11:O.push(O.splice(O.length-k[T+1],k[T+1])),T+=2;break;case 12:O.push(n.substring(O.pop(),l)),T++;break;case 13:A.push(D),C.push(T+3+k[T+1]+k[T+2]),O[O.length-1]?(D=T+3+k[T+1],T+=3):(D=T+3+k[T+1]+k[T+2],T+=3+k[T+1]);break;case 14:A.push(D),C.push(T+3+k[T+1]+k[T+2]),O[O.length-1]===t?(D=T+3+k[T+1],T+=3):(D=T+3+k[T+1]+k[T+2],T+=3+k[T+1]);break;case 15:A.push(D),C.push(T+3+k[T+1]+k[T+2]),O[O.length-1]!==t?(D=T+3+k[T+1],T+=3):(D=T+3+k[T+1]+k[T+2],T+=3+k[T+1]);break;case 16:O[O.length-1]!==t?(A.push(D),C.push(T),D=T+2+k[T+1],T+=2):T+=2+k[T+1];break;case 17:A.push(D),C.push(T+3+k[T+1]+k[T+2]),n.length>l?(D=T+3+k[T+1],T+=3):(D=T+3+k[T+1]+k[T+2],T+=3+k[T+1]);break;case 18:A.push(D),C.push(T+4+k[T+2]+k[T+3]),n.substr(l,o[k[T+1]].length)===o[k[T+1]]?(D=T+4+k[T+2],T+=4):(D=T+4+k[T+2]+k[T+3],T+=4+k[T+2]);break;case 19:A.push(D),C.push(T+4+k[T+2]+k[T+3]),n.substr(l,o[k[T+1]].length).toLowerCase()===o[k[T+1]]?(D=T+4+k[T+2],T+=4):(D=T+4+k[T+2]+k[T+3],T+=4+k[T+2]);break;case 20:A.push(D),C.push(T+4+k[T+2]+k[T+3]),o[k[T+1]].test(n.charAt(l))?(D=T+4+k[T+2],T+=4):(D=T+4+k[T+2]+k[T+3],T+=4+k[T+2]);break;case 21:O.push(n.substr(l,k[T+1])),l+=k[T+1],T+=2;break;case 22:O.push(o[k[T+1]]),l+=o[k[T+1]].length,T+=2;break;case 23:O.push(t),p===0&&y(o[k[T+1]]),T+=2;break;case 24:c=O[O.length-1-k[T+1]],T+=2;break;case 25:c=l,T++;break;case 26:P=k.slice(T+4,T+4+k[T+3]).map(function(N){return O[O.length-1-N]}),O.splice(O.length-k[T+2],k[T+2],o[k[T+1]].apply(null,P)),T+=4+k[T+3];break;case 27:O.push(I(k[T+1])),T+=2;break;case 28:p++,T++;break;case 29:p--,T++;break;default:throw new Error("Invalid opcode: "+k[T]+".")}if(A.length>0)D=A.pop(),T=C.pop();else break}return O[0]}e.data={};function R(S,k){return[S].concat(k)}if(m=I(s),m!==t&&l===n.length)return m;throw m!==t&&l<n.length&&y(M()),E(f,d<n.length?n.charAt(d):null,d<n.length?w(d,d+1):w(d,d))}const mQ=pQ;var Gt;(function(n){function e(i,s){const o={startRule:s};try{mQ(i,o)}catch(a){o.data=-1}return o.data}n.parse=e;function t(i){const s=n.parse(i,"Name_Addr_Header");return s!==-1?s:void 0}n.nameAddrHeaderParse=t;function r(i){const s=n.parse(i,"SIP_URI");return s!==-1?s:void 0}n.URIParse=r})(Gt=Gt||(Gt={}));const gQ={100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"};function Po(n,e=32){let t="";for(let r=0;r<n;r++){const i=Math.floor(Math.random()*e);t+=i.toString(e)}return t}function lm(n){return gQ[n]||""}function cm(){return Po(10)}function pi(n){const e={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"},t=n.toLowerCase().replace(/_/g,"-").split("-"),r=t.length;let i="";for(let s=0;s<r;s++)s!==0&&(i+="-"),i+=t[s].charAt(0).toUpperCase()+t[s].substring(1);return e[i]&&(i=e[i]),i}function Xu(n){return encodeURIComponent(n).replace(/%[A-F\d]{2}/g,"U").length}class UM{constructor(){this.headers={}}addHeader(e,t){const r={raw:t};e=pi(e),this.headers[e]?this.headers[e].push(r):this.headers[e]=[r]}getHeader(e){const t=this.headers[pi(e)];if(t){if(t[0])return t[0].raw}else return}getHeaders(e){const t=this.headers[pi(e)],r=[];if(!t)return[];for(const i of t)r.push(i.raw);return r}hasHeader(e){return!!this.headers[pi(e)]}parseHeader(e,t=0){if(e=pi(e),this.headers[e]){if(t>=this.headers[e].length)return}else return;const r=this.headers[e][t],i=r.raw;if(r.parsed)return r.parsed;const s=Gt.parse(i,e.replace(/-/g,"_"));if(s===-1){this.headers[e].splice(t,1);return}else return r.parsed=s,s}s(e,t=0){return this.parseHeader(e,t)}setHeader(e,t){this.headers[pi(e)]=[{raw:t}]}toString(){return this.data}}class ul extends UM{constructor(){super()}}class qs extends UM{constructor(){super()}}class Yo{constructor(e,t,r,i,s,o,a){this.headers={},this.extraHeaders=[],this.options=Yo.getDefaultOptions(),s&&(this.options=Object.assign(Object.assign({},this.options),s),this.options.optionTags&&this.options.optionTags.length&&(this.options.optionTags=this.options.optionTags.slice()),this.options.routeSet&&this.options.routeSet.length&&(this.options.routeSet=this.options.routeSet.slice())),o&&o.length&&(this.extraHeaders=o.slice()),a&&(this.body={body:a.content,contentType:a.contentType}),this.method=e,this.ruri=t.clone(),this.fromURI=r.clone(),this.fromTag=this.options.fromTag?this.options.fromTag:cm(),this.from=Yo.makeNameAddrHeader(this.fromURI,this.options.fromDisplayName,this.fromTag),this.toURI=i.clone(),this.toTag=this.options.toTag,this.to=Yo.makeNameAddrHeader(this.toURI,this.options.toDisplayName,this.toTag),this.callId=this.options.callId?this.options.callId:this.options.callIdPrefix+Po(15),this.cseq=this.options.cseq,this.setHeader("route",this.options.routeSet),this.setHeader("via",""),this.setHeader("to",this.to.toString()),this.setHeader("from",this.from.toString()),this.setHeader("cseq",this.cseq+" "+this.method),this.setHeader("call-id",this.callId),this.setHeader("max-forwards","70")}static getDefaultOptions(){return{callId:"",callIdPrefix:"",cseq:1,toDisplayName:"",toTag:"",fromDisplayName:"",fromTag:"",forceRport:!1,hackViaTcp:!1,optionTags:["outbound"],routeSet:[],userAgentString:"sip.js",viaHost:""}}static makeNameAddrHeader(e,t,r){const i={};return r&&(i.tag=r),new Wn(e,t,i)}getHeader(e){const t=this.headers[pi(e)];if(t){if(t[0])return t[0]}else{const r=new RegExp("^\\s*"+e+"\\s*:","i");for(const i of this.extraHeaders)if(r.test(i))return i.substring(i.indexOf(":")+1).trim()}}getHeaders(e){const t=[],r=this.headers[pi(e)];if(r)for(const i of r)t.push(i);else{const i=new RegExp("^\\s*"+e+"\\s*:","i");for(const s of this.extraHeaders)i.test(s)&&t.push(s.substring(s.indexOf(":")+1).trim())}return t}hasHeader(e){if(this.headers[pi(e)])return!0;{const t=new RegExp("^\\s*"+e+"\\s*:","i");for(const r of this.extraHeaders)if(t.test(r))return!0}return!1}setHeader(e,t){this.headers[pi(e)]=t instanceof Array?t:[t]}setViaHeader(e,t){this.options.hackViaTcp&&(t="TCP");let r="SIP/2.0/"+t;r+=" "+this.options.viaHost+";branch="+e,this.options.forceRport&&(r+=";rport"),this.setHeader("via",r),this.branch=e}toString(){let e="";e+=this.method+" "+this.ruri.toRaw()+` SIP/2.0\r
`;for(const t in this.headers)if(this.headers[t])for(const r of this.headers[t])e+=t+": "+r+`\r
`;for(const t of this.extraHeaders)e+=t.trim()+`\r
`;return e+="Supported: "+this.options.optionTags.join(", ")+`\r
`,e+="User-Agent: "+this.options.userAgentString+`\r
`,this.body?typeof this.body=="string"?(e+="Content-Length: "+Xu(this.body)+`\r
\r
`,e+=this.body):this.body.body&&this.body.contentType?(e+="Content-Type: "+this.body.contentType+`\r
`,e+="Content-Length: "+Xu(this.body.body)+`\r
\r
`,e+=this.body.body):e+=`Content-Length: 0\r
\r
`:e+=`Content-Length: 0\r
\r
`,e}}function WM(n){return n==="application/sdp"?"session":"render"}function cp(n){const e=typeof n=="string"?n:n.body,t=typeof n=="string"?"application/sdp":n.contentType;return{contentDisposition:WM(t),contentType:t,content:e}}function JM(n){return n&&typeof n.content=="string"&&typeof n.contentType=="string"&&n.contentDisposition===void 0?!0:typeof n.contentDisposition=="string"}function bu(n){let e,t,r;if(n instanceof ul&&n.body){const i=n.parseHeader("Content-Disposition");e=i?i.type:void 0,t=n.parseHeader("Content-Type"),r=n.body}if(n instanceof qs&&n.body){const i=n.parseHeader("Content-Disposition");e=i?i.type:void 0,t=n.parseHeader("Content-Type"),r=n.body}if(n instanceof Yo&&n.body)if(e=n.getHeader("Content-Disposition"),t=n.getHeader("Content-Type"),typeof n.body=="string"){if(!t)throw new Error("Header content type header does not equal body content type.");r=n.body}else{if(t&&t!==n.body.contentType)throw new Error("Header content type header does not equal body content type.");t=n.body.contentType,r=n.body.body}if(JM(n)&&(e=n.contentDisposition,t=n.contentType,r=n.content),!!r){if(t&&!e&&(e=WM(t)),!e)throw new Error("Content disposition undefined.");if(!t)throw new Error("Content type undefined.");return{contentDisposition:e,contentType:t,content:r}}}var Tr;(function(n){n.Initial="Initial",n.Early="Early",n.AckWait="AckWait",n.Confirmed="Confirmed",n.Terminated="Terminated"})(Tr=Tr||(Tr={}));var ge;(function(n){n.Initial="Initial",n.HaveLocalOffer="HaveLocalOffer",n.HaveRemoteOffer="HaveRemoteOffer",n.Stable="Stable",n.Closed="Closed"})(ge=ge||(ge={}));const $i=500,yQ=4e3,Gg=5e3,rn={T1:$i,T2:yQ,T4:Gg,TIMER_B:64*$i,TIMER_D:0*$i,TIMER_F:64*$i,TIMER_H:64*$i,TIMER_I:0*Gg,TIMER_J:0*$i,TIMER_K:0*Gg,TIMER_L:64*$i,TIMER_M:64*$i,TIMER_N:64*$i,PROVISIONAL_RESPONSE_INTERVAL:6e4};class Ms extends ga{constructor(e){super(e||"Transaction state error.")}}var ve;(function(n){n.ACK="ACK",n.BYE="BYE",n.CANCEL="CANCEL",n.INFO="INFO",n.INVITE="INVITE",n.MESSAGE="MESSAGE",n.NOTIFY="NOTIFY",n.OPTIONS="OPTIONS",n.REGISTER="REGISTER",n.UPDATE="UPDATE",n.SUBSCRIBE="SUBSCRIBE",n.PUBLISH="PUBLISH",n.REFER="REFER",n.PRACK="PRACK"})(ve=ve||(ve={}));const Ps=[ve.ACK,ve.BYE,ve.CANCEL,ve.INFO,ve.INVITE,ve.MESSAGE,ve.NOTIFY,ve.OPTIONS,ve.PRACK,ve.REFER,ve.REGISTER,ve.SUBSCRIBE];class KM{constructor(e){this.incomingMessageRequest=e}get request(){return this.incomingMessageRequest.message}accept(e){return this.incomingMessageRequest.accept(e),Promise.resolve()}reject(e){return this.incomingMessageRequest.reject(e),Promise.resolve()}}let X1=class{constructor(e){this.incomingNotifyRequest=e}get request(){return this.incomingNotifyRequest.message}accept(e){return this.incomingNotifyRequest.accept(e),Promise.resolve()}reject(e){return this.incomingNotifyRequest.reject(e),Promise.resolve()}};class vQ{constructor(e,t){this.incomingReferRequest=e,this.session=t}get referTo(){const e=this.incomingReferRequest.message.parseHeader("refer-to");if(!(e instanceof Wn))throw new Error("Failed to parse Refer-To header.");return e}get referredBy(){return this.incomingReferRequest.message.getHeader("referred-by")}get replaces(){const e=this.referTo.uri.getHeader("replaces");return e instanceof Array?e[0]:e}get request(){return this.incomingReferRequest.message}accept(e={statusCode:202}){return this.incomingReferRequest.accept(e),Promise.resolve()}reject(e){return this.incomingReferRequest.reject(e),Promise.resolve()}makeInviter(e){if(this.inviter)return this.inviter;const t=this.referTo.uri.clone();t.clearHeaders(),e=e||{};const r=(e.extraHeaders||[]).slice(),i=this.replaces;i&&r.push("Replaces: "+decodeURIComponent(i));const s=this.referredBy;return s&&r.push("Referred-By: "+s),e.extraHeaders=r,this.inviter=this.session.userAgent._makeInviter(t,e),this.inviter._referred=this.session,this.session._referral=this.inviter,this.inviter}}var X;(function(n){n.Initial="Initial",n.Establishing="Establishing",n.Established="Established",n.Terminating="Terminating",n.Terminated="Terminated"})(X=X||(X={}));class Zu{constructor(e,t={}){this.pendingReinvite=!1,this.pendingReinviteAck=!1,this._state=X.Initial,this.delegate=t.delegate,this._stateEventEmitter=new Yu,this._userAgent=e}dispose(){switch(this.logger.log(`Session ${this.id} in state ${this._state} is being disposed`),delete this.userAgent._sessions[this.id],this._sessionDescriptionHandler&&this._sessionDescriptionHandler.close(),this.state){case X.Initial:break;case X.Establishing:break;case X.Established:return new Promise(e=>{this._bye({onAccept:()=>e(),onRedirect:()=>e(),onReject:()=>e()})});case X.Terminating:break;case X.Terminated:break;default:throw new Error("Unknown state.")}return Promise.resolve()}get assertedIdentity(){return this._assertedIdentity}get dialog(){return this._dialog}get id(){return this._id}get replacee(){return this._replacee}get sessionDescriptionHandler(){return this._sessionDescriptionHandler}get sessionDescriptionHandlerFactory(){return this.userAgent.configuration.sessionDescriptionHandlerFactory}get sessionDescriptionHandlerModifiers(){return this._sessionDescriptionHandlerModifiers||[]}set sessionDescriptionHandlerModifiers(e){this._sessionDescriptionHandlerModifiers=e.slice()}get sessionDescriptionHandlerOptions(){return this._sessionDescriptionHandlerOptions||{}}set sessionDescriptionHandlerOptions(e){this._sessionDescriptionHandlerOptions=Object.assign({},e)}get sessionDescriptionHandlerModifiersReInvite(){return this._sessionDescriptionHandlerModifiersReInvite||[]}set sessionDescriptionHandlerModifiersReInvite(e){this._sessionDescriptionHandlerModifiersReInvite=e.slice()}get sessionDescriptionHandlerOptionsReInvite(){return this._sessionDescriptionHandlerOptionsReInvite||{}}set sessionDescriptionHandlerOptionsReInvite(e){this._sessionDescriptionHandlerOptionsReInvite=Object.assign({},e)}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get userAgent(){return this._userAgent}bye(e={}){let t="Session.bye() may only be called if established session.";switch(this.state){case X.Initial:typeof this.cancel=="function"?(t+=" However Inviter.invite() has not yet been called.",t+=" Perhaps you should have called Inviter.cancel()?"):typeof this.reject=="function"&&(t+=" However Invitation.accept() has not yet been called.",t+=" Perhaps you should have called Invitation.reject()?");break;case X.Establishing:typeof this.cancel=="function"?(t+=" However a dialog does not yet exist.",t+=" Perhaps you should have called Inviter.cancel()?"):typeof this.reject=="function"&&(t+=" However Invitation.accept() has not yet been called (or not yet resolved).",t+=" Perhaps you should have called Invitation.reject()?");break;case X.Established:{const r=e.requestDelegate,i=this.copyRequestOptions(e.requestOptions);return this._bye(r,i)}case X.Terminating:t+=" However this session is already terminating.",typeof this.cancel=="function"?t+=" Perhaps you have already called Inviter.cancel()?":typeof this.reject=="function"&&(t+=" Perhaps you have already called Session.bye()?");break;case X.Terminated:t+=" However this session is already terminated.";break;default:throw new Error("Unknown state")}return this.logger.error(t),Promise.reject(new Error(`Invalid session state ${this.state}`))}info(e={}){if(this.state!==X.Established)return this.logger.error("Session.info() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));const t=e.requestDelegate,r=this.copyRequestOptions(e.requestOptions);return this._info(t,r)}invite(e={}){if(this.logger.log("Session.invite"),this.state!==X.Established)return Promise.reject(new Error(`Invalid session state ${this.state}`));if(this.pendingReinvite)return Promise.reject(new Y1("Reinvite in progress. Please wait until complete, then try again."));this.pendingReinvite=!0,e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiersReInvite=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptionsReInvite=e.sessionDescriptionHandlerOptions);const t={onAccept:s=>{const o=bu(s.message);if(!o){this.logger.error("Received 2xx response to re-INVITE without a session description"),this.ackAndBye(s,400,"Missing session description"),this.stateTransition(X.Terminated),this.pendingReinvite=!1;return}if(e.withoutSdp){const a={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.setOfferAndGetAnswer(o,a).then(l=>{s.ack({body:l})}).catch(l=>{this.logger.error("Failed to handle offer in 2xx response to re-INVITE"),this.logger.error(l.message),this.state===X.Terminated?s.ack():(this.ackAndBye(s,488,"Bad Media Description"),this.stateTransition(X.Terminated))}).then(()=>{this.pendingReinvite=!1,e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(s)})}else{const a={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.setAnswer(o,a).then(()=>{s.ack()}).catch(l=>{this.logger.error("Failed to handle answer in 2xx response to re-INVITE"),this.logger.error(l.message),this.state!==X.Terminated?(this.ackAndBye(s,488,"Bad Media Description"),this.stateTransition(X.Terminated)):s.ack()}).then(()=>{this.pendingReinvite=!1,e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(s)})}},onProgress:s=>{},onRedirect:s=>{},onReject:s=>{this.logger.warn("Received a non-2xx response to re-INVITE"),this.pendingReinvite=!1,e.withoutSdp?e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(s):this.rollbackOffer().catch(o=>{if(this.logger.error("Failed to rollback offer on non-2xx response to re-INVITE"),this.logger.error(o.message),this.state!==X.Terminated){if(!this.dialog)throw new Error("Dialog undefined.");const a=[];a.push("Reason: "+this.getReasonHeaderValue(500,"Internal Server Error")),this.dialog.bye(void 0,{extraHeaders:a}),this.stateTransition(X.Terminated)}}).then(()=>{e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(s)})},onTrying:s=>{}},r=e.requestOptions||{};if(r.extraHeaders=(r.extraHeaders||[]).slice(),r.extraHeaders.push("Allow: "+Ps.toString()),r.extraHeaders.push("Contact: "+this._contact),e.withoutSdp){if(!this.dialog)throw this.pendingReinvite=!1,new Error("Dialog undefined.");return Promise.resolve(this.dialog.invite(t,r))}const i={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};return this.getOffer(i).then(s=>{if(!this.dialog)throw this.pendingReinvite=!1,new Error("Dialog undefined.");return r.body=s,this.dialog.invite(t,r)}).catch(s=>{throw this.logger.error(s.message),this.logger.error("Failed to send re-INVITE"),this.pendingReinvite=!1,s})}message(e={}){if(this.state!==X.Established)return this.logger.error("Session.message() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));const t=e.requestDelegate,r=this.copyRequestOptions(e.requestOptions);return this._message(t,r)}refer(e,t={}){if(this.state!==X.Established)return this.logger.error("Session.refer() may only be called if established session."),Promise.reject(new Error(`Invalid session state ${this.state}`));if(e instanceof Zu&&!e.dialog)return this.logger.error("Session.refer() may only be called with session which is established. You are perhaps attempting to attended transfer to a target for which there is not dialog yet established. Perhaps you are attempting a 'semi-attended' tansfer? Regardless, this is not supported. The recommended approached is to check to see if the target Session is in the Established state before calling refer(); if the state is not Established you may proceed by falling back using a URI as the target (blind transfer)."),Promise.reject(new Error(`Invalid session state ${this.state}`));const r=t.requestDelegate,i=this.copyRequestOptions(t.requestOptions);return i.extraHeaders=i.extraHeaders?i.extraHeaders.concat(this.referExtraHeaders(this.referToString(e))):this.referExtraHeaders(this.referToString(e)),this._refer(t.onNotify,r,i)}_bye(e,t){if(!this.dialog)return Promise.reject(new Error("Session dialog undefined."));const r=this.dialog;switch(r.sessionState){case Tr.Initial:throw new Error(`Invalid dialog state ${r.sessionState}`);case Tr.Early:throw new Error(`Invalid dialog state ${r.sessionState}`);case Tr.AckWait:return this.stateTransition(X.Terminating),new Promise(i=>{r.delegate={onAck:()=>{const s=r.bye(e,t);return this.stateTransition(X.Terminated),i(s),Promise.resolve()},onAckTimeout:()=>{const s=r.bye(e,t);this.stateTransition(X.Terminated),i(s)}}});case Tr.Confirmed:{const i=r.bye(e,t);return this.stateTransition(X.Terminated),Promise.resolve(i)}case Tr.Terminated:throw new Error(`Invalid dialog state ${r.sessionState}`);default:throw new Error("Unrecognized state.")}}_info(e,t){return this.dialog?Promise.resolve(this.dialog.info(e,t)):Promise.reject(new Error("Session dialog undefined."))}_message(e,t){return this.dialog?Promise.resolve(this.dialog.message(e,t)):Promise.reject(new Error("Session dialog undefined."))}_refer(e,t,r){return this.dialog?(this.onNotify=e,Promise.resolve(this.dialog.refer(t,r))):Promise.reject(new Error("Session dialog undefined."))}ackAndBye(e,t,r){e.ack();const i=[];t&&i.push("Reason: "+this.getReasonHeaderValue(t,r)),e.session.bye(void 0,{extraHeaders:i})}onAckRequest(e){if(this.logger.log("Session.onAckRequest"),this.state!==X.Established&&this.state!==X.Terminating)return this.logger.error(`ACK received while in state ${this.state}, dropping request`),Promise.resolve();const t=this.dialog;if(!t)throw new Error("Dialog undefined.");const r={sessionDescriptionHandlerOptions:this.pendingReinviteAck?this.sessionDescriptionHandlerOptionsReInvite:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.pendingReinviteAck?this._sessionDescriptionHandlerModifiersReInvite:this._sessionDescriptionHandlerModifiers};if(this.delegate&&this.delegate.onAck){const i=new uQ(e);this.delegate.onAck(i)}switch(this.pendingReinviteAck=!1,t.signalingState){case ge.Initial:{this.logger.error(`Invalid signaling state ${t.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return t.bye(void 0,{extraHeaders:i}),this.stateTransition(X.Terminated),Promise.resolve()}case ge.Stable:{const i=bu(e.message);return i?i.contentDisposition==="render"?(this._renderbody=i.content,this._rendertype=i.contentType,Promise.resolve()):i.contentDisposition!=="session"?Promise.resolve():this.setAnswer(i,r).catch(s=>{this.logger.error(s.message);const o=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];t.bye(void 0,{extraHeaders:o}),this.stateTransition(X.Terminated)}):Promise.resolve()}case ge.HaveLocalOffer:{this.logger.error(`Invalid signaling state ${t.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return t.bye(void 0,{extraHeaders:i}),this.stateTransition(X.Terminated),Promise.resolve()}case ge.HaveRemoteOffer:{this.logger.error(`Invalid signaling state ${t.signalingState}.`);const i=["Reason: "+this.getReasonHeaderValue(488,"Bad Media Description")];return t.bye(void 0,{extraHeaders:i}),this.stateTransition(X.Terminated),Promise.resolve()}case ge.Closed:throw new Error(`Invalid signaling state ${t.signalingState}.`);default:throw new Error(`Invalid signaling state ${t.signalingState}.`)}}onByeRequest(e){if(this.logger.log("Session.onByeRequest"),this.state!==X.Established){this.logger.error(`BYE received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onBye){const t=new dQ(e);this.delegate.onBye(t)}else e.accept();this.stateTransition(X.Terminated)}onInfoRequest(e){if(this.logger.log("Session.onInfoRequest"),this.state!==X.Established){this.logger.error(`INFO received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onInfo){const t=new hQ(e);this.delegate.onInfo(t)}else e.accept()}onInviteRequest(e){if(this.logger.log("Session.onInviteRequest"),this.state!==X.Established){this.logger.error(`INVITE received while in state ${this.state}, dropping request`);return}this.pendingReinviteAck=!0;const t=["Contact: "+this._contact];if(e.message.hasHeader("P-Asserted-Identity")){const i=e.message.getHeader("P-Asserted-Identity");if(!i)throw new Error("Header undefined.");this._assertedIdentity=Gt.nameAddrHeaderParse(i)}const r={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptionsReInvite,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiersReInvite};this.generateResponseOfferAnswerInDialog(r).then(i=>{const s=e.accept({statusCode:200,extraHeaders:t,body:i});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,s.message,200)}).catch(i=>{if(this.logger.error(i.message),this.logger.error("Failed to handle to re-INVITE request"),!this.dialog)throw new Error("Dialog undefined.");if(this.logger.error(this.dialog.signalingState),this.dialog.signalingState===ge.Stable){const s=e.reject({statusCode:488});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,s.message,488);return}this.rollbackOffer().then(()=>{const s=e.reject({statusCode:488});this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,s.message,488)}).catch(s=>{this.logger.error(s.message),this.logger.error("Failed to rollback offer on re-INVITE request");const o=e.reject({statusCode:488});if(this.state!==X.Terminated){if(!this.dialog)throw new Error("Dialog undefined.");const a=[];a.push("Reason: "+this.getReasonHeaderValue(500,"Internal Server Error")),this.dialog.bye(void 0,{extraHeaders:a}),this.stateTransition(X.Terminated)}this.delegate&&this.delegate.onInvite&&this.delegate.onInvite(e.message,o.message,488)})})}onMessageRequest(e){if(this.logger.log("Session.onMessageRequest"),this.state!==X.Established){this.logger.error(`MESSAGE received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onMessage){const t=new KM(e);this.delegate.onMessage(t)}else e.accept()}onNotifyRequest(e){if(this.logger.log("Session.onNotifyRequest"),this.state!==X.Established){this.logger.error(`NOTIFY received while in state ${this.state}, dropping request`);return}if(this.onNotify){const t=new X1(e);this.onNotify(t);return}if(this.delegate&&this.delegate.onNotify){const t=new X1(e);this.delegate.onNotify(t)}else e.accept()}onPrackRequest(e){if(this.logger.log("Session.onPrackRequest"),this.state!==X.Established){this.logger.error(`PRACK received while in state ${this.state}, dropping request`);return}throw new Error("Unimplemented.")}onReferRequest(e){if(this.logger.log("Session.onReferRequest"),this.state!==X.Established){this.logger.error(`REFER received while in state ${this.state}, dropping request`);return}if(!e.message.hasHeader("refer-to")){this.logger.warn("Invalid REFER packet. A refer-to header is required. Rejecting."),e.reject();return}const t=new vQ(e,this);this.delegate&&this.delegate.onRefer?this.delegate.onRefer(t):(this.logger.log("No delegate available to handle REFER, automatically accepting and following."),t.accept().then(()=>t.makeInviter(this._referralInviterOptions).invite()).catch(r=>{this.logger.error(r.message)}))}generateResponseOfferAnswer(e,t){if(this.dialog)return this.generateResponseOfferAnswerInDialog(t);const r=bu(e.message);return!r||r.contentDisposition!=="session"?this.getOffer(t):this.setOfferAndGetAnswer(r,t)}generateResponseOfferAnswerInDialog(e){if(!this.dialog)throw new Error("Dialog undefined.");switch(this.dialog.signalingState){case ge.Initial:return this.getOffer(e);case ge.HaveLocalOffer:return Promise.resolve(void 0);case ge.HaveRemoteOffer:if(!this.dialog.offer)throw new Error(`Session offer undefined in signaling state ${this.dialog.signalingState}.`);return this.setOfferAndGetAnswer(this.dialog.offer,e);case ge.Stable:return this.state!==X.Established?Promise.resolve(void 0):this.getOffer(e);case ge.Closed:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);default:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`)}}getOffer(e){const t=this.setupSessionDescriptionHandler(),r=e.sessionDescriptionHandlerOptions,i=e.sessionDescriptionHandlerModifiers;try{return t.getDescription(r,i).then(s=>cp(s)).catch(s=>{this.logger.error("Session.getOffer: SDH getDescription rejected...");const o=s instanceof Error?s:new Error("Session.getOffer unknown error.");throw this.logger.error(o.message),o})}catch(s){this.logger.error("Session.getOffer: SDH getDescription threw...");const o=s instanceof Error?s:new Error(s);return this.logger.error(o.message),Promise.reject(o)}}rollbackOffer(){const e=this.setupSessionDescriptionHandler();if(e.rollbackDescription===void 0)return Promise.resolve();try{return e.rollbackDescription().catch(t=>{this.logger.error("Session.rollbackOffer: SDH rollbackDescription rejected...");const r=t instanceof Error?t:new Error("Session.rollbackOffer unknown error.");throw this.logger.error(r.message),r})}catch(t){this.logger.error("Session.rollbackOffer: SDH rollbackDescription threw...");const r=t instanceof Error?t:new Error(t);return this.logger.error(r.message),Promise.reject(r)}}setAnswer(e,t){const r=this.setupSessionDescriptionHandler(),i=t.sessionDescriptionHandlerOptions,s=t.sessionDescriptionHandlerModifiers;try{if(!r.hasDescription(e.contentType))return Promise.reject(new G1)}catch(o){this.logger.error("Session.setAnswer: SDH hasDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}try{return r.setDescription(e.content,i,s).catch(o=>{this.logger.error("Session.setAnswer: SDH setDescription rejected...");const a=o instanceof Error?o:new Error("Session.setAnswer unknown error.");throw this.logger.error(a.message),a})}catch(o){this.logger.error("Session.setAnswer: SDH setDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}}setOfferAndGetAnswer(e,t){const r=this.setupSessionDescriptionHandler(),i=t.sessionDescriptionHandlerOptions,s=t.sessionDescriptionHandlerModifiers;try{if(!r.hasDescription(e.contentType))return Promise.reject(new G1)}catch(o){this.logger.error("Session.setOfferAndGetAnswer: SDH hasDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}try{return r.setDescription(e.content,i,s).then(()=>r.getDescription(i,s)).then(o=>cp(o)).catch(o=>{this.logger.error("Session.setOfferAndGetAnswer: SDH setDescription or getDescription rejected...");const a=o instanceof Error?o:new Error("Session.setOfferAndGetAnswer unknown error.");throw this.logger.error(a.message),a})}catch(o){this.logger.error("Session.setOfferAndGetAnswer: SDH setDescription or getDescription threw...");const a=o instanceof Error?o:new Error(o);return this.logger.error(a.message),Promise.reject(a)}}setSessionDescriptionHandler(e){if(this._sessionDescriptionHandler)throw new Error("Session description handler defined.");this._sessionDescriptionHandler=e}setupSessionDescriptionHandler(){var e;return this._sessionDescriptionHandler?this._sessionDescriptionHandler:(this._sessionDescriptionHandler=this.sessionDescriptionHandlerFactory(this,this.userAgent.configuration.sessionDescriptionHandlerFactoryOptions),!((e=this.delegate)===null||e===void 0)&&e.onSessionDescriptionHandler&&this.delegate.onSessionDescriptionHandler(this._sessionDescriptionHandler,!1),this._sessionDescriptionHandler)}stateTransition(e){const t=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case X.Initial:e!==X.Establishing&&e!==X.Established&&e!==X.Terminating&&e!==X.Terminated&&t();break;case X.Establishing:e!==X.Established&&e!==X.Terminating&&e!==X.Terminated&&t();break;case X.Established:e!==X.Terminating&&e!==X.Terminated&&t();break;case X.Terminating:e!==X.Terminated&&t();break;case X.Terminated:t();break;default:throw new Error("Unrecognized state.")}this._state=e,this.logger.log(`Session ${this.id} transitioned to state ${this._state}`),this._stateEventEmitter.emit(this._state),e===X.Terminated&&this.dispose()}copyRequestOptions(e={}){const t=e.extraHeaders?e.extraHeaders.slice():void 0,r=e.body?{contentDisposition:e.body.contentDisposition||"render",contentType:e.body.contentType||"text/plain",content:e.body.content||""}:void 0;return{extraHeaders:t,body:r}}getReasonHeaderValue(e,t){const r=e;let i=lm(e);return!i&&t&&(i=t),"SIP;cause="+r+';text="'+i+'"'}referExtraHeaders(e){const t=[];return t.push("Referred-By: <"+this.userAgent.configuration.uri+">"),t.push("Contact: "+this._contact),t.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),t.push("Refer-To: "+e),t}referToString(e){let t;if(e instanceof wi)t=e.toString();else{if(!e.dialog)throw new Error("Dialog undefined.");const r=e.remoteIdentity.friendlyName,i=e.dialog.remoteTarget.toString(),s=e.dialog.callId,o=e.dialog.remoteTag,a=e.dialog.localTag,l=encodeURIComponent(`${s};to-tag=${o};from-tag=${a}`);t=`"${r}" <${i}?Replaces=${l}>`}return t}}var Kr;(function(n){n.Required="Required",n.Supported="Supported",n.Unsupported="Unsupported"})(Kr=Kr||(Kr={}));const bQ={"100rel":!0,199:!0,answermode:!0,"early-session":!0,eventlist:!0,explicitsub:!0,"from-change":!0,"geolocation-http":!0,"geolocation-sip":!0,gin:!0,gruu:!0,histinfo:!0,ice:!0,join:!0,"multiple-refer":!0,norefersub:!0,nosub:!0,outbound:!0,path:!0,policy:!0,precondition:!0,pref:!0,privacy:!0,"recipient-list-invite":!0,"recipient-list-message":!0,"recipient-list-subscribe":!0,replaces:!0,"resource-priority":!0,"sdp-anat":!0,"sec-agree":!0,tdialog:!0,timer:!0,uui:!0};class wQ extends Zu{constructor(e,t){super(e),this.incomingInviteRequest=t,this.disposed=!1,this.expiresTimer=void 0,this.isCanceled=!1,this.rel100="none",this.rseq=Math.floor(Math.random()*1e4),this.userNoAnswerTimer=void 0,this.waitingForPrack=!1,this.logger=e.getLogger("sip.Invitation");const r=this.incomingInviteRequest.message,i=r.getHeader("require");i&&i.toLowerCase().includes("100rel")&&(this.rel100="required");const s=r.getHeader("supported");if(s&&s.toLowerCase().includes("100rel")&&(this.rel100="supported"),r.toTag=t.toTag,typeof r.toTag!="string")throw new TypeError("toTag should have been a string.");if(this.userNoAnswerTimer=setTimeout(()=>{t.reject({statusCode:480}),this.stateTransition(X.Terminated)},this.userAgent.configuration.noAnswerTimeout?this.userAgent.configuration.noAnswerTimeout*1e3:6e4),r.hasHeader("expires")){const l=Number(r.getHeader("expires")||0)*1e3;this.expiresTimer=setTimeout(()=>{this.state===X.Initial&&(t.reject({statusCode:487}),this.stateTransition(X.Terminated))},l)}const o=this.request.getHeader("P-Asserted-Identity");o&&(this._assertedIdentity=Gt.nameAddrHeaderParse(o)),this._contact=this.userAgent.contact.toString();const a=r.parseHeader("Content-Disposition");a&&a.type==="render"&&(this._renderbody=r.body,this._rendertype=r.getHeader("Content-Type")),this._id=r.callId+r.fromTag,this.userAgent._sessions[this._id]=this}dispose(){if(this.disposed)return Promise.resolve();switch(this.disposed=!0,this.expiresTimer&&(clearTimeout(this.expiresTimer),this.expiresTimer=void 0),this.userNoAnswerTimer&&(clearTimeout(this.userNoAnswerTimer),this.userNoAnswerTimer=void 0),this.prackNeverArrived(),this.state){case X.Initial:return this.reject().then(()=>super.dispose());case X.Establishing:return this.reject().then(()=>super.dispose());case X.Established:return super.dispose();case X.Terminating:return super.dispose();case X.Terminated:return super.dispose();default:throw new Error("Unknown state.")}}get autoSendAnInitialProvisionalResponse(){return this.rel100!=="required"&&this.userAgent.configuration.sendInitialProvisionalResponse}get body(){return this.incomingInviteRequest.message.body}get localIdentity(){return this.request.to}get remoteIdentity(){return this.request.from}get request(){return this.incomingInviteRequest.message}accept(e={}){if(this.logger.log("Invitation.accept"),this.state!==X.Initial){const t=new Error(`Invalid session state ${this.state}`);return this.logger.error(t.message),Promise.reject(t)}return e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),this.stateTransition(X.Establishing),this.sendAccept(e).then(({message:t,session:r})=>{r.delegate={onAck:i=>this.onAckRequest(i),onAckTimeout:()=>this.onAckTimeout(),onBye:i=>this.onByeRequest(i),onInfo:i=>this.onInfoRequest(i),onInvite:i=>this.onInviteRequest(i),onMessage:i=>this.onMessageRequest(i),onNotify:i=>this.onNotifyRequest(i),onPrack:i=>this.onPrackRequest(i),onRefer:i=>this.onReferRequest(i)},this._dialog=r,this.stateTransition(X.Established),this._replacee&&this._replacee._bye()}).catch(t=>this.handleResponseError(t))}progress(e={}){if(this.logger.log("Invitation.progress"),this.state!==X.Initial){const r=new Error(`Invalid session state ${this.state}`);return this.logger.error(r.message),Promise.reject(r)}const t=e.statusCode||180;if(t<100||t>199)throw new TypeError("Invalid statusCode: "+t);return e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),this.waitingForPrack?(this.logger.warn("Unexpected call for progress while waiting for prack, ignoring"),Promise.resolve()):e.statusCode===100?this.sendProgressTrying().then(()=>{}).catch(r=>this.handleResponseError(r)):this.rel100!=="required"&&!(this.rel100==="supported"&&e.rel100)&&!(this.rel100==="supported"&&this.userAgent.configuration.sipExtension100rel===Kr.Required)?this.sendProgress(e).then(()=>{}).catch(r=>this.handleResponseError(r)):this.sendProgressReliableWaitForPrack(e).then(()=>{}).catch(r=>this.handleResponseError(r))}reject(e={}){if(this.logger.log("Invitation.reject"),this.state!==X.Initial&&this.state!==X.Establishing){const o=new Error(`Invalid session state ${this.state}`);return this.logger.error(o.message),Promise.reject(o)}const t=e.statusCode||480,r=e.reasonPhrase?e.reasonPhrase:lm(t),i=e.extraHeaders||[];if(t<300||t>699)throw new TypeError("Invalid statusCode: "+t);const s=e.body?cp(e.body):void 0;return t<400?this.incomingInviteRequest.redirect([],{statusCode:t,reasonPhrase:r,extraHeaders:i,body:s}):this.incomingInviteRequest.reject({statusCode:t,reasonPhrase:r,extraHeaders:i,body:s}),this.stateTransition(X.Terminated),Promise.resolve()}_onCancel(e){if(this.logger.log("Invitation._onCancel"),this.state!==X.Initial&&this.state!==X.Establishing){this.logger.error(`CANCEL received while in state ${this.state}, dropping request`);return}if(this.delegate&&this.delegate.onCancel){const t=new fQ(e);this.delegate.onCancel(t)}this.isCanceled=!0,this.incomingInviteRequest.reject({statusCode:487}),this.stateTransition(X.Terminated)}handlePrackOfferAnswer(e){if(!this.dialog)throw new Error("Dialog undefined.");const t=bu(e.message);if(!t||t.contentDisposition!=="session")return Promise.resolve(void 0);const r={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers};switch(this.dialog.signalingState){case ge.Initial:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);case ge.Stable:return this.setAnswer(t,r).then(()=>{});case ge.HaveLocalOffer:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);case ge.HaveRemoteOffer:return this.setOfferAndGetAnswer(t,r);case ge.Closed:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`);default:throw new Error(`Invalid signaling state ${this.dialog.signalingState}.`)}}handleResponseError(e){let t=480;if(e instanceof Error?this.logger.error(e.message):this.logger.error(e),e instanceof G1?(this.logger.error("A session description handler occurred while sending response (content type unsupported"),t=415):e instanceof cQ?this.logger.error("A session description handler occurred while sending response"):e instanceof Jg?this.logger.error("Session ended before response could be formulated and sent (while waiting for PRACK)"):e instanceof Ms&&this.logger.error("Session changed state before response could be formulated and sent"),this.state===X.Initial||this.state===X.Establishing)try{this.incomingInviteRequest.reject({statusCode:t}),this.stateTransition(X.Terminated)}catch(r){throw this.logger.error("An error occurred attempting to reject the request while handling another error"),r}if(this.isCanceled){this.logger.warn("An error occurred while attempting to formulate and send a response to an incoming INVITE. However a CANCEL was received and processed while doing so which can (and often does) result in errors occurring as the session terminates in the meantime. Said error is being ignored.");return}throw e}onAckTimeout(){if(this.logger.log("Invitation.onAckTimeout"),!this.dialog)throw new Error("Dialog undefined.");this.logger.log("No ACK received for an extended period of time, terminating session"),this.dialog.bye(),this.stateTransition(X.Terminated)}sendAccept(e={}){const t={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.extraHeaders||[];return this.waitingForPrack?this.waitForArrivalOfPrack().then(()=>clearTimeout(this.userNoAnswerTimer)).then(()=>this.generateResponseOfferAnswer(this.incomingInviteRequest,t)).then(i=>this.incomingInviteRequest.accept({statusCode:200,body:i,extraHeaders:r})):(clearTimeout(this.userNoAnswerTimer),this.generateResponseOfferAnswer(this.incomingInviteRequest,t).then(i=>this.incomingInviteRequest.accept({statusCode:200,body:i,extraHeaders:r})))}sendProgress(e={}){const t=e.statusCode||180,r=e.reasonPhrase,i=(e.extraHeaders||[]).slice(),s=e.body?cp(e.body):void 0;if(t===183&&!s)return this.sendProgressWithSDP(e);try{const o=this.incomingInviteRequest.progress({statusCode:t,reasonPhrase:r,extraHeaders:i,body:s});return this._dialog=o.session,Promise.resolve(o)}catch(o){return Promise.reject(o)}}sendProgressWithSDP(e={}){const t={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.statusCode||183,i=e.reasonPhrase,s=(e.extraHeaders||[]).slice();return this.generateResponseOfferAnswer(this.incomingInviteRequest,t).then(o=>this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:s,body:o})).then(o=>(this._dialog=o.session,o))}sendProgressReliable(e={}){return e.extraHeaders=(e.extraHeaders||[]).slice(),e.extraHeaders.push("Require: 100rel"),e.extraHeaders.push("RSeq: "+Math.floor(Math.random()*1e4)),this.sendProgressWithSDP(e)}sendProgressReliableWaitForPrack(e={}){const t={sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions,sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers},r=e.statusCode||183,i=e.reasonPhrase,s=(e.extraHeaders||[]).slice();s.push("Require: 100rel"),s.push("RSeq: "+this.rseq++);let o;return new Promise((a,l)=>{this.waitingForPrack=!0,this.generateResponseOfferAnswer(this.incomingInviteRequest,t).then(c=>(o=c,this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:s,body:o}))).then(c=>{this._dialog=c.session;let u,d;c.session.delegate={onPrack:b=>{u=b,clearTimeout(p),clearTimeout(x),this.waitingForPrack&&(this.waitingForPrack=!1,this.handlePrackOfferAnswer(u).then(_=>{try{d=u.accept({statusCode:200,body:_}),this.prackArrived(),a({prackRequest:u,prackResponse:d,progressResponse:c})}catch(M){l(M)}}).catch(_=>l(_)))}};const p=setTimeout(()=>{this.waitingForPrack&&(this.waitingForPrack=!1,this.logger.warn("No PRACK received, rejecting INVITE."),clearTimeout(x),this.reject({statusCode:504}).then(()=>l(new Jg)).catch(b=>l(b)))},rn.T1*64),m=()=>{try{this.incomingInviteRequest.progress({statusCode:r,reasonPhrase:i,extraHeaders:s,body:o})}catch(b){this.waitingForPrack=!1,l(b);return}x=setTimeout(m,v*=2)};let v=rn.T1,x=setTimeout(m,v)}).catch(c=>{this.waitingForPrack=!1,l(c)})})}sendProgressTrying(){try{const e=this.incomingInviteRequest.trying();return Promise.resolve(e)}catch(e){return Promise.reject(e)}}waitForArrivalOfPrack(){if(this.waitingForPrackPromise)throw new Error("Already waiting for PRACK");return this.waitingForPrackPromise=new Promise((e,t)=>{this.waitingForPrackResolve=e,this.waitingForPrackReject=t}),this.waitingForPrackPromise}prackArrived(){this.waitingForPrackResolve&&this.waitingForPrackResolve(),this.waitingForPrackPromise=void 0,this.waitingForPrackResolve=void 0,this.waitingForPrackReject=void 0}prackNeverArrived(){this.waitingForPrackReject&&this.waitingForPrackReject(new Jg),this.waitingForPrackPromise=void 0,this.waitingForPrackResolve=void 0,this.waitingForPrackReject=void 0}}class GM extends Zu{constructor(e,t,r={}){super(e,r),this.disposed=!1,this.earlyMedia=!1,this.earlyMediaSessionDescriptionHandlers=new Map,this.isCanceled=!1,this.inviteWithoutSdp=!1,this.logger=e.getLogger("sip.Inviter"),this.earlyMedia=r.earlyMedia!==void 0?r.earlyMedia:this.earlyMedia,this.fromTag=cm(),this.inviteWithoutSdp=r.inviteWithoutSdp!==void 0?r.inviteWithoutSdp:this.inviteWithoutSdp;const i=Object.assign({},r);i.params=Object.assign({},r.params);const s=r.anonymous||!1,o=e.contact.toString({anonymous:s,outbound:s?!e.contact.tempGruu:!e.contact.pubGruu});s&&e.configuration.uri&&(i.params.fromDisplayName="Anonymous",i.params.fromUri="sip:anonymous@anonymous.invalid");let a=e.userAgentCore.configuration.aor;if(i.params.fromUri&&(a=typeof i.params.fromUri=="string"?Gt.URIParse(i.params.fromUri):i.params.fromUri),!a)throw new TypeError("Invalid from URI: "+i.params.fromUri);let l=t;if(i.params.toUri&&(l=typeof i.params.toUri=="string"?Gt.URIParse(i.params.toUri):i.params.toUri),!l)throw new TypeError("Invalid to URI: "+i.params.toUri);const c=Object.assign({},i.params);c.fromTag=this.fromTag;const u=(i.extraHeaders||[]).slice();s&&e.configuration.uri&&(u.push("P-Preferred-Identity: "+e.configuration.uri.toString()),u.push("Privacy: id")),u.push("Contact: "+o),u.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),e.configuration.sipExtension100rel===Kr.Required&&u.push("Require: 100rel"),e.configuration.sipExtensionReplaces===Kr.Required&&u.push("Require: replaces"),i.extraHeaders=u;const d=void 0;this.outgoingRequestMessage=e.userAgentCore.makeOutgoingRequestMessage(ve.INVITE,t,a,l,c,u,d),this._contact=o,this._referralInviterOptions=i,this._renderbody=r.renderbody,this._rendertype=r.rendertype,r.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=r.sessionDescriptionHandlerModifiers),r.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=r.sessionDescriptionHandlerOptions),r.sessionDescriptionHandlerModifiersReInvite&&(this.sessionDescriptionHandlerModifiersReInvite=r.sessionDescriptionHandlerModifiersReInvite),r.sessionDescriptionHandlerOptionsReInvite&&(this.sessionDescriptionHandlerOptionsReInvite=r.sessionDescriptionHandlerOptionsReInvite),this._id=this.outgoingRequestMessage.callId+this.fromTag,this.userAgent._sessions[this._id]=this}dispose(){if(this.disposed)return Promise.resolve();switch(this.disposed=!0,this.disposeEarlyMedia(),this.state){case X.Initial:return this.cancel().then(()=>super.dispose());case X.Establishing:return this.cancel().then(()=>super.dispose());case X.Established:return super.dispose();case X.Terminating:return super.dispose();case X.Terminated:return super.dispose();default:throw new Error("Unknown state.")}}get body(){return this.outgoingRequestMessage.body}get localIdentity(){return this.outgoingRequestMessage.from}get remoteIdentity(){return this.outgoingRequestMessage.to}get request(){return this.outgoingRequestMessage}cancel(e={}){if(this.logger.log("Inviter.cancel"),this.state!==X.Initial&&this.state!==X.Establishing){const r=new Error(`Invalid session state ${this.state}`);return this.logger.error(r.message),Promise.reject(r)}this.isCanceled=!0,this.stateTransition(X.Terminating);function t(r,i){if(r&&r<200||r>699)throw new TypeError("Invalid statusCode: "+r);if(r){const s=r,o=lm(r)||i;return"SIP;cause="+s+';text="'+o+'"'}}if(this.outgoingInviteRequest){let r;e.statusCode&&e.reasonPhrase&&(r=t(e.statusCode,e.reasonPhrase)),this.outgoingInviteRequest.cancel(r,e)}else this.logger.warn("Canceled session before INVITE was sent"),this.stateTransition(X.Terminated);return Promise.resolve()}invite(e={}){if(this.logger.log("Inviter.invite"),this.state!==X.Initial)return super.invite(e);if(e.sessionDescriptionHandlerModifiers&&(this.sessionDescriptionHandlerModifiers=e.sessionDescriptionHandlerModifiers),e.sessionDescriptionHandlerOptions&&(this.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions),e.withoutSdp||this.inviteWithoutSdp)return this._renderbody&&this._rendertype&&(this.outgoingRequestMessage.body={contentType:this._rendertype,body:this._renderbody}),this.stateTransition(X.Establishing),Promise.resolve(this.sendInvite(e));const t={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.getOffer(t).then(r=>(this.outgoingRequestMessage.body={body:r.content,contentType:r.contentType},this.stateTransition(X.Establishing),this.sendInvite(e))).catch(r=>{throw this.logger.log(r.message),this.state!==X.Terminated&&this.stateTransition(X.Terminated),r})}sendInvite(e={}){return this.outgoingInviteRequest=this.userAgent.userAgentCore.invite(this.outgoingRequestMessage,{onAccept:t=>{if(this.dialog){this.logger.log("Additional confirmed dialog, sending ACK and BYE"),this.ackAndBye(t);return}if(this.isCanceled){this.logger.log("Canceled session accepted, sending ACK and BYE"),this.ackAndBye(t),this.stateTransition(X.Terminated);return}this.notifyReferer(t),this.onAccept(t).then(()=>{this.disposeEarlyMedia()}).catch(()=>{this.disposeEarlyMedia()}).then(()=>{e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(t)})},onProgress:t=>{this.isCanceled||(this.notifyReferer(t),this.onProgress(t).catch(()=>{this.disposeEarlyMedia()}).then(()=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(t)}))},onRedirect:t=>{this.notifyReferer(t),this.onRedirect(t),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(t)},onReject:t=>{this.notifyReferer(t),this.onReject(t),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(t)},onTrying:t=>{this.notifyReferer(t),this.onTrying(t),e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(t)}}),this.outgoingInviteRequest}disposeEarlyMedia(){this.earlyMediaSessionDescriptionHandlers.forEach(e=>{e.close()}),this.earlyMediaSessionDescriptionHandlers.clear()}notifyReferer(e){if(!this._referred)return;if(!(this._referred instanceof Zu))throw new Error("Referred session not instance of session");if(!this._referred.dialog)return;if(!e.message.statusCode)throw new Error("Status code undefined.");if(!e.message.reasonPhrase)throw new Error("Reason phrase undefined.");const t=e.message.statusCode,r=e.message.reasonPhrase,i=`SIP/2.0 ${t} ${r}`.trim(),s=this._referred.dialog.notify(void 0,{extraHeaders:["Event: refer","Subscription-State: terminated"],body:{contentDisposition:"render",contentType:"message/sipfrag",content:i}});s.delegate={onReject:()=>{this._referred=void 0}}}onAccept(e){if(this.logger.log("Inviter.onAccept"),this.state!==X.Establishing)return this.logger.error(`Accept received while in state ${this.state}, dropping response`),Promise.reject(new Error(`Invalid session state ${this.state}`));const t=e.message,r=e.session;switch(t.hasHeader("P-Asserted-Identity")&&(this._assertedIdentity=Gt.nameAddrHeaderParse(t.getHeader("P-Asserted-Identity"))),r.delegate={onAck:i=>this.onAckRequest(i),onBye:i=>this.onByeRequest(i),onInfo:i=>this.onInfoRequest(i),onInvite:i=>this.onInviteRequest(i),onMessage:i=>this.onMessageRequest(i),onNotify:i=>this.onNotifyRequest(i),onPrack:i=>this.onPrackRequest(i),onRefer:i=>this.onReferRequest(i)},this._dialog=r,r.signalingState){case ge.Initial:return this.logger.error("Received 2xx response to INVITE without a session description"),this.ackAndBye(e,400,"Missing session description"),this.stateTransition(X.Terminated),Promise.reject(new Error("Bad Media Description"));case ge.HaveLocalOffer:return this.logger.error("Received 2xx response to INVITE without a session description"),this.ackAndBye(e,400,"Missing session description"),this.stateTransition(X.Terminated),Promise.reject(new Error("Bad Media Description"));case ge.HaveRemoteOffer:{if(!this._dialog.offer)throw new Error(`Session offer undefined in signaling state ${this._dialog.signalingState}.`);const i={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setOfferAndGetAnswer(this._dialog.offer,i).then(s=>{e.ack({body:s}),this.stateTransition(X.Established)}).catch(s=>{throw this.ackAndBye(e,488,"Invalid session description"),this.stateTransition(X.Terminated),s})}case ge.Stable:{if(this.earlyMediaSessionDescriptionHandlers.size>0){const o=this.earlyMediaSessionDescriptionHandlers.get(r.id);if(!o)throw new Error("Session description handler undefined.");return this.setSessionDescriptionHandler(o),this.earlyMediaSessionDescriptionHandlers.delete(r.id),e.ack(),this.stateTransition(X.Established),Promise.resolve()}if(this.earlyMediaDialog){if(this.earlyMediaDialog!==r){this.earlyMedia&&this.logger.error("You have set the 'earlyMedia' option to 'true' which requires that your INVITE requests do not fork and yet this INVITE request did in fact fork. Consequentially and not surprisingly the end point which accepted the INVITE (confirmed dialog) does not match the end point with which early media has been setup (early dialog) and thus this session is unable to proceed. In accordance with the SIP specifications, the SIP servers your end point is connected to determine if an INVITE forks and the forking behavior of those servers cannot be controlled by this library. If you wish to use early media with this library you must configure those servers accordingly. Alternatively you may set the 'earlyMedia' to 'false' which will allow this library to function with any INVITE requests which do fork.");const o=new Error("Early media dialog does not equal confirmed dialog, terminating session");return this.logger.error(o.message),this.ackAndBye(e,488,"Not Acceptable Here"),this.stateTransition(X.Terminated),Promise.reject(o)}return e.ack(),this.stateTransition(X.Established),Promise.resolve()}const i=r.answer;if(!i)throw new Error("Answer is undefined.");const s={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setAnswer(i,s).then(()=>{let o;this._renderbody&&this._rendertype&&(o={body:{contentDisposition:"render",contentType:this._rendertype,content:this._renderbody}}),e.ack(o),this.stateTransition(X.Established)}).catch(o=>{throw this.logger.error(o.message),this.ackAndBye(e,488,"Not Acceptable Here"),this.stateTransition(X.Terminated),o})}case ge.Closed:return Promise.reject(new Error("Terminated."));default:throw new Error("Unknown session signaling state.")}}onProgress(e){var t;if(this.logger.log("Inviter.onProgress"),this.state!==X.Establishing)return this.logger.error(`Progress received while in state ${this.state}, dropping response`),Promise.reject(new Error(`Invalid session state ${this.state}`));if(!this.outgoingInviteRequest)throw new Error("Outgoing INVITE request undefined.");const r=e.message,i=e.session;r.hasHeader("P-Asserted-Identity")&&(this._assertedIdentity=Gt.nameAddrHeaderParse(r.getHeader("P-Asserted-Identity")));const s=r.getHeader("require"),o=r.getHeader("rseq"),l=!!(s&&s.includes("100rel")&&o?Number(o):void 0),c=[];switch(l&&c.push("RAck: "+r.getHeader("rseq")+" "+r.getHeader("cseq")),i.signalingState){case ge.Initial:return l&&(this.logger.warn("First reliable provisional response received MUST contain an offer when INVITE does not contain an offer."),e.prack({extraHeaders:c})),Promise.resolve();case ge.HaveLocalOffer:return l&&e.prack({extraHeaders:c}),Promise.resolve();case ge.HaveRemoteOffer:if(!l)return this.logger.warn("Non-reliable provisional response MUST NOT contain an initial offer, discarding response."),Promise.resolve();{const u=this.sessionDescriptionHandlerFactory(this,this.userAgent.configuration.sessionDescriptionHandlerFactoryOptions||{});return!((t=this.delegate)===null||t===void 0)&&t.onSessionDescriptionHandler&&this.delegate.onSessionDescriptionHandler(u,!0),this.earlyMediaSessionDescriptionHandlers.set(i.id,u),u.setDescription(r.body,this.sessionDescriptionHandlerOptions,this.sessionDescriptionHandlerModifiers).then(()=>u.getDescription(this.sessionDescriptionHandlerOptions,this.sessionDescriptionHandlerModifiers)).then(d=>{const f={contentDisposition:"session",contentType:d.contentType,content:d.body};e.prack({extraHeaders:c,body:f})}).catch(d=>{throw this.stateTransition(X.Terminated),d})}case ge.Stable:if(l&&e.prack({extraHeaders:c}),this.earlyMedia&&!this.earlyMediaDialog){this.earlyMediaDialog=i;const u=i.answer;if(!u)throw new Error("Answer is undefined.");const d={sessionDescriptionHandlerModifiers:this.sessionDescriptionHandlerModifiers,sessionDescriptionHandlerOptions:this.sessionDescriptionHandlerOptions};return this.setAnswer(u,d).catch(f=>{throw this.stateTransition(X.Terminated),f})}return Promise.resolve();case ge.Closed:return Promise.reject(new Error("Terminated."));default:throw new Error("Unknown session signaling state.")}}onRedirect(e){if(this.logger.log("Inviter.onRedirect"),this.state!==X.Establishing&&this.state!==X.Terminating){this.logger.error(`Redirect received while in state ${this.state}, dropping response`);return}this.stateTransition(X.Terminated)}onReject(e){if(this.logger.log("Inviter.onReject"),this.state!==X.Establishing&&this.state!==X.Terminating){this.logger.error(`Reject received while in state ${this.state}, dropping response`);return}this.stateTransition(X.Terminated)}onTrying(e){if(this.logger.log("Inviter.onTrying"),this.state!==X.Establishing){this.logger.error(`Trying received while in state ${this.state}, dropping response`);return}}}var pt;(function(n){n.Initial="Initial",n.Registered="Registered",n.Unregistered="Unregistered",n.Terminated="Terminated"})(pt=pt||(pt={}));class mi{constructor(e,t={}){this.disposed=!1,this._contacts=[],this._retryAfter=void 0,this._state=pt.Initial,this._waiting=!1,this._stateEventEmitter=new Yu,this._waitingEventEmitter=new Yu,this.userAgent=e;const r=e.configuration.uri.clone();if(r.user=void 0,this.options=Object.assign(Object.assign(Object.assign({},mi.defaultOptions()),{registrar:r}),mi.stripUndefinedProperties(t)),this.options.extraContactHeaderParams=(this.options.extraContactHeaderParams||[]).slice(),this.options.extraHeaders=(this.options.extraHeaders||[]).slice(),!this.options.registrar)throw new Error("Registrar undefined.");if(this.options.registrar=this.options.registrar.clone(),this.options.regId&&!this.options.instanceId?this.options.instanceId=this.userAgent.instanceId:!this.options.regId&&this.options.instanceId&&(this.options.regId=1),this.options.instanceId&&Gt.parse(this.options.instanceId,"uuid")===-1)throw new Error("Invalid instanceId.");if(this.options.regId&&this.options.regId<0)throw new Error("Invalid regId.");const i=this.options.registrar,s=this.options.params&&this.options.params.fromUri||e.userAgentCore.configuration.aor,o=this.options.params&&this.options.params.toUri||e.configuration.uri,a=this.options.params||{},l=(t.extraHeaders||[]).slice();if(this.request=e.userAgentCore.makeOutgoingRequestMessage(ve.REGISTER,i,s,o,a,l,void 0),this.expires=this.options.expires||mi.defaultExpires,this.expires<0)throw new Error("Invalid expires.");if(this.refreshFrequency=this.options.refreshFrequency||mi.defaultRefreshFrequency,this.refreshFrequency<50||this.refreshFrequency>99)throw new Error("Invalid refresh frequency. The value represents a percentage of the expiration time and should be between 50 and 99.");this.logger=e.getLogger("sip.Registerer"),this.options.logConfiguration&&(this.logger.log("Configuration:"),Object.keys(this.options).forEach(c=>{const u=this.options[c];switch(c){case"registrar":this.logger.log(" "+c+": "+u);break;default:this.logger.log(" "+c+": "+JSON.stringify(u))}})),this.id=this.request.callId+this.request.from.parameters.tag,this.userAgent._registerers[this.id]=this}static defaultOptions(){return{expires:mi.defaultExpires,extraContactHeaderParams:[],extraHeaders:[],logConfiguration:!0,instanceId:"",params:{},regId:0,registrar:new wi("sip","anonymous","anonymous.invalid"),refreshFrequency:mi.defaultRefreshFrequency}}static stripUndefinedProperties(e){return Object.keys(e).reduce((t,r)=>(e[r]!==void 0&&(t[r]=e[r]),t),{})}get contacts(){return this._contacts.slice()}get retryAfter(){return this._retryAfter}get state(){return this._state}get stateChange(){return this._stateEventEmitter}dispose(){return this.disposed?Promise.resolve():(this.disposed=!0,this.logger.log(`Registerer ${this.id} in state ${this.state} is being disposed`),delete this.userAgent._registerers[this.id],new Promise(e=>{const t=()=>{if(!this.waiting&&this._state===pt.Registered){this.stateChange.addListener(()=>{this.terminated(),e()},{once:!0}),this.unregister();return}this.terminated(),e()};this.waiting?this.waitingChange.addListener(()=>{t()},{once:!0}):t()}))}register(e={}){if(this.state===pt.Terminated)throw this.stateError(),new Error("Registerer terminated. Unable to register.");if(this.disposed)throw this.stateError(),new Error("Registerer disposed. Unable to register.");if(this.waiting){this.waitingWarning();const i=new Y1("REGISTER request already in progress, waiting for final response");return Promise.reject(i)}e.requestOptions&&(this.options=Object.assign(Object.assign({},this.options),e.requestOptions));const t=(this.options.extraHeaders||[]).slice();t.push("Contact: "+this.generateContactHeader(this.expires)),t.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString()),this.request.cseq++,this.request.setHeader("cseq",this.request.cseq+" REGISTER"),this.request.extraHeaders=t,this.waitingToggle(!0);const r=this.userAgent.userAgentCore.register(this.request,{onAccept:i=>{let s;i.message.hasHeader("expires")&&(s=Number(i.message.getHeader("expires"))),this._contacts=i.message.getHeaders("contact");let o=this._contacts.length;if(!o){this.logger.error("No Contact header in response to REGISTER, dropping response."),this.unregistered();return}let a;for(;o--;){if(a=i.message.parseHeader("contact",o),!a)throw new Error("Contact undefined");if(this.userAgent.contact.pubGruu&&QS(a.uri,this.userAgent.contact.pubGruu)){s=Number(a.getParam("expires"));break}if(this.userAgent.configuration.contactName===""){if(a.uri.user===this.userAgent.contact.uri.user){s=Number(a.getParam("expires"));break}}else if(QS(a.uri,this.userAgent.contact.uri)){s=Number(a.getParam("expires"));break}a=void 0}if(a===void 0){this.logger.error("No Contact header pointing to us, dropping response"),this.unregistered(),this.waitingToggle(!1);return}if(s===void 0){this.logger.error("Contact pointing to us is missing expires parameter, dropping response"),this.unregistered(),this.waitingToggle(!1);return}if(a.hasParam("temp-gruu")){const l=a.getParam("temp-gruu");l&&(this.userAgent.contact.tempGruu=Gt.URIParse(l.replace(/"/g,"")))}if(a.hasParam("pub-gruu")){const l=a.getParam("pub-gruu");l&&(this.userAgent.contact.pubGruu=Gt.URIParse(l.replace(/"/g,"")))}this.registered(s),e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(i),this.waitingToggle(!1)},onProgress:i=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(i)},onRedirect:i=>{this.logger.error("Redirect received. Not supported."),this.unregistered(),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(i),this.waitingToggle(!1)},onReject:i=>{if(i.message.statusCode===423){if(!i.message.hasHeader("min-expires")){this.logger.error("423 response received for REGISTER without Min-Expires, dropping response"),this.unregistered(),this.waitingToggle(!1);return}this.expires=Number(i.message.getHeader("min-expires")),this.waitingToggle(!1),this.register();return}this.logger.warn(`Failed to register, status code ${i.message.statusCode}`);let s=NaN;if(i.message.statusCode===500||i.message.statusCode===503){const o=i.message.getHeader("retry-after");o&&(s=Number.parseInt(o,void 0))}this._retryAfter=isNaN(s)?void 0:s,this.unregistered(),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(i),this._retryAfter=void 0,this.waitingToggle(!1)},onTrying:i=>{e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(i)}});return Promise.resolve(r)}unregister(e={}){if(this.state===pt.Terminated)throw this.stateError(),new Error("Registerer terminated. Unable to register.");if(this.disposed&&this.state!==pt.Registered)throw this.stateError(),new Error("Registerer disposed. Unable to register.");if(this.waiting){this.waitingWarning();const i=new Y1("REGISTER request already in progress, waiting for final response");return Promise.reject(i)}this._state!==pt.Registered&&!e.all&&this.logger.warn("Not currently registered, but sending an unregister anyway.");const t=(e.requestOptions&&e.requestOptions.extraHeaders||[]).slice();this.request.extraHeaders=t,e.all?(t.push("Contact: *"),t.push("Expires: 0")):t.push("Contact: "+this.generateContactHeader(0)),this.request.cseq++,this.request.setHeader("cseq",this.request.cseq+" REGISTER"),this.registrationTimer!==void 0&&(clearTimeout(this.registrationTimer),this.registrationTimer=void 0),this.waitingToggle(!0);const r=this.userAgent.userAgentCore.register(this.request,{onAccept:i=>{this._contacts=i.message.getHeaders("contact"),this.unregistered(),e.requestDelegate&&e.requestDelegate.onAccept&&e.requestDelegate.onAccept(i),this.waitingToggle(!1)},onProgress:i=>{e.requestDelegate&&e.requestDelegate.onProgress&&e.requestDelegate.onProgress(i)},onRedirect:i=>{this.logger.error("Unregister redirected. Not currently supported."),this.unregistered(),e.requestDelegate&&e.requestDelegate.onRedirect&&e.requestDelegate.onRedirect(i),this.waitingToggle(!1)},onReject:i=>{this.logger.error(`Unregister rejected with status code ${i.message.statusCode}`),this.unregistered(),e.requestDelegate&&e.requestDelegate.onReject&&e.requestDelegate.onReject(i),this.waitingToggle(!1)},onTrying:i=>{e.requestDelegate&&e.requestDelegate.onTrying&&e.requestDelegate.onTrying(i)}});return Promise.resolve(r)}clearTimers(){this.registrationTimer!==void 0&&(clearTimeout(this.registrationTimer),this.registrationTimer=void 0),this.registrationExpiredTimer!==void 0&&(clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=void 0)}generateContactHeader(e){let t=this.userAgent.contact.toString({register:!0});return this.options.regId&&this.options.instanceId&&(t+=";reg-id="+this.options.regId,t+=';+sip.instance="<urn:uuid:'+this.options.instanceId+'>"'),this.options.extraContactHeaderParams&&this.options.extraContactHeaderParams.forEach(r=>{t+=";"+r}),t+=";expires="+e,t}registered(e){this.clearTimers(),this.registrationTimer=setTimeout(()=>{this.registrationTimer=void 0,this.register()},this.refreshFrequency/100*e*1e3),this.registrationExpiredTimer=setTimeout(()=>{this.logger.warn("Registration expired"),this.unregistered()},e*1e3),this._state!==pt.Registered&&this.stateTransition(pt.Registered)}unregistered(){this.clearTimers(),this._state!==pt.Unregistered&&this.stateTransition(pt.Unregistered)}terminated(){this.clearTimers(),this._state!==pt.Terminated&&this.stateTransition(pt.Terminated)}stateTransition(e){const t=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case pt.Initial:e!==pt.Registered&&e!==pt.Unregistered&&e!==pt.Terminated&&t();break;case pt.Registered:e!==pt.Unregistered&&e!==pt.Terminated&&t();break;case pt.Unregistered:e!==pt.Registered&&e!==pt.Terminated&&t();break;case pt.Terminated:t();break;default:throw new Error("Unrecognized state.")}this._state=e,this.logger.log(`Registration transitioned to state ${this._state}`),this._stateEventEmitter.emit(this._state),e===pt.Terminated&&this.dispose()}get waiting(){return this._waiting}get waitingChange(){return this._waitingEventEmitter}waitingToggle(e){if(this._waiting===e)throw new Error(`Invalid waiting transition from ${this._waiting} to ${e}`);this._waiting=e,this.logger.log(`Waiting toggled to ${this._waiting}`),this._waitingEventEmitter.emit(this._waiting)}waitingWarning(){let e="An attempt was made to send a REGISTER request while a prior one was still in progress.";e+=" RFC 3261 requires UAs MUST NOT send a new registration until they have received a final response",e+=" from the registrar for the previous one or the previous REGISTER request has timed out.",e+=" Note that if the transport disconnects, you still must wait for the prior request to time out before",e+=" sending a new REGISTER request or alternatively dispose of the current Registerer and create a new Registerer.",this.logger.warn(e)}stateError(){let t=`An attempt was made to send a REGISTER request when the Registerer ${this.state===pt.Terminated?"is in 'Terminated' state":"has been disposed"}.`;t+=" The Registerer transitions to 'Terminated' when Registerer.dispose() is called.",t+=" Perhaps you called UserAgent.stop() which dipsoses of all Registerers?",this.logger.error(t)}}mi.defaultExpires=600;mi.defaultRefreshFrequency=99;var it;(function(n){n.Initial="Initial",n.NotifyWait="NotifyWait",n.Pending="Pending",n.Active="Active",n.Terminated="Terminated"})(it=it||(it={}));var Me;(function(n){n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Disconnected="Disconnected"})(Me=Me||(Me={}));var on;(function(n){n.Started="Started",n.Stopped="Stopped"})(on=on||(on={}));class Ft{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=Ft.hexChars,r=Ft.hexOut;let i,s,o,a;for(a=0;a<4;a+=1)for(s=a*8,i=e[a],o=0;o<8;o+=2)r[s+1+o]=t.charAt(i&15),i>>>=4,r[s+0+o]=t.charAt(i&15),i>>>=4;return r.join("")}static _md5cycle(e,t){let r=e[0],i=e[1],s=e[2],o=e[3];r+=(i&s|~i&o)+t[0]-680876936|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&s)+t[1]-389564586|0,o=(o<<12|o>>>20)+r|0,s+=(o&r|~o&i)+t[2]+606105819|0,s=(s<<17|s>>>15)+o|0,i+=(s&o|~s&r)+t[3]-1044525330|0,i=(i<<22|i>>>10)+s|0,r+=(i&s|~i&o)+t[4]-176418897|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&s)+t[5]+1200080426|0,o=(o<<12|o>>>20)+r|0,s+=(o&r|~o&i)+t[6]-1473231341|0,s=(s<<17|s>>>15)+o|0,i+=(s&o|~s&r)+t[7]-45705983|0,i=(i<<22|i>>>10)+s|0,r+=(i&s|~i&o)+t[8]+1770035416|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&s)+t[9]-1958414417|0,o=(o<<12|o>>>20)+r|0,s+=(o&r|~o&i)+t[10]-42063|0,s=(s<<17|s>>>15)+o|0,i+=(s&o|~s&r)+t[11]-1990404162|0,i=(i<<22|i>>>10)+s|0,r+=(i&s|~i&o)+t[12]+1804603682|0,r=(r<<7|r>>>25)+i|0,o+=(r&i|~r&s)+t[13]-40341101|0,o=(o<<12|o>>>20)+r|0,s+=(o&r|~o&i)+t[14]-1502002290|0,s=(s<<17|s>>>15)+o|0,i+=(s&o|~s&r)+t[15]+1236535329|0,i=(i<<22|i>>>10)+s|0,r+=(i&o|s&~o)+t[1]-165796510|0,r=(r<<5|r>>>27)+i|0,o+=(r&s|i&~s)+t[6]-1069501632|0,o=(o<<9|o>>>23)+r|0,s+=(o&i|r&~i)+t[11]+643717713|0,s=(s<<14|s>>>18)+o|0,i+=(s&r|o&~r)+t[0]-373897302|0,i=(i<<20|i>>>12)+s|0,r+=(i&o|s&~o)+t[5]-701558691|0,r=(r<<5|r>>>27)+i|0,o+=(r&s|i&~s)+t[10]+38016083|0,o=(o<<9|o>>>23)+r|0,s+=(o&i|r&~i)+t[15]-660478335|0,s=(s<<14|s>>>18)+o|0,i+=(s&r|o&~r)+t[4]-405537848|0,i=(i<<20|i>>>12)+s|0,r+=(i&o|s&~o)+t[9]+568446438|0,r=(r<<5|r>>>27)+i|0,o+=(r&s|i&~s)+t[14]-1019803690|0,o=(o<<9|o>>>23)+r|0,s+=(o&i|r&~i)+t[3]-187363961|0,s=(s<<14|s>>>18)+o|0,i+=(s&r|o&~r)+t[8]+1163531501|0,i=(i<<20|i>>>12)+s|0,r+=(i&o|s&~o)+t[13]-1444681467|0,r=(r<<5|r>>>27)+i|0,o+=(r&s|i&~s)+t[2]-51403784|0,o=(o<<9|o>>>23)+r|0,s+=(o&i|r&~i)+t[7]+1735328473|0,s=(s<<14|s>>>18)+o|0,i+=(s&r|o&~r)+t[12]-1926607734|0,i=(i<<20|i>>>12)+s|0,r+=(i^s^o)+t[5]-378558|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^s)+t[8]-2022574463|0,o=(o<<11|o>>>21)+r|0,s+=(o^r^i)+t[11]+1839030562|0,s=(s<<16|s>>>16)+o|0,i+=(s^o^r)+t[14]-35309556|0,i=(i<<23|i>>>9)+s|0,r+=(i^s^o)+t[1]-1530992060|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^s)+t[4]+1272893353|0,o=(o<<11|o>>>21)+r|0,s+=(o^r^i)+t[7]-155497632|0,s=(s<<16|s>>>16)+o|0,i+=(s^o^r)+t[10]-1094730640|0,i=(i<<23|i>>>9)+s|0,r+=(i^s^o)+t[13]+681279174|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^s)+t[0]-358537222|0,o=(o<<11|o>>>21)+r|0,s+=(o^r^i)+t[3]-722521979|0,s=(s<<16|s>>>16)+o|0,i+=(s^o^r)+t[6]+76029189|0,i=(i<<23|i>>>9)+s|0,r+=(i^s^o)+t[9]-640364487|0,r=(r<<4|r>>>28)+i|0,o+=(r^i^s)+t[12]-421815835|0,o=(o<<11|o>>>21)+r|0,s+=(o^r^i)+t[15]+530742520|0,s=(s<<16|s>>>16)+o|0,i+=(s^o^r)+t[2]-995338651|0,i=(i<<23|i>>>9)+s|0,r+=(s^(i|~o))+t[0]-198630844|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~s))+t[7]+1126891415|0,o=(o<<10|o>>>22)+r|0,s+=(r^(o|~i))+t[14]-1416354905|0,s=(s<<15|s>>>17)+o|0,i+=(o^(s|~r))+t[5]-57434055|0,i=(i<<21|i>>>11)+s|0,r+=(s^(i|~o))+t[12]+1700485571|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~s))+t[3]-1894986606|0,o=(o<<10|o>>>22)+r|0,s+=(r^(o|~i))+t[10]-1051523|0,s=(s<<15|s>>>17)+o|0,i+=(o^(s|~r))+t[1]-2054922799|0,i=(i<<21|i>>>11)+s|0,r+=(s^(i|~o))+t[8]+1873313359|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~s))+t[15]-30611744|0,o=(o<<10|o>>>22)+r|0,s+=(r^(o|~i))+t[6]-1560198380|0,s=(s<<15|s>>>17)+o|0,i+=(o^(s|~r))+t[13]+1309151649|0,i=(i<<21|i>>>11)+s|0,r+=(s^(i|~o))+t[4]-145523070|0,r=(r<<6|r>>>26)+i|0,o+=(i^(r|~s))+t[11]-1120210379|0,o=(o<<10|o>>>22)+r|0,s+=(r^(o|~i))+t[2]+718787259|0,s=(s<<15|s>>>17)+o|0,i+=(o^(s|~r))+t[9]-343485551|0,i=(i<<21|i>>>11)+s|0,e[0]=r+e[0]|0,e[1]=i+e[1]|0,e[2]=s+e[2]|0,e[3]=o+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(Ft.stateIdentity),this}appendStr(e){const t=this._buffer8,r=this._buffer32;let i=this._bufferLength,s,o;for(o=0;o<e.length;o+=1){if(s=e.charCodeAt(o),s<128)t[i++]=s;else if(s<2048)t[i++]=(s>>>6)+192,t[i++]=s&63|128;else if(s<55296||s>56319)t[i++]=(s>>>12)+224,t[i++]=s>>>6&63|128,t[i++]=s&63|128;else{if(s=(s-55296)*1024+(e.charCodeAt(++o)-56320)+65536,s>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[i++]=(s>>>18)+240,t[i++]=s>>>12&63|128,t[i++]=s>>>6&63|128,t[i++]=s&63|128}i>=64&&(this._dataLength+=64,Ft._md5cycle(this._state,r),i-=64,r[0]=r[16])}return this._bufferLength=i,this}appendAsciiStr(e){const t=this._buffer8,r=this._buffer32;let i=this._bufferLength,s,o=0;for(;;){for(s=Math.min(e.length-o,64-i);s--;)t[i++]=e.charCodeAt(o++);if(i<64)break;this._dataLength+=64,Ft._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}appendByteArray(e){const t=this._buffer8,r=this._buffer32;let i=this._bufferLength,s,o=0;for(;;){for(s=Math.min(e.length-o,64-i);s--;)t[i++]=e[o++];if(i<64)break;this._dataLength+=64,Ft._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}getState(){const e=this,t=e._state;return{buffer:String.fromCharCode.apply(null,e._buffer8),buflen:e._bufferLength,length:e._dataLength,state:[t[0],t[1],t[2],t[3]]}}setState(e){const t=e.buffer,r=e.state,i=this._state;let s;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],s=0;s<t.length;s+=1)this._buffer8[s]=t.charCodeAt(s)}end(e=!1){const t=this._bufferLength,r=this._buffer8,i=this._buffer32,s=(t>>2)+1;let o;if(this._dataLength+=t,r[t]=128,r[t+1]=r[t+2]=r[t+3]=0,i.set(Ft.buffer32Identity.subarray(s),s),t>55&&(Ft._md5cycle(this._state,i),i.set(Ft.buffer32Identity)),o=this._dataLength*8,o<=4294967295)i[14]=o;else{const a=o.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;const l=parseInt(a[2],16),c=parseInt(a[1],16)||0;i[14]=l,i[15]=c}return Ft._md5cycle(this._state,i),e?this._state:Ft._hex(this._state)}}Ft.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);Ft.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);Ft.hexChars="0123456789abcdef";Ft.hexOut=[];Ft.onePassHasher=new Ft;Ft.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592"&&console.error("Md5 self test failed.");function ds(n){return Ft.hashStr(n)}class xQ{constructor(e,t,r,i){this.logger=e.getLogger("sipjs.digestauthentication"),this.username=r,this.password=i,this.ha1=t,this.nc=0,this.ncHex="00000000"}authenticate(e,t,r){if(this.algorithm=t.algorithm,this.realm=t.realm,this.nonce=t.nonce,this.opaque=t.opaque,this.stale=t.stale,this.algorithm){if(this.algorithm!=="MD5")return this.logger.warn("challenge with Digest algorithm different than 'MD5', authentication aborted"),!1}else this.algorithm="MD5";if(!this.realm)return this.logger.warn("challenge without Digest realm, authentication aborted"),!1;if(!this.nonce)return this.logger.warn("challenge without Digest nonce, authentication aborted"),!1;if(t.qop)if(t.qop.indexOf("auth")>-1)this.qop="auth";else if(t.qop.indexOf("auth-int")>-1)this.qop="auth-int";else return this.logger.warn("challenge without Digest qop different than 'auth' or 'auth-int', authentication aborted"),!1;else this.qop=void 0;return this.method=e.method,this.uri=e.ruri,this.cnonce=Po(12),this.nc+=1,this.updateNcHex(),this.nc===4294967296&&(this.nc=1,this.ncHex="00000001"),this.calculateResponse(r),!0}toString(){const e=[];if(!this.response)throw new Error("response field does not exist, cannot generate Authorization header");return e.push("algorithm="+this.algorithm),e.push('username="'+this.username+'"'),e.push('realm="'+this.realm+'"'),e.push('nonce="'+this.nonce+'"'),e.push('uri="'+this.uri+'"'),e.push('response="'+this.response+'"'),this.opaque&&e.push('opaque="'+this.opaque+'"'),this.qop&&(e.push("qop="+this.qop),e.push('cnonce="'+this.cnonce+'"'),e.push("nc="+this.ncHex)),"Digest "+e.join(", ")}updateNcHex(){const e=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-e.length)+e}calculateResponse(e){let t,r;t=this.ha1,(t===""||t===void 0)&&(t=ds(this.username+":"+this.realm+":"+this.password)),this.qop==="auth"?(r=ds(this.method+":"+this.uri),this.response=ds(t+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+r)):this.qop==="auth-int"?(r=ds(this.method+":"+this.uri+":"+ds(e||"")),this.response=ds(t+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+r)):this.qop===void 0&&(r=ds(this.method+":"+this.uri),this.response=ds(t+":"+this.nonce+":"+r))}}var tn;(function(n){n[n.error=0]="error",n[n.warn=1]="warn",n[n.log=2]="log",n[n.debug=3]="debug"})(tn=tn||(tn={}));class t_{constructor(e,t,r){this.logger=e,this.category=t,this.label=r}error(e){this.genericLog(tn.error,e)}warn(e){this.genericLog(tn.warn,e)}log(e){this.genericLog(tn.log,e)}debug(e){this.genericLog(tn.debug,e)}genericLog(e,t){this.logger.genericLog(e,this.category,this.label,t)}get level(){return this.logger.level}set level(e){this.logger.level=e}}class SQ{constructor(){this.builtinEnabled=!0,this._level=tn.log,this.loggers={},this.logger=this.getLogger("sip:loggerfactory")}get level(){return this._level}set level(e){e>=0&&e<=3?this._level=e:e>3?this._level=3:tn.hasOwnProperty(e)?this._level=e:this.logger.error("invalid 'level' parameter value: "+JSON.stringify(e))}get connector(){return this._connector}set connector(e){e?typeof e=="function"?this._connector=e:this.logger.error("invalid 'connector' parameter value: "+JSON.stringify(e)):this._connector=void 0}getLogger(e,t){if(t&&this.level===3)return new t_(this,e,t);if(this.loggers[e])return this.loggers[e];{const r=new t_(this,e);return this.loggers[e]=r,r}}genericLog(e,t,r,i){this.level>=e&&this.builtinEnabled&&this.print(e,t,r,i),this.connector&&this.connector(tn[e],t,r,i)}print(e,t,r,i){if(typeof i=="string"){const s=[new Date,t];r&&s.push(r),i=s.concat(i).join(" | ")}switch(e){case tn.error:console.error(i);break;case tn.warn:console.warn(i);break;case tn.log:console.log(i);break;case tn.debug:console.debug(i);break}}}var lh;(function(n){function e(i,s){let o=s,a=0,l=0;if(i.substring(o,o+2).match(/(^\r\n)/))return-2;for(;a===0;){if(l=i.indexOf(`\r
`,o),l===-1)return l;!i.substring(l+2,l+4).match(/(^\r\n)/)&&i.charAt(l+2).match(/(^\s+)/)?o=l+2:a=l}return a}n.getHeader=e;function t(i,s,o,a){const l=s.indexOf(":",o),c=s.substring(o,l).trim(),u=s.substring(l+1,a).trim();let d;switch(c.toLowerCase()){case"via":case"v":i.addHeader("via",u),i.getHeaders("via").length===1?(d=i.parseHeader("Via"),d&&(i.via=d,i.viaBranch=d.branch)):d=0;break;case"from":case"f":i.setHeader("from",u),d=i.parseHeader("from"),d&&(i.from=d,i.fromTag=d.getParam("tag"));break;case"to":case"t":i.setHeader("to",u),d=i.parseHeader("to"),d&&(i.to=d,i.toTag=d.getParam("tag"));break;case"record-route":if(d=Gt.parse(u,"Record_Route"),d===-1){d=void 0;break}if(!(d instanceof Array)){d=void 0;break}d.forEach(f=>{i.addHeader("record-route",u.substring(f.position,f.offset)),i.headers["Record-Route"][i.getHeaders("record-route").length-1].parsed=f.parsed});break;case"call-id":case"i":i.setHeader("call-id",u),d=i.parseHeader("call-id"),d&&(i.callId=u);break;case"contact":case"m":if(d=Gt.parse(u,"Contact"),d===-1){d=void 0;break}if(!(d instanceof Array)){d=void 0;break}d.forEach(f=>{i.addHeader("contact",u.substring(f.position,f.offset)),i.headers.Contact[i.getHeaders("contact").length-1].parsed=f.parsed});break;case"content-length":case"l":i.setHeader("content-length",u),d=i.parseHeader("content-length");break;case"content-type":case"c":i.setHeader("content-type",u),d=i.parseHeader("content-type");break;case"cseq":i.setHeader("cseq",u),d=i.parseHeader("cseq"),d&&(i.cseq=d.value),i instanceof qs&&(i.method=d.method);break;case"max-forwards":i.setHeader("max-forwards",u),d=i.parseHeader("max-forwards");break;case"www-authenticate":i.setHeader("www-authenticate",u),d=i.parseHeader("www-authenticate");break;case"proxy-authenticate":i.setHeader("proxy-authenticate",u),d=i.parseHeader("proxy-authenticate");break;case"refer-to":case"r":i.setHeader("refer-to",u),d=i.parseHeader("refer-to"),d&&(i.referTo=d);break;default:i.addHeader(c.toLowerCase(),u),d=0}return d===void 0?{error:"error parsing header '"+c+"'"}:!0}n.parseHeader=t;function r(i,s){let o=0,a=i.indexOf(`\r
`);if(a===-1){s.warn("no CRLF found, not a SIP message, discarded");return}const l=i.substring(0,a),c=Gt.parse(l,"Request_Response");let u;if(c===-1){s.warn('error parsing first line of SIP message: "'+l+'"');return}else c.status_code?(u=new qs,u.statusCode=c.status_code,u.reasonPhrase=c.reason_phrase):(u=new ul,u.method=c.method,u.ruri=c.uri);u.data=i,o=a+2;let d;for(;;){if(a=e(i,o),a===-2){d=o+2;break}else if(a===-1){s.error("malformed message");return}const f=t(u,i,o,a);if(f&&f!==!0){s.error(f.error);return}o=a+2}return u.hasHeader("content-length")?u.body=i.substr(d,Number(u.getHeader("content-length"))):u.body=i.substring(d),u}n.parseMessage=r})(lh=lh||(lh={}));function YM(n,e){const t=`\r
`;if(e.statusCode<100||e.statusCode>699)throw new TypeError("Invalid statusCode: "+e.statusCode);const r=e.reasonPhrase?e.reasonPhrase:lm(e.statusCode);let i="SIP/2.0 "+e.statusCode+" "+r+t;e.statusCode>=100&&e.statusCode<200,e.statusCode;const s="From: "+n.getHeader("From")+t,o="Call-ID: "+n.callId+t,a="CSeq: "+n.cseq+" "+n.method+t,l=n.getHeaders("via").reduce((p,m)=>p+"Via: "+m+t,"");let c="To: "+n.getHeader("to");if(e.statusCode>100&&!n.parseHeader("to").hasParam("tag")){let p=e.toTag;p||(p=cm()),c+=";tag="+p}c+=t;let u="";e.supported&&(u="Supported: "+e.supported.join(", ")+t);let d="";e.userAgent&&(d="User-Agent: "+e.userAgent+t);let f="";return e.extraHeaders&&(f=e.extraHeaders.reduce((p,m)=>p+m.trim()+t,"")),i+=l,i+=s,i+=c,i+=a,i+=o,i+=u,i+=d,i+=f,e.body?(i+="Content-Type: "+e.body.contentType+t,i+="Content-Length: "+Xu(e.body.content)+t+t,i+=e.body.content):i+="Content-Length: 0"+t+t,{message:i}}class Yg extends ga{constructor(e){super(e||"Unspecified transport error.")}}class XM{constructor(e,t,r,i,s){this._transport=e,this._user=t,this._id=r,this._state=i,this.listeners=new Array,this.logger=t.loggerFactory.getLogger(s,r),this.logger.debug(`Constructing ${this.typeToString()} with id ${this.id}.`)}dispose(){this.logger.debug(`Destroyed ${this.typeToString()} with id ${this.id}.`)}get id(){return this._id}get kind(){throw new Error("Invalid kind.")}get state(){return this._state}get transport(){return this._transport}addStateChangeListener(e,t){const r=()=>{this.removeStateChangeListener(r),e()};(t==null?void 0:t.once)===!0?this.listeners.push(r):this.listeners.push(e)}notifyStateChangeListeners(){this.listeners.slice().forEach(e=>e())}removeStateChangeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}logTransportError(e,t){this.logger.error(e.message),this.logger.error(`Transport error occurred in ${this.typeToString()} with id ${this.id}.`),this.logger.error(t)}send(e){return this.transport.send(e).catch(t=>{if(t instanceof Yg)throw this.onTransportError(t),t;let r;throw t&&typeof t.message=="string"?r=new Yg(t.message):r=new Yg,this.onTransportError(r),r})}setState(e){this.logger.debug(`State change to "${e}" on ${this.typeToString()} with id ${this.id}.`),this._state=e,this._user.onStateChange&&this._user.onStateChange(e),this.notifyStateChangeListeners()}typeToString(){return"UnknownType"}}class ZM extends XM{constructor(e,t,r,i,s){super(t,r,e.viaBranch,i,s),this._request=e,this.user=r}get request(){return this._request}}var W;(function(n){n.Accepted="Accepted",n.Calling="Calling",n.Completed="Completed",n.Confirmed="Confirmed",n.Proceeding="Proceeding",n.Terminated="Terminated",n.Trying="Trying"})(W=W||(W={}));class Jn extends ZM{constructor(e,t,r){super(e,t,r,W.Proceeding,"sip.transaction.ist")}dispose(){this.stopProgressExtensionTimer(),this.H&&(clearTimeout(this.H),this.H=void 0),this.I&&(clearTimeout(this.I),this.I=void 0),this.L&&(clearTimeout(this.L),this.L=void 0),super.dispose()}get kind(){return"ist"}receiveRequest(e){switch(this.state){case W.Proceeding:if(e.method===ve.INVITE){this.lastProvisionalResponse&&this.send(this.lastProvisionalResponse).catch(r=>{this.logTransportError(r,"Failed to send retransmission of provisional response.")});return}break;case W.Accepted:if(e.method===ve.INVITE)return;break;case W.Completed:if(e.method===ve.INVITE){if(!this.lastFinalResponse)throw new Error("Last final response undefined.");this.send(this.lastFinalResponse).catch(r=>{this.logTransportError(r,"Failed to send retransmission of final response.")});return}if(e.method===ve.ACK){this.stateTransition(W.Confirmed);return}break;case W.Confirmed:if(e.method===ve.INVITE||e.method===ve.ACK)return;break;case W.Terminated:if(e.method===ve.INVITE||e.method===ve.ACK)return;break;default:throw new Error(`Invalid state ${this.state}`)}const t=`INVITE server transaction received unexpected ${e.method} request while in state ${this.state}.`;this.logger.warn(t)}receiveResponse(e,t){if(e<100||e>699)throw new Error(`Invalid status code ${e}`);switch(this.state){case W.Proceeding:if(e>=100&&e<=199){this.lastProvisionalResponse=t,e>100&&this.startProgressExtensionTimer(),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send 1xx response.")});return}if(e>=200&&e<=299){this.lastFinalResponse=t,this.stateTransition(W.Accepted),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send 2xx response.")});return}if(e>=300&&e<=699){this.lastFinalResponse=t,this.stateTransition(W.Completed),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send non-2xx final response.")});return}break;case W.Accepted:if(e>=200&&e<=299){this.send(t).catch(i=>{this.logTransportError(i,"Failed to send 2xx response.")});return}break;case W.Completed:break;case W.Confirmed:break;case W.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`INVITE server transaction received unexpected ${e} response from TU while in state ${this.state}.`;throw this.logger.error(r),new Error(r)}retransmitAcceptedResponse(){this.state===W.Accepted&&this.lastFinalResponse&&this.send(this.lastFinalResponse).catch(e=>{this.logTransportError(e,"Failed to send 2xx response.")})}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e)}typeToString(){return"INVITE server transaction"}stateTransition(e){const t=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case W.Proceeding:t();break;case W.Accepted:case W.Completed:this.state!==W.Proceeding&&t();break;case W.Confirmed:this.state!==W.Completed&&t();break;case W.Terminated:this.state!==W.Accepted&&this.state!==W.Completed&&this.state!==W.Confirmed&&t();break;default:t()}this.stopProgressExtensionTimer(),e===W.Accepted&&(this.L=setTimeout(()=>this.timerL(),rn.TIMER_L)),e===W.Completed&&(this.H=setTimeout(()=>this.timerH(),rn.TIMER_H)),e===W.Confirmed&&(this.I=setTimeout(()=>this.timerI(),rn.TIMER_I)),e===W.Terminated&&this.dispose(),this.setState(e)}startProgressExtensionTimer(){this.progressExtensionTimer===void 0&&(this.progressExtensionTimer=setInterval(()=>{if(this.logger.debug(`Progress extension timer expired for INVITE server transaction ${this.id}.`),!this.lastProvisionalResponse)throw new Error("Last provisional response undefined.");this.send(this.lastProvisionalResponse).catch(e=>{this.logTransportError(e,"Failed to send retransmission of provisional response.")})},rn.PROVISIONAL_RESPONSE_INTERVAL))}stopProgressExtensionTimer(){this.progressExtensionTimer!==void 0&&(clearInterval(this.progressExtensionTimer),this.progressExtensionTimer=void 0)}timerG(){}timerH(){this.logger.debug(`Timer H expired for INVITE server transaction ${this.id}.`),this.state===W.Completed&&(this.logger.warn("ACK to negative final response was never received, terminating transaction."),this.stateTransition(W.Terminated))}timerI(){this.logger.debug(`Timer I expired for INVITE server transaction ${this.id}.`),this.stateTransition(W.Terminated)}timerL(){this.logger.debug(`Timer L expired for INVITE server transaction ${this.id}.`),this.state===W.Accepted&&this.stateTransition(W.Terminated)}}class um extends XM{constructor(e,t,r,i,s){super(t,r,um.makeId(e),i,s),this._request=e,this.user=r,e.setViaHeader(this.id,t.protocol)}static makeId(e){if(e.method==="CANCEL"){if(!e.branch)throw new Error("Outgoing CANCEL request without a branch.");return e.branch}else return"z9hG4bK"+Math.floor(Math.random()*1e7)}get request(){return this._request}onRequestTimeout(){this.user.onRequestTimeout&&this.user.onRequestTimeout()}}class vr extends um{constructor(e,t,r){super(e,t,r,W.Trying,"sip.transaction.nict"),this.F=setTimeout(()=>this.timerF(),rn.TIMER_F),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send initial outgoing request.")})}dispose(){this.F&&(clearTimeout(this.F),this.F=void 0),this.K&&(clearTimeout(this.K),this.K=void 0),super.dispose()}get kind(){return"nict"}receiveResponse(e){const t=e.statusCode;if(!t||t<100||t>699)throw new Error(`Invalid status code ${t}`);switch(this.state){case W.Trying:if(t>=100&&t<=199){this.stateTransition(W.Proceeding),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=200&&t<=699){if(this.stateTransition(W.Completed),t===408){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case W.Proceeding:if(t>=100&&t<=199&&this.user.receiveResponse)return this.user.receiveResponse(e);if(t>=200&&t<=699){if(this.stateTransition(W.Completed),t===408){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case W.Completed:return;case W.Terminated:return;default:throw new Error(`Invalid state ${this.state}`)}const r=`Non-INVITE client transaction received unexpected ${t} response while in state ${this.state}.`;this.logger.warn(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(W.Terminated,!0)}typeToString(){return"non-INVITE client transaction"}stateTransition(e,t=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case W.Trying:r();break;case W.Proceeding:this.state!==W.Trying&&r();break;case W.Completed:this.state!==W.Trying&&this.state!==W.Proceeding&&r();break;case W.Terminated:this.state!==W.Trying&&this.state!==W.Proceeding&&this.state!==W.Completed&&(t||r());break;default:r()}e===W.Completed&&(this.F&&(clearTimeout(this.F),this.F=void 0),this.K=setTimeout(()=>this.timerK(),rn.TIMER_K)),e===W.Terminated&&this.dispose(),this.setState(e)}timerF(){this.logger.debug(`Timer F expired for non-INVITE client transaction ${this.id}.`),(this.state===W.Trying||this.state===W.Proceeding)&&(this.onRequestTimeout(),this.stateTransition(W.Terminated))}timerK(){this.state===W.Completed&&this.stateTransition(W.Terminated)}}class Ll{constructor(e,t){this.core=e,this.dialogState=t,this.core.dialogs.set(this.id,this)}static initialDialogStateForUserAgentClient(e,t){const i=t.getHeaders("record-route").reverse(),s=t.parseHeader("contact");if(!s)throw new Error("Contact undefined.");if(!(s instanceof Wn))throw new Error("Contact not instance of NameAddrHeader.");const o=s.uri,a=e.cseq,l=void 0,c=e.callId,u=e.fromTag,d=t.toTag;if(!c)throw new Error("Call id undefined.");if(!u)throw new Error("From tag undefined.");if(!d)throw new Error("To tag undefined.");if(!e.from)throw new Error("From undefined.");if(!e.to)throw new Error("To undefined.");const f=e.from.uri,p=e.to.uri;if(!t.statusCode)throw new Error("Incoming response status code undefined.");const m=t.statusCode<200;return{id:c+u+d,early:m,callId:c,localTag:u,remoteTag:d,localSequenceNumber:a,remoteSequenceNumber:l,localURI:f,remoteURI:p,remoteTarget:o,routeSet:i,secure:!1}}static initialDialogStateForUserAgentServer(e,t,r=!1){const s=e.getHeaders("record-route"),o=e.parseHeader("contact");if(!o)throw new Error("Contact undefined.");if(!(o instanceof Wn))throw new Error("Contact not instance of NameAddrHeader.");const a=o.uri,l=e.cseq,c=void 0,u=e.callId,d=t,f=e.fromTag,p=e.from.uri,m=e.to.uri;return{id:u+d+f,early:r,callId:u,localTag:d,remoteTag:f,localSequenceNumber:c,remoteSequenceNumber:l,localURI:m,remoteURI:p,remoteTarget:a,routeSet:s,secure:!1}}dispose(){this.core.dialogs.delete(this.id)}get id(){return this.dialogState.id}get early(){return this.dialogState.early}get callId(){return this.dialogState.callId}get localTag(){return this.dialogState.localTag}get remoteTag(){return this.dialogState.remoteTag}get localSequenceNumber(){return this.dialogState.localSequenceNumber}get remoteSequenceNumber(){return this.dialogState.remoteSequenceNumber}get localURI(){return this.dialogState.localURI}get remoteURI(){return this.dialogState.remoteURI}get remoteTarget(){return this.dialogState.remoteTarget}get routeSet(){return this.dialogState.routeSet}get secure(){return this.dialogState.secure}get userAgentCore(){return this.core}confirm(){this.dialogState.early=!1}receiveRequest(e){if(e.method!==ve.ACK){if(this.remoteSequenceNumber){if(e.cseq<=this.remoteSequenceNumber)throw new Error("Out of sequence in dialog request. Did you forget to call sequenceGuard()?");this.dialogState.remoteSequenceNumber=e.cseq}this.remoteSequenceNumber||(this.dialogState.remoteSequenceNumber=e.cseq)}}recomputeRouteSet(e){this.dialogState.routeSet=e.getHeaders("record-route").reverse()}createOutgoingRequestMessage(e,t){const r=this.remoteURI,i=this.remoteTag,s=this.localURI,o=this.localTag,a=this.callId;let l;t&&t.cseq?l=t.cseq:this.dialogState.localSequenceNumber?l=this.dialogState.localSequenceNumber+=1:l=this.dialogState.localSequenceNumber=1;const c=this.remoteTarget,u=this.routeSet,d=t&&t.extraHeaders,f=t&&t.body;return this.userAgentCore.makeOutgoingRequestMessage(e,c,s,r,{callId:a,cseq:l,fromTag:o,toTag:i,routeSet:u},d,f)}incrementLocalSequenceNumber(){if(!this.dialogState.localSequenceNumber)throw new Error("Local sequence number undefined.");this.dialogState.localSequenceNumber+=1}sequenceGuard(e){return e.method===ve.ACK?!0:this.remoteSequenceNumber&&e.cseq<=this.remoteSequenceNumber?(this.core.replyStateless(e,{statusCode:500}),!1):!0}}class Ds extends um{constructor(e,t,r){super(e,t,r,W.Calling,"sip.transaction.ict"),this.ackRetransmissionCache=new Map,this.B=setTimeout(()=>this.timerB(),rn.TIMER_B),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send initial outgoing request.")})}dispose(){this.B&&(clearTimeout(this.B),this.B=void 0),this.D&&(clearTimeout(this.D),this.D=void 0),this.M&&(clearTimeout(this.M),this.M=void 0),super.dispose()}get kind(){return"ict"}ackResponse(e){const t=e.toTag;if(!t)throw new Error("To tag undefined.");const r="z9hG4bK"+Math.floor(Math.random()*1e7);e.setViaHeader(r,this.transport.protocol),this.ackRetransmissionCache.set(t,e),this.send(e.toString()).catch(i=>{this.logTransportError(i,"Failed to send ACK to 2xx response.")})}receiveResponse(e){const t=e.statusCode;if(!t||t<100||t>699)throw new Error(`Invalid status code ${t}`);switch(this.state){case W.Calling:if(t>=100&&t<=199){this.stateTransition(W.Proceeding),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=200&&t<=299){this.ackRetransmissionCache.set(e.toTag,void 0),this.stateTransition(W.Accepted),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=300&&t<=699){this.stateTransition(W.Completed),this.ack(e),this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case W.Proceeding:if(t>=100&&t<=199){this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=200&&t<=299){this.ackRetransmissionCache.set(e.toTag,void 0),this.stateTransition(W.Accepted),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=300&&t<=699){this.stateTransition(W.Completed),this.ack(e),this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case W.Accepted:if(t>=200&&t<=299){if(!this.ackRetransmissionCache.has(e.toTag)){this.ackRetransmissionCache.set(e.toTag,void 0),this.user.receiveResponse&&this.user.receiveResponse(e);return}const i=this.ackRetransmissionCache.get(e.toTag);if(i){this.send(i.toString()).catch(s=>{this.logTransportError(s,"Failed to send retransmission of ACK to 2xx response.")});return}return}break;case W.Completed:if(t>=300&&t<=699){this.ack(e);return}break;case W.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`Received unexpected ${t} response while in state ${this.state}.`;this.logger.warn(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(W.Terminated,!0)}typeToString(){return"INVITE client transaction"}ack(e){const t=this.request.ruri,r=this.request.callId,i=this.request.cseq,s=this.request.getHeader("from"),o=e.getHeader("to"),a=this.request.getHeader("via"),l=this.request.getHeader("route");if(!s)throw new Error("From undefined.");if(!o)throw new Error("To undefined.");if(!a)throw new Error("Via undefined.");let c=`ACK ${t} SIP/2.0\r
`;l&&(c+=`Route: ${l}\r
`),c+=`Via: ${a}\r
`,c+=`To: ${o}\r
`,c+=`From: ${s}\r
`,c+=`Call-ID: ${r}\r
`,c+=`CSeq: ${i} ACK\r
`,c+=`Max-Forwards: 70\r
`,c+=`Content-Length: 0\r
\r
`,this.send(c).catch(u=>{this.logTransportError(u,"Failed to send ACK to non-2xx response.")})}stateTransition(e,t=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case W.Calling:r();break;case W.Proceeding:this.state!==W.Calling&&r();break;case W.Accepted:case W.Completed:this.state!==W.Calling&&this.state!==W.Proceeding&&r();break;case W.Terminated:this.state!==W.Calling&&this.state!==W.Accepted&&this.state!==W.Completed&&(t||r());break;default:r()}this.B&&(clearTimeout(this.B),this.B=void 0),W.Proceeding,e===W.Completed&&(this.D=setTimeout(()=>this.timerD(),rn.TIMER_D)),e===W.Accepted&&(this.M=setTimeout(()=>this.timerM(),rn.TIMER_M)),e===W.Terminated&&this.dispose(),this.setState(e)}timerA(){}timerB(){this.logger.debug(`Timer B expired for INVITE client transaction ${this.id}.`),this.state===W.Calling&&(this.onRequestTimeout(),this.stateTransition(W.Terminated))}timerD(){this.logger.debug(`Timer D expired for INVITE client transaction ${this.id}.`),this.state===W.Completed&&this.stateTransition(W.Terminated)}timerM(){this.logger.debug(`Timer M expired for INVITE client transaction ${this.id}.`),this.state===W.Accepted&&this.stateTransition(W.Terminated)}}class xn{constructor(e,t,r,i){this.transactionConstructor=e,this.core=t,this.message=r,this.delegate=i,this.challenged=!1,this.stale=!1,this.logger=this.loggerFactory.getLogger("sip.user-agent-client"),this.init()}dispose(){this.transaction.dispose()}get loggerFactory(){return this.core.loggerFactory}get transaction(){if(!this._transaction)throw new Error("Transaction undefined.");return this._transaction}cancel(e,t={}){if(!this.transaction)throw new Error("Transaction undefined.");if(!this.message.to)throw new Error("To undefined.");if(!this.message.from)throw new Error("From undefined.");const r=this.core.makeOutgoingRequestMessage(ve.CANCEL,this.message.ruri,this.message.from.uri,this.message.to.uri,{toTag:this.message.toTag,fromTag:this.message.fromTag,callId:this.message.callId,cseq:this.message.cseq},t.extraHeaders);return r.branch=this.message.branch,this.message.headers.Route&&(r.headers.Route=this.message.headers.Route),e&&r.setHeader("Reason",e),this.transaction.state===W.Proceeding?new xn(vr,this.core,r):this.transaction.addStateChangeListener(()=>{this.transaction&&this.transaction.state===W.Proceeding&&new xn(vr,this.core,r)},{once:!0}),r}authenticationGuard(e,t){const r=e.statusCode;if(!r)throw new Error("Response status code undefined.");if(r!==401&&r!==407)return!0;let i,s;if(r===401?(i=e.parseHeader("www-authenticate"),s="authorization"):(i=e.parseHeader("proxy-authenticate"),s="proxy-authorization"),!i)return this.logger.warn(r+" with wrong or missing challenge, cannot authenticate"),!0;if(this.challenged&&(this.stale||i.stale!==!0))return this.logger.warn(r+" apparently in authentication loop, cannot authenticate"),!0;if(!this.credentials&&(this.credentials=this.core.configuration.authenticationFactory(),!this.credentials))return this.logger.warn("Unable to obtain credentials, cannot authenticate"),!0;if(!this.credentials.authenticate(this.message,i))return!0;this.challenged=!0,i.stale&&(this.stale=!0);let o=this.message.cseq+=1;return t&&t.localSequenceNumber&&(t.incrementLocalSequenceNumber(),o=this.message.cseq=t.localSequenceNumber),this.message.setHeader("cseq",o+" "+this.message.method),this.message.setHeader(s,this.credentials.toString()),this.init(),!1}onRequestTimeout(){this.logger.warn("User agent client request timed out. Generating internal 408 Request Timeout.");const e=new qs;e.statusCode=408,e.reasonPhrase="Request Timeout",this.receiveResponse(e)}onTransportError(e){this.logger.error(e.message),this.logger.error("User agent client request transport error. Generating internal 503 Service Unavailable.");const t=new qs;t.statusCode=503,t.reasonPhrase="Service Unavailable",this.receiveResponse(t)}receiveResponse(e){if(!this.authenticationGuard(e))return;const t=e.statusCode?e.statusCode.toString():"";if(!t)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(t):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});break;case/^1[0-9]{2}$/.test(t):this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e});break;case/^2[0-9]{2}$/.test(t):this.delegate&&this.delegate.onAccept&&this.delegate.onAccept({message:e});break;case/^3[0-9]{2}$/.test(t):this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});break;case/^[4-6][0-9]{2}$/.test(t):this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});break;default:throw new Error(`Invalid status code ${t}`)}}init(){const e={loggerFactory:this.loggerFactory,onRequestTimeout:()=>this.onRequestTimeout(),onStateChange:i=>{i===W.Terminated&&(this.core.userAgentClients.delete(r),t===this._transaction&&this.dispose())},onTransportError:i=>this.onTransportError(i),receiveResponse:i=>this.receiveResponse(i)},t=new this.transactionConstructor(this.message,this.core.transport,e);this._transaction=t;const r=t.id+t.request.method;this.core.userAgentClients.set(r,this)}}class _Q extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.BYE,r);super(vr,e.userAgentCore,i,t),e.dispose()}}class hr extends ZM{constructor(e,t,r){super(e,t,r,W.Trying,"sip.transaction.nist")}dispose(){this.J&&(clearTimeout(this.J),this.J=void 0),super.dispose()}get kind(){return"nist"}receiveRequest(e){switch(this.state){case W.Trying:break;case W.Proceeding:if(!this.lastResponse)throw new Error("Last response undefined.");this.send(this.lastResponse).catch(t=>{this.logTransportError(t,"Failed to send retransmission of provisional response.")});break;case W.Completed:if(!this.lastResponse)throw new Error("Last response undefined.");this.send(this.lastResponse).catch(t=>{this.logTransportError(t,"Failed to send retransmission of final response.")});break;case W.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}}receiveResponse(e,t){if(e<100||e>699)throw new Error(`Invalid status code ${e}`);if(e>100&&e<=199)throw new Error("Provisional response other than 100 not allowed.");switch(this.state){case W.Trying:if(this.lastResponse=t,e>=100&&e<200){this.stateTransition(W.Proceeding),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send provisional response.")});return}if(e>=200&&e<=699){this.stateTransition(W.Completed),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send final response.")});return}break;case W.Proceeding:if(this.lastResponse=t,e>=200&&e<=699){this.stateTransition(W.Completed),this.send(t).catch(i=>{this.logTransportError(i,"Failed to send final response.")});return}break;case W.Completed:return;case W.Terminated:break;default:throw new Error(`Invalid state ${this.state}`)}const r=`Non-INVITE server transaction received unexpected ${e} response from TU while in state ${this.state}.`;throw this.logger.error(r),new Error(r)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(W.Terminated,!0)}typeToString(){return"non-INVITE server transaction"}stateTransition(e,t=!1){const r=()=>{throw new Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case W.Trying:r();break;case W.Proceeding:this.state!==W.Trying&&r();break;case W.Completed:this.state!==W.Trying&&this.state!==W.Proceeding&&r();break;case W.Terminated:this.state!==W.Proceeding&&this.state!==W.Completed&&(t||r());break;default:r()}e===W.Completed&&(this.J=setTimeout(()=>this.timerJ(),rn.TIMER_J)),e===W.Terminated&&this.dispose(),this.setState(e)}timerJ(){this.logger.debug(`Timer J expired for NON-INVITE server transaction ${this.id}.`),this.state===W.Completed&&this.stateTransition(W.Terminated)}}class Oi{constructor(e,t,r,i){this.transactionConstructor=e,this.core=t,this.message=r,this.delegate=i,this.logger=this.loggerFactory.getLogger("sip.user-agent-server"),this.toTag=r.toTag?r.toTag:cm(),this.init()}dispose(){this.transaction.dispose()}get loggerFactory(){return this.core.loggerFactory}get transaction(){if(!this._transaction)throw new Error("Transaction undefined.");return this._transaction}accept(e={statusCode:200}){if(!this.acceptable)throw new Ms(`${this.message.method} not acceptable in state ${this.transaction.state}.`);const t=e.statusCode;if(t<200||t>299)throw new TypeError(`Invalid statusCode: ${t}`);return this.reply(e)}progress(e={statusCode:180}){if(!this.progressable)throw new Ms(`${this.message.method} not progressable in state ${this.transaction.state}.`);const t=e.statusCode;if(t<101||t>199)throw new TypeError(`Invalid statusCode: ${t}`);return this.reply(e)}redirect(e,t={statusCode:302}){if(!this.redirectable)throw new Ms(`${this.message.method} not redirectable in state ${this.transaction.state}.`);const r=t.statusCode;if(r<300||r>399)throw new TypeError(`Invalid statusCode: ${r}`);const i=new Array;return e.forEach(o=>i.push(`Contact: ${o.toString()}`)),t.extraHeaders=(t.extraHeaders||[]).concat(i),this.reply(t)}reject(e={statusCode:480}){if(!this.rejectable)throw new Ms(`${this.message.method} not rejectable in state ${this.transaction.state}.`);const t=e.statusCode;if(t<400||t>699)throw new TypeError(`Invalid statusCode: ${t}`);return this.reply(e)}trying(e){if(!this.tryingable)throw new Ms(`${this.message.method} not tryingable in state ${this.transaction.state}.`);return this.reply({statusCode:100})}receiveCancel(e){this.delegate&&this.delegate.onCancel&&this.delegate.onCancel(e)}get acceptable(){if(this.transaction instanceof Jn)return this.transaction.state===W.Proceeding||this.transaction.state===W.Accepted;if(this.transaction instanceof hr)return this.transaction.state===W.Trying||this.transaction.state===W.Proceeding;throw new Error("Unknown transaction type.")}get progressable(){if(this.transaction instanceof Jn)return this.transaction.state===W.Proceeding;if(this.transaction instanceof hr)return!1;throw new Error("Unknown transaction type.")}get redirectable(){if(this.transaction instanceof Jn)return this.transaction.state===W.Proceeding;if(this.transaction instanceof hr)return this.transaction.state===W.Trying||this.transaction.state===W.Proceeding;throw new Error("Unknown transaction type.")}get rejectable(){if(this.transaction instanceof Jn)return this.transaction.state===W.Proceeding;if(this.transaction instanceof hr)return this.transaction.state===W.Trying||this.transaction.state===W.Proceeding;throw new Error("Unknown transaction type.")}get tryingable(){if(this.transaction instanceof Jn)return this.transaction.state===W.Proceeding;if(this.transaction instanceof hr)return this.transaction.state===W.Trying;throw new Error("Unknown transaction type.")}reply(e){!e.toTag&&e.statusCode!==100&&(e.toTag=this.toTag),e.userAgent=e.userAgent||this.core.configuration.userAgentHeaderFieldValue,e.supported=e.supported||this.core.configuration.supportedOptionTagsResponse;const t=YM(this.message,e);return this.transaction.receiveResponse(e.statusCode,t.message),t}init(){const e={loggerFactory:this.loggerFactory,onStateChange:i=>{i===W.Terminated&&(this.core.userAgentServers.delete(r),this.dispose())},onTransportError:i=>{this.logger.error(i.message),this.delegate&&this.delegate.onTransportError?this.delegate.onTransportError(i):this.logger.error("User agent server response transport error.")}},t=new this.transactionConstructor(this.message,this.core.transport,e);this._transaction=t;const r=t.id;this.core.userAgentServers.set(t.id,this)}}class CQ extends Oi{constructor(e,t,r){super(hr,e.userAgentCore,t,r)}}class kQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.INFO,r);super(vr,e.userAgentCore,i,t)}}class EQ extends Oi{constructor(e,t,r){super(hr,e.userAgentCore,t,r)}}class QM extends xn{constructor(e,t,r){super(vr,e,t,r)}}class eR extends Oi{constructor(e,t,r){super(hr,e,t,r)}}class TQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.NOTIFY,r);super(vr,e.userAgentCore,i,t)}}function AQ(n){return n.userAgentCore!==void 0}class up extends Oi{constructor(e,t,r){const i=AQ(e)?e.userAgentCore:e;super(hr,i,t,r)}}class MQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.PRACK,r);super(vr,e.userAgentCore,i,t),e.signalingStateTransition(i)}}class RQ extends Oi{constructor(e,t,r){super(hr,e.userAgentCore,t,r),e.signalingStateTransition(t),this.dialog=e}accept(e={statusCode:200}){return e.body&&this.dialog.signalingStateTransition(e.body),super.accept(e)}}class IQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.INVITE,r);super(Ds,e.userAgentCore,i,t),this.delegate=t,e.signalingStateTransition(i),e.reinviteUserAgentClient=this,this.dialog=e}receiveResponse(e){if(!this.authenticationGuard(e,this.dialog))return;const t=e.statusCode?e.statusCode.toString():"";if(!t)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(t):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});break;case/^1[0-9]{2}$/.test(t):this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e,session:this.dialog,prack:r=>{throw new Error("Unimplemented.")}});break;case/^2[0-9]{2}$/.test(t):this.dialog.signalingStateTransition(e),this.delegate&&this.delegate.onAccept&&this.delegate.onAccept({message:e,session:this.dialog,ack:r=>this.dialog.ack(r)});break;case/^3[0-9]{2}$/.test(t):this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentClient=void 0,this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});break;case/^[4-6][0-9]{2}$/.test(t):this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentClient=void 0,this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});break;default:throw new Error(`Invalid status code ${t}`)}}}class OQ extends Oi{constructor(e,t,r){super(Jn,e.userAgentCore,t,r),e.reinviteUserAgentServer=this,this.dialog=e}accept(e={statusCode:200}){e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(this.dialog.routeSet.map(s=>`Record-Route: ${s}`));const t=super.accept(e),r=this.dialog,i=Object.assign(Object.assign({},t),{session:r});return e.body&&this.dialog.signalingStateTransition(e.body),this.dialog.reConfirm(),i}progress(e={statusCode:180}){const t=super.progress(e),r=this.dialog,i=Object.assign(Object.assign({},t),{session:r});return e.body&&this.dialog.signalingStateTransition(e.body),i}redirect(e,t={statusCode:302}){throw this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentServer=void 0,new Error("Unimplemented.")}reject(e={statusCode:488}){return this.dialog.signalingStateRollback(),this.dialog.reinviteUserAgentServer=void 0,super.reject(e)}}class PQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.REFER,r);super(vr,e.userAgentCore,i,t)}}function DQ(n){return n.userAgentCore!==void 0}class tR extends Oi{constructor(e,t,r){const i=DQ(e)?e.userAgentCore:e;super(hr,i,t,r)}}class dp extends Ll{constructor(e,t,r,i){super(t,r),this.initialTransaction=e,this._signalingState=ge.Initial,this.ackWait=!1,this.ackProcessing=!1,this.delegate=i,e instanceof Jn&&(this.ackWait=!0),this.early||this.start2xxRetransmissionTimer(),this.signalingStateTransition(e.request),this.logger=t.loggerFactory.getLogger("sip.invite-dialog"),this.logger.log(`INVITE dialog ${this.id} constructed`)}dispose(){super.dispose(),this._signalingState=ge.Closed,this._offer=void 0,this._answer=void 0,this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.logger.log(`INVITE dialog ${this.id} destroyed`)}get sessionState(){return this.early?Tr.Early:this.ackWait?Tr.AckWait:this._signalingState===ge.Closed?Tr.Terminated:Tr.Confirmed}get signalingState(){return this._signalingState}get offer(){return this._offer}get answer(){return this._answer}confirm(){this.early&&this.start2xxRetransmissionTimer(),super.confirm()}reConfirm(){this.reinviteUserAgentServer&&this.startReInvite2xxRetransmissionTimer()}ack(e={}){this.logger.log(`INVITE dialog ${this.id} sending ACK request`);let t;if(this.reinviteUserAgentClient){if(!(this.reinviteUserAgentClient.transaction instanceof Ds))throw new Error("Transaction not instance of InviteClientTransaction.");t=this.reinviteUserAgentClient.transaction,this.reinviteUserAgentClient=void 0}else{if(!(this.initialTransaction instanceof Ds))throw new Error("Initial transaction not instance of InviteClientTransaction.");t=this.initialTransaction}const r=this.createOutgoingRequestMessage(ve.ACK,{cseq:t.request.cseq,extraHeaders:e.extraHeaders,body:e.body});return t.ackResponse(r),this.signalingStateTransition(r),{message:r}}bye(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending BYE request`),this.initialTransaction instanceof Jn){if(this.early)throw new Error("UAS MUST NOT send a BYE on early dialogs.");if(this.ackWait&&this.initialTransaction.state!==W.Terminated)throw new Error("UAS MUST NOT send a BYE on a confirmed dialog until it has received an ACK for its 2xx response or until the server transaction times out.")}return new _Q(this,e,t)}info(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending INFO request`),this.early)throw new Error("Dialog not confirmed.");return new kQ(this,e,t)}invite(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending INVITE request`),this.early)throw new Error("Dialog not confirmed.");if(this.reinviteUserAgentClient)throw new Error("There is an ongoing re-INVITE client transaction.");if(this.reinviteUserAgentServer)throw new Error("There is an ongoing re-INVITE server transaction.");return new IQ(this,e,t)}message(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending MESSAGE request`),this.early)throw new Error("Dialog not confirmed.");const r=this.createOutgoingRequestMessage(ve.MESSAGE,t);return new QM(this.core,r,e)}notify(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending NOTIFY request`),this.early)throw new Error("Dialog not confirmed.");return new TQ(this,e,t)}prack(e,t){return this.logger.log(`INVITE dialog ${this.id} sending PRACK request`),new MQ(this,e,t)}refer(e,t){if(this.logger.log(`INVITE dialog ${this.id} sending REFER request`),this.early)throw new Error("Dialog not confirmed.");return new PQ(this,e,t)}receiveRequest(e){if(this.logger.log(`INVITE dialog ${this.id} received ${e.method} request`),e.method===ve.ACK){if(this.ackWait){if(this.initialTransaction instanceof Ds){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}if(this.initialTransaction.request.cseq!==e.cseq){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}this.ackWait=!1}else{if(!this.reinviteUserAgentServer){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}if(this.reinviteUserAgentServer.transaction.request.cseq!==e.cseq){this.logger.warn(`INVITE dialog ${this.id} received unexpected ${e.method} request, dropping.`);return}this.reinviteUserAgentServer=void 0}if(this.signalingStateTransition(e),this.delegate&&this.delegate.onAck){const t=this.delegate.onAck({message:e});t instanceof Promise&&(this.ackProcessing=!0,t.then(()=>this.ackProcessing=!1).catch(()=>this.ackProcessing=!1))}return}if(!this.sequenceGuard(e)){this.logger.log(`INVITE dialog ${this.id} rejected out of order ${e.method} request.`);return}if(super.receiveRequest(e),e.method===ve.INVITE){const t=()=>{const s=this.ackWait?"waiting for initial ACK":"processing initial ACK";this.logger.warn(`INVITE dialog ${this.id} received re-INVITE while ${s}`);let o="RFC 5407 suggests the following to avoid this race condition... ";o+=" Note: Implementation issues are outside the scope of this document,",o+=" but the following tip is provided for avoiding race conditions of",o+=" this type.  The caller can delay sending re-INVITE F6 for some period",o+=" of time (2 seconds, perhaps), after which the caller can reasonably",o+=" assume that its ACK has been received.  Implementors can decouple the",o+=" actions of the user (e.g., pressing the hold button) from the actions",o+=" of the protocol (the sending of re-INVITE F6), so that the UA can",o+=" behave like this.  In this case, it is the implementor's choice as to",o+=" how long to wait.  In most cases, such an implementation may be",o+=" useful to prevent the type of race condition shown in this section.",o+=" This document expresses no preference about whether or not they",o+=" should wait for an ACK to be delivered.  After considering the impact",o+=" on user experience, implementors should decide whether or not to wait",o+=" for a while, because the user experience depends on the",o+=" implementation and has no direct bearing on protocol behavior.",this.logger.warn(o)},i=[`Retry-After: ${Math.floor(Math.random()*10)+1}`];if(this.ackProcessing){this.core.replyStateless(e,{statusCode:500,extraHeaders:i}),t();return}if(this.ackWait&&this.signalingState!==ge.Stable){this.core.replyStateless(e,{statusCode:500,extraHeaders:i}),t();return}if(this.reinviteUserAgentServer){this.core.replyStateless(e,{statusCode:500,extraHeaders:i});return}if(this.reinviteUserAgentClient){this.core.replyStateless(e,{statusCode:491});return}}if(e.method===ve.INVITE){const t=e.parseHeader("contact");if(!t)throw new Error("Contact undefined.");if(!(t instanceof Wn))throw new Error("Contact not instance of NameAddrHeader.");this.dialogState.remoteTarget=t.uri}switch(e.method){case ve.BYE:{const t=new CQ(this,e);this.delegate&&this.delegate.onBye?this.delegate.onBye(t):t.accept(),this.dispose()}break;case ve.INFO:{const t=new EQ(this,e);this.delegate&&this.delegate.onInfo?this.delegate.onInfo(t):t.reject({statusCode:469,extraHeaders:["Recv-Info:"]})}break;case ve.INVITE:{const t=new OQ(this,e);this.signalingStateTransition(e),this.delegate&&this.delegate.onInvite?this.delegate.onInvite(t):t.reject({statusCode:488})}break;case ve.MESSAGE:{const t=new eR(this.core,e);this.delegate&&this.delegate.onMessage?this.delegate.onMessage(t):t.accept()}break;case ve.NOTIFY:{const t=new up(this,e);this.delegate&&this.delegate.onNotify?this.delegate.onNotify(t):t.accept()}break;case ve.PRACK:{const t=new RQ(this,e);this.delegate&&this.delegate.onPrack?this.delegate.onPrack(t):t.accept()}break;case ve.REFER:{const t=new tR(this,e);this.delegate&&this.delegate.onRefer?this.delegate.onRefer(t):t.reject()}break;default:this.logger.log(`INVITE dialog ${this.id} received unimplemented ${e.method} request`),this.core.replyStateless(e,{statusCode:501});break}}reliableSequenceGuard(e){const t=e.statusCode;if(!t)throw new Error("Status code undefined");if(t>100&&t<200){const r=e.getHeader("require"),i=e.getHeader("rseq"),s=r&&r.includes("100rel")&&i?Number(i):void 0;if(s){if(this.rseq&&this.rseq+1!==s)return!1;this.rseq=this.rseq?this.rseq+1:s}}return!0}signalingStateRollback(){(this._signalingState===ge.HaveLocalOffer||this.signalingState===ge.HaveRemoteOffer)&&this._rollbackOffer&&this._rollbackAnswer&&(this._signalingState=ge.Stable,this._offer=this._rollbackOffer,this._answer=this._rollbackAnswer)}signalingStateTransition(e){const t=bu(e);if(!(!t||t.contentDisposition!=="session")){if(this._signalingState===ge.Stable&&(this._rollbackOffer=this._offer,this._rollbackAnswer=this._answer),e instanceof ul)switch(this._signalingState){case ge.Initial:case ge.Stable:this._signalingState=ge.HaveRemoteOffer,this._offer=t,this._answer=void 0;break;case ge.HaveLocalOffer:this._signalingState=ge.Stable,this._answer=t;break;case ge.HaveRemoteOffer:break;case ge.Closed:break;default:throw new Error("Unexpected signaling state.")}if(e instanceof qs)switch(this._signalingState){case ge.Initial:case ge.Stable:this._signalingState=ge.HaveRemoteOffer,this._offer=t,this._answer=void 0;break;case ge.HaveLocalOffer:this._signalingState=ge.Stable,this._answer=t;break;case ge.HaveRemoteOffer:break;case ge.Closed:break;default:throw new Error("Unexpected signaling state.")}if(e instanceof Yo)switch(this._signalingState){case ge.Initial:case ge.Stable:this._signalingState=ge.HaveLocalOffer,this._offer=t,this._answer=void 0;break;case ge.HaveLocalOffer:break;case ge.HaveRemoteOffer:this._signalingState=ge.Stable,this._answer=t;break;case ge.Closed:break;default:throw new Error("Unexpected signaling state.")}if(JM(e))switch(this._signalingState){case ge.Initial:case ge.Stable:this._signalingState=ge.HaveLocalOffer,this._offer=t,this._answer=void 0;break;case ge.HaveLocalOffer:break;case ge.HaveRemoteOffer:this._signalingState=ge.Stable,this._answer=t;break;case ge.Closed:break;default:throw new Error("Unexpected signaling state.")}}}start2xxRetransmissionTimer(){if(this.initialTransaction instanceof Jn){const e=this.initialTransaction;let t=rn.T1;const r=()=>{if(!this.ackWait){this.invite2xxTimer=void 0;return}this.logger.log("No ACK for 2xx response received, attempting retransmission"),e.retransmitAcceptedResponse(),t=Math.min(t*2,rn.T2),this.invite2xxTimer=setTimeout(r,t)};this.invite2xxTimer=setTimeout(r,t);const i=()=>{e.state===W.Terminated&&(e.removeStateChangeListener(i),this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.ackWait&&(this.delegate&&this.delegate.onAckTimeout?this.delegate.onAckTimeout():this.bye()))};e.addStateChangeListener(i)}}startReInvite2xxRetransmissionTimer(){if(this.reinviteUserAgentServer&&this.reinviteUserAgentServer.transaction instanceof Jn){const e=this.reinviteUserAgentServer.transaction;let t=rn.T1;const r=()=>{if(!this.reinviteUserAgentServer){this.invite2xxTimer=void 0;return}this.logger.log("No ACK for 2xx response received, attempting retransmission"),e.retransmitAcceptedResponse(),t=Math.min(t*2,rn.T2),this.invite2xxTimer=setTimeout(r,t)};this.invite2xxTimer=setTimeout(r,t);const i=()=>{e.state===W.Terminated&&(e.removeStateChangeListener(i),this.invite2xxTimer&&(clearTimeout(this.invite2xxTimer),this.invite2xxTimer=void 0),this.reinviteUserAgentServer)};e.addStateChangeListener(i)}}}class $Q extends xn{constructor(e,t,r){super(Ds,e,t,r),this.confirmedDialogAcks=new Map,this.confirmedDialogs=new Map,this.earlyDialogs=new Map,this.delegate=r}dispose(){this.earlyDialogs.forEach(e=>e.dispose()),this.earlyDialogs.clear(),super.dispose()}onTransportError(e){if(this.transaction.state===W.Calling)return super.onTransportError(e);this.logger.error(e.message),this.logger.error("User agent client request transport error while sending ACK.")}receiveResponse(e){if(!this.authenticationGuard(e))return;const t=e.statusCode?e.statusCode.toString():"";if(!t)throw new Error("Response status code undefined.");switch(!0){case/^100$/.test(t):this.delegate&&this.delegate.onTrying&&this.delegate.onTrying({message:e});return;case/^1[0-9]{2}$/.test(t):{if(!e.toTag){this.logger.warn("Non-100 1xx INVITE response received without a to tag, dropping.");return}if(!e.parseHeader("contact")){this.logger.error("Non-100 1xx INVITE response received without a Contact header field, dropping.");return}const i=Ll.initialDialogStateForUserAgentClient(this.message,e);let s=this.earlyDialogs.get(i.id);if(!s){const a=this.transaction;if(!(a instanceof Ds))throw new Error("Transaction not instance of InviteClientTransaction.");s=new dp(a,this.core,i),this.earlyDialogs.set(s.id,s)}if(!s.reliableSequenceGuard(e)){this.logger.warn("1xx INVITE reliable response received out of order or is a retransmission, dropping.");return}(s.signalingState===ge.Initial||s.signalingState===ge.HaveLocalOffer)&&s.signalingStateTransition(e);const o=s;this.delegate&&this.delegate.onProgress&&this.delegate.onProgress({message:e,session:o,prack:a=>o.prack(void 0,a)})}return;case/^2[0-9]{2}$/.test(t):{if(!e.toTag){this.logger.error("2xx INVITE response received without a to tag, dropping.");return}if(!e.parseHeader("contact")){this.logger.error("2xx INVITE response received without a Contact header field, dropping.");return}const i=Ll.initialDialogStateForUserAgentClient(this.message,e);let s=this.confirmedDialogs.get(i.id);if(s){const a=this.confirmedDialogAcks.get(i.id);if(a){const l=this.transaction;if(!(l instanceof Ds))throw new Error("Client transaction not instance of InviteClientTransaction.");l.ackResponse(a.message)}return}if(s=this.earlyDialogs.get(i.id),s)s.confirm(),s.recomputeRouteSet(e),this.earlyDialogs.delete(s.id),this.confirmedDialogs.set(s.id,s);else{const a=this.transaction;if(!(a instanceof Ds))throw new Error("Transaction not instance of InviteClientTransaction.");s=new dp(a,this.core,i),this.confirmedDialogs.set(s.id,s)}(s.signalingState===ge.Initial||s.signalingState===ge.HaveLocalOffer)&&s.signalingStateTransition(e);const o=s;if(this.delegate&&this.delegate.onAccept)this.delegate.onAccept({message:e,session:o,ack:a=>{const l=o.ack(a);return this.confirmedDialogAcks.set(o.id,l),l}});else{const a=o.ack();this.confirmedDialogAcks.set(o.id,a)}}return;case/^3[0-9]{2}$/.test(t):this.earlyDialogs.forEach(r=>r.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onRedirect&&this.delegate.onRedirect({message:e});return;case/^[4-6][0-9]{2}$/.test(t):this.earlyDialogs.forEach(r=>r.dispose()),this.earlyDialogs.clear(),this.delegate&&this.delegate.onReject&&this.delegate.onReject({message:e});return;default:throw new Error(`Invalid status code ${t}`)}}}class Xg extends Oi{constructor(e,t,r){super(Jn,e,t,r),this.core=e}dispose(){this.earlyDialog&&this.earlyDialog.dispose(),super.dispose()}accept(e={statusCode:200}){if(!this.acceptable)throw new Ms(`${this.message.method} not acceptable in state ${this.transaction.state}.`);if(!this.confirmedDialog)if(this.earlyDialog)this.earlyDialog.confirm(),this.confirmedDialog=this.earlyDialog,this.earlyDialog=void 0;else{const l=this.transaction;if(!(l instanceof Jn))throw new Error("Transaction not instance of InviteClientTransaction.");const c=Ll.initialDialogStateForUserAgentServer(this.message,this.toTag);this.confirmedDialog=new dp(l,this.core,c)}const t=this.message.getHeaders("record-route").map(l=>`Record-Route: ${l}`),r=`Contact: ${this.core.configuration.contact.toString()}`,i="Allow: "+Ps.toString();if(!e.body){if(this.confirmedDialog.signalingState===ge.Stable)e.body=this.confirmedDialog.answer;else if(this.confirmedDialog.signalingState===ge.Initial||this.confirmedDialog.signalingState===ge.HaveRemoteOffer)throw new Error("Response must have a body.")}e.statusCode=e.statusCode||200,e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(t),e.extraHeaders.push(i),e.extraHeaders.push(r);const s=super.accept(e),o=this.confirmedDialog,a=Object.assign(Object.assign({},s),{session:o});return e.body&&this.confirmedDialog.signalingState!==ge.Stable&&this.confirmedDialog.signalingStateTransition(e.body),a}progress(e={statusCode:180}){if(!this.progressable)throw new Ms(`${this.message.method} not progressable in state ${this.transaction.state}.`);if(!this.earlyDialog){const a=this.transaction;if(!(a instanceof Jn))throw new Error("Transaction not instance of InviteClientTransaction.");const l=Ll.initialDialogStateForUserAgentServer(this.message,this.toTag,!0);this.earlyDialog=new dp(a,this.core,l)}const t=this.message.getHeaders("record-route").map(a=>`Record-Route: ${a}`),r=`Contact: ${this.core.configuration.contact}`;e.extraHeaders=e.extraHeaders||[],e.extraHeaders=e.extraHeaders.concat(t),e.extraHeaders.push(r);const i=super.progress(e),s=this.earlyDialog,o=Object.assign(Object.assign({},i),{session:s});return e.body&&this.earlyDialog.signalingState!==ge.Stable&&this.earlyDialog.signalingStateTransition(e.body),o}redirect(e,t={statusCode:302}){return super.redirect(e,t)}reject(e={statusCode:486}){return super.reject(e)}}class NQ extends xn{constructor(e,t,r){super(vr,e,t,r)}}class LQ extends xn{constructor(e,t,r){super(vr,e,t,r)}}class jQ extends Oi{constructor(e,t,r){super(hr,e,t,r),this.core=e}}class FQ extends xn{constructor(e,t,r){const i=e.createOutgoingRequestMessage(ve.SUBSCRIBE,r);super(vr,e.userAgentCore,i,t),this.dialog=e}waitNotifyStop(){}receiveResponse(e){if(e.statusCode&&e.statusCode>=200&&e.statusCode<300){const t=e.getHeader("Expires");if(!t)this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE");else{const r=Number(t);this.dialog.subscriptionExpires>r&&(this.dialog.subscriptionExpires=r)}}e.statusCode&&e.statusCode>=400&&e.statusCode<700&&[404,405,410,416,480,481,482,483,484,485,489,501,604].includes(e.statusCode)&&this.dialog.terminate(),super.receiveResponse(e)}}class n_ extends Ll{constructor(e,t,r,i,s,o){super(i,s),this.delegate=o,this._autoRefresh=!1,this._subscriptionEvent=e,this._subscriptionExpires=t,this._subscriptionExpiresInitial=t,this._subscriptionExpiresLastSet=Math.floor(Date.now()/1e3),this._subscriptionRefresh=void 0,this._subscriptionRefreshLastSet=void 0,this._subscriptionState=r,this.logger=i.loggerFactory.getLogger("sip.subscribe-dialog"),this.logger.log(`SUBSCRIBE dialog ${this.id} constructed`)}static initialDialogStateForSubscription(e,t){const i=t.getHeaders("record-route"),s=t.parseHeader("contact");if(!s)throw new Error("Contact undefined.");if(!(s instanceof Wn))throw new Error("Contact not instance of NameAddrHeader.");const o=s.uri,a=e.cseq,l=void 0,c=e.callId,u=e.fromTag,d=t.fromTag;if(!c)throw new Error("Call id undefined.");if(!u)throw new Error("From tag undefined.");if(!d)throw new Error("To tag undefined.");if(!e.from)throw new Error("From undefined.");if(!e.to)throw new Error("To undefined.");const f=e.from.uri,p=e.to.uri;return{id:c+u+d,early:!1,callId:c,localTag:u,remoteTag:d,localSequenceNumber:a,remoteSequenceNumber:l,localURI:f,remoteURI:p,remoteTarget:o,routeSet:i,secure:!1}}dispose(){super.dispose(),this.N&&(clearTimeout(this.N),this.N=void 0),this.refreshTimerClear(),this.logger.log(`SUBSCRIBE dialog ${this.id} destroyed`)}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=!0,this.refreshTimerSet()}get subscriptionEvent(){return this._subscriptionEvent}get subscriptionExpires(){const e=Math.floor(Date.now()/1e3)-this._subscriptionExpiresLastSet,t=this._subscriptionExpires-e;return Math.max(t,0)}set subscriptionExpires(e){if(e<0)throw new Error("Expires must be greater than or equal to zero.");if(this._subscriptionExpires=e,this._subscriptionExpiresLastSet=Math.floor(Date.now()/1e3),this.autoRefresh){const t=this.subscriptionRefresh;(t===void 0||t>=e)&&this.refreshTimerSet()}}get subscriptionExpiresInitial(){return this._subscriptionExpiresInitial}get subscriptionRefresh(){if(this._subscriptionRefresh===void 0||this._subscriptionRefreshLastSet===void 0)return;const e=Math.floor(Date.now()/1e3)-this._subscriptionRefreshLastSet,t=this._subscriptionRefresh-e;return Math.max(t,0)}get subscriptionState(){return this._subscriptionState}receiveRequest(e){if(this.logger.log(`SUBSCRIBE dialog ${this.id} received ${e.method} request`),!this.sequenceGuard(e)){this.logger.log(`SUBSCRIBE dialog ${this.id} rejected out of order ${e.method} request.`);return}switch(super.receiveRequest(e),e.method){case ve.NOTIFY:this.onNotify(e);break;default:this.logger.log(`SUBSCRIBE dialog ${this.id} received unimplemented ${e.method} request`),this.core.replyStateless(e,{statusCode:501});break}}refresh(){const e="Allow: "+Ps.toString(),t={};return t.extraHeaders=(t.extraHeaders||[]).slice(),t.extraHeaders.push(e),t.extraHeaders.push("Event: "+this.subscriptionEvent),t.extraHeaders.push("Expires: "+this.subscriptionExpiresInitial),t.extraHeaders.push("Contact: "+this.core.configuration.contact.toString()),this.subscribe(void 0,t)}subscribe(e,t={}){var r;if(this.subscriptionState!==it.Pending&&this.subscriptionState!==it.Active)throw new Error(`Invalid state ${this.subscriptionState}. May only re-subscribe while in state "pending" or "active".`);this.logger.log(`SUBSCRIBE dialog ${this.id} sending SUBSCRIBE request`);const i=new FQ(this,e,t);return this.N&&(clearTimeout(this.N),this.N=void 0),!((r=t.extraHeaders)===null||r===void 0)&&r.includes("Expires: 0")||(this.N=setTimeout(()=>this.timerN(),rn.TIMER_N)),i}terminate(){this.stateTransition(it.Terminated),this.onTerminated()}unsubscribe(){const e="Allow: "+Ps.toString(),t={};return t.extraHeaders=(t.extraHeaders||[]).slice(),t.extraHeaders.push(e),t.extraHeaders.push("Event: "+this.subscriptionEvent),t.extraHeaders.push("Expires: 0"),t.extraHeaders.push("Contact: "+this.core.configuration.contact.toString()),this.subscribe(void 0,t)}onNotify(e){const t=e.parseHeader("Event").event;if(!t||t!==this.subscriptionEvent){this.core.replyStateless(e,{statusCode:489});return}this.N&&(clearTimeout(this.N),this.N=void 0);const r=e.parseHeader("Subscription-State");if(!r||!r.state){this.core.replyStateless(e,{statusCode:489});return}const i=r.state,s=r.expires?Math.max(r.expires,0):void 0;switch(i){case"pending":this.stateTransition(it.Pending,s);break;case"active":this.stateTransition(it.Active,s);break;case"terminated":this.stateTransition(it.Terminated,s);break;default:this.logger.warn("Unrecognized subscription state.");break}const o=new up(this,e);this.delegate&&this.delegate.onNotify?this.delegate.onNotify(o):o.accept()}onRefresh(e){this.delegate&&this.delegate.onRefresh&&this.delegate.onRefresh(e)}onTerminated(){this.delegate&&this.delegate.onTerminated&&this.delegate.onTerminated()}refreshTimerClear(){this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=void 0)}refreshTimerSet(){if(this.refreshTimerClear(),this.autoRefresh&&this.subscriptionExpires>0){const e=this.subscriptionExpires*900;this._subscriptionRefresh=Math.floor(e/1e3),this._subscriptionRefreshLastSet=Math.floor(Date.now()/1e3),this.refreshTimer=setTimeout(()=>{this.refreshTimer=void 0,this._subscriptionRefresh=void 0,this._subscriptionRefreshLastSet=void 0,this.onRefresh(this.refresh())},e)}}stateTransition(e,t){const r=()=>{this.logger.warn(`Invalid subscription state transition from ${this.subscriptionState} to ${e}`)};switch(e){case it.Initial:r();return;case it.NotifyWait:r();return;case it.Pending:if(this.subscriptionState!==it.NotifyWait&&this.subscriptionState!==it.Pending){r();return}break;case it.Active:if(this.subscriptionState!==it.NotifyWait&&this.subscriptionState!==it.Pending&&this.subscriptionState!==it.Active){r();return}break;case it.Terminated:if(this.subscriptionState!==it.NotifyWait&&this.subscriptionState!==it.Pending&&this.subscriptionState!==it.Active){r();return}break;default:r();return}e===it.Pending&&t&&(this.subscriptionExpires=t),e===it.Active&&t&&(this.subscriptionExpires=t),e===it.Terminated&&this.dispose(),this._subscriptionState=e}timerN(){this.logger.warn("Timer N expired for SUBSCRIBE dialog. Timed out waiting for NOTIFY."),this.subscriptionState!==it.Terminated&&(this.stateTransition(it.Terminated),this.onTerminated())}}class HQ extends xn{constructor(e,t,r){const i=t.getHeader("Event");if(!i)throw new Error("Event undefined");const s=t.getHeader("Expires");if(!s)throw new Error("Expires undefined");super(vr,e,t,r),this.delegate=r,this.subscriberId=t.callId+t.fromTag+i,this.subscriptionExpiresRequested=this.subscriptionExpires=Number(s),this.subscriptionEvent=i,this.subscriptionState=it.NotifyWait,this.waitNotifyStart()}dispose(){super.dispose()}onNotify(e){const t=e.message.parseHeader("Event").event;if(!t||t!==this.subscriptionEvent){this.logger.warn("Failed to parse event."),e.reject({statusCode:489});return}const r=e.message.parseHeader("Subscription-State");if(!r||!r.state){this.logger.warn("Failed to parse subscription state."),e.reject({statusCode:489});return}const i=r.state;switch(i){case"pending":break;case"active":break;case"terminated":break;default:this.logger.warn(`Invalid subscription state ${i}`),e.reject({statusCode:489});return}if(i!=="terminated"&&!e.message.parseHeader("contact")){this.logger.warn("Failed to parse contact."),e.reject({statusCode:489});return}if(this.dialog)throw new Error("Dialog already created. This implementation only supports install of single subscriptions.");switch(this.waitNotifyStop(),this.subscriptionExpires=r.expires?Math.min(this.subscriptionExpires,Math.max(r.expires,0)):this.subscriptionExpires,i){case"pending":this.subscriptionState=it.Pending;break;case"active":this.subscriptionState=it.Active;break;case"terminated":this.subscriptionState=it.Terminated;break;default:throw new Error(`Unrecognized state ${i}.`)}if(this.subscriptionState!==it.Terminated){const s=n_.initialDialogStateForSubscription(this.message,e.message);this.dialog=new n_(this.subscriptionEvent,this.subscriptionExpires,this.subscriptionState,this.core,s)}if(this.delegate&&this.delegate.onNotify){const s=e,o=this.dialog;this.delegate.onNotify({request:s,subscription:o})}else e.accept()}waitNotifyStart(){this.N||(this.core.subscribers.set(this.subscriberId,this),this.N=setTimeout(()=>this.timerN(),rn.TIMER_N))}waitNotifyStop(){this.N&&(this.core.subscribers.delete(this.subscriberId),clearTimeout(this.N),this.N=void 0)}receiveResponse(e){if(this.authenticationGuard(e)){if(e.statusCode&&e.statusCode>=200&&e.statusCode<300){const t=e.getHeader("Expires");if(!t)this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE");else{const r=Number(t);r>this.subscriptionExpiresRequested&&this.logger.warn("Expires header in a 200-class response to SUBSCRIBE with a higher value than the one in the request"),r<this.subscriptionExpires&&(this.subscriptionExpires=r)}this.dialog&&this.dialog.subscriptionExpires>this.subscriptionExpires&&(this.dialog.subscriptionExpires=this.subscriptionExpires)}e.statusCode&&e.statusCode>=300&&e.statusCode<700&&this.waitNotifyStop(),super.receiveResponse(e)}}timerN(){this.logger.warn("Timer N expired for SUBSCRIBE user agent client. Timed out waiting for NOTIFY."),this.waitNotifyStop(),this.delegate&&this.delegate.onNotifyTimeout&&this.delegate.onNotifyTimeout()}}class BQ extends Oi{constructor(e,t,r){super(hr,e,t,r),this.core=e}}const r_=["application/sdp","application/dtmf-relay"];class zQ{constructor(e,t={}){this.userAgentClients=new Map,this.userAgentServers=new Map,this.configuration=e,this.delegate=t,this.dialogs=new Map,this.subscribers=new Map,this.logger=e.loggerFactory.getLogger("sip.user-agent-core")}dispose(){this.reset()}reset(){this.dialogs.forEach(e=>e.dispose()),this.dialogs.clear(),this.subscribers.forEach(e=>e.dispose()),this.subscribers.clear(),this.userAgentClients.forEach(e=>e.dispose()),this.userAgentClients.clear(),this.userAgentServers.forEach(e=>e.dispose()),this.userAgentServers.clear()}get loggerFactory(){return this.configuration.loggerFactory}get transport(){const e=this.configuration.transportAccessor();if(!e)throw new Error("Transport undefined.");return e}invite(e,t){return new $Q(this,e,t)}message(e,t){return new QM(this,e,t)}publish(e,t){return new NQ(this,e,t)}register(e,t){return new LQ(this,e,t)}subscribe(e,t){return new HQ(this,e,t)}request(e,t){return new xn(vr,this,e,t)}makeOutgoingRequestMessage(e,t,r,i,s,o,a){const l=this.configuration.sipjsId,c=this.configuration.displayName,u=this.configuration.viaForceRport,d=this.configuration.hackViaTcp,f=this.configuration.supportedOptionTags.slice();e===ve.REGISTER&&f.push("path","gruu"),e===ve.INVITE&&(this.configuration.contact.pubGruu||this.configuration.contact.tempGruu)&&f.push("gruu");const p=this.configuration.routeSet,m=this.configuration.userAgentHeaderFieldValue,v=this.configuration.viaHost,b=Object.assign(Object.assign({},{callIdPrefix:l,forceRport:u,fromDisplayName:c,hackViaTcp:d,optionTags:f,routeSet:p,userAgentString:m,viaHost:v}),s);return new Yo(e,t,r,i,b,o,a)}receiveIncomingRequestFromTransport(e){this.receiveRequestFromTransport(e)}receiveIncomingResponseFromTransport(e){this.receiveResponseFromTransport(e)}replyStateless(e,t){const r=this.configuration.userAgentHeaderFieldValue,i=this.configuration.supportedOptionTagsResponse;t=Object.assign(Object.assign({},t),{userAgent:r,supported:i});const s=YM(e,t);return this.transport.send(s.message).catch(o=>{o instanceof Error&&this.logger.error(o.message),this.logger.error(`Transport error occurred sending stateless reply to ${e.method} request.`)}),s}receiveRequestFromTransport(e){const t=e.viaBranch,r=this.userAgentServers.get(t);if(e.method===ve.ACK&&r&&r.transaction.state===W.Accepted&&r instanceof Xg){this.logger.warn(`Discarding out of dialog ACK after 2xx response sent on transaction ${t}.`);return}if(e.method===ve.CANCEL){r?(this.replyStateless(e,{statusCode:200}),r.transaction instanceof Jn&&r.transaction.state===W.Proceeding&&r instanceof Xg&&r.receiveCancel(e)):this.replyStateless(e,{statusCode:481});return}if(r){r.transaction.receiveRequest(e);return}this.receiveRequest(e)}receiveRequest(e){if(!Ps.includes(e.method)){const i="Allow: "+Ps.toString();this.replyStateless(e,{statusCode:405,extraHeaders:[i]});return}if(!e.ruri)throw new Error("Request-URI undefined.");if(e.ruri.scheme!=="sip"){this.replyStateless(e,{statusCode:416});return}const t=e.ruri,r=i=>!!i&&i.user===t.user;if(!r(this.configuration.aor)&&!(r(this.configuration.contact.uri)||r(this.configuration.contact.pubGruu)||r(this.configuration.contact.tempGruu))){this.logger.warn("Request-URI does not point to us."),e.method!==ve.ACK&&this.replyStateless(e,{statusCode:404});return}if(e.method===ve.INVITE&&!e.hasHeader("Contact")){this.replyStateless(e,{statusCode:400,reasonPhrase:"Missing Contact Header"});return}if(!e.toTag){const i=e.viaBranch;if(!this.userAgentServers.has(i)&&Array.from(this.userAgentServers.values()).some(o=>o.transaction.request.fromTag===e.fromTag&&o.transaction.request.callId===e.callId&&o.transaction.request.cseq===e.cseq)){this.replyStateless(e,{statusCode:482});return}}e.toTag?this.receiveInsideDialogRequest(e):this.receiveOutsideDialogRequest(e)}receiveInsideDialogRequest(e){if(e.method===ve.NOTIFY){const i=e.parseHeader("Event");if(!i||!i.event){this.replyStateless(e,{statusCode:489});return}const s=e.callId+e.toTag+i.event,o=this.subscribers.get(s);if(o){const a=new up(this,e);o.onNotify(a);return}}const t=e.callId+e.toTag+e.fromTag,r=this.dialogs.get(t);if(r){if(e.method===ve.OPTIONS){const i="Allow: "+Ps.toString(),s="Accept: "+r_.toString();this.replyStateless(e,{statusCode:200,extraHeaders:[i,s]});return}r.receiveRequest(e);return}e.method!==ve.ACK&&this.replyStateless(e,{statusCode:481})}receiveOutsideDialogRequest(e){switch(e.method){case ve.ACK:break;case ve.BYE:this.replyStateless(e,{statusCode:481});break;case ve.CANCEL:throw new Error(`Unexpected out of dialog request method ${e.method}.`);case ve.INFO:this.replyStateless(e,{statusCode:405});break;case ve.INVITE:{const t=new Xg(this,e);this.delegate.onInvite?this.delegate.onInvite(t):t.reject()}break;case ve.MESSAGE:{const t=new eR(this,e);this.delegate.onMessage?this.delegate.onMessage(t):t.accept()}break;case ve.NOTIFY:{const t=new up(this,e);this.delegate.onNotify?this.delegate.onNotify(t):t.reject({statusCode:405})}break;case ve.OPTIONS:{const t="Allow: "+Ps.toString(),r="Accept: "+r_.toString();this.replyStateless(e,{statusCode:200,extraHeaders:[t,r]})}break;case ve.REFER:{const t=new tR(this,e);this.delegate.onRefer?this.delegate.onRefer(t):t.reject({statusCode:405})}break;case ve.REGISTER:{const t=new jQ(this,e);this.delegate.onRegister?this.delegate.onRegister(t):t.reject({statusCode:405})}break;case ve.SUBSCRIBE:{const t=new BQ(this,e);this.delegate.onSubscribe?this.delegate.onSubscribe(t):t.reject({statusCode:480})}break;default:throw new Error(`Unexpected out of dialog request method ${e.method}.`)}}receiveResponseFromTransport(e){if(e.getHeaders("via").length>1){this.logger.warn("More than one Via header field present in the response, dropping");return}const t=e.viaBranch+e.method,r=this.userAgentClients.get(t);r?r.transaction.receiveResponse(e):this.logger.warn(`Discarding unmatched ${e.statusCode} response to ${e.method} ${t}.`)}}function VQ(){return n=>!n.audio&&!n.video?Promise.resolve(new MediaStream):navigator.mediaDevices===void 0?Promise.reject(new Error("Media devices not available in insecure contexts.")):navigator.mediaDevices.getUserMedia.call(navigator.mediaDevices,n)}function qQ(){return{bundlePolicy:"balanced",certificates:void 0,iceCandidatePoolSize:0,iceServers:[{urls:"stun:stun.l.google.com:19302"}],iceTransportPolicy:"all",rtcpMuxPolicy:"require"}}class Fi{constructor(e,t,r){e.debug("SessionDescriptionHandler.constructor"),this.logger=e,this.mediaStreamFactory=t,this.sessionDescriptionHandlerConfiguration=r,this._localMediaStream=new MediaStream,this._remoteMediaStream=new MediaStream,this._peerConnection=new RTCPeerConnection(r==null?void 0:r.peerConnectionConfiguration),this.initPeerConnectionEventHandlers()}get localMediaStream(){return this._localMediaStream}get remoteMediaStream(){return this._remoteMediaStream}get dataChannel(){return this._dataChannel}get peerConnection(){return this._peerConnection}get peerConnectionDelegate(){return this._peerConnectionDelegate}set peerConnectionDelegate(e){this._peerConnectionDelegate=e}static dispatchAddTrackEvent(e,t){e.dispatchEvent(new MediaStreamTrackEvent("addtrack",{track:t}))}static dispatchRemoveTrackEvent(e,t){e.dispatchEvent(new MediaStreamTrackEvent("removetrack",{track:t}))}close(){this.logger.debug("SessionDescriptionHandler.close"),this._peerConnection!==void 0&&(this._peerConnection.getReceivers().forEach(e=>{e.track&&e.track.stop()}),this._peerConnection.getSenders().forEach(e=>{e.track&&e.track.stop()}),this._dataChannel&&this._dataChannel.close(),this._peerConnection.close(),this._peerConnection=void 0)}enableReceiverTracks(e){const t=this.peerConnection;if(!t)throw new Error("Peer connection closed.");t.getReceivers().forEach(r=>{r.track&&(r.track.enabled=e)})}enableSenderTracks(e){const t=this.peerConnection;if(!t)throw new Error("Peer connection closed.");t.getSenders().forEach(r=>{r.track&&(r.track.enabled=e)})}getDescription(e,t){var r,i;if(this.logger.debug("SessionDescriptionHandler.getDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));this.onDataChannel=e==null?void 0:e.onDataChannel;const s=(r=e==null?void 0:e.offerOptions)===null||r===void 0?void 0:r.iceRestart,o=(e==null?void 0:e.iceGatheringTimeout)===void 0?(i=this.sessionDescriptionHandlerConfiguration)===null||i===void 0?void 0:i.iceGatheringTimeout:e==null?void 0:e.iceGatheringTimeout;return this.getLocalMediaStream(e).then(()=>this.updateDirection(e)).then(()=>this.createDataChannel(e)).then(()=>this.createLocalOfferOrAnswer(e)).then(a=>this.applyModifiers(a,t)).then(a=>this.setLocalSessionDescription(a)).then(()=>this.waitForIceGatheringComplete(s,o)).then(()=>this.getLocalSessionDescription()).then(a=>({body:a.sdp,contentType:"application/sdp"})).catch(a=>{throw this.logger.error("SessionDescriptionHandler.getDescription failed - "+a),a})}hasDescription(e){return this.logger.debug("SessionDescriptionHandler.hasDescription"),e==="application/sdp"}iceGatheringComplete(){this.logger.debug("SessionDescriptionHandler.iceGatheringComplete"),this.iceGatheringCompleteTimeoutId!==void 0&&(this.logger.debug("SessionDescriptionHandler.iceGatheringComplete - clearing timeout"),clearTimeout(this.iceGatheringCompleteTimeoutId),this.iceGatheringCompleteTimeoutId=void 0),this.iceGatheringCompletePromise!==void 0&&(this.logger.debug("SessionDescriptionHandler.iceGatheringComplete - resolving promise"),this.iceGatheringCompleteResolve&&this.iceGatheringCompleteResolve(),this.iceGatheringCompletePromise=void 0,this.iceGatheringCompleteResolve=void 0,this.iceGatheringCompleteReject=void 0)}sendDtmf(e,t){if(this.logger.debug("SessionDescriptionHandler.sendDtmf"),this._peerConnection===void 0)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - peer connection closed"),!1;const r=this._peerConnection.getSenders();if(r.length===0)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - no senders"),!1;const i=r[0].dtmf;if(!i)return this.logger.error("SessionDescriptionHandler.sendDtmf failed - no DTMF sender"),!1;const s=t==null?void 0:t.duration,o=t==null?void 0:t.interToneGap;try{i.insertDTMF(e,s,o)}catch(a){return this.logger.error(a.toString()),!1}return this.logger.log("SessionDescriptionHandler.sendDtmf sent via RTP: "+e.toString()),!0}setDescription(e,t,r){if(this.logger.debug("SessionDescriptionHandler.setDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));this.onDataChannel=t==null?void 0:t.onDataChannel;const i=this._peerConnection.signalingState==="have-local-offer"?"answer":"offer";return this.getLocalMediaStream(t).then(()=>this.applyModifiers({sdp:e,type:i},r)).then(s=>this.setRemoteSessionDescription(s)).catch(s=>{throw this.logger.error("SessionDescriptionHandler.setDescription failed - "+s),s})}applyModifiers(e,t){return this.logger.debug("SessionDescriptionHandler.applyModifiers"),!t||t.length===0?Promise.resolve(e):t.reduce((r,i)=>r.then(i),Promise.resolve(e)).then(r=>{if(this.logger.debug("SessionDescriptionHandler.applyModifiers - modified sdp"),!r.sdp||!r.type)throw new Error("Invalid SDP.");return{sdp:r.sdp,type:r.type}})}createDataChannel(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));if((e==null?void 0:e.dataChannel)!==!0||this._dataChannel)return Promise.resolve();switch(this._peerConnection.signalingState){case"stable":this.logger.debug("SessionDescriptionHandler.createDataChannel - creating data channel");try{return this._dataChannel=this._peerConnection.createDataChannel((e==null?void 0:e.dataChannelLabel)||"",e==null?void 0:e.dataChannelOptions),this.onDataChannel&&this.onDataChannel(this._dataChannel),Promise.resolve()}catch(t){return Promise.reject(t)}case"have-remote-offer":return Promise.resolve();case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}}createLocalOfferOrAnswer(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));switch(this._peerConnection.signalingState){case"stable":return this.logger.debug("SessionDescriptionHandler.createLocalOfferOrAnswer - creating SDP offer"),this._peerConnection.createOffer(e==null?void 0:e.offerOptions);case"have-remote-offer":return this.logger.debug("SessionDescriptionHandler.createLocalOfferOrAnswer - creating SDP answer"),this._peerConnection.createAnswer(e==null?void 0:e.answerOptions);case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}}getLocalMediaStream(e){if(this.logger.debug("SessionDescriptionHandler.getLocalMediaStream"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));let t=Object.assign({},e==null?void 0:e.constraints);if(this.localMediaStreamConstraints){if(t.audio=t.audio||this.localMediaStreamConstraints.audio,t.video=t.video||this.localMediaStreamConstraints.video,JSON.stringify(this.localMediaStreamConstraints.audio)===JSON.stringify(t.audio)&&JSON.stringify(this.localMediaStreamConstraints.video)===JSON.stringify(t.video))return Promise.resolve()}else t.audio===void 0&&t.video===void 0&&(t={audio:!0});return this.localMediaStreamConstraints=t,this.mediaStreamFactory(t,this,e).then(r=>this.setLocalMediaStream(r))}setLocalMediaStream(e){if(this.logger.debug("SessionDescriptionHandler.setLocalMediaStream"),!this._peerConnection)throw new Error("Peer connection undefined.");const t=this._peerConnection,r=this._localMediaStream,i=[],s=l=>{const c=l.kind;if(c!=="audio"&&c!=="video")throw new Error(`Unknown new track kind ${c}.`);const u=t.getSenders().find(d=>d.track&&d.track.kind===c);u?i.push(new Promise(d=>{this.logger.debug(`SessionDescriptionHandler.setLocalMediaStream - replacing sender ${c} track`),d()}).then(()=>u.replaceTrack(l).then(()=>{const d=r.getTracks().find(f=>f.kind===c);d&&(d.stop(),r.removeTrack(d),Fi.dispatchRemoveTrackEvent(r,d)),r.addTrack(l),Fi.dispatchAddTrackEvent(r,l)}).catch(d=>{throw this.logger.error(`SessionDescriptionHandler.setLocalMediaStream - failed to replace sender ${c} track`),d}))):i.push(new Promise(d=>{this.logger.debug(`SessionDescriptionHandler.setLocalMediaStream - adding sender ${c} track`),d()}).then(()=>{try{t.addTrack(l,r)}catch(d){throw this.logger.error(`SessionDescriptionHandler.setLocalMediaStream - failed to add sender ${c} track`),d}r.addTrack(l),Fi.dispatchAddTrackEvent(r,l)}))},o=e.getAudioTracks();o.length&&s(o[0]);const a=e.getVideoTracks();return a.length&&s(a[0]),i.reduce((l,c)=>l.then(()=>c),Promise.resolve())}getLocalSessionDescription(){if(this.logger.debug("SessionDescriptionHandler.getLocalSessionDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));const e=this._peerConnection.localDescription;return e?Promise.resolve(e):Promise.reject(new Error("Failed to get local session description"))}setLocalSessionDescription(e){return this.logger.debug("SessionDescriptionHandler.setLocalSessionDescription"),this._peerConnection===void 0?Promise.reject(new Error("Peer connection closed.")):this._peerConnection.setLocalDescription(e)}setRemoteSessionDescription(e){if(this.logger.debug("SessionDescriptionHandler.setRemoteSessionDescription"),this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));const t=e.sdp;let r;switch(this._peerConnection.signalingState){case"stable":r="offer";break;case"have-local-offer":r="answer";break;case"have-local-pranswer":case"have-remote-offer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}return t?this._peerConnection.setRemoteDescription({sdp:t,type:r}):(this.logger.error("SessionDescriptionHandler.setRemoteSessionDescription failed - cannot set null sdp"),Promise.reject(new Error("SDP is undefined")))}setRemoteTrack(e){this.logger.debug("SessionDescriptionHandler.setRemoteTrack");const t=this._remoteMediaStream;t.getTrackById(e.id)?this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - have remote ${e.kind} track`):e.kind==="audio"?(this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - adding remote ${e.kind} track`),t.getAudioTracks().forEach(r=>{r.stop(),t.removeTrack(r),Fi.dispatchRemoveTrackEvent(t,r)}),t.addTrack(e),Fi.dispatchAddTrackEvent(t,e)):e.kind==="video"&&(this.logger.debug(`SessionDescriptionHandler.setRemoteTrack - adding remote ${e.kind} track`),t.getVideoTracks().forEach(r=>{r.stop(),t.removeTrack(r),Fi.dispatchRemoveTrackEvent(t,r)}),t.addTrack(e),Fi.dispatchAddTrackEvent(t,e))}updateDirection(e){if(this._peerConnection===void 0)return Promise.reject(new Error("Peer connection closed."));switch(this._peerConnection.signalingState){case"stable":this.logger.debug("SessionDescriptionHandler.updateDirection - setting offer direction");{const t=r=>{switch(r){case"inactive":return e!=null&&e.hold?"inactive":"recvonly";case"recvonly":return e!=null&&e.hold?"inactive":"recvonly";case"sendonly":return e!=null&&e.hold?"sendonly":"sendrecv";case"sendrecv":return e!=null&&e.hold?"sendonly":"sendrecv";case"stopped":return"stopped";default:throw new Error("Should never happen")}};this._peerConnection.getTransceivers().forEach(r=>{if(r.direction){const i=t(r.direction);r.direction!==i&&(r.direction=i)}})}break;case"have-remote-offer":this.logger.debug("SessionDescriptionHandler.updateDirection - setting answer direction");{const t=(()=>{const i=this._peerConnection.remoteDescription;if(!i)throw new Error("Failed to read remote offer");const s=/a=sendrecv\r\n|a=sendonly\r\n|a=recvonly\r\n|a=inactive\r\n/.exec(i.sdp);if(s)switch(s[0]){case`a=inactive\r
`:return"inactive";case`a=recvonly\r
`:return"recvonly";case`a=sendonly\r
`:return"sendonly";case`a=sendrecv\r
`:return"sendrecv";default:throw new Error("Should never happen")}return"sendrecv"})(),r=(()=>{switch(t){case"inactive":return"inactive";case"recvonly":return"sendonly";case"sendonly":return e!=null&&e.hold?"inactive":"recvonly";case"sendrecv":return e!=null&&e.hold?"sendonly":"sendrecv";default:throw new Error("Should never happen")}})();this._peerConnection.getTransceivers().forEach(i=>{i.direction&&i.direction!=="stopped"&&i.direction!==r&&(i.direction=r)})}break;case"have-local-offer":case"have-local-pranswer":case"have-remote-pranswer":case"closed":default:return Promise.reject(new Error("Invalid signaling state "+this._peerConnection.signalingState))}return Promise.resolve()}waitForIceGatheringComplete(e=!1,t=0){return this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete"),this._peerConnection===void 0?Promise.reject("Peer connection closed."):!e&&this._peerConnection.iceGatheringState==="complete"?(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - already complete"),Promise.resolve()):(this.iceGatheringCompletePromise!==void 0&&(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - rejecting prior waiting promise"),this.iceGatheringCompleteReject&&this.iceGatheringCompleteReject(new Error("Promise superseded.")),this.iceGatheringCompletePromise=void 0,this.iceGatheringCompleteResolve=void 0,this.iceGatheringCompleteReject=void 0),this.iceGatheringCompletePromise=new Promise((r,i)=>{this.iceGatheringCompleteResolve=r,this.iceGatheringCompleteReject=i,t>0&&(this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - timeout in "+t),this.iceGatheringCompleteTimeoutId=setTimeout(()=>{this.logger.debug("SessionDescriptionHandler.waitForIceGatheringToComplete - timeout"),this.iceGatheringComplete()},t))}),this.iceGatheringCompletePromise)}initPeerConnectionEventHandlers(){if(this.logger.debug("SessionDescriptionHandler.initPeerConnectionEventHandlers"),!this._peerConnection)throw new Error("Peer connection undefined.");const e=this._peerConnection;e.onconnectionstatechange=t=>{var r;const i=e.connectionState;this.logger.debug(`SessionDescriptionHandler.onconnectionstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onconnectionstatechange&&this._peerConnectionDelegate.onconnectionstatechange(t)},e.ondatachannel=t=>{var r;this.logger.debug("SessionDescriptionHandler.ondatachannel"),this._dataChannel=t.channel,this.onDataChannel&&this.onDataChannel(this._dataChannel),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.ondatachannel&&this._peerConnectionDelegate.ondatachannel(t)},e.onicecandidate=t=>{var r;this.logger.debug("SessionDescriptionHandler.onicecandidate"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicecandidate&&this._peerConnectionDelegate.onicecandidate(t)},e.onicecandidateerror=t=>{var r;this.logger.debug("SessionDescriptionHandler.onicecandidateerror"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicecandidateerror&&this._peerConnectionDelegate.onicecandidateerror(t)},e.oniceconnectionstatechange=t=>{var r;const i=e.iceConnectionState;this.logger.debug(`SessionDescriptionHandler.oniceconnectionstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.oniceconnectionstatechange&&this._peerConnectionDelegate.oniceconnectionstatechange(t)},e.onicegatheringstatechange=t=>{var r;const i=e.iceGatheringState;this.logger.debug(`SessionDescriptionHandler.onicegatheringstatechange ${i}`),i==="complete"&&this.iceGatheringComplete(),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onicegatheringstatechange&&this._peerConnectionDelegate.onicegatheringstatechange(t)},e.onnegotiationneeded=t=>{var r;this.logger.debug("SessionDescriptionHandler.onnegotiationneeded"),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onnegotiationneeded&&this._peerConnectionDelegate.onnegotiationneeded(t)},e.onsignalingstatechange=t=>{var r;const i=e.signalingState;this.logger.debug(`SessionDescriptionHandler.onsignalingstatechange ${i}`),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.onsignalingstatechange&&this._peerConnectionDelegate.onsignalingstatechange(t)},e.ontrack=t=>{var r;const i=t.track.kind,s=t.track.enabled?"enabled":"disabled";this.logger.debug(`SessionDescriptionHandler.ontrack ${i} ${s}`),this.setRemoteTrack(t.track),!((r=this._peerConnectionDelegate)===null||r===void 0)&&r.ontrack&&this._peerConnectionDelegate.ontrack(t)}}}function UQ(n){return(e,t)=>{n===void 0&&(n=VQ());const i={iceGatheringTimeout:(t==null?void 0:t.iceGatheringTimeout)!==void 0?t==null?void 0:t.iceGatheringTimeout:5e3,peerConnectionConfiguration:Object.assign(Object.assign({},qQ()),t==null?void 0:t.peerConnectionConfiguration)},s=e.userAgent.getLogger("sip.SessionDescriptionHandler");return new Fi(s,n,i)}}class dm{constructor(e,t){if(this._state=Me.Disconnected,this.transitioningState=!1,this._stateEventEmitter=new Yu,this.logger=e,t){const s=t,o=s==null?void 0:s.wsServers,a=s==null?void 0:s.maxReconnectionAttempts;o!==void 0&&this.logger.warn('The transport option "wsServers" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),a!==void 0&&this.logger.warn('The transport option "maxReconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),o&&!t.server&&(typeof o=="string"&&(t.server=o),o instanceof Array&&(t.server=o[0]))}this.configuration=Object.assign(Object.assign({},dm.defaultOptions),t);const r=this.configuration.server,i=Gt.parse(r,"absoluteURI");if(i===-1)throw this.logger.error(`Invalid WebSocket Server URL "${r}"`),new Error("Invalid WebSocket Server URL");if(!["wss","ws","udp"].includes(i.scheme))throw this.logger.error(`Invalid scheme in WebSocket Server URL "${r}"`),new Error("Invalid scheme in WebSocket Server URL");this._protocol=i.scheme.toUpperCase()}dispose(){return this.disconnect()}get protocol(){return this._protocol}get server(){return this.configuration.server}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get ws(){return this._ws}connect(){return this._connect()}disconnect(){return this._disconnect()}isConnected(){return this.state===Me.Connected}send(e){return this._send(e)}_connect(){switch(this.logger.log(`Connecting ${this.server}`),this.state){case Me.Connecting:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(Me.Connecting));if(!this.connectPromise)throw new Error("Connect promise must be defined.");return this.connectPromise;case Me.Connected:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(Me.Connecting));if(this.connectPromise)throw new Error("Connect promise must not be defined.");return Promise.resolve();case Me.Disconnecting:if(this.connectPromise)throw new Error("Connect promise must not be defined.");try{this.transitionState(Me.Connecting)}catch(t){if(t instanceof rc)return Promise.reject(t);throw t}break;case Me.Disconnected:if(this.connectPromise)throw new Error("Connect promise must not be defined.");try{this.transitionState(Me.Connecting)}catch(t){if(t instanceof rc)return Promise.reject(t);throw t}break;default:throw new Error("Unknown state")}let e;try{e=new WebSocket(this.server,"sip"),e.binaryType="arraybuffer",e.addEventListener("close",t=>this.onWebSocketClose(t,e)),e.addEventListener("error",t=>this.onWebSocketError(t,e)),e.addEventListener("open",t=>this.onWebSocketOpen(t,e)),e.addEventListener("message",t=>this.onWebSocketMessage(t,e)),this._ws=e}catch(t){return this._ws=void 0,this.logger.error("WebSocket construction failed."),this.logger.error(t.toString()),new Promise((r,i)=>{this.connectResolve=r,this.connectReject=i,this.transitionState(Me.Disconnected,t)})}return this.connectPromise=new Promise((t,r)=>{this.connectResolve=t,this.connectReject=r,this.connectTimeout=setTimeout(()=>{this.logger.warn("Connect timed out. Exceeded time set in configuration.connectionTimeout: "+this.configuration.connectionTimeout+"s."),e.close(1e3)},this.configuration.connectionTimeout*1e3)}),this.connectPromise}_disconnect(){switch(this.logger.log(`Disconnecting ${this.server}`),this.state){case Me.Connecting:if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");try{this.transitionState(Me.Disconnecting)}catch(t){if(t instanceof rc)return Promise.reject(t);throw t}break;case Me.Connected:if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");try{this.transitionState(Me.Disconnecting)}catch(t){if(t instanceof rc)return Promise.reject(t);throw t}break;case Me.Disconnecting:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(Me.Disconnecting));if(!this.disconnectPromise)throw new Error("Disconnect promise must be defined.");return this.disconnectPromise;case Me.Disconnected:if(this.transitioningState)return Promise.reject(this.transitionLoopDetectedError(Me.Disconnecting));if(this.disconnectPromise)throw new Error("Disconnect promise must not be defined.");return Promise.resolve();default:throw new Error("Unknown state")}if(!this._ws)throw new Error("WebSocket must be defined.");const e=this._ws;return this.disconnectPromise=new Promise((t,r)=>{this.disconnectResolve=t,this.disconnectReject=r;try{e.close(1e3)}catch(i){throw this.logger.error("WebSocket close failed."),this.logger.error(i.toString()),i}}),this.disconnectPromise}_send(e){if(this.configuration.traceSip===!0&&this.logger.log(`Sending WebSocket message:

`+e+`
`),this._state!==Me.Connected)return Promise.reject(new Error("Not connected."));if(!this._ws)throw new Error("WebSocket undefined.");try{this._ws.send(e)}catch(t){return t instanceof Error?Promise.reject(t):Promise.reject(new Error("WebSocket send failed."))}return Promise.resolve()}onWebSocketClose(e,t){if(t!==this._ws)return;const r=`WebSocket closed ${this.server} (code: ${e.code})`,i=this.disconnectPromise?void 0:new Error(r);i&&this.logger.warn("WebSocket closed unexpectedly"),this.logger.log(r),this._ws=void 0,this.transitionState(Me.Disconnected,i)}onWebSocketError(e,t){t===this._ws&&this.logger.error("WebSocket error occurred.")}onWebSocketMessage(e,t){if(t!==this._ws)return;const r=e.data;let i;if(/^(\r\n)+$/.test(r)){this.clearKeepAliveTimeout(),this.configuration.traceSip===!0&&this.logger.log("Received WebSocket message with CRLF Keep Alive response");return}if(!r){this.logger.warn("Received empty message, discarding...");return}if(typeof r!="string"){try{i=new TextDecoder().decode(new Uint8Array(r))}catch(s){this.logger.error(s.toString()),this.logger.error("Received WebSocket binary message failed to be converted into string, message discarded");return}this.configuration.traceSip===!0&&this.logger.log(`Received WebSocket binary message:

`+i+`
`)}else i=r,this.configuration.traceSip===!0&&this.logger.log(`Received WebSocket text message:

`+i+`
`);if(this.state!==Me.Connected){this.logger.warn("Received message while not connected, discarding...");return}if(this.onMessage)try{this.onMessage(i)}catch(s){throw this.logger.error(s.toString()),this.logger.error("Exception thrown by onMessage callback"),s}}onWebSocketOpen(e,t){t===this._ws&&this._state===Me.Connecting&&(this.logger.log(`WebSocket opened ${this.server}`),this.transitionState(Me.Connected))}transitionLoopDetectedError(e){let t="A state transition loop has been detected.";return t+=` An attempt to transition from ${this._state} to ${e} before the prior transition completed.`,t+=" Perhaps you are synchronously calling connect() or disconnect() from a callback or state change handler?",this.logger.error(t),new rc("Loop detected.")}transitionState(e,t){const r=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};if(this.transitioningState)throw this.transitionLoopDetectedError(e);switch(this.transitioningState=!0,this._state){case Me.Connecting:e!==Me.Connected&&e!==Me.Disconnecting&&e!==Me.Disconnected&&r();break;case Me.Connected:e!==Me.Disconnecting&&e!==Me.Disconnected&&r();break;case Me.Disconnecting:e!==Me.Connecting&&e!==Me.Disconnected&&r();break;case Me.Disconnected:e!==Me.Connecting&&r();break;default:throw new Error("Unknown state.")}const i=this._state;this._state=e;const s=this.connectResolve,o=this.connectReject;i===Me.Connecting&&(this.connectPromise=void 0,this.connectResolve=void 0,this.connectReject=void 0);const a=this.disconnectResolve,l=this.disconnectReject;if(i===Me.Disconnecting&&(this.disconnectPromise=void 0,this.disconnectResolve=void 0,this.disconnectReject=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.logger.log(`Transitioned from ${i} to ${this._state}`),this._stateEventEmitter.emit(this._state),e===Me.Connected&&(this.startSendingKeepAlives(),this.onConnect))try{this.onConnect()}catch(c){throw this.logger.error(c.toString()),this.logger.error("Exception thrown by onConnect callback"),c}if(i===Me.Connected&&(this.stopSendingKeepAlives(),this.onDisconnect))try{t?this.onDisconnect(t):this.onDisconnect()}catch(c){throw this.logger.error(c.toString()),this.logger.error("Exception thrown by onDisconnect callback"),c}if(i===Me.Connecting){if(!s)throw new Error("Connect resolve undefined.");if(!o)throw new Error("Connect reject undefined.");e===Me.Connected?s():o(t||new Error("Connect aborted."))}if(i===Me.Disconnecting){if(!a)throw new Error("Disconnect resolve undefined.");if(!l)throw new Error("Disconnect reject undefined.");e===Me.Disconnected?a():l(t||new Error("Disconnect aborted."))}this.transitioningState=!1}clearKeepAliveTimeout(){this.keepAliveDebounceTimeout&&clearTimeout(this.keepAliveDebounceTimeout),this.keepAliveDebounceTimeout=void 0}sendKeepAlive(){return this.keepAliveDebounceTimeout?Promise.resolve():(this.keepAliveDebounceTimeout=setTimeout(()=>{this.clearKeepAliveTimeout()},this.configuration.keepAliveDebounce*1e3),this.send(`\r
\r
`))}startSendingKeepAlives(){const e=t=>{const r=t*.8;return 1e3*(Math.random()*(t-r)+r)};this.configuration.keepAliveInterval&&!this.keepAliveInterval&&(this.keepAliveInterval=setInterval(()=>{this.sendKeepAlive(),this.startSendingKeepAlives()},e(this.configuration.keepAliveInterval)))}stopSendingKeepAlives(){this.keepAliveInterval&&clearInterval(this.keepAliveInterval),this.keepAliveDebounceTimeout&&clearTimeout(this.keepAliveDebounceTimeout),this.keepAliveInterval=void 0,this.keepAliveDebounceTimeout=void 0}}dm.defaultOptions={server:"",connectionTimeout:5,keepAliveInterval:0,keepAliveDebounce:10,traceSip:!0};class Bi{constructor(e={}){if(this._publishers={},this._registerers={},this._sessions={},this._subscriptions={},this._state=on.Stopped,this._stateEventEmitter=new Yu,this.delegate=e.delegate,this.options=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Bi.defaultOptions()),{sipjsId:Po(5)}),{uri:new wi("sip","anonymous."+Po(6),"anonymous.invalid")}),{viaHost:Po(12)+".invalid"}),Bi.stripUndefinedProperties(e)),this.options.hackIpInContact)if(typeof this.options.hackIpInContact=="boolean"&&this.options.hackIpInContact){const i=Math.floor(Math.random()*254+1);this.options.viaHost="192.0.2."+i}else this.options.hackIpInContact&&(this.options.viaHost=this.options.hackIpInContact);switch(this.loggerFactory=new SQ,this.logger=this.loggerFactory.getLogger("sip.UserAgent"),this.loggerFactory.builtinEnabled=this.options.logBuiltinEnabled,this.loggerFactory.connector=this.options.logConnector,this.options.logLevel){case"error":this.loggerFactory.level=tn.error;break;case"warn":this.loggerFactory.level=tn.warn;break;case"log":this.loggerFactory.level=tn.log;break;case"debug":this.loggerFactory.level=tn.debug;break}if(this.options.logConfiguration&&(this.logger.log("Configuration:"),Object.keys(this.options).forEach(t=>{const r=this.options[t];switch(t){case"uri":case"sessionDescriptionHandlerFactory":this.logger.log(" "+t+": "+r);break;case"authorizationPassword":this.logger.log(" "+t+": NOT SHOWN");break;case"transportConstructor":this.logger.log(" "+t+": "+r.name);break;default:this.logger.log(" "+t+": "+JSON.stringify(r))}})),this.options.transportOptions){const t=this.options.transportOptions,r=t.maxReconnectionAttempts,i=t.reconnectionTimeout;r!==void 0&&this.logger.warn('The transport option "maxReconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),i!==void 0&&this.logger.warn('The transport option "reconnectionTimeout" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),e.reconnectionDelay===void 0&&i!==void 0&&(this.options.reconnectionDelay=i),e.reconnectionAttempts===void 0&&r!==void 0&&(this.options.reconnectionAttempts=r)}if(e.reconnectionDelay!==void 0&&this.logger.warn('The user agent option "reconnectionDelay" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),e.reconnectionAttempts!==void 0&&this.logger.warn('The user agent option "reconnectionAttempts" as has apparently been specified and has been deprecated. It will no longer be available starting with SIP.js release 0.16.0. Please update accordingly.'),this._transport=new this.options.transportConstructor(this.getLogger("sip.Transport"),this.options.transportOptions),this.initTransportCallbacks(),this._contact=this.initContact(),this._instanceId=this.options.instanceId?this.options.instanceId:Bi.newUUID(),Gt.parse(this._instanceId,"uuid")===-1)throw new Error("Invalid instanceId.");this._userAgentCore=this.initCore()}static makeURI(e){return Gt.URIParse(e)}static defaultOptions(){return{allowLegacyNotifications:!1,authorizationHa1:"",authorizationPassword:"",authorizationUsername:"",delegate:{},contactName:"",contactParams:{transport:"ws"},displayName:"",forceRport:!1,gracefulShutdown:!0,hackAllowUnregisteredOptionTags:!1,hackIpInContact:!1,hackViaTcp:!1,instanceId:"",instanceIdAlwaysAdded:!1,logBuiltinEnabled:!0,logConfiguration:!0,logConnector:()=>{},logLevel:"log",noAnswerTimeout:60,preloadedRouteSet:[],reconnectionAttempts:0,reconnectionDelay:4,sendInitialProvisionalResponse:!0,sessionDescriptionHandlerFactory:UQ(),sessionDescriptionHandlerFactoryOptions:{},sipExtension100rel:Kr.Unsupported,sipExtensionReplaces:Kr.Unsupported,sipExtensionExtraSupported:[],sipjsId:"",transportConstructor:dm,transportOptions:{},uri:new wi("sip","anonymous","anonymous.invalid"),userAgentString:"SIP.js/"+lQ,viaHost:""}}static newUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=Math.floor(Math.random()*16);return(t==="x"?r:r%4+8).toString(16)})}static stripUndefinedProperties(e){return Object.keys(e).reduce((t,r)=>(e[r]!==void 0&&(t[r]=e[r]),t),{})}get configuration(){return this.options}get contact(){return this._contact}get instanceId(){return this._instanceId}get state(){return this._state}get stateChange(){return this._stateEventEmitter}get transport(){return this._transport}get userAgentCore(){return this._userAgentCore}getLogger(e,t){return this.loggerFactory.getLogger(e,t)}getLoggerFactory(){return this.loggerFactory}isConnected(){return this.transport.isConnected()}reconnect(){return this.state===on.Stopped?Promise.reject(new Error("User agent stopped.")):Promise.resolve().then(()=>this.transport.connect())}start(){return this.state===on.Started?(this.logger.warn("User agent already started"),Promise.resolve()):(this.logger.log(`Starting ${this.configuration.uri}`),this.transitionState(on.Started),this.transport.connect())}stop(){return Zt(this,null,function*(){if(this.state===on.Stopped)return this.logger.warn("User agent already stopped"),Promise.resolve();if(this.logger.log(`Stopping ${this.configuration.uri}`),!this.options.gracefulShutdown)return this.logger.log("Dispose of transport"),this.transport.dispose().catch(a=>{throw this.logger.error(a.message),a}),this.logger.log("Dispose of core"),this.userAgentCore.dispose(),this._publishers={},this._registerers={},this._sessions={},this._subscriptions={},this.transitionState(on.Stopped),Promise.resolve();const e=Object.assign({},this._publishers),t=Object.assign({},this._registerers),r=Object.assign({},this._sessions),i=Object.assign({},this._subscriptions),s=this.transport,o=this.userAgentCore;this.logger.log("Dispose of registerers");for(const a in t)t[a]&&(yield t[a].dispose().catch(l=>{throw this.logger.error(l.message),delete this._registerers[a],l}));this.logger.log("Dispose of sessions");for(const a in r)r[a]&&(yield r[a].dispose().catch(l=>{throw this.logger.error(l.message),delete this._sessions[a],l}));this.logger.log("Dispose of subscriptions");for(const a in i)i[a]&&(yield i[a].dispose().catch(l=>{throw this.logger.error(l.message),delete this._subscriptions[a],l}));this.logger.log("Dispose of publishers");for(const a in e)e[a]&&(yield e[a].dispose().catch(l=>{throw this.logger.error(l.message),delete this._publishers[a],l}));this.logger.log("Dispose of transport"),yield s.dispose().catch(a=>{throw this.logger.error(a.message),a}),this.logger.log("Dispose of core"),o.dispose(),this.transitionState(on.Stopped)})}_makeInviter(e,t){return new GM(this,e,t)}attemptReconnection(e=1){const t=this.options.reconnectionAttempts,r=this.options.reconnectionDelay;if(e>t){this.logger.log("Maximum reconnection attempts reached");return}this.logger.log(`Reconnection attempt ${e} of ${t} - trying`),setTimeout(()=>{this.reconnect().then(()=>{this.logger.log(`Reconnection attempt ${e} of ${t} - succeeded`)}).catch(i=>{this.logger.error(i.message),this.logger.log(`Reconnection attempt ${e} of ${t} - failed`),this.attemptReconnection(++e)})},e===1?0:r*1e3)}initContact(){const e=this.options.contactName!==""?this.options.contactName:Po(8),t=this.options.contactParams;return{pubGruu:void 0,tempGruu:void 0,uri:new wi("sip",e,this.options.viaHost,void 0,t),toString:(i={})=>{const s=i.anonymous||!1,o=i.outbound||!1,a=i.register||!1;let l="<";return s?l+=this.contact.tempGruu||`sip:anonymous@anonymous.invalid;transport=${t.transport?t.transport:"ws"}`:a?l+=this.contact.uri:l+=this.contact.pubGruu||this.contact.uri,o&&(l+=";ob"),l+=">",this.options.instanceIdAlwaysAdded&&(l+=';+sip.instance="<urn:uuid:'+this._instanceId+'>"'),l}}}initCore(){let e=[];e.push("outbound"),this.options.sipExtension100rel===Kr.Supported&&e.push("100rel"),this.options.sipExtensionReplaces===Kr.Supported&&e.push("replaces"),this.options.sipExtensionExtraSupported&&e.push(...this.options.sipExtensionExtraSupported),this.options.hackAllowUnregisteredOptionTags||(e=e.filter(s=>bQ[s])),e=Array.from(new Set(e));const t=e.slice();(this.contact.pubGruu||this.contact.tempGruu)&&t.push("gruu");const r={aor:this.options.uri,contact:this.contact,displayName:this.options.displayName,loggerFactory:this.loggerFactory,hackViaTcp:this.options.hackViaTcp,routeSet:this.options.preloadedRouteSet,supportedOptionTags:e,supportedOptionTagsResponse:t,sipjsId:this.options.sipjsId,userAgentHeaderFieldValue:this.options.userAgentString,viaForceRport:this.options.forceRport,viaHost:this.options.viaHost,authenticationFactory:()=>{const s=this.options.authorizationUsername?this.options.authorizationUsername:this.options.uri.user,o=this.options.authorizationPassword?this.options.authorizationPassword:void 0,a=this.options.authorizationHa1?this.options.authorizationHa1:void 0;return new xQ(this.getLoggerFactory(),a,s,o)},transportAccessor:()=>this.transport},i={onInvite:s=>{var o;const a=new wQ(this,s);if(s.delegate={onCancel:l=>{a._onCancel(l)},onTransportError:l=>{this.logger.error("A transport error has occurred while handling an incoming INVITE request.")}},s.trying(),this.options.sipExtensionReplaces!==Kr.Unsupported){const c=s.message.parseHeader("replaces");if(c){const u=c.call_id;if(typeof u!="string")throw new Error("Type of call id is not string");const d=c.replaces_to_tag;if(typeof d!="string")throw new Error("Type of to tag is not string");const f=c.replaces_from_tag;if(typeof f!="string")throw new Error("type of from tag is not string");const p=u+d+f,m=this.userAgentCore.dialogs.get(p);if(!m){a.reject({statusCode:481});return}if(!m.early&&c.early_only===!0){a.reject({statusCode:486});return}const v=this._sessions[u+f]||this._sessions[u+d]||void 0;if(!v)throw new Error("Session does not exist.");a._replacee=v}}if(!((o=this.delegate)===null||o===void 0)&&o.onInvite){if(a.autoSendAnInitialProvisionalResponse){a.progress().then(()=>{var l;if(((l=this.delegate)===null||l===void 0?void 0:l.onInvite)===void 0)throw new Error("onInvite undefined.");this.delegate.onInvite(a)});return}this.delegate.onInvite(a);return}a.reject({statusCode:486})},onMessage:s=>{if(this.delegate&&this.delegate.onMessage){const o=new KM(s);this.delegate.onMessage(o)}else s.accept()},onNotify:s=>{if(this.delegate&&this.delegate.onNotify){const o=new X1(s);this.delegate.onNotify(o)}else this.options.allowLegacyNotifications?s.accept():s.reject({statusCode:481})},onRefer:s=>{this.logger.warn("Received an out of dialog REFER request"),this.delegate&&this.delegate.onReferRequest?this.delegate.onReferRequest(s):s.reject({statusCode:405})},onRegister:s=>{this.logger.warn("Received an out of dialog REGISTER request"),this.delegate&&this.delegate.onRegisterRequest?this.delegate.onRegisterRequest(s):s.reject({statusCode:405})},onSubscribe:s=>{this.logger.warn("Received an out of dialog SUBSCRIBE request"),this.delegate&&this.delegate.onSubscribeRequest?this.delegate.onSubscribeRequest(s):s.reject({statusCode:405})}};return new zQ(r,i)}initTransportCallbacks(){this.transport.onConnect=()=>this.onTransportConnect(),this.transport.onDisconnect=e=>this.onTransportDisconnect(e),this.transport.onMessage=e=>this.onTransportMessage(e)}onTransportConnect(){this.state!==on.Stopped&&this.delegate&&this.delegate.onConnect&&this.delegate.onConnect()}onTransportDisconnect(e){this.state!==on.Stopped&&(this.delegate&&this.delegate.onDisconnect&&this.delegate.onDisconnect(e),e&&this.options.reconnectionAttempts>0&&this.attemptReconnection())}onTransportMessage(e){const t=lh.parseMessage(e,this.getLogger("sip.Parser"));if(!t){this.logger.warn("Failed to parse incoming message. Dropping.");return}if(this.state===on.Stopped&&t instanceof ul){this.logger.warn(`Received ${t.method} request while stopped. Dropping.`);return}const r=()=>{const i=["from","to","call_id","cseq","via"];for(const s of i)if(!t.hasHeader(s))return this.logger.warn(`Missing mandatory header field : ${s}.`),!1;return!0};if(t instanceof ul){if(!r()){this.logger.warn("Request missing mandatory header field. Dropping.");return}if(!t.toTag&&t.callId.substr(0,5)===this.options.sipjsId){this.userAgentCore.replyStateless(t,{statusCode:482});return}const i=Xu(t.body),s=t.getHeader("content-length");if(s&&i<Number(s)){this.userAgentCore.replyStateless(t,{statusCode:400});return}}if(t instanceof qs){if(!r()){this.logger.warn("Response missing mandatory header field. Dropping.");return}if(t.getHeaders("via").length>1){this.logger.warn("More than one Via header field present in the response. Dropping.");return}if(t.via.host!==this.options.viaHost||t.via.port!==void 0){this.logger.warn("Via sent-by in the response does not match UA Via host value. Dropping.");return}const i=Xu(t.body),s=t.getHeader("content-length");if(s&&i<Number(s)){this.logger.warn("Message body length is lower than the value in Content-Length header field. Dropping.");return}}if(t instanceof ul){this.userAgentCore.receiveIncomingRequestFromTransport(t);return}if(t instanceof qs){this.userAgentCore.receiveIncomingResponseFromTransport(t);return}throw new Error("Invalid message type.")}transitionState(e,t){const r=()=>{throw new Error(`Invalid state transition from ${this._state} to ${e}`)};switch(this._state){case on.Started:e!==on.Stopped&&r();break;case on.Stopped:e!==on.Started&&r();break;default:throw new Error("Unknown state.")}this.logger.log(`Transitioned from ${this._state} to ${e}`),this._state=e,this._stateEventEmitter.emit(this._state)}}/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let nR;const fm=n=>nR=n,rR=Symbol();function Z1(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var wu;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(wu||(wu={}));function WQ(){const n=p_(!0),e=n.run(()=>de({}));let t=[],r=[];const i=Hl({install(s){fm(i),i._a=s,s.provide(rR,i),s.config.globalProperties.$pinia=i,r.forEach(o=>t.push(o)),r=[]},use(s){return!this._a&&!G6?r.push(s):t.push(s),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return i}const iR=()=>{};function i_(n,e,t,r=iR){n.push(e);const i=()=>{const s=n.indexOf(e);s>-1&&(n.splice(s,1),r())};return!t&&iy()&&sy(i),i}function Ca(n,...e){n.slice().forEach(t=>{t(...e)})}const JQ=n=>n();function Q1(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,r)=>n.set(r,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],i=n[t];Z1(i)&&Z1(r)&&n.hasOwnProperty(t)&&!Lt(r)&&!Ns(r)?n[t]=Q1(i,r):n[t]=r}return n}const KQ=Symbol();function GQ(n){return!Z1(n)||!n.hasOwnProperty(KQ)}const{assign:ps}=Object;function YQ(n){return!!(Lt(n)&&n.effect)}function XQ(n,e,t,r){const{state:i,actions:s,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=i?i():{});const u=$_(t.state.value[n]);return ps(u,s,Object.keys(o||{}).reduce((d,f)=>(d[f]=Hl(re(()=>{fm(t);const p=t._s.get(n);return o[f].call(p,p)})),d),{}))}return l=sR(n,c,e,t,r,!0),l}function sR(n,e,t={},r,i,s){let o;const a=ps({actions:{}},t),l={deep:!0};let c,u,d=[],f=[],p;const m=r.state.value[n];!s&&!m&&(r.state.value[n]={}),de({});let v;function x(g){let I;c=u=!1,typeof g=="function"?(g(r.state.value[n]),I={type:wu.patchFunction,storeId:n,events:p}):(Q1(r.state.value[n],g),I={type:wu.patchObject,payload:g,storeId:n,events:p});const R=v=Symbol();Dn().then(()=>{v===R&&(c=!0)}),u=!0,Ca(d,I,r.state.value[n])}const b=s?function(){const{state:I}=t,R=I?I():{};this.$patch(S=>{ps(S,R)})}:iR;function _(){o.stop(),d=[],f=[],r._s.delete(n)}function M(g,I){return function(){fm(r);const R=Array.from(arguments),S=[],k=[];function T(A){S.push(A)}function C(A){k.push(A)}Ca(f,{args:R,name:g,store:w,after:T,onError:C});let D;try{D=I.apply(this&&this.$id===n?this:w,R)}catch(A){throw Ca(k,A),A}return D instanceof Promise?D.then(A=>(Ca(S,A),A)).catch(A=>(Ca(k,A),Promise.reject(A))):(Ca(S,D),D)}}const h={_p:r,$id:n,$onAction:i_.bind(null,f),$patch:x,$reset:b,$subscribe(g,I={}){const R=i_(d,g,I.detached,()=>S()),S=o.run(()=>At(()=>r.state.value[n],k=>{(I.flush==="sync"?u:c)&&g({storeId:n,type:wu.direct,events:p},k)},ps({},l,I)));return R},$dispose:_},w=zr(h);r._s.set(n,w);const E=(r._a&&r._a.runWithContext||JQ)(()=>r._e.run(()=>(o=p_()).run(e)));for(const g in E){const I=E[g];if(Lt(I)&&!YQ(I)||Ns(I))s||(m&&GQ(I)&&(Lt(I)?I.value=m[g]:Q1(I,m[g])),r.state.value[n][g]=I);else if(typeof I=="function"){const R=M(g,I);E[g]=R,a.actions[g]=I}}return ps(w,E),ps(ze(w),E),Object.defineProperty(w,"$state",{get:()=>r.state.value[n],set:g=>{x(I=>{ps(I,g)})}}),r._p.forEach(g=>{ps(w,o.run(()=>g({store:w,app:r._a,pinia:r,options:a})))}),m&&s&&t.hydrate&&t.hydrate(w.$state,m),c=!0,u=!0,w}function ZQ(n,e,t){let r,i;const s=typeof e=="function";typeof n=="string"?(r=n,i=s?t:e):(i=n,r=n.id);function o(a,l){const c=DI();return a=a||(c?_t(rR,null):null),a&&fm(a),a=nR,a._s.has(r)||(s?sR(r,e,i,a):XQ(r,i,a)),a._s.get(r)}return o.$id=r,o}const QQ=ZQ("crm-global",()=>{const n=Ws(),{$dialog:e}=n.appContext.config.globalProperties;let t=de(!1),r=()=>{};function i(a){t.value=a}function s(a){r=a}function o(a){r(a)}return{$dialog:e,twilioEnabled:t,makeCall:o,setTwilioEnabled:i,setMakeCall:s}}),eee=n=>(tI("data-v-865177a0"),n=n(),nI(),n),tee={ref:"xaid",id:"remoteAudio"},nee={class:"flex flex-row-reverse items-center gap-1"},ree={class:"flex flex-col items-center justify-center gap-3"},iee={class:"flex flex-col items-center justify-center gap-1"},see={class:"text-xl font-medium"},oee={class:"text-sm text-gray-600"},aee={class:"text-xs text-gray-600"},lee={key:0,class:"my-1 text-base"},cee={key:0,class:"my-1 text-base"},uee={key:1,class:"flex gap-2"},dee={key:0},fee={key:1},hee={key:2},pee={key:3,class:"flex gap-2"},mee={class:"flex items-center gap-2"},gee={class:"max-w-[120px] truncate"},yee={key:0,class:"flex items-center gap-2"},vee={class:"my-1 min-w-[40px] text-center"},bee={key:1,class:"flex items-center gap-3"},wee={class:"my-1"},xee={key:2,class:"flex items-center gap-2"},See={key:0,class:"absolute top-0 right-0 w-72 max-h-56 overflow-y-auto z-[1030] cursor-move p-4 bg-white shadow-lg rounded z-50"},_ee=eee(()=>K("h3",{class:"font-semibold text-gray-700"},"Transfer Call To:",-1)),Cee={class:"flex justify-between items-center"},kee={__name:"App",setup(n){QQ();let e=de("Connecting...");const t=de({full_name:"",mobile_no:"",user_link:""});let r=de(!1),i=de(!1),s=de(!1),o=de(!1),a=de(!1),l=de(!1),c=de(null),u=de(null),d=de("");const f=de(!1),p=de({title:"",content:""});let m=null,v=de(""),x=de([]),b=null,_=null,M=null,h=null,w=null,y=0,E=null,g=null,I=null,R=0;function S(){return Zt(this,null,function*(){x.value=[];try{if(x=yield Cs("vulero_dialer.config.user_list.fetch_users_to_transfer",{},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}}),x.status=="OK"){const H=x.result.findIndex(z=>z.extension==_.result.extension);H!==-1&&x.result.splice(H,1),x.value=x.result}}catch(H){x.value=[]}})}function k(H){return Zt(this,null,function*(){try{const z=H.replace(/^\+?251/,"0"),U=yield Cs("vulero_dialer.config.get_contact.get_contact_info",{formattedNumber:z},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}});U&&U.data.length!==0?t.value={full_name:U.data.full_name,mobile_no:H}:t.value={full_name:"Unknown",mobile_no:H},U&&U.open_file_name!=""?t.value.user_link=`/app/${U.file_doc_type}/${U.open_file_name}`:t.value.user_link=`/app/${U.file_doc_type}/new}`}catch(z){console.log("contact error",z),t.value={full_name:"Unknown",mobile_no:H}}})}function T(H){return Zt(this,null,function*(){if(r.value=!0,b=H,v.value="",H.remoteIdentity&&H.remoteIdentity.displayName){H.remoteIdentity;let U=H.remoteIdentity.displayName;yield k(U)}else if(H.remoteIdentity&&H.remoteIdentity.uri.normal.user){H.remoteIdentity;let U=H.remoteIdentity.uri.normal.user;yield k(U)}else if(H.remoteIdentity&&H.remoteIdentity.uri.raw.user){H.remoteIdentity;let U=H.remoteIdentity.uri.raw.user;yield k(U)}const z=H.request.getHeader("Referred-By");if(z)try{const U=z.replace(/<|>/g,""),ne=Bi.makeURI(U);if(ne&&ne.user&&ne.user.includes("S")){let G=ne.user.split("S")[1];for(let te of x.result)te.extension===G&&(v.value=`Referer: ${te.cid_name}`)}}catch(U){v.value=""}else v.value="";m.play().then(()=>{}).catch(U=>{console.log(U),Notification.permission==="granted"&&new Notification("Incoming Call")}),H.stateChange.addListener(U=>{switch(U){case X.Establishing:break;case X.Established:$(H),m.pause(),r.value=!0,a.value=!1,s.value=!0,v.value="";break;case X.Terminated:b=null,r.value=!1,i.value==null?i=!1:i.value=!1,a.value=!1,s.value=!1,v.value="",l.value=!1,m.pause(),$e(),u.value.stop(),V("incoming");break}})})}const{width:C,height:D}=a$(),{x:A,y:O,style:P}=o$(c,{initialValue:{x:C.value-280,y:D.value-310},containerElement:document.body,preventDefault:!0,onMove:({x:H,y:z})=>{const U=c.value;if(!U)return;const{offsetWidth:ne,offsetHeight:G}=U;H.value=Math.min(C.value-ne,Math.max(0,H)),z.value=Math.min(D.value-G,Math.max(0,z))}});At([C,D],()=>{const H=c.value;if(!H)return;const{offsetWidth:z,offsetHeight:U}=H;A.value=Math.min(C.value-z,Math.max(0,A.value)),O.value=Math.min(D.value-U,Math.max(0,O.value))});function N(){return Zt(this,null,function*(){e.value="Requesting Access Token...",++y;try{_=yield Cs("vulero_dialer.config.call_setting.get_user_settings",{},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}})}catch(te){console.log("An error occured fetching connection details"),_=null;return}let{username:H,cid_name:z,ep_pass:U,pri_sip_address:ne}=_.result;if(!_||!_.result){console.log("Invalid connection details");return}y>3&&(ne=_.result.sec_sip_address),console.log(ne);const G=`wss://${ne}:8089/ws`;E=Bi.makeURI(`sip:${H}@${ne}`),w={uri:E,media:{remote:{audio:document.getElementById("remoteAudio")}},delegate:{onRefer:te=>Zt(this,null,function*(){console.log(te)}),onInvite:T,onMessage:function(te){console.log("Received SIP message:",te)},onRegistered:function(){console.log("Successfully registered!")},onRegistrationFailed:function(te){console.log("Registration failed:",te)}},transportOptions:{server:G,traceSip:!0,keepAliveInterval:5},register:!0,hackIpInContact:!0,authorizationUsername:H,authorizationPassword:U,displayName:z},h=new Bi(w),h.transport.stateChange.addListener(te=>{switch(te){case Me.Connecting:console.log("Attempting to connect to the server...");break;case Me.Connected:console.log("Successfully connected to the server."),R=1,window.dispatchEvent(new CustomEvent("statusEvent",{detail:"connected"}));break;case Me.Disconnecting:R=0,console.log("Disconnecting from the server..."),window.dispatchEvent(new CustomEvent("statusEvent",{detail:"disconnecting"}));break;case Me.Disconnected:R=0,console.log("Disconnected from the server."),y<10&&(setTimeout(()=>Zt(this,null,function*(){yield N(),console.log("Attempting Re-connection")}),5e3),window.dispatchEvent(new CustomEvent("statusEvent",{detail:"reconnecting"}))),window.dispatchEvent(new CustomEvent("statusEvent",{detail:"disconnected"}));break;case Me.Reconnecting:console.log("Reconnecting to the server...");break;default:console.log("Unknown transport state:",te);break}});try{yield F()}catch(te){e.value="An error occurred. "+te.message}})}function F(){return Zt(this,null,function*(){const H=new mi(h,E);h.start().then(()=>{H.register().catch(z=>console.log(z))})})}function j(){l.value=!l.value}function J(){a.value?(ie(!0),a.value=!1):(ie(!1),a.value=!0)}function ie(H){const U=b.sessionDescriptionHandler.peerConnection;if(!U)throw new Error("Peer connection closed.");U.getSenders().forEach(ne=>{ne.track&&(ne.track.enabled=H)})}function oe(){return Zt(this,null,function*(){e.value="Accepted incoming call.",s.value=!0,b.accept(),u.value.start()})}function he(){b.reject().catch(H=>console.log(H)),console.log("Call Rejected"),e.value="Rejected incoming call",r.value=!1,i.value==null?i=!1:i.value=!1,d.value="",a.value=!1}function ae(){e.value="Hanging up incoming call",s.value=!1,d.value="",a.value=!1,p.value={title:"",content:""},u.value.stop(),b.state=="Established"?b.bye().catch(H=>{}):b.cancel().catch(H=>{})}function B(H,z){return Zt(this,null,function*(){if(!R){window.frappe.msgprint("The user is offline and can't make calls right now");return}v.value="";let U=H;H=="join_queue"&&g!=null?H=g:H=="leave_queue"&&I!=null&&(H=I);const ne=Bi.makeURI(`sip:${H}@${z}`),G=new GM(h,ne,{earlyMedia:!0,sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}});b=G,yield h.start().then(()=>{G.invite()}).catch(te=>{console.error("Error <callWithTarget-sip>: ",te)}),yield k(H),H[0]!="*"&&(r.value=!0,o.value=!0,d.value="initiating"),G.stateChange.addListener(te=>{switch(te){case X.Initial:break;case X.Establishing:d.value="ringing",b=G,Ke(G);break;case X.Established:d.value="",b=G,r.value=!0,a.value=!1,s.value=!0,v.value="",o.value=!1,u.value.start(),$(G),window.dispatchEvent(new CustomEvent("queueEvent",{detail:U}));break;case X.Terminating:break;case X.Terminated:console.log("Call ended."),b=null,o.value=!1,t.value={full_name:"",mobile_no:"",user_link:""},s.value=!1,r.value=!1,i=!1,l.value=!1,d.value="",a.value=!1,u.value.stop(),V("outgoing");break;default:console.log("Unknown session state")}})})}function ee(){b&&(b.state=="Initial"||b.state=="Established"?b.bye():b.state=="Establishing"&&b.cancel()),b=null,r.value=!1,i.value==null?i=!1:i.value=!1,o.value=!1,s.value=!1,d.value="",a.value=!1,t.value={full_name:"",mobile_no:"",user_link:""}}function le(H){if(b){const z=Bi.makeURI(`sip:${H}@${M}`);b.refer(z).then(()=>{b=null,r.value=!1,i.value==null?i=!1:i.value=!1,l.value=!1,a.value=!1,s.value=!1,$e(),u.value.stop()}).catch(U=>{console.log("Can't Transfer call",U)})}}function me(){r.value=!r.value,i.value==null?i=!i:i.value=!i.value}function $e(){let H=document.getElementById("remoteAudio");H.srcObject=null,H.pause()}function Ke(H){const z=document.getElementById("remoteAudio"),U=new MediaStream;H.sessionDescriptionHandler.peerConnection.getReceivers().forEach(ne=>{ne.track&&U.addTrack(ne.track)}),z.srcObject=U,z.play()}function $(H){const z=document.getElementById("remoteAudio"),U=new MediaStream;H.sessionDescriptionHandler.peerConnection.getReceivers().forEach(ne=>{ne.track&&U.addTrack(ne.track)}),z.srcObject=U,z.play(),H.sessionDescriptionHandler.peerConnection.getReceivers().forEach(ne=>{ne.track&&U.addTrack(ne.track)})}function L(){window.frappe.open_in_new_tab=!0,window.frappe.set_route(t.value.user_link),window.frappe.open_in_new_tab=!1}function V(H){return Zt(this,null,function*(){H=="incoming"?yield Cs("vulero_dialer.config.call_log.fetch_and_process_call_logs",{},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}}):H=="outgoing"&&(yield Cs("vulero_dialer.config.call_log.fetch_and_process_outgoing_call_logs",{},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}}))})}return Et(()=>Zt(this,null,function*(){navigator.mediaDevices.getUserMedia({audio:!0}),yield N();try{let H=yield Cs("vulero_dialer.config.call_setting.get_queue_settings",{},{headers:{"X-Frappe-CSRF-Token":window.frappe.csrf_token}});H&&(g=H.join_dtmf,I=H.leave_dtmf)}catch(H){console.log("An error occured fetching queue details",H)}window.addEventListener("callEvent",function(H){B(H.detail.number,M)}),yield S(),m=new Audio("/assets/vulero_dialer/frontend/ring.mp3")})),At(()=>e.value,H=>{console.log(H)},{immediate:!0}),(H,z)=>{var ne;const U=mt("Button");return q(),Q(lt,null,[K("audio",tee,null,512),Xo(K("div",null,[K("div",{ref_key:"callPopup",ref:c,class:"fixed z-20 flex w-60 cursor-move select-none flex-col rounded-lg bg-gray-900 p-4 text-gray-300 shadow-2xl",style:Fl(we(P))},[K("div",nee,[ye(dP,{class:"h-4 w-4 cursor-pointer",onClick:me})]),K("div",ree,[ye(we(Nw),{image:t.value.image,label:t.value.full_name,class:De(["relative flex !h-24 !w-24 items-center justify-center [&>div]:text-[30px]",we(s)||we(o)?"":"pulse"])},null,8,["image","label","class"]),K("div",iee,[K("div",see,Ge(t.value.full_name),1),K("div",oee,Ge(t.value.mobile_no),1),K("div",aee,Ge(we(v)),1)]),ye(_P,{ref_key:"counterUp",ref:u},{default:Ue(()=>{var G;return[we(s)?(q(),Q("div",lee,Ge((G=we(u))==null?void 0:G.updatedTime),1)):He("",!0)]}),_:1},512),we(s)?He("",!0):(q(),Q("div",cee,Ge(we(d)=="initiating"?"Initiating call...":we(d)=="ringing"?"Ringing...":we(o)?"Calling...":"Incoming call..."),1)),we(s)?(q(),Q("div",uee,[ye(U,{icon:we(a)?"mic-off":"mic",class:"rounded-full",onClick:J},null,8,["icon"]),ye(U,{onClick:j,class:"rounded-full"},{icon:Ue(()=>[ye(yP,{class:"cursor-pointer rounded-full"})]),_:1}),ye(U,{class:"rounded-full"},{icon:Ue(()=>[t.value.first_name&&t.value.first_name!=="Unknown"?(q(),Q("div",dee,[ye(Y8,{class:"h-4 w-4 cursor-pointer rounded-full text-gray-900",onClick:z[0]||(z[0]=G=>L())})])):(q(),Q("div",fee,[ye(nP,{class:"h-4 w-4 cursor-pointer rounded-full text-gray-900",onClick:z[1]||(z[1]=G=>L())})]))]),_:1}),ye(U,{class:"rounded-full bg-red-600 hover:bg-red-700"},{icon:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white text-white",onClick:ae})]),_:1})])):we(o)||we(d)=="initiating"?(q(),Q("div",hee,[ye(U,{size:"md",variant:"solid",theme:"red",label:"Cancel",onClick:ee,class:"rounded-lg"},{prefix:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white"})]),_:1})])):(q(),Q("div",pee,[ye(U,{size:"md",variant:"solid",theme:"green",label:"Accept",class:"rounded-lg",onClick:oe},{prefix:Ue(()=>[ye(cs,{class:"h-4 w-4 fill-white"})]),_:1}),ye(U,{size:"md",variant:"solid",theme:"red",label:"Reject",class:"rounded-lg",onClick:he},{prefix:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white"})]),_:1})]))])],4)],512),[[Qo,we(r)]]),Xo(K("div",{class:"ml-2 flex cursor-pointer select-none items-center justify-between gap-3 rounded-lg bg-gray-900 px-2 py-[7px] text-base text-gray-300 fixed bottom-0 right-0 w-1/4",onClick:me},[K("div",mee,[ye(we(Nw),{image:t.value.image,label:t.value.full_name,class:"relative flex !h-5 !w-5 items-center justify-center"},null,8,["image","label"]),K("div",gee,Ge(t.value.full_name),1)]),we(s)?(q(),Q("div",yee,[K("div",vee,Ge((ne=we(u))==null?void 0:ne.updatedTime),1),ye(U,{variant:"solid",theme:"red",class:"!h-6 !w-6 rounded-full"},{icon:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white",onClick:Wa(ae,["stop"])})]),_:1})])):we(o)?(q(),Q("div",bee,[K("div",wee,Ge(we(d)=="ringing"?"Ringing...":"Calling..."),1),ye(U,{variant:"solid",theme:"red",class:"!h-6 !w-6 rounded-full",onClick:Wa(ee,["stop"])},{icon:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white"})]),_:1})])):(q(),Q("div",xee,[ye(U,{variant:"solid",theme:"green",class:"pulse relative !h-6 !w-6 rounded-full",onClick:Wa(oe,["stop"])},{icon:Ue(()=>[ye(cs,{class:"h-4 w-4 animate-pulse fill-white"})]),_:1}),ye(U,{variant:"solid",theme:"red",class:"!h-6 !w-6 rounded-full",onClick:Wa(he,["stop"])},{icon:Ue(()=>[ye(cs,{class:"h-4 w-4 rotate-[135deg] fill-white"})]),_:1})]))],512),[[Qo,we(i)]]),we(l)?(q(),Q("div",See,[_ee,K("ul",null,[(q(!0),Q(lt,null,Si(we(x).result,G=>(q(),Q("li",{key:G.id,class:"mb-2"},[K("div",Cee,[K("span",null,Ge(G.cid_name)+"-"+Ge(G.extension),1),ye(U,{class:"text-blue-500 hover:text-blue-700",onClick:te=>le(G.extension)},{default:Ue(()=>[Zo(" Transfer ")]),_:2},1032,["onClick"])])]))),128))])])):He("",!0),ye(OY,{modelValue:f.value,"onUpdate:modelValue":z[2]||(z[2]=G=>f.value=G),note:p.value,doctype:"CRM Call Log",onAfter:H.updateNote},null,8,["modelValue","note","onAfter"])],64)}}},Eee=je(kee,[["__scopeId","data-v-865177a0"]]);let Tee=de([]);function Aee(n){let e=zr(n);e.key=`dialog-${Math.random().toString(36).slice(2,9)}`,Tee.value.push(e),e.show=!0}let s_={Button:Dy,TextInput:pk,Input:x$,FormControl:Y$,ErrorMessage:F$,Dialog:$$,Alert:FP,Badge:K6,FeatherIcon:jo},Mee=WQ(),Cd=DO(Eee);Cd.use(Mee);Cd.use(V8);for(let n in s_)Cd.component(n,s_[n]);Cd.config.globalProperties.$dialog=Aee;Cd.mount("#app");export{x$ as $,Yr as A,p_ as B,M_ as C,$$ as D,Dn as E,gt as F,Fl as G,gy as H,Wa as I,_t as J,bn as K,Ws as L,mm as M,ei as N,Oee as O,Yt as P,Pr as Q,_i as R,Pee as S,wy as T,hy as U,lt as V,De as W,lk as X,Si as Y,Dy as Z,je as _,ye as a,Dee as a0,mS as a1,K as b,Q as c,Zo as d,re as e,de as f,At as g,iy as h,sy as i,Iee as j,zr as k,at as l,$_ as m,Ye as n,q as o,dt as p,Et as q,mt as r,fy as s,Ge as t,we as u,nn as v,Ue as w,bf as x,He as y,Mr as z};
//# sourceMappingURL=index-Dyl3I0Od.js.map
